<html>
<head>
<title>ajv.bundle.js</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.s0 { color: #cfd2d5;}
.s1 { color: #cc7832; font-weight: bold;}
.s2 { color: #8ea765;}
.s3 { color: #cc7832;}
.s4 { color: #6897bb;}
.s5 { color: #8a8a8a; font-style: italic;}
.s6 { color: #8a8a8a; font-weight: bold; font-style: italic;}
.s7 { color: #8a8a8a;}
.s8 { color: #808080;}
</style>
</head>
<body bgcolor="#1c1c1c">
<table CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#606060" >
<tr><td><center>
<font face="Arial, Helvetica" color="#000000">
ajv.bundle.js</font>
</center></td></tr></table>
<pre><span class="s0">(</span><span class="s1">function</span><span class="s0">(f){</span><span class="s1">if</span><span class="s0">(</span><span class="s1">typeof </span><span class="s0">exports===</span><span class="s2">&quot;object&quot;</span><span class="s0">&amp;&amp;</span><span class="s1">typeof </span><span class="s0">module!==</span><span class="s2">&quot;undefined&quot;</span><span class="s0">){module.exports=f()}</span><span class="s1">else if</span><span class="s0">(</span><span class="s1">typeof </span><span class="s0">define===</span><span class="s2">&quot;function&quot;</span><span class="s0">&amp;&amp;define.amd){define([]</span><span class="s3">,</span><span class="s0">f)}</span><span class="s1">else</span><span class="s0">{</span><span class="s1">var </span><span class="s0">g</span><span class="s3">;</span><span class="s1">if</span><span class="s0">(</span><span class="s1">typeof </span><span class="s0">window!==</span><span class="s2">&quot;undefined&quot;</span><span class="s0">){g=window}</span><span class="s1">else if</span><span class="s0">(</span><span class="s1">typeof </span><span class="s0">global!==</span><span class="s2">&quot;undefined&quot;</span><span class="s0">){g=global}</span><span class="s1">else if</span><span class="s0">(</span><span class="s1">typeof </span><span class="s0">self!==</span><span class="s2">&quot;undefined&quot;</span><span class="s0">){g=self}</span><span class="s1">else</span><span class="s0">{g=</span><span class="s1">this</span><span class="s0">}g.Ajv = f()}})(</span><span class="s1">function</span><span class="s0">(){</span><span class="s1">var </span><span class="s0">define</span><span class="s3">,</span><span class="s0">module</span><span class="s3">,</span><span class="s0">exports</span><span class="s3">;</span><span class="s1">return </span><span class="s0">(</span><span class="s1">function</span><span class="s0">(){</span><span class="s1">function </span><span class="s0">r(e</span><span class="s3">,</span><span class="s0">n</span><span class="s3">,</span><span class="s0">t){</span><span class="s1">function </span><span class="s0">o(i</span><span class="s3">,</span><span class="s0">f){</span><span class="s1">if</span><span class="s0">(!n[i]){</span><span class="s1">if</span><span class="s0">(!e[i]){</span><span class="s1">var </span><span class="s0">c=</span><span class="s2">&quot;function&quot;</span><span class="s0">==</span><span class="s1">typeof </span><span class="s0">require&amp;&amp;require</span><span class="s3">;</span><span class="s1">if</span><span class="s0">(!f&amp;&amp;c)</span><span class="s1">return </span><span class="s0">c(i</span><span class="s3">,</span><span class="s0">!</span><span class="s4">0</span><span class="s0">)</span><span class="s3">;</span><span class="s1">if</span><span class="s0">(u)</span><span class="s1">return </span><span class="s0">u(i</span><span class="s3">,</span><span class="s0">!</span><span class="s4">0</span><span class="s0">)</span><span class="s3">;</span><span class="s1">var </span><span class="s0">a=</span><span class="s1">new </span><span class="s0">Error(</span><span class="s2">&quot;Cannot find module '&quot;</span><span class="s0">+i+</span><span class="s2">&quot;'&quot;</span><span class="s0">)</span><span class="s3">;</span><span class="s1">throw </span><span class="s0">a.code=</span><span class="s2">&quot;MODULE_NOT_FOUND&quot;</span><span class="s3">,</span><span class="s0">a}</span><span class="s1">var </span><span class="s0">p=n[i]={exports:{}}</span><span class="s3">;</span><span class="s0">e[i][</span><span class="s4">0</span><span class="s0">].call(p.exports</span><span class="s3">,</span><span class="s1">function</span><span class="s0">(r){</span><span class="s1">var </span><span class="s0">n=e[i][</span><span class="s4">1</span><span class="s0">][r]</span><span class="s3">;</span><span class="s1">return </span><span class="s0">o(n||r)}</span><span class="s3">,</span><span class="s0">p</span><span class="s3">,</span><span class="s0">p.exports</span><span class="s3">,</span><span class="s0">r</span><span class="s3">,</span><span class="s0">e</span><span class="s3">,</span><span class="s0">n</span><span class="s3">,</span><span class="s0">t)}</span><span class="s1">return </span><span class="s0">n[i].exports}</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s0">u=</span><span class="s2">&quot;function&quot;</span><span class="s0">==</span><span class="s1">typeof </span><span class="s0">require&amp;&amp;require</span><span class="s3">,</span><span class="s0">i=</span><span class="s4">0</span><span class="s3">;</span><span class="s0">i&lt;t.length</span><span class="s3">;</span><span class="s0">i++)o(t[i])</span><span class="s3">;</span><span class="s1">return </span><span class="s0">o}</span><span class="s1">return </span><span class="s0">r})()({</span><span class="s4">1</span><span class="s0">:[</span><span class="s1">function</span><span class="s0">(require</span><span class="s3">,</span><span class="s0">module</span><span class="s3">,</span><span class="s0">exports){</span>
<span class="s2">'use strict'</span><span class="s3">;</span>


<span class="s1">var </span><span class="s0">Cache = module.exports = </span><span class="s1">function </span><span class="s0">Cache() {</span>
  <span class="s1">this</span><span class="s0">._cache = {}</span><span class="s3">;</span>
<span class="s0">}</span><span class="s3">;</span>


<span class="s0">Cache.prototype.put = </span><span class="s1">function </span><span class="s0">Cache_put(key</span><span class="s3">, </span><span class="s0">value) {</span>
  <span class="s1">this</span><span class="s0">._cache[key] = value</span><span class="s3">;</span>
<span class="s0">}</span><span class="s3">;</span>


<span class="s0">Cache.prototype.get = </span><span class="s1">function </span><span class="s0">Cache_get(key) {</span>
  <span class="s1">return this</span><span class="s0">._cache[key]</span><span class="s3">;</span>
<span class="s0">}</span><span class="s3">;</span>


<span class="s0">Cache.prototype.del = </span><span class="s1">function </span><span class="s0">Cache_del(key) {</span>
  <span class="s1">delete this</span><span class="s0">._cache[key]</span><span class="s3">;</span>
<span class="s0">}</span><span class="s3">;</span>


<span class="s0">Cache.prototype.clear = </span><span class="s1">function </span><span class="s0">Cache_clear() {</span>
  <span class="s1">this</span><span class="s0">._cache = {}</span><span class="s3">;</span>
<span class="s0">}</span><span class="s3">;</span>

<span class="s0">}</span><span class="s3">,</span><span class="s0">{}]</span><span class="s3">,</span><span class="s4">2</span><span class="s0">:[</span><span class="s1">function</span><span class="s0">(require</span><span class="s3">,</span><span class="s0">module</span><span class="s3">,</span><span class="s0">exports){</span>
<span class="s2">'use strict'</span><span class="s3">;</span>

<span class="s1">var </span><span class="s0">MissingRefError = require(</span><span class="s2">'./error_classes'</span><span class="s0">).MissingRef</span><span class="s3">;</span>

<span class="s0">module.exports = compileAsync</span><span class="s3">;</span>


<span class="s5">/**</span>
 <span class="s5">* Creates validating function for passed schema with asynchronous loading of missing schemas.</span>
 <span class="s5">* `loadSchema` option should be a function that accepts schema uri and returns promise that resolves with the schema.</span>
 <span class="s5">* </span><span class="s6">@this  </span><span class="s5">Ajv</span>
 <span class="s5">* </span><span class="s6">@param </span><span class="s5">{Object}   schema schema object</span>
 <span class="s5">* </span><span class="s6">@param </span><span class="s5">{Boolean}  meta optional true to compile meta-schema; this parameter can be skipped</span>
 <span class="s5">* </span><span class="s6">@param </span><span class="s5">{Function} callback an optional node-style callback, it is called with 2 parameters: error (or null) and validating function.</span>
 <span class="s5">* </span><span class="s6">@return </span><span class="s5">{Promise} promise that resolves with a validating function.</span>
 <span class="s5">*/</span>
<span class="s1">function </span><span class="s0">compileAsync(schema</span><span class="s3">, </span><span class="s0">meta</span><span class="s3">, </span><span class="s0">callback) {</span>
  <span class="s7">/* eslint no-shadow: 0 */</span>
  <span class="s7">/* global Promise */</span>
  <span class="s7">/* jshint validthis: true */</span>
  <span class="s1">var </span><span class="s0">self = </span><span class="s1">this</span><span class="s3">;</span>
  <span class="s1">if </span><span class="s0">(</span><span class="s1">typeof this</span><span class="s0">._opts.loadSchema != </span><span class="s2">'function'</span><span class="s0">)</span>
    <span class="s1">throw new </span><span class="s0">Error(</span><span class="s2">'options.loadSchema should be a function'</span><span class="s0">)</span><span class="s3">;</span>

  <span class="s1">if </span><span class="s0">(</span><span class="s1">typeof </span><span class="s0">meta == </span><span class="s2">'function'</span><span class="s0">) {</span>
    <span class="s0">callback = meta</span><span class="s3">;</span>
    <span class="s0">meta = undefined</span><span class="s3">;</span>
  <span class="s0">}</span>

  <span class="s1">var </span><span class="s0">p = loadMetaSchemaOf(schema).then(</span><span class="s1">function </span><span class="s0">() {</span>
    <span class="s1">var </span><span class="s0">schemaObj = self._addSchema(schema</span><span class="s3">, </span><span class="s0">undefined</span><span class="s3">, </span><span class="s0">meta)</span><span class="s3">;</span>
    <span class="s1">return </span><span class="s0">schemaObj.validate || _compileAsync(schemaObj)</span><span class="s3">;</span>
  <span class="s0">})</span><span class="s3">;</span>

  <span class="s1">if </span><span class="s0">(callback) {</span>
    <span class="s0">p.then(</span>
      <span class="s1">function</span><span class="s0">(v) { callback(</span><span class="s1">null</span><span class="s3">, </span><span class="s0">v)</span><span class="s3">; </span><span class="s0">}</span><span class="s3">,</span>
      <span class="s0">callback</span>
    <span class="s0">)</span><span class="s3">;</span>
  <span class="s0">}</span>

  <span class="s1">return </span><span class="s0">p</span><span class="s3">;</span>


  <span class="s1">function </span><span class="s0">loadMetaSchemaOf(sch) {</span>
    <span class="s1">var </span><span class="s0">$schema = sch.$schema</span><span class="s3">;</span>
    <span class="s1">return </span><span class="s0">$schema &amp;&amp; !self.getSchema($schema)</span>
            <span class="s0">? compileAsync.call(self</span><span class="s3">, </span><span class="s0">{ $ref: $schema }</span><span class="s3">, </span><span class="s1">true</span><span class="s0">)</span>
            <span class="s0">: Promise.resolve()</span><span class="s3">;</span>
  <span class="s0">}</span>


  <span class="s1">function </span><span class="s0">_compileAsync(schemaObj) {</span>
    <span class="s1">try </span><span class="s0">{ </span><span class="s1">return </span><span class="s0">self._compile(schemaObj)</span><span class="s3">; </span><span class="s0">}</span>
    <span class="s1">catch</span><span class="s0">(e) {</span>
      <span class="s1">if </span><span class="s0">(e </span><span class="s1">instanceof </span><span class="s0">MissingRefError) </span><span class="s1">return </span><span class="s0">loadMissingSchema(e)</span><span class="s3">;</span>
      <span class="s1">throw </span><span class="s0">e</span><span class="s3">;</span>
    <span class="s0">}</span>


    <span class="s1">function </span><span class="s0">loadMissingSchema(e) {</span>
      <span class="s1">var </span><span class="s0">ref = e.missingSchema</span><span class="s3">;</span>
      <span class="s1">if </span><span class="s0">(added(ref)) </span><span class="s1">throw new </span><span class="s0">Error(</span><span class="s2">'Schema ' </span><span class="s0">+ ref + </span><span class="s2">' is loaded but ' </span><span class="s0">+ e.missingRef + </span><span class="s2">' cannot be resolved'</span><span class="s0">)</span><span class="s3">;</span>

      <span class="s1">var </span><span class="s0">schemaPromise = self._loadingSchemas[ref]</span><span class="s3">;</span>
      <span class="s1">if </span><span class="s0">(!schemaPromise) {</span>
        <span class="s0">schemaPromise = self._loadingSchemas[ref] = self._opts.loadSchema(ref)</span><span class="s3">;</span>
        <span class="s0">schemaPromise.then(removePromise</span><span class="s3">, </span><span class="s0">removePromise)</span><span class="s3">;</span>
      <span class="s0">}</span>

      <span class="s1">return </span><span class="s0">schemaPromise.then(</span><span class="s1">function </span><span class="s0">(sch) {</span>
        <span class="s1">if </span><span class="s0">(!added(ref)) {</span>
          <span class="s1">return </span><span class="s0">loadMetaSchemaOf(sch).then(</span><span class="s1">function </span><span class="s0">() {</span>
            <span class="s1">if </span><span class="s0">(!added(ref)) self.addSchema(sch</span><span class="s3">, </span><span class="s0">ref</span><span class="s3">, </span><span class="s0">undefined</span><span class="s3">, </span><span class="s0">meta)</span><span class="s3">;</span>
          <span class="s0">})</span><span class="s3">;</span>
        <span class="s0">}</span>
      <span class="s0">}).then(</span><span class="s1">function</span><span class="s0">() {</span>
        <span class="s1">return </span><span class="s0">_compileAsync(schemaObj)</span><span class="s3">;</span>
      <span class="s0">})</span><span class="s3">;</span>

      <span class="s1">function </span><span class="s0">removePromise() {</span>
        <span class="s1">delete </span><span class="s0">self._loadingSchemas[ref]</span><span class="s3">;</span>
      <span class="s0">}</span>

      <span class="s1">function </span><span class="s0">added(ref) {</span>
        <span class="s1">return </span><span class="s0">self._refs[ref] || self._schemas[ref]</span><span class="s3">;</span>
      <span class="s0">}</span>
    <span class="s0">}</span>
  <span class="s0">}</span>
<span class="s0">}</span>

<span class="s0">}</span><span class="s3">,</span><span class="s0">{</span><span class="s2">&quot;./error_classes&quot;</span><span class="s0">:</span><span class="s4">3</span><span class="s0">}]</span><span class="s3">,</span><span class="s4">3</span><span class="s0">:[</span><span class="s1">function</span><span class="s0">(require</span><span class="s3">,</span><span class="s0">module</span><span class="s3">,</span><span class="s0">exports){</span>
<span class="s2">'use strict'</span><span class="s3">;</span>

<span class="s1">var </span><span class="s0">resolve = require(</span><span class="s2">'./resolve'</span><span class="s0">)</span><span class="s3">;</span>

<span class="s0">module.exports = {</span>
  <span class="s0">Validation: errorSubclass(ValidationError)</span><span class="s3">,</span>
  <span class="s0">MissingRef: errorSubclass(MissingRefError)</span>
<span class="s0">}</span><span class="s3">;</span>


<span class="s1">function </span><span class="s0">ValidationError(errors) {</span>
  <span class="s1">this</span><span class="s0">.message = </span><span class="s2">'validation failed'</span><span class="s3">;</span>
  <span class="s1">this</span><span class="s0">.errors = errors</span><span class="s3">;</span>
  <span class="s1">this</span><span class="s0">.ajv = </span><span class="s1">this</span><span class="s0">.validation = </span><span class="s1">true</span><span class="s3">;</span>
<span class="s0">}</span>


<span class="s0">MissingRefError.message = </span><span class="s1">function </span><span class="s0">(baseId</span><span class="s3">, </span><span class="s0">ref) {</span>
  <span class="s1">return </span><span class="s2">'can</span><span class="s3">\'</span><span class="s2">t resolve reference ' </span><span class="s0">+ ref + </span><span class="s2">' from id ' </span><span class="s0">+ baseId</span><span class="s3">;</span>
<span class="s0">}</span><span class="s3">;</span>


<span class="s1">function </span><span class="s0">MissingRefError(baseId</span><span class="s3">, </span><span class="s0">ref</span><span class="s3">, </span><span class="s0">message) {</span>
  <span class="s1">this</span><span class="s0">.message = message || MissingRefError.message(baseId</span><span class="s3">, </span><span class="s0">ref)</span><span class="s3">;</span>
  <span class="s1">this</span><span class="s0">.missingRef = resolve.url(baseId</span><span class="s3">, </span><span class="s0">ref)</span><span class="s3">;</span>
  <span class="s1">this</span><span class="s0">.missingSchema = resolve.normalizeId(resolve.fullPath(</span><span class="s1">this</span><span class="s0">.missingRef))</span><span class="s3">;</span>
<span class="s0">}</span>


<span class="s1">function </span><span class="s0">errorSubclass(Subclass) {</span>
  <span class="s0">Subclass.prototype = Object.create(Error.prototype)</span><span class="s3">;</span>
  <span class="s0">Subclass.prototype.constructor = Subclass</span><span class="s3">;</span>
  <span class="s1">return </span><span class="s0">Subclass</span><span class="s3">;</span>
<span class="s0">}</span>

<span class="s0">}</span><span class="s3">,</span><span class="s0">{</span><span class="s2">&quot;./resolve&quot;</span><span class="s0">:</span><span class="s4">6</span><span class="s0">}]</span><span class="s3">,</span><span class="s4">4</span><span class="s0">:[</span><span class="s1">function</span><span class="s0">(require</span><span class="s3">,</span><span class="s0">module</span><span class="s3">,</span><span class="s0">exports){</span>
<span class="s2">'use strict'</span><span class="s3">;</span>

<span class="s1">var </span><span class="s0">util = require(</span><span class="s2">'./util'</span><span class="s0">)</span><span class="s3">;</span>

<span class="s1">var </span><span class="s0">DATE = </span><span class="s4">/^(\d\d\d\d)-(\d\d)-(\d\d)$/</span><span class="s3">;</span>
<span class="s1">var </span><span class="s0">DAYS = [</span><span class="s4">0</span><span class="s3">,</span><span class="s4">31</span><span class="s3">,</span><span class="s4">28</span><span class="s3">,</span><span class="s4">31</span><span class="s3">,</span><span class="s4">30</span><span class="s3">,</span><span class="s4">31</span><span class="s3">,</span><span class="s4">30</span><span class="s3">,</span><span class="s4">31</span><span class="s3">,</span><span class="s4">31</span><span class="s3">,</span><span class="s4">30</span><span class="s3">,</span><span class="s4">31</span><span class="s3">,</span><span class="s4">30</span><span class="s3">,</span><span class="s4">31</span><span class="s0">]</span><span class="s3">;</span>
<span class="s1">var </span><span class="s0">TIME = </span><span class="s4">/^(\d\d):(\d\d):(\d\d)(\.\d+)?(z|[+-]\d\d(?::?\d\d)?)?$/i</span><span class="s3">;</span>
<span class="s1">var </span><span class="s0">HOSTNAME = </span><span class="s4">/^(?=.{1,253}\.?$)[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?(?:\.[a-z0-9](?:[-0-9a-z]{0,61}[0-9a-z])?)*\.?$/i</span><span class="s3">;</span>
<span class="s1">var </span><span class="s0">URI = </span><span class="s4">/^(?:[a-z][a-z0-9+\-.]*:)(?:\/?\/(?:(?:[a-z0-9\-._~!$&amp;'()*+,;=:]|%[0-9a-f]{2})*@)?(?:\[(?:(?:(?:(?:[0-9a-f]{1,4}:){6}|::(?:[0-9a-f]{1,4}:){5}|(?:[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){4}|(?:(?:[0-9a-f]{1,4}:){0,1}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){3}|(?:(?:[0-9a-f]{1,4}:){0,2}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){2}|(?:(?:[0-9a-f]{1,4}:){0,3}[0-9a-f]{1,4})?::[0-9a-f]{1,4}:|(?:(?:[0-9a-f]{1,4}:){0,4}[0-9a-f]{1,4})?::)(?:[0-9a-f]{1,4}:[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?))|(?:(?:[0-9a-f]{1,4}:){0,5}[0-9a-f]{1,4})?::[0-9a-f]{1,4}|(?:(?:[0-9a-f]{1,4}:){0,6}[0-9a-f]{1,4})?::)|[Vv][0-9a-f]+\.[a-z0-9\-._~!$&amp;'()*+,;=:]+)\]|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)|(?:[a-z0-9\-._~!$&amp;'()*+,;=]|%[0-9a-f]{2})*)(?::\d*)?(?:\/(?:[a-z0-9\-._~!$&amp;'()*+,;=:@]|%[0-9a-f]{2})*)*|\/(?:(?:[a-z0-9\-._~!$&amp;'()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&amp;'()*+,;=:@]|%[0-9a-f]{2})*)*)?|(?:[a-z0-9\-._~!$&amp;'()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&amp;'()*+,;=:@]|%[0-9a-f]{2})*)*)(?:\?(?:[a-z0-9\-._~!$&amp;'()*+,;=:@/?]|%[0-9a-f]{2})*)?(?:#(?:[a-z0-9\-._~!$&amp;'()*+,;=:@/?]|%[0-9a-f]{2})*)?$/i</span><span class="s3">;</span>
<span class="s1">var </span><span class="s0">URIREF = </span><span class="s4">/^(?:[a-z][a-z0-9+\-.]*:)?(?:\/?\/(?:(?:[a-z0-9\-._~!$&amp;'()*+,;=:]|%[0-9a-f]{2})*@)?(?:\[(?:(?:(?:(?:[0-9a-f]{1,4}:){6}|::(?:[0-9a-f]{1,4}:){5}|(?:[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){4}|(?:(?:[0-9a-f]{1,4}:){0,1}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){3}|(?:(?:[0-9a-f]{1,4}:){0,2}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){2}|(?:(?:[0-9a-f]{1,4}:){0,3}[0-9a-f]{1,4})?::[0-9a-f]{1,4}:|(?:(?:[0-9a-f]{1,4}:){0,4}[0-9a-f]{1,4})?::)(?:[0-9a-f]{1,4}:[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?))|(?:(?:[0-9a-f]{1,4}:){0,5}[0-9a-f]{1,4})?::[0-9a-f]{1,4}|(?:(?:[0-9a-f]{1,4}:){0,6}[0-9a-f]{1,4})?::)|[Vv][0-9a-f]+\.[a-z0-9\-._~!$&amp;'()*+,;=:]+)\]|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)|(?:[a-z0-9\-._~!$&amp;'&quot;()*+,;=]|%[0-9a-f]{2})*)(?::\d*)?(?:\/(?:[a-z0-9\-._~!$&amp;'&quot;()*+,;=:@]|%[0-9a-f]{2})*)*|\/(?:(?:[a-z0-9\-._~!$&amp;'&quot;()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&amp;'&quot;()*+,;=:@]|%[0-9a-f]{2})*)*)?|(?:[a-z0-9\-._~!$&amp;'&quot;()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&amp;'&quot;()*+,;=:@]|%[0-9a-f]{2})*)*)?(?:\?(?:[a-z0-9\-._~!$&amp;'&quot;()*+,;=:@/?]|%[0-9a-f]{2})*)?(?:#(?:[a-z0-9\-._~!$&amp;'&quot;()*+,;=:@/?]|%[0-9a-f]{2})*)?$/i</span><span class="s3">;</span>
<span class="s8">// uri-template: https://tools.ietf.org/html/rfc6570</span>
<span class="s1">var </span><span class="s0">URITEMPLATE = </span><span class="s4">/^(?:(?:[^\x00-\x20&quot;'&lt;&gt;%\\^`{|}]|%[0-9a-f]{2})|\{[+#./;?&amp;=,!@|]?(?:[a-z0-9_]|%[0-9a-f]{2})+(?::[1-9][0-9]{0,3}|\*)?(?:,(?:[a-z0-9_]|%[0-9a-f]{2})+(?::[1-9][0-9]{0,3}|\*)?)*\})*$/i</span><span class="s3">;</span>
<span class="s8">// For the source: https://gist.github.com/dperini/729294</span>
<span class="s8">// For test cases: https://mathiasbynens.be/demo/url-regex</span>
<span class="s8">// @todo Delete current URL in favour of the commented out URL rule when this issue is fixed https://github.com/eslint/eslint/issues/7983.</span>
<span class="s8">// var URL = /^(?:(?:https?|ftp):\/\/)(?:\S+(?::\S*)?@)?(?:(?!10(?:\.\d{1,3}){3})(?!127(?:\.\d{1,3}){3})(?!169\.254(?:\.\d{1,3}){2})(?!192\.168(?:\.\d{1,3}){2})(?!172\.(?:1[6-9]|2\d|3[0-1])(?:\.\d{1,3}){2})(?:[1-9]\d?|1\d\d|2[01]\d|22[0-3])(?:\.(?:1?\d{1,2}|2[0-4]\d|25[0-5])){2}(?:\.(?:[1-9]\d?|1\d\d|2[0-4]\d|25[0-4]))|(?:(?:[a-z\u{00a1}-\u{ffff}0-9]+-)*[a-z\u{00a1}-\u{ffff}0-9]+)(?:\.(?:[a-z\u{00a1}-\u{ffff}0-9]+-)*[a-z\u{00a1}-\u{ffff}0-9]+)*(?:\.(?:[a-z\u{00a1}-\u{ffff}]{2,})))(?::\d{2,5})?(?:\/[^\s]*)?$/iu;</span>
<span class="s1">var </span><span class="s0">URL = </span><span class="s4">/^(?:(?:http[s\u017F]?|ftp):\/\/)(?:(?:[\0-\x08\x0E-\x1F!-\x9F\xA1-\u167F\u1681-\u1FFF\u200B-\u2027\u202A-\u202E\u2030-\u205E\u2060-\u2FFF\u3001-\uD7FF\uE000-\uFEFE\uFF00-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])+(?::(?:[\0-\x08\x0E-\x1F!-\x9F\xA1-\u167F\u1681-\u1FFF\u200B-\u2027\u202A-\u202E\u2030-\u205E\u2060-\u2FFF\u3001-\uD7FF\uE000-\uFEFE\uFF00-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])*)?@)?(?:(?!10(?:\.[0-9]{1,3}){3})(?!127(?:\.[0-9]{1,3}){3})(?!169\.254(?:\.[0-9]{1,3}){2})(?!192\.168(?:\.[0-9]{1,3}){2})(?!172\.(?:1[6-9]|2[0-9]|3[01])(?:\.[0-9]{1,3}){2})(?:[1-9][0-9]?|1[0-9][0-9]|2[01][0-9]|22[0-3])(?:\.(?:1?[0-9]{1,2}|2[0-4][0-9]|25[0-5])){2}(?:\.(?:[1-9][0-9]?|1[0-9][0-9]|2[0-4][0-9]|25[0-4]))|(?:(?:(?:[0-9a-z\xA1-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])+-)*(?:[0-9a-z\xA1-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])+)(?:\.(?:(?:[0-9a-z\xA1-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])+-)*(?:[0-9a-z\xA1-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])+)*(?:\.(?:(?:[a-z\xA1-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]){2,})))(?::[0-9]{2,5})?(?:\/(?:[\0-\x08\x0E-\x1F!-\x9F\xA1-\u167F\u1681-\u1FFF\u200B-\u2027\u202A-\u202E\u2030-\u205E\u2060-\u2FFF\u3001-\uD7FF\uE000-\uFEFE\uFF00-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])*)?$/i</span><span class="s3">;</span>
<span class="s1">var </span><span class="s0">UUID = </span><span class="s4">/^(?:urn:uuid:)?[0-9a-f]{8}-(?:[0-9a-f]{4}-){3}[0-9a-f]{12}$/i</span><span class="s3">;</span>
<span class="s1">var </span><span class="s0">JSON_POINTER = </span><span class="s4">/^(?:\/(?:[^~/]|~0|~1)*)*$/</span><span class="s3">;</span>
<span class="s1">var </span><span class="s0">JSON_POINTER_URI_FRAGMENT = </span><span class="s4">/^#(?:\/(?:[a-z0-9_\-.!$&amp;'()*+,;:=@]|%[0-9a-f]{2}|~0|~1)*)*$/i</span><span class="s3">;</span>
<span class="s1">var </span><span class="s0">RELATIVE_JSON_POINTER = </span><span class="s4">/^(?:0|[1-9][0-9]*)(?:#|(?:\/(?:[^~/]|~0|~1)*)*)$/</span><span class="s3">;</span>


<span class="s0">module.exports = formats</span><span class="s3">;</span>

<span class="s1">function </span><span class="s0">formats(mode) {</span>
  <span class="s0">mode = mode == </span><span class="s2">'full' </span><span class="s0">? </span><span class="s2">'full' </span><span class="s0">: </span><span class="s2">'fast'</span><span class="s3">;</span>
  <span class="s1">return </span><span class="s0">util.copy(formats[mode])</span><span class="s3">;</span>
<span class="s0">}</span>


<span class="s0">formats.fast = {</span>
  <span class="s8">// date: http://tools.ietf.org/html/rfc3339#section-5.6</span>
  <span class="s0">date: </span><span class="s4">/^\d\d\d\d-[0-1]\d-[0-3]\d$/</span><span class="s3">,</span>
  <span class="s8">// date-time: http://tools.ietf.org/html/rfc3339#section-5.6</span>
  <span class="s0">time: </span><span class="s4">/^(?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d(?::?\d\d)?)?$/i</span><span class="s3">,</span>
  <span class="s2">'date-time'</span><span class="s0">: </span><span class="s4">/^\d\d\d\d-[0-1]\d-[0-3]\d[t\s](?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d(?::?\d\d)?)$/i</span><span class="s3">,</span>
  <span class="s8">// uri: https://github.com/mafintosh/is-my-json-valid/blob/master/formats.js</span>
  <span class="s0">uri: </span><span class="s4">/^(?:[a-z][a-z0-9+\-.]*:)(?:\/?\/)?[^\s]*$/i</span><span class="s3">,</span>
  <span class="s2">'uri-reference'</span><span class="s0">: </span><span class="s4">/^(?:(?:[a-z][a-z0-9+\-.]*:)?\/?\/)?(?:[^\\\s#][^\s#]*)?(?:#[^\\\s]*)?$/i</span><span class="s3">,</span>
  <span class="s2">'uri-template'</span><span class="s0">: URITEMPLATE</span><span class="s3">,</span>
  <span class="s0">url: URL</span><span class="s3">,</span>
  <span class="s8">// email (sources from jsen validator):</span>
  <span class="s8">// http://stackoverflow.com/questions/201323/using-a-regular-expression-to-validate-an-email-address#answer-8829363</span>
  <span class="s8">// http://www.w3.org/TR/html5/forms.html#valid-e-mail-address (search for 'willful violation')</span>
  <span class="s0">email: </span><span class="s4">/^[a-z0-9.!#$%&amp;'*+/=?^_`{|}~-]+@[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?(?:\.[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?)*$/i</span><span class="s3">,</span>
  <span class="s0">hostname: HOSTNAME</span><span class="s3">,</span>
  <span class="s8">// optimized https://www.safaribooksonline.com/library/view/regular-expressions-cookbook/9780596802837/ch07s16.html</span>
  <span class="s0">ipv4: </span><span class="s4">/^(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)$/</span><span class="s3">,</span>
  <span class="s8">// optimized http://stackoverflow.com/questions/53497/regular-expression-that-matches-valid-ipv6-addresses</span>
  <span class="s0">ipv6: </span><span class="s4">/^\s*(?:(?:(?:[0-9a-f]{1,4}:){7}(?:[0-9a-f]{1,4}|:))|(?:(?:[0-9a-f]{1,4}:){6}(?::[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(?:(?:[0-9a-f]{1,4}:){5}(?:(?:(?::[0-9a-f]{1,4}){1,2})|:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(?:(?:[0-9a-f]{1,4}:){4}(?:(?:(?::[0-9a-f]{1,4}){1,3})|(?:(?::[0-9a-f]{1,4})?:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?:(?:[0-9a-f]{1,4}:){3}(?:(?:(?::[0-9a-f]{1,4}){1,4})|(?:(?::[0-9a-f]{1,4}){0,2}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?:(?:[0-9a-f]{1,4}:){2}(?:(?:(?::[0-9a-f]{1,4}){1,5})|(?:(?::[0-9a-f]{1,4}){0,3}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?:(?:[0-9a-f]{1,4}:){1}(?:(?:(?::[0-9a-f]{1,4}){1,6})|(?:(?::[0-9a-f]{1,4}){0,4}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?::(?:(?:(?::[0-9a-f]{1,4}){1,7})|(?:(?::[0-9a-f]{1,4}){0,5}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:)))(?:%.+)?\s*$/i</span><span class="s3">,</span>
  <span class="s0">regex: regex</span><span class="s3">,</span>
  <span class="s8">// uuid: http://tools.ietf.org/html/rfc4122</span>
  <span class="s0">uuid: UUID</span><span class="s3">,</span>
  <span class="s8">// JSON-pointer: https://tools.ietf.org/html/rfc6901</span>
  <span class="s8">// uri fragment: https://tools.ietf.org/html/rfc3986#appendix-A</span>
  <span class="s2">'json-pointer'</span><span class="s0">: JSON_POINTER</span><span class="s3">,</span>
  <span class="s2">'json-pointer-uri-fragment'</span><span class="s0">: JSON_POINTER_URI_FRAGMENT</span><span class="s3">,</span>
  <span class="s8">// relative JSON-pointer: http://tools.ietf.org/html/draft-luff-relative-json-pointer-00</span>
  <span class="s2">'relative-json-pointer'</span><span class="s0">: RELATIVE_JSON_POINTER</span>
<span class="s0">}</span><span class="s3">;</span>


<span class="s0">formats.full = {</span>
  <span class="s0">date: date</span><span class="s3">,</span>
  <span class="s0">time: time</span><span class="s3">,</span>
  <span class="s2">'date-time'</span><span class="s0">: date_time</span><span class="s3">,</span>
  <span class="s0">uri: uri</span><span class="s3">,</span>
  <span class="s2">'uri-reference'</span><span class="s0">: URIREF</span><span class="s3">,</span>
  <span class="s2">'uri-template'</span><span class="s0">: URITEMPLATE</span><span class="s3">,</span>
  <span class="s0">url: URL</span><span class="s3">,</span>
  <span class="s0">email: </span><span class="s4">/^[a-z0-9!#$%&amp;'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&amp;'*+/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?$/i</span><span class="s3">,</span>
  <span class="s0">hostname: HOSTNAME</span><span class="s3">,</span>
  <span class="s0">ipv4: </span><span class="s4">/^(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)$/</span><span class="s3">,</span>
  <span class="s0">ipv6: </span><span class="s4">/^\s*(?:(?:(?:[0-9a-f]{1,4}:){7}(?:[0-9a-f]{1,4}|:))|(?:(?:[0-9a-f]{1,4}:){6}(?::[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(?:(?:[0-9a-f]{1,4}:){5}(?:(?:(?::[0-9a-f]{1,4}){1,2})|:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(?:(?:[0-9a-f]{1,4}:){4}(?:(?:(?::[0-9a-f]{1,4}){1,3})|(?:(?::[0-9a-f]{1,4})?:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?:(?:[0-9a-f]{1,4}:){3}(?:(?:(?::[0-9a-f]{1,4}){1,4})|(?:(?::[0-9a-f]{1,4}){0,2}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?:(?:[0-9a-f]{1,4}:){2}(?:(?:(?::[0-9a-f]{1,4}){1,5})|(?:(?::[0-9a-f]{1,4}){0,3}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?:(?:[0-9a-f]{1,4}:){1}(?:(?:(?::[0-9a-f]{1,4}){1,6})|(?:(?::[0-9a-f]{1,4}){0,4}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?::(?:(?:(?::[0-9a-f]{1,4}){1,7})|(?:(?::[0-9a-f]{1,4}){0,5}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:)))(?:%.+)?\s*$/i</span><span class="s3">,</span>
  <span class="s0">regex: regex</span><span class="s3">,</span>
  <span class="s0">uuid: UUID</span><span class="s3">,</span>
  <span class="s2">'json-pointer'</span><span class="s0">: JSON_POINTER</span><span class="s3">,</span>
  <span class="s2">'json-pointer-uri-fragment'</span><span class="s0">: JSON_POINTER_URI_FRAGMENT</span><span class="s3">,</span>
  <span class="s2">'relative-json-pointer'</span><span class="s0">: RELATIVE_JSON_POINTER</span>
<span class="s0">}</span><span class="s3">;</span>


<span class="s1">function </span><span class="s0">isLeapYear(year) {</span>
  <span class="s8">// https://tools.ietf.org/html/rfc3339#appendix-C</span>
  <span class="s1">return </span><span class="s0">year % </span><span class="s4">4 </span><span class="s0">=== </span><span class="s4">0 </span><span class="s0">&amp;&amp; (year % </span><span class="s4">100 </span><span class="s0">!== </span><span class="s4">0 </span><span class="s0">|| year % </span><span class="s4">400 </span><span class="s0">=== </span><span class="s4">0</span><span class="s0">)</span><span class="s3">;</span>
<span class="s0">}</span>


<span class="s1">function </span><span class="s0">date(str) {</span>
  <span class="s8">// full-date from http://tools.ietf.org/html/rfc3339#section-5.6</span>
  <span class="s1">var </span><span class="s0">matches = str.match(DATE)</span><span class="s3">;</span>
  <span class="s1">if </span><span class="s0">(!matches) </span><span class="s1">return false</span><span class="s3">;</span>

  <span class="s1">var </span><span class="s0">year = +matches[</span><span class="s4">1</span><span class="s0">]</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">month = +matches[</span><span class="s4">2</span><span class="s0">]</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">day = +matches[</span><span class="s4">3</span><span class="s0">]</span><span class="s3">;</span>

  <span class="s1">return </span><span class="s0">month &gt;= </span><span class="s4">1 </span><span class="s0">&amp;&amp; month &lt;= </span><span class="s4">12 </span><span class="s0">&amp;&amp; day &gt;= </span><span class="s4">1 </span><span class="s0">&amp;&amp;</span>
          <span class="s0">day &lt;= (month == </span><span class="s4">2 </span><span class="s0">&amp;&amp; isLeapYear(year) ? </span><span class="s4">29 </span><span class="s0">: DAYS[month])</span><span class="s3">;</span>
<span class="s0">}</span>


<span class="s1">function </span><span class="s0">time(str</span><span class="s3">, </span><span class="s0">full) {</span>
  <span class="s1">var </span><span class="s0">matches = str.match(TIME)</span><span class="s3">;</span>
  <span class="s1">if </span><span class="s0">(!matches) </span><span class="s1">return false</span><span class="s3">;</span>

  <span class="s1">var </span><span class="s0">hour = matches[</span><span class="s4">1</span><span class="s0">]</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">minute = matches[</span><span class="s4">2</span><span class="s0">]</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">second = matches[</span><span class="s4">3</span><span class="s0">]</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">timeZone = matches[</span><span class="s4">5</span><span class="s0">]</span><span class="s3">;</span>
  <span class="s1">return </span><span class="s0">((hour &lt;= </span><span class="s4">23 </span><span class="s0">&amp;&amp; minute &lt;= </span><span class="s4">59 </span><span class="s0">&amp;&amp; second &lt;= </span><span class="s4">59</span><span class="s0">) ||</span>
          <span class="s0">(hour == </span><span class="s4">23 </span><span class="s0">&amp;&amp; minute == </span><span class="s4">59 </span><span class="s0">&amp;&amp; second == </span><span class="s4">60</span><span class="s0">)) &amp;&amp;</span>
         <span class="s0">(!full || timeZone)</span><span class="s3">;</span>
<span class="s0">}</span>


<span class="s1">var </span><span class="s0">DATE_TIME_SEPARATOR = </span><span class="s4">/t|\s/i</span><span class="s3">;</span>
<span class="s1">function </span><span class="s0">date_time(str) {</span>
  <span class="s8">// http://tools.ietf.org/html/rfc3339#section-5.6</span>
  <span class="s1">var </span><span class="s0">dateTime = str.split(DATE_TIME_SEPARATOR)</span><span class="s3">;</span>
  <span class="s1">return </span><span class="s0">dateTime.length == </span><span class="s4">2 </span><span class="s0">&amp;&amp; date(dateTime[</span><span class="s4">0</span><span class="s0">]) &amp;&amp; time(dateTime[</span><span class="s4">1</span><span class="s0">]</span><span class="s3">, </span><span class="s1">true</span><span class="s0">)</span><span class="s3">;</span>
<span class="s0">}</span>


<span class="s1">var </span><span class="s0">NOT_URI_FRAGMENT = </span><span class="s4">/\/|:/</span><span class="s3">;</span>
<span class="s1">function </span><span class="s0">uri(str) {</span>
  <span class="s8">// http://jmrware.com/articles/2009/uri_regexp/URI_regex.html + optional protocol + required &quot;.&quot;</span>
  <span class="s1">return </span><span class="s0">NOT_URI_FRAGMENT.test(str) &amp;&amp; URI.test(str)</span><span class="s3">;</span>
<span class="s0">}</span>


<span class="s1">var </span><span class="s0">Z_ANCHOR = </span><span class="s4">/[^\\]\\Z/</span><span class="s3">;</span>
<span class="s1">function </span><span class="s0">regex(str) {</span>
  <span class="s1">if </span><span class="s0">(Z_ANCHOR.test(str)) </span><span class="s1">return false</span><span class="s3">;</span>
  <span class="s1">try </span><span class="s0">{</span>
    <span class="s1">new </span><span class="s0">RegExp(str)</span><span class="s3">;</span>
    <span class="s1">return true</span><span class="s3">;</span>
  <span class="s0">} </span><span class="s1">catch</span><span class="s0">(e) {</span>
    <span class="s1">return false</span><span class="s3">;</span>
  <span class="s0">}</span>
<span class="s0">}</span>

<span class="s0">}</span><span class="s3">,</span><span class="s0">{</span><span class="s2">&quot;./util&quot;</span><span class="s0">:</span><span class="s4">10</span><span class="s0">}]</span><span class="s3">,</span><span class="s4">5</span><span class="s0">:[</span><span class="s1">function</span><span class="s0">(require</span><span class="s3">,</span><span class="s0">module</span><span class="s3">,</span><span class="s0">exports){</span>
<span class="s2">'use strict'</span><span class="s3">;</span>

<span class="s1">var </span><span class="s0">resolve = require(</span><span class="s2">'./resolve'</span><span class="s0">)</span>
  <span class="s3">, </span><span class="s0">util = require(</span><span class="s2">'./util'</span><span class="s0">)</span>
  <span class="s3">, </span><span class="s0">errorClasses = require(</span><span class="s2">'./error_classes'</span><span class="s0">)</span>
  <span class="s3">, </span><span class="s0">stableStringify = require(</span><span class="s2">'fast-json-stable-stringify'</span><span class="s0">)</span><span class="s3">;</span>

<span class="s1">var </span><span class="s0">validateGenerator = require(</span><span class="s2">'../dotjs/validate'</span><span class="s0">)</span><span class="s3">;</span>

<span class="s5">/**</span>
 <span class="s5">* Functions below are used inside compiled validations function</span>
 <span class="s5">*/</span>

<span class="s1">var </span><span class="s0">ucs2length = util.ucs2length</span><span class="s3">;</span>
<span class="s1">var </span><span class="s0">equal = require(</span><span class="s2">'fast-deep-equal'</span><span class="s0">)</span><span class="s3">;</span>

<span class="s8">// this error is thrown by async schemas to return validation errors via exception</span>
<span class="s1">var </span><span class="s0">ValidationError = errorClasses.Validation</span><span class="s3">;</span>

<span class="s0">module.exports = compile</span><span class="s3">;</span>


<span class="s5">/**</span>
 <span class="s5">* Compiles schema to validation function</span>
 <span class="s5">* </span><span class="s6">@this   </span><span class="s5">Ajv</span>
 <span class="s5">* </span><span class="s6">@param  </span><span class="s5">{Object} schema schema object</span>
 <span class="s5">* </span><span class="s6">@param  </span><span class="s5">{Object} root object with information about the root schema for this schema</span>
 <span class="s5">* </span><span class="s6">@param  </span><span class="s5">{Object} localRefs the hash of local references inside the schema (created by resolve.id), used for inline resolution</span>
 <span class="s5">* </span><span class="s6">@param  </span><span class="s5">{String} baseId base ID for IDs in the schema</span>
 <span class="s5">* </span><span class="s6">@return </span><span class="s5">{Function} validation function</span>
 <span class="s5">*/</span>
<span class="s1">function </span><span class="s0">compile(schema</span><span class="s3">, </span><span class="s0">root</span><span class="s3">, </span><span class="s0">localRefs</span><span class="s3">, </span><span class="s0">baseId) {</span>
  <span class="s7">/* jshint validthis: true, evil: true */</span>
  <span class="s7">/* eslint no-shadow: 0 */</span>
  <span class="s1">var </span><span class="s0">self = </span><span class="s1">this</span>
    <span class="s3">, </span><span class="s0">opts = </span><span class="s1">this</span><span class="s0">._opts</span>
    <span class="s3">, </span><span class="s0">refVal = [ undefined ]</span>
    <span class="s3">, </span><span class="s0">refs = {}</span>
    <span class="s3">, </span><span class="s0">patterns = []</span>
    <span class="s3">, </span><span class="s0">patternsHash = {}</span>
    <span class="s3">, </span><span class="s0">defaults = []</span>
    <span class="s3">, </span><span class="s0">defaultsHash = {}</span>
    <span class="s3">, </span><span class="s0">customRules = []</span><span class="s3">;</span>

  <span class="s0">root = root || { schema: schema</span><span class="s3">, </span><span class="s0">refVal: refVal</span><span class="s3">, </span><span class="s0">refs: refs }</span><span class="s3">;</span>

  <span class="s1">var </span><span class="s0">c = checkCompiling.call(</span><span class="s1">this</span><span class="s3">, </span><span class="s0">schema</span><span class="s3">, </span><span class="s0">root</span><span class="s3">, </span><span class="s0">baseId)</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">compilation = </span><span class="s1">this</span><span class="s0">._compilations[c.index]</span><span class="s3">;</span>
  <span class="s1">if </span><span class="s0">(c.compiling) </span><span class="s1">return </span><span class="s0">(compilation.callValidate = callValidate)</span><span class="s3">;</span>

  <span class="s1">var </span><span class="s0">formats = </span><span class="s1">this</span><span class="s0">._formats</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">RULES = </span><span class="s1">this</span><span class="s0">.RULES</span><span class="s3">;</span>

  <span class="s1">try </span><span class="s0">{</span>
    <span class="s1">var </span><span class="s0">v = localCompile(schema</span><span class="s3">, </span><span class="s0">root</span><span class="s3">, </span><span class="s0">localRefs</span><span class="s3">, </span><span class="s0">baseId)</span><span class="s3">;</span>
    <span class="s0">compilation.validate = v</span><span class="s3">;</span>
    <span class="s1">var </span><span class="s0">cv = compilation.callValidate</span><span class="s3">;</span>
    <span class="s1">if </span><span class="s0">(cv) {</span>
      <span class="s0">cv.schema = v.schema</span><span class="s3">;</span>
      <span class="s0">cv.errors = </span><span class="s1">null</span><span class="s3">;</span>
      <span class="s0">cv.refs = v.refs</span><span class="s3">;</span>
      <span class="s0">cv.refVal = v.refVal</span><span class="s3">;</span>
      <span class="s0">cv.root = v.root</span><span class="s3">;</span>
      <span class="s0">cv.$async = v.$async</span><span class="s3">;</span>
      <span class="s1">if </span><span class="s0">(opts.sourceCode) cv.source = v.source</span><span class="s3">;</span>
    <span class="s0">}</span>
    <span class="s1">return </span><span class="s0">v</span><span class="s3">;</span>
  <span class="s0">} </span><span class="s1">finally </span><span class="s0">{</span>
    <span class="s0">endCompiling.call(</span><span class="s1">this</span><span class="s3">, </span><span class="s0">schema</span><span class="s3">, </span><span class="s0">root</span><span class="s3">, </span><span class="s0">baseId)</span><span class="s3">;</span>
  <span class="s0">}</span>

  <span class="s7">/* @this   {*} - custom context, see passContext option */</span>
  <span class="s1">function </span><span class="s0">callValidate() {</span>
    <span class="s7">/* jshint validthis: true */</span>
    <span class="s1">var </span><span class="s0">validate = compilation.validate</span><span class="s3">;</span>
    <span class="s1">var </span><span class="s0">result = validate.apply(</span><span class="s1">this</span><span class="s3">, </span><span class="s0">arguments)</span><span class="s3">;</span>
    <span class="s0">callValidate.errors = validate.errors</span><span class="s3">;</span>
    <span class="s1">return </span><span class="s0">result</span><span class="s3">;</span>
  <span class="s0">}</span>

  <span class="s1">function </span><span class="s0">localCompile(_schema</span><span class="s3">, </span><span class="s0">_root</span><span class="s3">, </span><span class="s0">localRefs</span><span class="s3">, </span><span class="s0">baseId) {</span>
    <span class="s1">var </span><span class="s0">isRoot = !_root || (_root &amp;&amp; _root.schema == _schema)</span><span class="s3">;</span>
    <span class="s1">if </span><span class="s0">(_root.schema != root.schema)</span>
      <span class="s1">return </span><span class="s0">compile.call(self</span><span class="s3">, </span><span class="s0">_schema</span><span class="s3">, </span><span class="s0">_root</span><span class="s3">, </span><span class="s0">localRefs</span><span class="s3">, </span><span class="s0">baseId)</span><span class="s3">;</span>

    <span class="s1">var </span><span class="s0">$async = _schema.$async === </span><span class="s1">true</span><span class="s3">;</span>

    <span class="s1">var </span><span class="s0">sourceCode = validateGenerator({</span>
      <span class="s0">isTop: </span><span class="s1">true</span><span class="s3">,</span>
      <span class="s0">schema: _schema</span><span class="s3">,</span>
      <span class="s0">isRoot: isRoot</span><span class="s3">,</span>
      <span class="s0">baseId: baseId</span><span class="s3">,</span>
      <span class="s0">root: _root</span><span class="s3">,</span>
      <span class="s0">schemaPath: </span><span class="s2">''</span><span class="s3">,</span>
      <span class="s0">errSchemaPath: </span><span class="s2">'#'</span><span class="s3">,</span>
      <span class="s0">errorPath: </span><span class="s2">'&quot;&quot;'</span><span class="s3">,</span>
      <span class="s0">MissingRefError: errorClasses.MissingRef</span><span class="s3">,</span>
      <span class="s0">RULES: RULES</span><span class="s3">,</span>
      <span class="s0">validate: validateGenerator</span><span class="s3">,</span>
      <span class="s0">util: util</span><span class="s3">,</span>
      <span class="s0">resolve: resolve</span><span class="s3">,</span>
      <span class="s0">resolveRef: resolveRef</span><span class="s3">,</span>
      <span class="s0">usePattern: usePattern</span><span class="s3">,</span>
      <span class="s0">useDefault: useDefault</span><span class="s3">,</span>
      <span class="s0">useCustomRule: useCustomRule</span><span class="s3">,</span>
      <span class="s0">opts: opts</span><span class="s3">,</span>
      <span class="s0">formats: formats</span><span class="s3">,</span>
      <span class="s0">logger: self.logger</span><span class="s3">,</span>
      <span class="s0">self: self</span>
    <span class="s0">})</span><span class="s3">;</span>

    <span class="s0">sourceCode = vars(refVal</span><span class="s3">, </span><span class="s0">refValCode) + vars(patterns</span><span class="s3">, </span><span class="s0">patternCode)</span>
                   <span class="s0">+ vars(defaults</span><span class="s3">, </span><span class="s0">defaultCode) + vars(customRules</span><span class="s3">, </span><span class="s0">customRuleCode)</span>
                   <span class="s0">+ sourceCode</span><span class="s3">;</span>

    <span class="s1">if </span><span class="s0">(opts.processCode) sourceCode = opts.processCode(sourceCode</span><span class="s3">, </span><span class="s0">_schema)</span><span class="s3">;</span>
    <span class="s8">// console.log('\n\n\n *** \n', JSON.stringify(sourceCode));</span>
    <span class="s1">var </span><span class="s0">validate</span><span class="s3">;</span>
    <span class="s1">try </span><span class="s0">{</span>
      <span class="s1">var </span><span class="s0">makeValidate = </span><span class="s1">new </span><span class="s0">Function(</span>
        <span class="s2">'self'</span><span class="s3">,</span>
        <span class="s2">'RULES'</span><span class="s3">,</span>
        <span class="s2">'formats'</span><span class="s3">,</span>
        <span class="s2">'root'</span><span class="s3">,</span>
        <span class="s2">'refVal'</span><span class="s3">,</span>
        <span class="s2">'defaults'</span><span class="s3">,</span>
        <span class="s2">'customRules'</span><span class="s3">,</span>
        <span class="s2">'equal'</span><span class="s3">,</span>
        <span class="s2">'ucs2length'</span><span class="s3">,</span>
        <span class="s2">'ValidationError'</span><span class="s3">,</span>
        <span class="s0">sourceCode</span>
      <span class="s0">)</span><span class="s3">;</span>

      <span class="s0">validate = makeValidate(</span>
        <span class="s0">self</span><span class="s3">,</span>
        <span class="s0">RULES</span><span class="s3">,</span>
        <span class="s0">formats</span><span class="s3">,</span>
        <span class="s0">root</span><span class="s3">,</span>
        <span class="s0">refVal</span><span class="s3">,</span>
        <span class="s0">defaults</span><span class="s3">,</span>
        <span class="s0">customRules</span><span class="s3">,</span>
        <span class="s0">equal</span><span class="s3">,</span>
        <span class="s0">ucs2length</span><span class="s3">,</span>
        <span class="s0">ValidationError</span>
      <span class="s0">)</span><span class="s3">;</span>

      <span class="s0">refVal[</span><span class="s4">0</span><span class="s0">] = validate</span><span class="s3">;</span>
    <span class="s0">} </span><span class="s1">catch</span><span class="s0">(e) {</span>
      <span class="s0">self.logger.error(</span><span class="s2">'Error compiling schema, function code:'</span><span class="s3">, </span><span class="s0">sourceCode)</span><span class="s3">;</span>
      <span class="s1">throw </span><span class="s0">e</span><span class="s3">;</span>
    <span class="s0">}</span>

    <span class="s0">validate.schema = _schema</span><span class="s3">;</span>
    <span class="s0">validate.errors = </span><span class="s1">null</span><span class="s3">;</span>
    <span class="s0">validate.refs = refs</span><span class="s3">;</span>
    <span class="s0">validate.refVal = refVal</span><span class="s3">;</span>
    <span class="s0">validate.root = isRoot ? validate : _root</span><span class="s3">;</span>
    <span class="s1">if </span><span class="s0">($async) validate.$async = </span><span class="s1">true</span><span class="s3">;</span>
    <span class="s1">if </span><span class="s0">(opts.sourceCode === </span><span class="s1">true</span><span class="s0">) {</span>
      <span class="s0">validate.source = {</span>
        <span class="s0">code: sourceCode</span><span class="s3">,</span>
        <span class="s0">patterns: patterns</span><span class="s3">,</span>
        <span class="s0">defaults: defaults</span>
      <span class="s0">}</span><span class="s3">;</span>
    <span class="s0">}</span>

    <span class="s1">return </span><span class="s0">validate</span><span class="s3">;</span>
  <span class="s0">}</span>

  <span class="s1">function </span><span class="s0">resolveRef(baseId</span><span class="s3">, </span><span class="s0">ref</span><span class="s3">, </span><span class="s0">isRoot) {</span>
    <span class="s0">ref = resolve.url(baseId</span><span class="s3">, </span><span class="s0">ref)</span><span class="s3">;</span>
    <span class="s1">var </span><span class="s0">refIndex = refs[ref]</span><span class="s3">;</span>
    <span class="s1">var </span><span class="s0">_refVal</span><span class="s3">, </span><span class="s0">refCode</span><span class="s3">;</span>
    <span class="s1">if </span><span class="s0">(refIndex !== undefined) {</span>
      <span class="s0">_refVal = refVal[refIndex]</span><span class="s3">;</span>
      <span class="s0">refCode = </span><span class="s2">'refVal[' </span><span class="s0">+ refIndex + </span><span class="s2">']'</span><span class="s3">;</span>
      <span class="s1">return </span><span class="s0">resolvedRef(_refVal</span><span class="s3">, </span><span class="s0">refCode)</span><span class="s3">;</span>
    <span class="s0">}</span>
    <span class="s1">if </span><span class="s0">(!isRoot &amp;&amp; root.refs) {</span>
      <span class="s1">var </span><span class="s0">rootRefId = root.refs[ref]</span><span class="s3">;</span>
      <span class="s1">if </span><span class="s0">(rootRefId !== undefined) {</span>
        <span class="s0">_refVal = root.refVal[rootRefId]</span><span class="s3">;</span>
        <span class="s0">refCode = addLocalRef(ref</span><span class="s3">, </span><span class="s0">_refVal)</span><span class="s3">;</span>
        <span class="s1">return </span><span class="s0">resolvedRef(_refVal</span><span class="s3">, </span><span class="s0">refCode)</span><span class="s3">;</span>
      <span class="s0">}</span>
    <span class="s0">}</span>

    <span class="s0">refCode = addLocalRef(ref)</span><span class="s3">;</span>
    <span class="s1">var </span><span class="s0">v = resolve.call(self</span><span class="s3">, </span><span class="s0">localCompile</span><span class="s3">, </span><span class="s0">root</span><span class="s3">, </span><span class="s0">ref)</span><span class="s3">;</span>
    <span class="s1">if </span><span class="s0">(v === undefined) {</span>
      <span class="s1">var </span><span class="s0">localSchema = localRefs &amp;&amp; localRefs[ref]</span><span class="s3">;</span>
      <span class="s1">if </span><span class="s0">(localSchema) {</span>
        <span class="s0">v = resolve.inlineRef(localSchema</span><span class="s3">, </span><span class="s0">opts.inlineRefs)</span>
            <span class="s0">? localSchema</span>
            <span class="s0">: compile.call(self</span><span class="s3">, </span><span class="s0">localSchema</span><span class="s3">, </span><span class="s0">root</span><span class="s3">, </span><span class="s0">localRefs</span><span class="s3">, </span><span class="s0">baseId)</span><span class="s3">;</span>
      <span class="s0">}</span>
    <span class="s0">}</span>

    <span class="s1">if </span><span class="s0">(v === undefined) {</span>
      <span class="s0">removeLocalRef(ref)</span><span class="s3">;</span>
    <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
      <span class="s0">replaceLocalRef(ref</span><span class="s3">, </span><span class="s0">v)</span><span class="s3">;</span>
      <span class="s1">return </span><span class="s0">resolvedRef(v</span><span class="s3">, </span><span class="s0">refCode)</span><span class="s3">;</span>
    <span class="s0">}</span>
  <span class="s0">}</span>

  <span class="s1">function </span><span class="s0">addLocalRef(ref</span><span class="s3">, </span><span class="s0">v) {</span>
    <span class="s1">var </span><span class="s0">refId = refVal.length</span><span class="s3">;</span>
    <span class="s0">refVal[refId] = v</span><span class="s3">;</span>
    <span class="s0">refs[ref] = refId</span><span class="s3">;</span>
    <span class="s1">return </span><span class="s2">'refVal' </span><span class="s0">+ refId</span><span class="s3">;</span>
  <span class="s0">}</span>

  <span class="s1">function </span><span class="s0">removeLocalRef(ref) {</span>
    <span class="s1">delete </span><span class="s0">refs[ref]</span><span class="s3">;</span>
  <span class="s0">}</span>

  <span class="s1">function </span><span class="s0">replaceLocalRef(ref</span><span class="s3">, </span><span class="s0">v) {</span>
    <span class="s1">var </span><span class="s0">refId = refs[ref]</span><span class="s3">;</span>
    <span class="s0">refVal[refId] = v</span><span class="s3">;</span>
  <span class="s0">}</span>

  <span class="s1">function </span><span class="s0">resolvedRef(refVal</span><span class="s3">, </span><span class="s0">code) {</span>
    <span class="s1">return typeof </span><span class="s0">refVal == </span><span class="s2">'object' </span><span class="s0">|| </span><span class="s1">typeof </span><span class="s0">refVal == </span><span class="s2">'boolean'</span>
            <span class="s0">? { code: code</span><span class="s3">, </span><span class="s0">schema: refVal</span><span class="s3">, </span><span class="s0">inline: </span><span class="s1">true </span><span class="s0">}</span>
            <span class="s0">: { code: code</span><span class="s3">, </span><span class="s0">$async: refVal &amp;&amp; !!refVal.$async }</span><span class="s3">;</span>
  <span class="s0">}</span>

  <span class="s1">function </span><span class="s0">usePattern(regexStr) {</span>
    <span class="s1">var </span><span class="s0">index = patternsHash[regexStr]</span><span class="s3">;</span>
    <span class="s1">if </span><span class="s0">(index === undefined) {</span>
      <span class="s0">index = patternsHash[regexStr] = patterns.length</span><span class="s3">;</span>
      <span class="s0">patterns[index] = regexStr</span><span class="s3">;</span>
    <span class="s0">}</span>
    <span class="s1">return </span><span class="s2">'pattern' </span><span class="s0">+ index</span><span class="s3">;</span>
  <span class="s0">}</span>

  <span class="s1">function </span><span class="s0">useDefault(value) {</span>
    <span class="s1">switch </span><span class="s0">(</span><span class="s1">typeof </span><span class="s0">value) {</span>
      <span class="s1">case </span><span class="s2">'boolean'</span><span class="s0">:</span>
      <span class="s1">case </span><span class="s2">'number'</span><span class="s0">:</span>
        <span class="s1">return </span><span class="s2">'' </span><span class="s0">+ value</span><span class="s3">;</span>
      <span class="s1">case </span><span class="s2">'string'</span><span class="s0">:</span>
        <span class="s1">return </span><span class="s0">util.toQuotedString(value)</span><span class="s3">;</span>
      <span class="s1">case </span><span class="s2">'object'</span><span class="s0">:</span>
        <span class="s1">if </span><span class="s0">(value === </span><span class="s1">null</span><span class="s0">) </span><span class="s1">return </span><span class="s2">'null'</span><span class="s3">;</span>
        <span class="s1">var </span><span class="s0">valueStr = stableStringify(value)</span><span class="s3">;</span>
        <span class="s1">var </span><span class="s0">index = defaultsHash[valueStr]</span><span class="s3">;</span>
        <span class="s1">if </span><span class="s0">(index === undefined) {</span>
          <span class="s0">index = defaultsHash[valueStr] = defaults.length</span><span class="s3">;</span>
          <span class="s0">defaults[index] = value</span><span class="s3">;</span>
        <span class="s0">}</span>
        <span class="s1">return </span><span class="s2">'default' </span><span class="s0">+ index</span><span class="s3">;</span>
    <span class="s0">}</span>
  <span class="s0">}</span>

  <span class="s1">function </span><span class="s0">useCustomRule(rule</span><span class="s3">, </span><span class="s0">schema</span><span class="s3">, </span><span class="s0">parentSchema</span><span class="s3">, </span><span class="s0">it) {</span>
    <span class="s1">if </span><span class="s0">(self._opts.validateSchema !== </span><span class="s1">false</span><span class="s0">) {</span>
      <span class="s1">var </span><span class="s0">deps = rule.definition.dependencies</span><span class="s3">;</span>
      <span class="s1">if </span><span class="s0">(deps &amp;&amp; !deps.every(</span><span class="s1">function</span><span class="s0">(keyword) {</span>
        <span class="s1">return </span><span class="s0">Object.prototype.hasOwnProperty.call(parentSchema</span><span class="s3">, </span><span class="s0">keyword)</span><span class="s3">;</span>
      <span class="s0">}))</span>
        <span class="s1">throw new </span><span class="s0">Error(</span><span class="s2">'parent schema must have all required keywords: ' </span><span class="s0">+ deps.join(</span><span class="s2">','</span><span class="s0">))</span><span class="s3">;</span>

      <span class="s1">var </span><span class="s0">validateSchema = rule.definition.validateSchema</span><span class="s3">;</span>
      <span class="s1">if </span><span class="s0">(validateSchema) {</span>
        <span class="s1">var </span><span class="s0">valid = validateSchema(schema)</span><span class="s3">;</span>
        <span class="s1">if </span><span class="s0">(!valid) {</span>
          <span class="s1">var </span><span class="s0">message = </span><span class="s2">'keyword schema is invalid: ' </span><span class="s0">+ self.errorsText(validateSchema.errors)</span><span class="s3">;</span>
          <span class="s1">if </span><span class="s0">(self._opts.validateSchema == </span><span class="s2">'log'</span><span class="s0">) self.logger.error(message)</span><span class="s3">;</span>
          <span class="s1">else throw new </span><span class="s0">Error(message)</span><span class="s3">;</span>
        <span class="s0">}</span>
      <span class="s0">}</span>
    <span class="s0">}</span>

    <span class="s1">var </span><span class="s0">compile = rule.definition.compile</span>
      <span class="s3">, </span><span class="s0">inline = rule.definition.inline</span>
      <span class="s3">, </span><span class="s0">macro = rule.definition.macro</span><span class="s3">;</span>

    <span class="s1">var </span><span class="s0">validate</span><span class="s3">;</span>
    <span class="s1">if </span><span class="s0">(compile) {</span>
      <span class="s0">validate = compile.call(self</span><span class="s3">, </span><span class="s0">schema</span><span class="s3">, </span><span class="s0">parentSchema</span><span class="s3">, </span><span class="s0">it)</span><span class="s3">;</span>
    <span class="s0">} </span><span class="s1">else if </span><span class="s0">(macro) {</span>
      <span class="s0">validate = macro.call(self</span><span class="s3">, </span><span class="s0">schema</span><span class="s3">, </span><span class="s0">parentSchema</span><span class="s3">, </span><span class="s0">it)</span><span class="s3">;</span>
      <span class="s1">if </span><span class="s0">(opts.validateSchema !== </span><span class="s1">false</span><span class="s0">) self.validateSchema(validate</span><span class="s3">, </span><span class="s1">true</span><span class="s0">)</span><span class="s3">;</span>
    <span class="s0">} </span><span class="s1">else if </span><span class="s0">(inline) {</span>
      <span class="s0">validate = inline.call(self</span><span class="s3">, </span><span class="s0">it</span><span class="s3">, </span><span class="s0">rule.keyword</span><span class="s3">, </span><span class="s0">schema</span><span class="s3">, </span><span class="s0">parentSchema)</span><span class="s3">;</span>
    <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
      <span class="s0">validate = rule.definition.validate</span><span class="s3">;</span>
      <span class="s1">if </span><span class="s0">(!validate) </span><span class="s1">return</span><span class="s3">;</span>
    <span class="s0">}</span>

    <span class="s1">if </span><span class="s0">(validate === undefined)</span>
      <span class="s1">throw new </span><span class="s0">Error(</span><span class="s2">'custom keyword &quot;' </span><span class="s0">+ rule.keyword + </span><span class="s2">'&quot;failed to compile'</span><span class="s0">)</span><span class="s3">;</span>

    <span class="s1">var </span><span class="s0">index = customRules.length</span><span class="s3">;</span>
    <span class="s0">customRules[index] = validate</span><span class="s3">;</span>

    <span class="s1">return </span><span class="s0">{</span>
      <span class="s0">code: </span><span class="s2">'customRule' </span><span class="s0">+ index</span><span class="s3">,</span>
      <span class="s0">validate: validate</span>
    <span class="s0">}</span><span class="s3">;</span>
  <span class="s0">}</span>
<span class="s0">}</span>


<span class="s5">/**</span>
 <span class="s5">* Checks if the schema is currently compiled</span>
 <span class="s5">* </span><span class="s6">@this   </span><span class="s5">Ajv</span>
 <span class="s5">* </span><span class="s6">@param  </span><span class="s5">{Object} schema schema to compile</span>
 <span class="s5">* </span><span class="s6">@param  </span><span class="s5">{Object} root root object</span>
 <span class="s5">* </span><span class="s6">@param  </span><span class="s5">{String} baseId base schema ID</span>
 <span class="s5">* </span><span class="s6">@return </span><span class="s5">{Object} object with properties &quot;index&quot; (compilation index) and &quot;compiling&quot; (boolean)</span>
 <span class="s5">*/</span>
<span class="s1">function </span><span class="s0">checkCompiling(schema</span><span class="s3">, </span><span class="s0">root</span><span class="s3">, </span><span class="s0">baseId) {</span>
  <span class="s7">/* jshint validthis: true */</span>
  <span class="s1">var </span><span class="s0">index = compIndex.call(</span><span class="s1">this</span><span class="s3">, </span><span class="s0">schema</span><span class="s3">, </span><span class="s0">root</span><span class="s3">, </span><span class="s0">baseId)</span><span class="s3">;</span>
  <span class="s1">if </span><span class="s0">(index &gt;= </span><span class="s4">0</span><span class="s0">) </span><span class="s1">return </span><span class="s0">{ index: index</span><span class="s3">, </span><span class="s0">compiling: </span><span class="s1">true </span><span class="s0">}</span><span class="s3">;</span>
  <span class="s0">index = </span><span class="s1">this</span><span class="s0">._compilations.length</span><span class="s3">;</span>
  <span class="s1">this</span><span class="s0">._compilations[index] = {</span>
    <span class="s0">schema: schema</span><span class="s3">,</span>
    <span class="s0">root: root</span><span class="s3">,</span>
    <span class="s0">baseId: baseId</span>
  <span class="s0">}</span><span class="s3">;</span>
  <span class="s1">return </span><span class="s0">{ index: index</span><span class="s3">, </span><span class="s0">compiling: </span><span class="s1">false </span><span class="s0">}</span><span class="s3">;</span>
<span class="s0">}</span>


<span class="s5">/**</span>
 <span class="s5">* Removes the schema from the currently compiled list</span>
 <span class="s5">* </span><span class="s6">@this   </span><span class="s5">Ajv</span>
 <span class="s5">* </span><span class="s6">@param  </span><span class="s5">{Object} schema schema to compile</span>
 <span class="s5">* </span><span class="s6">@param  </span><span class="s5">{Object} root root object</span>
 <span class="s5">* </span><span class="s6">@param  </span><span class="s5">{String} baseId base schema ID</span>
 <span class="s5">*/</span>
<span class="s1">function </span><span class="s0">endCompiling(schema</span><span class="s3">, </span><span class="s0">root</span><span class="s3">, </span><span class="s0">baseId) {</span>
  <span class="s7">/* jshint validthis: true */</span>
  <span class="s1">var </span><span class="s0">i = compIndex.call(</span><span class="s1">this</span><span class="s3">, </span><span class="s0">schema</span><span class="s3">, </span><span class="s0">root</span><span class="s3">, </span><span class="s0">baseId)</span><span class="s3">;</span>
  <span class="s1">if </span><span class="s0">(i &gt;= </span><span class="s4">0</span><span class="s0">) </span><span class="s1">this</span><span class="s0">._compilations.splice(i</span><span class="s3">, </span><span class="s4">1</span><span class="s0">)</span><span class="s3">;</span>
<span class="s0">}</span>


<span class="s5">/**</span>
 <span class="s5">* Index of schema compilation in the currently compiled list</span>
 <span class="s5">* </span><span class="s6">@this   </span><span class="s5">Ajv</span>
 <span class="s5">* </span><span class="s6">@param  </span><span class="s5">{Object} schema schema to compile</span>
 <span class="s5">* </span><span class="s6">@param  </span><span class="s5">{Object} root root object</span>
 <span class="s5">* </span><span class="s6">@param  </span><span class="s5">{String} baseId base schema ID</span>
 <span class="s5">* </span><span class="s6">@return </span><span class="s5">{Integer} compilation index</span>
 <span class="s5">*/</span>
<span class="s1">function </span><span class="s0">compIndex(schema</span><span class="s3">, </span><span class="s0">root</span><span class="s3">, </span><span class="s0">baseId) {</span>
  <span class="s7">/* jshint validthis: true */</span>
  <span class="s1">for </span><span class="s0">(</span><span class="s1">var </span><span class="s0">i=</span><span class="s4">0</span><span class="s3">; </span><span class="s0">i&lt;</span><span class="s1">this</span><span class="s0">._compilations.length</span><span class="s3">; </span><span class="s0">i++) {</span>
    <span class="s1">var </span><span class="s0">c = </span><span class="s1">this</span><span class="s0">._compilations[i]</span><span class="s3">;</span>
    <span class="s1">if </span><span class="s0">(c.schema == schema &amp;&amp; c.root == root &amp;&amp; c.baseId == baseId) </span><span class="s1">return </span><span class="s0">i</span><span class="s3">;</span>
  <span class="s0">}</span>
  <span class="s1">return </span><span class="s0">-</span><span class="s4">1</span><span class="s3">;</span>
<span class="s0">}</span>


<span class="s1">function </span><span class="s0">patternCode(i</span><span class="s3">, </span><span class="s0">patterns) {</span>
  <span class="s1">return </span><span class="s2">'var pattern' </span><span class="s0">+ i + </span><span class="s2">' = new RegExp(' </span><span class="s0">+ util.toQuotedString(patterns[i]) + </span><span class="s2">');'</span><span class="s3">;</span>
<span class="s0">}</span>


<span class="s1">function </span><span class="s0">defaultCode(i) {</span>
  <span class="s1">return </span><span class="s2">'var default' </span><span class="s0">+ i + </span><span class="s2">' = defaults[' </span><span class="s0">+ i + </span><span class="s2">'];'</span><span class="s3">;</span>
<span class="s0">}</span>


<span class="s1">function </span><span class="s0">refValCode(i</span><span class="s3">, </span><span class="s0">refVal) {</span>
  <span class="s1">return </span><span class="s0">refVal[i] === undefined ? </span><span class="s2">'' </span><span class="s0">: </span><span class="s2">'var refVal' </span><span class="s0">+ i + </span><span class="s2">' = refVal[' </span><span class="s0">+ i + </span><span class="s2">'];'</span><span class="s3">;</span>
<span class="s0">}</span>


<span class="s1">function </span><span class="s0">customRuleCode(i) {</span>
  <span class="s1">return </span><span class="s2">'var customRule' </span><span class="s0">+ i + </span><span class="s2">' = customRules[' </span><span class="s0">+ i + </span><span class="s2">'];'</span><span class="s3">;</span>
<span class="s0">}</span>


<span class="s1">function </span><span class="s0">vars(arr</span><span class="s3">, </span><span class="s0">statement) {</span>
  <span class="s1">if </span><span class="s0">(!arr.length) </span><span class="s1">return </span><span class="s2">''</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">code = </span><span class="s2">''</span><span class="s3">;</span>
  <span class="s1">for </span><span class="s0">(</span><span class="s1">var </span><span class="s0">i=</span><span class="s4">0</span><span class="s3">; </span><span class="s0">i&lt;arr.length</span><span class="s3">; </span><span class="s0">i++)</span>
    <span class="s0">code += statement(i</span><span class="s3">, </span><span class="s0">arr)</span><span class="s3">;</span>
  <span class="s1">return </span><span class="s0">code</span><span class="s3">;</span>
<span class="s0">}</span>

<span class="s0">}</span><span class="s3">,</span><span class="s0">{</span><span class="s2">&quot;../dotjs/validate&quot;</span><span class="s0">:</span><span class="s4">38</span><span class="s3">,</span><span class="s2">&quot;./error_classes&quot;</span><span class="s0">:</span><span class="s4">3</span><span class="s3">,</span><span class="s2">&quot;./resolve&quot;</span><span class="s0">:</span><span class="s4">6</span><span class="s3">,</span><span class="s2">&quot;./util&quot;</span><span class="s0">:</span><span class="s4">10</span><span class="s3">,</span><span class="s2">&quot;fast-deep-equal&quot;</span><span class="s0">:</span><span class="s4">42</span><span class="s3">,</span><span class="s2">&quot;fast-json-stable-stringify&quot;</span><span class="s0">:</span><span class="s4">43</span><span class="s0">}]</span><span class="s3">,</span><span class="s4">6</span><span class="s0">:[</span><span class="s1">function</span><span class="s0">(require</span><span class="s3">,</span><span class="s0">module</span><span class="s3">,</span><span class="s0">exports){</span>
<span class="s2">'use strict'</span><span class="s3">;</span>

<span class="s1">var </span><span class="s0">URI = require(</span><span class="s2">'uri-js'</span><span class="s0">)</span>
  <span class="s3">, </span><span class="s0">equal = require(</span><span class="s2">'fast-deep-equal'</span><span class="s0">)</span>
  <span class="s3">, </span><span class="s0">util = require(</span><span class="s2">'./util'</span><span class="s0">)</span>
  <span class="s3">, </span><span class="s0">SchemaObject = require(</span><span class="s2">'./schema_obj'</span><span class="s0">)</span>
  <span class="s3">, </span><span class="s0">traverse = require(</span><span class="s2">'json-schema-traverse'</span><span class="s0">)</span><span class="s3">;</span>

<span class="s0">module.exports = resolve</span><span class="s3">;</span>

<span class="s0">resolve.normalizeId = normalizeId</span><span class="s3">;</span>
<span class="s0">resolve.fullPath = getFullPath</span><span class="s3">;</span>
<span class="s0">resolve.url = resolveUrl</span><span class="s3">;</span>
<span class="s0">resolve.ids = resolveIds</span><span class="s3">;</span>
<span class="s0">resolve.inlineRef = inlineRef</span><span class="s3">;</span>
<span class="s0">resolve.schema = resolveSchema</span><span class="s3">;</span>

<span class="s5">/**</span>
 <span class="s5">* [resolve and compile the references ($ref)]</span>
 <span class="s5">* </span><span class="s6">@this   </span><span class="s5">Ajv</span>
 <span class="s5">* </span><span class="s6">@param  </span><span class="s5">{Function} compile reference to schema compilation funciton (localCompile)</span>
 <span class="s5">* </span><span class="s6">@param  </span><span class="s5">{Object} root object with information about the root schema for the current schema</span>
 <span class="s5">* </span><span class="s6">@param  </span><span class="s5">{String} ref reference to resolve</span>
 <span class="s5">* </span><span class="s6">@return </span><span class="s5">{Object|Function} schema object (if the schema can be inlined) or validation function</span>
 <span class="s5">*/</span>
<span class="s1">function </span><span class="s0">resolve(compile</span><span class="s3">, </span><span class="s0">root</span><span class="s3">, </span><span class="s0">ref) {</span>
  <span class="s7">/* jshint validthis: true */</span>
  <span class="s1">var </span><span class="s0">refVal = </span><span class="s1">this</span><span class="s0">._refs[ref]</span><span class="s3">;</span>
  <span class="s1">if </span><span class="s0">(</span><span class="s1">typeof </span><span class="s0">refVal == </span><span class="s2">'string'</span><span class="s0">) {</span>
    <span class="s1">if </span><span class="s0">(</span><span class="s1">this</span><span class="s0">._refs[refVal]) refVal = </span><span class="s1">this</span><span class="s0">._refs[refVal]</span><span class="s3">;</span>
    <span class="s1">else return </span><span class="s0">resolve.call(</span><span class="s1">this</span><span class="s3">, </span><span class="s0">compile</span><span class="s3">, </span><span class="s0">root</span><span class="s3">, </span><span class="s0">refVal)</span><span class="s3">;</span>
  <span class="s0">}</span>

  <span class="s0">refVal = refVal || </span><span class="s1">this</span><span class="s0">._schemas[ref]</span><span class="s3">;</span>
  <span class="s1">if </span><span class="s0">(refVal </span><span class="s1">instanceof </span><span class="s0">SchemaObject) {</span>
    <span class="s1">return </span><span class="s0">inlineRef(refVal.schema</span><span class="s3">, </span><span class="s1">this</span><span class="s0">._opts.inlineRefs)</span>
            <span class="s0">? refVal.schema</span>
            <span class="s0">: refVal.validate || </span><span class="s1">this</span><span class="s0">._compile(refVal)</span><span class="s3">;</span>
  <span class="s0">}</span>

  <span class="s1">var </span><span class="s0">res = resolveSchema.call(</span><span class="s1">this</span><span class="s3">, </span><span class="s0">root</span><span class="s3">, </span><span class="s0">ref)</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">schema</span><span class="s3">, </span><span class="s0">v</span><span class="s3">, </span><span class="s0">baseId</span><span class="s3">;</span>
  <span class="s1">if </span><span class="s0">(res) {</span>
    <span class="s0">schema = res.schema</span><span class="s3">;</span>
    <span class="s0">root = res.root</span><span class="s3">;</span>
    <span class="s0">baseId = res.baseId</span><span class="s3">;</span>
  <span class="s0">}</span>

  <span class="s1">if </span><span class="s0">(schema </span><span class="s1">instanceof </span><span class="s0">SchemaObject) {</span>
    <span class="s0">v = schema.validate || compile.call(</span><span class="s1">this</span><span class="s3">, </span><span class="s0">schema.schema</span><span class="s3">, </span><span class="s0">root</span><span class="s3">, </span><span class="s0">undefined</span><span class="s3">, </span><span class="s0">baseId)</span><span class="s3">;</span>
  <span class="s0">} </span><span class="s1">else if </span><span class="s0">(schema !== undefined) {</span>
    <span class="s0">v = inlineRef(schema</span><span class="s3">, </span><span class="s1">this</span><span class="s0">._opts.inlineRefs)</span>
        <span class="s0">? schema</span>
        <span class="s0">: compile.call(</span><span class="s1">this</span><span class="s3">, </span><span class="s0">schema</span><span class="s3">, </span><span class="s0">root</span><span class="s3">, </span><span class="s0">undefined</span><span class="s3">, </span><span class="s0">baseId)</span><span class="s3">;</span>
  <span class="s0">}</span>

  <span class="s1">return </span><span class="s0">v</span><span class="s3">;</span>
<span class="s0">}</span>


<span class="s5">/**</span>
 <span class="s5">* Resolve schema, its root and baseId</span>
 <span class="s5">* </span><span class="s6">@this </span><span class="s5">Ajv</span>
 <span class="s5">* </span><span class="s6">@param  </span><span class="s5">{Object} root root object with properties schema, refVal, refs</span>
 <span class="s5">* </span><span class="s6">@param  </span><span class="s5">{String} ref  reference to resolve</span>
 <span class="s5">* </span><span class="s6">@return </span><span class="s5">{Object} object with properties schema, root, baseId</span>
 <span class="s5">*/</span>
<span class="s1">function </span><span class="s0">resolveSchema(root</span><span class="s3">, </span><span class="s0">ref) {</span>
  <span class="s7">/* jshint validthis: true */</span>
  <span class="s1">var </span><span class="s0">p = URI.parse(ref)</span>
    <span class="s3">, </span><span class="s0">refPath = _getFullPath(p)</span>
    <span class="s3">, </span><span class="s0">baseId = getFullPath(</span><span class="s1">this</span><span class="s0">._getId(root.schema))</span><span class="s3">;</span>
  <span class="s1">if </span><span class="s0">(Object.keys(root.schema).length === </span><span class="s4">0 </span><span class="s0">|| refPath !== baseId) {</span>
    <span class="s1">var </span><span class="s0">id = normalizeId(refPath)</span><span class="s3">;</span>
    <span class="s1">var </span><span class="s0">refVal = </span><span class="s1">this</span><span class="s0">._refs[id]</span><span class="s3">;</span>
    <span class="s1">if </span><span class="s0">(</span><span class="s1">typeof </span><span class="s0">refVal == </span><span class="s2">'string'</span><span class="s0">) {</span>
      <span class="s1">return </span><span class="s0">resolveRecursive.call(</span><span class="s1">this</span><span class="s3">, </span><span class="s0">root</span><span class="s3">, </span><span class="s0">refVal</span><span class="s3">, </span><span class="s0">p)</span><span class="s3">;</span>
    <span class="s0">} </span><span class="s1">else if </span><span class="s0">(refVal </span><span class="s1">instanceof </span><span class="s0">SchemaObject) {</span>
      <span class="s1">if </span><span class="s0">(!refVal.validate) </span><span class="s1">this</span><span class="s0">._compile(refVal)</span><span class="s3">;</span>
      <span class="s0">root = refVal</span><span class="s3">;</span>
    <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
      <span class="s0">refVal = </span><span class="s1">this</span><span class="s0">._schemas[id]</span><span class="s3">;</span>
      <span class="s1">if </span><span class="s0">(refVal </span><span class="s1">instanceof </span><span class="s0">SchemaObject) {</span>
        <span class="s1">if </span><span class="s0">(!refVal.validate) </span><span class="s1">this</span><span class="s0">._compile(refVal)</span><span class="s3">;</span>
        <span class="s1">if </span><span class="s0">(id == normalizeId(ref))</span>
          <span class="s1">return </span><span class="s0">{ schema: refVal</span><span class="s3">, </span><span class="s0">root: root</span><span class="s3">, </span><span class="s0">baseId: baseId }</span><span class="s3">;</span>
        <span class="s0">root = refVal</span><span class="s3">;</span>
      <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
        <span class="s1">return</span><span class="s3">;</span>
      <span class="s0">}</span>
    <span class="s0">}</span>
    <span class="s1">if </span><span class="s0">(!root.schema) </span><span class="s1">return</span><span class="s3">;</span>
    <span class="s0">baseId = getFullPath(</span><span class="s1">this</span><span class="s0">._getId(root.schema))</span><span class="s3">;</span>
  <span class="s0">}</span>
  <span class="s1">return </span><span class="s0">getJsonPointer.call(</span><span class="s1">this</span><span class="s3">, </span><span class="s0">p</span><span class="s3">, </span><span class="s0">baseId</span><span class="s3">, </span><span class="s0">root.schema</span><span class="s3">, </span><span class="s0">root)</span><span class="s3">;</span>
<span class="s0">}</span>


<span class="s7">/* @this Ajv */</span>
<span class="s1">function </span><span class="s0">resolveRecursive(root</span><span class="s3">, </span><span class="s0">ref</span><span class="s3">, </span><span class="s0">parsedRef) {</span>
  <span class="s7">/* jshint validthis: true */</span>
  <span class="s1">var </span><span class="s0">res = resolveSchema.call(</span><span class="s1">this</span><span class="s3">, </span><span class="s0">root</span><span class="s3">, </span><span class="s0">ref)</span><span class="s3">;</span>
  <span class="s1">if </span><span class="s0">(res) {</span>
    <span class="s1">var </span><span class="s0">schema = res.schema</span><span class="s3">;</span>
    <span class="s1">var </span><span class="s0">baseId = res.baseId</span><span class="s3">;</span>
    <span class="s0">root = res.root</span><span class="s3">;</span>
    <span class="s1">var </span><span class="s0">id = </span><span class="s1">this</span><span class="s0">._getId(schema)</span><span class="s3">;</span>
    <span class="s1">if </span><span class="s0">(id) baseId = resolveUrl(baseId</span><span class="s3">, </span><span class="s0">id)</span><span class="s3">;</span>
    <span class="s1">return </span><span class="s0">getJsonPointer.call(</span><span class="s1">this</span><span class="s3">, </span><span class="s0">parsedRef</span><span class="s3">, </span><span class="s0">baseId</span><span class="s3">, </span><span class="s0">schema</span><span class="s3">, </span><span class="s0">root)</span><span class="s3">;</span>
  <span class="s0">}</span>
<span class="s0">}</span>


<span class="s1">var </span><span class="s0">PREVENT_SCOPE_CHANGE = util.toHash([</span><span class="s2">'properties'</span><span class="s3">, </span><span class="s2">'patternProperties'</span><span class="s3">, </span><span class="s2">'enum'</span><span class="s3">, </span><span class="s2">'dependencies'</span><span class="s3">, </span><span class="s2">'definitions'</span><span class="s0">])</span><span class="s3">;</span>
<span class="s7">/* @this Ajv */</span>
<span class="s1">function </span><span class="s0">getJsonPointer(parsedRef</span><span class="s3">, </span><span class="s0">baseId</span><span class="s3">, </span><span class="s0">schema</span><span class="s3">, </span><span class="s0">root) {</span>
  <span class="s7">/* jshint validthis: true */</span>
  <span class="s0">parsedRef.fragment = parsedRef.fragment || </span><span class="s2">''</span><span class="s3">;</span>
  <span class="s1">if </span><span class="s0">(parsedRef.fragment.slice(</span><span class="s4">0</span><span class="s3">,</span><span class="s4">1</span><span class="s0">) != </span><span class="s2">'/'</span><span class="s0">) </span><span class="s1">return</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">parts = parsedRef.fragment.split(</span><span class="s2">'/'</span><span class="s0">)</span><span class="s3">;</span>

  <span class="s1">for </span><span class="s0">(</span><span class="s1">var </span><span class="s0">i = </span><span class="s4">1</span><span class="s3">; </span><span class="s0">i &lt; parts.length</span><span class="s3">; </span><span class="s0">i++) {</span>
    <span class="s1">var </span><span class="s0">part = parts[i]</span><span class="s3">;</span>
    <span class="s1">if </span><span class="s0">(part) {</span>
      <span class="s0">part = util.unescapeFragment(part)</span><span class="s3">;</span>
      <span class="s0">schema = schema[part]</span><span class="s3">;</span>
      <span class="s1">if </span><span class="s0">(schema === undefined) </span><span class="s1">break</span><span class="s3">;</span>
      <span class="s1">var </span><span class="s0">id</span><span class="s3">;</span>
      <span class="s1">if </span><span class="s0">(!PREVENT_SCOPE_CHANGE[part]) {</span>
        <span class="s0">id = </span><span class="s1">this</span><span class="s0">._getId(schema)</span><span class="s3">;</span>
        <span class="s1">if </span><span class="s0">(id) baseId = resolveUrl(baseId</span><span class="s3">, </span><span class="s0">id)</span><span class="s3">;</span>
        <span class="s1">if </span><span class="s0">(schema.$ref) {</span>
          <span class="s1">var </span><span class="s0">$ref = resolveUrl(baseId</span><span class="s3">, </span><span class="s0">schema.$ref)</span><span class="s3">;</span>
          <span class="s1">var </span><span class="s0">res = resolveSchema.call(</span><span class="s1">this</span><span class="s3">, </span><span class="s0">root</span><span class="s3">, </span><span class="s0">$ref)</span><span class="s3">;</span>
          <span class="s1">if </span><span class="s0">(res) {</span>
            <span class="s0">schema = res.schema</span><span class="s3">;</span>
            <span class="s0">root = res.root</span><span class="s3">;</span>
            <span class="s0">baseId = res.baseId</span><span class="s3">;</span>
          <span class="s0">}</span>
        <span class="s0">}</span>
      <span class="s0">}</span>
    <span class="s0">}</span>
  <span class="s0">}</span>
  <span class="s1">if </span><span class="s0">(schema !== undefined &amp;&amp; schema !== root.schema)</span>
    <span class="s1">return </span><span class="s0">{ schema: schema</span><span class="s3">, </span><span class="s0">root: root</span><span class="s3">, </span><span class="s0">baseId: baseId }</span><span class="s3">;</span>
<span class="s0">}</span>


<span class="s1">var </span><span class="s0">SIMPLE_INLINED = util.toHash([</span>
  <span class="s2">'type'</span><span class="s3">, </span><span class="s2">'format'</span><span class="s3">, </span><span class="s2">'pattern'</span><span class="s3">,</span>
  <span class="s2">'maxLength'</span><span class="s3">, </span><span class="s2">'minLength'</span><span class="s3">,</span>
  <span class="s2">'maxProperties'</span><span class="s3">, </span><span class="s2">'minProperties'</span><span class="s3">,</span>
  <span class="s2">'maxItems'</span><span class="s3">, </span><span class="s2">'minItems'</span><span class="s3">,</span>
  <span class="s2">'maximum'</span><span class="s3">, </span><span class="s2">'minimum'</span><span class="s3">,</span>
  <span class="s2">'uniqueItems'</span><span class="s3">, </span><span class="s2">'multipleOf'</span><span class="s3">,</span>
  <span class="s2">'required'</span><span class="s3">, </span><span class="s2">'enum'</span>
<span class="s0">])</span><span class="s3">;</span>
<span class="s1">function </span><span class="s0">inlineRef(schema</span><span class="s3">, </span><span class="s0">limit) {</span>
  <span class="s1">if </span><span class="s0">(limit === </span><span class="s1">false</span><span class="s0">) </span><span class="s1">return false</span><span class="s3">;</span>
  <span class="s1">if </span><span class="s0">(limit === undefined || limit === </span><span class="s1">true</span><span class="s0">) </span><span class="s1">return </span><span class="s0">checkNoRef(schema)</span><span class="s3">;</span>
  <span class="s1">else if </span><span class="s0">(limit) </span><span class="s1">return </span><span class="s0">countKeys(schema) &lt;= limit</span><span class="s3">;</span>
<span class="s0">}</span>


<span class="s1">function </span><span class="s0">checkNoRef(schema) {</span>
  <span class="s1">var </span><span class="s0">item</span><span class="s3">;</span>
  <span class="s1">if </span><span class="s0">(Array.isArray(schema)) {</span>
    <span class="s1">for </span><span class="s0">(</span><span class="s1">var </span><span class="s0">i=</span><span class="s4">0</span><span class="s3">; </span><span class="s0">i&lt;schema.length</span><span class="s3">; </span><span class="s0">i++) {</span>
      <span class="s0">item = schema[i]</span><span class="s3">;</span>
      <span class="s1">if </span><span class="s0">(</span><span class="s1">typeof </span><span class="s0">item == </span><span class="s2">'object' </span><span class="s0">&amp;&amp; !checkNoRef(item)) </span><span class="s1">return false</span><span class="s3">;</span>
    <span class="s0">}</span>
  <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
    <span class="s1">for </span><span class="s0">(</span><span class="s1">var </span><span class="s0">key </span><span class="s1">in </span><span class="s0">schema) {</span>
      <span class="s1">if </span><span class="s0">(key == </span><span class="s2">'$ref'</span><span class="s0">) </span><span class="s1">return false</span><span class="s3">;</span>
      <span class="s0">item = schema[key]</span><span class="s3">;</span>
      <span class="s1">if </span><span class="s0">(</span><span class="s1">typeof </span><span class="s0">item == </span><span class="s2">'object' </span><span class="s0">&amp;&amp; !checkNoRef(item)) </span><span class="s1">return false</span><span class="s3">;</span>
    <span class="s0">}</span>
  <span class="s0">}</span>
  <span class="s1">return true</span><span class="s3">;</span>
<span class="s0">}</span>


<span class="s1">function </span><span class="s0">countKeys(schema) {</span>
  <span class="s1">var </span><span class="s0">count = </span><span class="s4">0</span><span class="s3">, </span><span class="s0">item</span><span class="s3">;</span>
  <span class="s1">if </span><span class="s0">(Array.isArray(schema)) {</span>
    <span class="s1">for </span><span class="s0">(</span><span class="s1">var </span><span class="s0">i=</span><span class="s4">0</span><span class="s3">; </span><span class="s0">i&lt;schema.length</span><span class="s3">; </span><span class="s0">i++) {</span>
      <span class="s0">item = schema[i]</span><span class="s3">;</span>
      <span class="s1">if </span><span class="s0">(</span><span class="s1">typeof </span><span class="s0">item == </span><span class="s2">'object'</span><span class="s0">) count += countKeys(item)</span><span class="s3">;</span>
      <span class="s1">if </span><span class="s0">(count == Infinity) </span><span class="s1">return </span><span class="s0">Infinity</span><span class="s3">;</span>
    <span class="s0">}</span>
  <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
    <span class="s1">for </span><span class="s0">(</span><span class="s1">var </span><span class="s0">key </span><span class="s1">in </span><span class="s0">schema) {</span>
      <span class="s1">if </span><span class="s0">(key == </span><span class="s2">'$ref'</span><span class="s0">) </span><span class="s1">return </span><span class="s0">Infinity</span><span class="s3">;</span>
      <span class="s1">if </span><span class="s0">(SIMPLE_INLINED[key]) {</span>
        <span class="s0">count++</span><span class="s3">;</span>
      <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
        <span class="s0">item = schema[key]</span><span class="s3">;</span>
        <span class="s1">if </span><span class="s0">(</span><span class="s1">typeof </span><span class="s0">item == </span><span class="s2">'object'</span><span class="s0">) count += countKeys(item) + </span><span class="s4">1</span><span class="s3">;</span>
        <span class="s1">if </span><span class="s0">(count == Infinity) </span><span class="s1">return </span><span class="s0">Infinity</span><span class="s3">;</span>
      <span class="s0">}</span>
    <span class="s0">}</span>
  <span class="s0">}</span>
  <span class="s1">return </span><span class="s0">count</span><span class="s3">;</span>
<span class="s0">}</span>


<span class="s1">function </span><span class="s0">getFullPath(id</span><span class="s3">, </span><span class="s0">normalize) {</span>
  <span class="s1">if </span><span class="s0">(normalize !== </span><span class="s1">false</span><span class="s0">) id = normalizeId(id)</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">p = URI.parse(id)</span><span class="s3">;</span>
  <span class="s1">return </span><span class="s0">_getFullPath(p)</span><span class="s3">;</span>
<span class="s0">}</span>


<span class="s1">function </span><span class="s0">_getFullPath(p) {</span>
  <span class="s1">return </span><span class="s0">URI.serialize(p).split(</span><span class="s2">'#'</span><span class="s0">)[</span><span class="s4">0</span><span class="s0">] + </span><span class="s2">'#'</span><span class="s3">;</span>
<span class="s0">}</span>


<span class="s1">var </span><span class="s0">TRAILING_SLASH_HASH = </span><span class="s4">/#\/?$/</span><span class="s3">;</span>
<span class="s1">function </span><span class="s0">normalizeId(id) {</span>
  <span class="s1">return </span><span class="s0">id ? id.replace(TRAILING_SLASH_HASH</span><span class="s3">, </span><span class="s2">''</span><span class="s0">) : </span><span class="s2">''</span><span class="s3">;</span>
<span class="s0">}</span>


<span class="s1">function </span><span class="s0">resolveUrl(baseId</span><span class="s3">, </span><span class="s0">id) {</span>
  <span class="s0">id = normalizeId(id)</span><span class="s3">;</span>
  <span class="s1">return </span><span class="s0">URI.resolve(baseId</span><span class="s3">, </span><span class="s0">id)</span><span class="s3">;</span>
<span class="s0">}</span>


<span class="s7">/* @this Ajv */</span>
<span class="s1">function </span><span class="s0">resolveIds(schema) {</span>
  <span class="s1">var </span><span class="s0">schemaId = normalizeId(</span><span class="s1">this</span><span class="s0">._getId(schema))</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">baseIds = {</span><span class="s2">''</span><span class="s0">: schemaId}</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">fullPaths = {</span><span class="s2">''</span><span class="s0">: getFullPath(schemaId</span><span class="s3">, </span><span class="s1">false</span><span class="s0">)}</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">localRefs = {}</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">self = </span><span class="s1">this</span><span class="s3">;</span>

  <span class="s0">traverse(schema</span><span class="s3">, </span><span class="s0">{allKeys: </span><span class="s1">true</span><span class="s0">}</span><span class="s3">, </span><span class="s1">function</span><span class="s0">(sch</span><span class="s3">, </span><span class="s0">jsonPtr</span><span class="s3">, </span><span class="s0">rootSchema</span><span class="s3">, </span><span class="s0">parentJsonPtr</span><span class="s3">, </span><span class="s0">parentKeyword</span><span class="s3">, </span><span class="s0">parentSchema</span><span class="s3">, </span><span class="s0">keyIndex) {</span>
    <span class="s1">if </span><span class="s0">(jsonPtr === </span><span class="s2">''</span><span class="s0">) </span><span class="s1">return</span><span class="s3">;</span>
    <span class="s1">var </span><span class="s0">id = self._getId(sch)</span><span class="s3">;</span>
    <span class="s1">var </span><span class="s0">baseId = baseIds[parentJsonPtr]</span><span class="s3">;</span>
    <span class="s1">var </span><span class="s0">fullPath = fullPaths[parentJsonPtr] + </span><span class="s2">'/' </span><span class="s0">+ parentKeyword</span><span class="s3">;</span>
    <span class="s1">if </span><span class="s0">(keyIndex !== undefined)</span>
      <span class="s0">fullPath += </span><span class="s2">'/' </span><span class="s0">+ (</span><span class="s1">typeof </span><span class="s0">keyIndex == </span><span class="s2">'number' </span><span class="s0">? keyIndex : util.escapeFragment(keyIndex))</span><span class="s3">;</span>

    <span class="s1">if </span><span class="s0">(</span><span class="s1">typeof </span><span class="s0">id == </span><span class="s2">'string'</span><span class="s0">) {</span>
      <span class="s0">id = baseId = normalizeId(baseId ? URI.resolve(baseId</span><span class="s3">, </span><span class="s0">id) : id)</span><span class="s3">;</span>

      <span class="s1">var </span><span class="s0">refVal = self._refs[id]</span><span class="s3">;</span>
      <span class="s1">if </span><span class="s0">(</span><span class="s1">typeof </span><span class="s0">refVal == </span><span class="s2">'string'</span><span class="s0">) refVal = self._refs[refVal]</span><span class="s3">;</span>
      <span class="s1">if </span><span class="s0">(refVal &amp;&amp; refVal.schema) {</span>
        <span class="s1">if </span><span class="s0">(!equal(sch</span><span class="s3">, </span><span class="s0">refVal.schema))</span>
          <span class="s1">throw new </span><span class="s0">Error(</span><span class="s2">'id &quot;' </span><span class="s0">+ id + </span><span class="s2">'&quot; resolves to more than one schema'</span><span class="s0">)</span><span class="s3">;</span>
      <span class="s0">} </span><span class="s1">else if </span><span class="s0">(id != normalizeId(fullPath)) {</span>
        <span class="s1">if </span><span class="s0">(id[</span><span class="s4">0</span><span class="s0">] == </span><span class="s2">'#'</span><span class="s0">) {</span>
          <span class="s1">if </span><span class="s0">(localRefs[id] &amp;&amp; !equal(sch</span><span class="s3">, </span><span class="s0">localRefs[id]))</span>
            <span class="s1">throw new </span><span class="s0">Error(</span><span class="s2">'id &quot;' </span><span class="s0">+ id + </span><span class="s2">'&quot; resolves to more than one schema'</span><span class="s0">)</span><span class="s3">;</span>
          <span class="s0">localRefs[id] = sch</span><span class="s3">;</span>
        <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
          <span class="s0">self._refs[id] = fullPath</span><span class="s3">;</span>
        <span class="s0">}</span>
      <span class="s0">}</span>
    <span class="s0">}</span>
    <span class="s0">baseIds[jsonPtr] = baseId</span><span class="s3">;</span>
    <span class="s0">fullPaths[jsonPtr] = fullPath</span><span class="s3">;</span>
  <span class="s0">})</span><span class="s3">;</span>

  <span class="s1">return </span><span class="s0">localRefs</span><span class="s3">;</span>
<span class="s0">}</span>

<span class="s0">}</span><span class="s3">,</span><span class="s0">{</span><span class="s2">&quot;./schema_obj&quot;</span><span class="s0">:</span><span class="s4">8</span><span class="s3">,</span><span class="s2">&quot;./util&quot;</span><span class="s0">:</span><span class="s4">10</span><span class="s3">,</span><span class="s2">&quot;fast-deep-equal&quot;</span><span class="s0">:</span><span class="s4">42</span><span class="s3">,</span><span class="s2">&quot;json-schema-traverse&quot;</span><span class="s0">:</span><span class="s4">44</span><span class="s3">,</span><span class="s2">&quot;uri-js&quot;</span><span class="s0">:</span><span class="s4">45</span><span class="s0">}]</span><span class="s3">,</span><span class="s4">7</span><span class="s0">:[</span><span class="s1">function</span><span class="s0">(require</span><span class="s3">,</span><span class="s0">module</span><span class="s3">,</span><span class="s0">exports){</span>
<span class="s2">'use strict'</span><span class="s3">;</span>

<span class="s1">var </span><span class="s0">ruleModules = require(</span><span class="s2">'../dotjs'</span><span class="s0">)</span>
  <span class="s3">, </span><span class="s0">toHash = require(</span><span class="s2">'./util'</span><span class="s0">).toHash</span><span class="s3">;</span>

<span class="s0">module.exports = </span><span class="s1">function </span><span class="s0">rules() {</span>
  <span class="s1">var </span><span class="s0">RULES = [</span>
    <span class="s0">{ type: </span><span class="s2">'number'</span><span class="s3">,</span>
      <span class="s0">rules: [ { </span><span class="s2">'maximum'</span><span class="s0">: [</span><span class="s2">'exclusiveMaximum'</span><span class="s0">] }</span><span class="s3">,</span>
               <span class="s0">{ </span><span class="s2">'minimum'</span><span class="s0">: [</span><span class="s2">'exclusiveMinimum'</span><span class="s0">] }</span><span class="s3">, </span><span class="s2">'multipleOf'</span><span class="s3">, </span><span class="s2">'format'</span><span class="s0">] }</span><span class="s3">,</span>
    <span class="s0">{ type: </span><span class="s2">'string'</span><span class="s3">,</span>
      <span class="s0">rules: [ </span><span class="s2">'maxLength'</span><span class="s3">, </span><span class="s2">'minLength'</span><span class="s3">, </span><span class="s2">'pattern'</span><span class="s3">, </span><span class="s2">'format' </span><span class="s0">] }</span><span class="s3">,</span>
    <span class="s0">{ type: </span><span class="s2">'array'</span><span class="s3">,</span>
      <span class="s0">rules: [ </span><span class="s2">'maxItems'</span><span class="s3">, </span><span class="s2">'minItems'</span><span class="s3">, </span><span class="s2">'items'</span><span class="s3">, </span><span class="s2">'contains'</span><span class="s3">, </span><span class="s2">'uniqueItems' </span><span class="s0">] }</span><span class="s3">,</span>
    <span class="s0">{ type: </span><span class="s2">'object'</span><span class="s3">,</span>
      <span class="s0">rules: [ </span><span class="s2">'maxProperties'</span><span class="s3">, </span><span class="s2">'minProperties'</span><span class="s3">, </span><span class="s2">'required'</span><span class="s3">, </span><span class="s2">'dependencies'</span><span class="s3">, </span><span class="s2">'propertyNames'</span><span class="s3">,</span>
               <span class="s0">{ </span><span class="s2">'properties'</span><span class="s0">: [</span><span class="s2">'additionalProperties'</span><span class="s3">, </span><span class="s2">'patternProperties'</span><span class="s0">] } ] }</span><span class="s3">,</span>
    <span class="s0">{ rules: [ </span><span class="s2">'$ref'</span><span class="s3">, </span><span class="s2">'const'</span><span class="s3">, </span><span class="s2">'enum'</span><span class="s3">, </span><span class="s2">'not'</span><span class="s3">, </span><span class="s2">'anyOf'</span><span class="s3">, </span><span class="s2">'oneOf'</span><span class="s3">, </span><span class="s2">'allOf'</span><span class="s3">, </span><span class="s2">'if' </span><span class="s0">] }</span>
  <span class="s0">]</span><span class="s3">;</span>

  <span class="s1">var </span><span class="s0">ALL = [ </span><span class="s2">'type'</span><span class="s3">, </span><span class="s2">'$comment' </span><span class="s0">]</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">KEYWORDS = [</span>
    <span class="s2">'$schema'</span><span class="s3">, </span><span class="s2">'$id'</span><span class="s3">, </span><span class="s2">'id'</span><span class="s3">, </span><span class="s2">'$data'</span><span class="s3">, </span><span class="s2">'$async'</span><span class="s3">, </span><span class="s2">'title'</span><span class="s3">,</span>
    <span class="s2">'description'</span><span class="s3">, </span><span class="s2">'default'</span><span class="s3">, </span><span class="s2">'definitions'</span><span class="s3">,</span>
    <span class="s2">'examples'</span><span class="s3">, </span><span class="s2">'readOnly'</span><span class="s3">, </span><span class="s2">'writeOnly'</span><span class="s3">,</span>
    <span class="s2">'contentMediaType'</span><span class="s3">, </span><span class="s2">'contentEncoding'</span><span class="s3">,</span>
    <span class="s2">'additionalItems'</span><span class="s3">, </span><span class="s2">'then'</span><span class="s3">, </span><span class="s2">'else'</span>
  <span class="s0">]</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">TYPES = [ </span><span class="s2">'number'</span><span class="s3">, </span><span class="s2">'integer'</span><span class="s3">, </span><span class="s2">'string'</span><span class="s3">, </span><span class="s2">'array'</span><span class="s3">, </span><span class="s2">'object'</span><span class="s3">, </span><span class="s2">'boolean'</span><span class="s3">, </span><span class="s2">'null' </span><span class="s0">]</span><span class="s3">;</span>
  <span class="s0">RULES.all = toHash(ALL)</span><span class="s3">;</span>
  <span class="s0">RULES.types = toHash(TYPES)</span><span class="s3">;</span>

  <span class="s0">RULES.forEach(</span><span class="s1">function </span><span class="s0">(group) {</span>
    <span class="s0">group.rules = group.rules.map(</span><span class="s1">function </span><span class="s0">(keyword) {</span>
      <span class="s1">var </span><span class="s0">implKeywords</span><span class="s3">;</span>
      <span class="s1">if </span><span class="s0">(</span><span class="s1">typeof </span><span class="s0">keyword == </span><span class="s2">'object'</span><span class="s0">) {</span>
        <span class="s1">var </span><span class="s0">key = Object.keys(keyword)[</span><span class="s4">0</span><span class="s0">]</span><span class="s3">;</span>
        <span class="s0">implKeywords = keyword[key]</span><span class="s3">;</span>
        <span class="s0">keyword = key</span><span class="s3">;</span>
        <span class="s0">implKeywords.forEach(</span><span class="s1">function </span><span class="s0">(k) {</span>
          <span class="s0">ALL.push(k)</span><span class="s3">;</span>
          <span class="s0">RULES.all[k] = </span><span class="s1">true</span><span class="s3">;</span>
        <span class="s0">})</span><span class="s3">;</span>
      <span class="s0">}</span>
      <span class="s0">ALL.push(keyword)</span><span class="s3">;</span>
      <span class="s1">var </span><span class="s0">rule = RULES.all[keyword] = {</span>
        <span class="s0">keyword: keyword</span><span class="s3">,</span>
        <span class="s0">code: ruleModules[keyword]</span><span class="s3">,</span>
        <span class="s1">implements</span><span class="s0">: implKeywords</span>
      <span class="s0">}</span><span class="s3">;</span>
      <span class="s1">return </span><span class="s0">rule</span><span class="s3">;</span>
    <span class="s0">})</span><span class="s3">;</span>

    <span class="s0">RULES.all.$comment = {</span>
      <span class="s0">keyword: </span><span class="s2">'$comment'</span><span class="s3">,</span>
      <span class="s0">code: ruleModules.$comment</span>
    <span class="s0">}</span><span class="s3">;</span>

    <span class="s1">if </span><span class="s0">(group.type) RULES.types[group.type] = group</span><span class="s3">;</span>
  <span class="s0">})</span><span class="s3">;</span>

  <span class="s0">RULES.keywords = toHash(ALL.concat(KEYWORDS))</span><span class="s3">;</span>
  <span class="s0">RULES.custom = {}</span><span class="s3">;</span>

  <span class="s1">return </span><span class="s0">RULES</span><span class="s3">;</span>
<span class="s0">}</span><span class="s3">;</span>

<span class="s0">}</span><span class="s3">,</span><span class="s0">{</span><span class="s2">&quot;../dotjs&quot;</span><span class="s0">:</span><span class="s4">27</span><span class="s3">,</span><span class="s2">&quot;./util&quot;</span><span class="s0">:</span><span class="s4">10</span><span class="s0">}]</span><span class="s3">,</span><span class="s4">8</span><span class="s0">:[</span><span class="s1">function</span><span class="s0">(require</span><span class="s3">,</span><span class="s0">module</span><span class="s3">,</span><span class="s0">exports){</span>
<span class="s2">'use strict'</span><span class="s3">;</span>

<span class="s1">var </span><span class="s0">util = require(</span><span class="s2">'./util'</span><span class="s0">)</span><span class="s3">;</span>

<span class="s0">module.exports = SchemaObject</span><span class="s3">;</span>

<span class="s1">function </span><span class="s0">SchemaObject(obj) {</span>
  <span class="s0">util.copy(obj</span><span class="s3">, </span><span class="s1">this</span><span class="s0">)</span><span class="s3">;</span>
<span class="s0">}</span>

<span class="s0">}</span><span class="s3">,</span><span class="s0">{</span><span class="s2">&quot;./util&quot;</span><span class="s0">:</span><span class="s4">10</span><span class="s0">}]</span><span class="s3">,</span><span class="s4">9</span><span class="s0">:[</span><span class="s1">function</span><span class="s0">(require</span><span class="s3">,</span><span class="s0">module</span><span class="s3">,</span><span class="s0">exports){</span>
<span class="s2">'use strict'</span><span class="s3">;</span>

<span class="s8">// https://mathiasbynens.be/notes/javascript-encoding</span>
<span class="s8">// https://github.com/bestiejs/punycode.js - punycode.ucs2.decode</span>
<span class="s0">module.exports = </span><span class="s1">function </span><span class="s0">ucs2length(str) {</span>
  <span class="s1">var </span><span class="s0">length = </span><span class="s4">0</span>
    <span class="s3">, </span><span class="s0">len = str.length</span>
    <span class="s3">, </span><span class="s0">pos = </span><span class="s4">0</span>
    <span class="s3">, </span><span class="s0">value</span><span class="s3">;</span>
  <span class="s1">while </span><span class="s0">(pos &lt; len) {</span>
    <span class="s0">length++</span><span class="s3">;</span>
    <span class="s0">value = str.charCodeAt(pos++)</span><span class="s3">;</span>
    <span class="s1">if </span><span class="s0">(value &gt;= </span><span class="s4">0xD800 </span><span class="s0">&amp;&amp; value &lt;= </span><span class="s4">0xDBFF </span><span class="s0">&amp;&amp; pos &lt; len) {</span>
      <span class="s8">// high surrogate, and there is a next character</span>
      <span class="s0">value = str.charCodeAt(pos)</span><span class="s3">;</span>
      <span class="s1">if </span><span class="s0">((value &amp; </span><span class="s4">0xFC00</span><span class="s0">) == </span><span class="s4">0xDC00</span><span class="s0">) pos++</span><span class="s3">; </span><span class="s8">// low surrogate</span>
    <span class="s0">}</span>
  <span class="s0">}</span>
  <span class="s1">return </span><span class="s0">length</span><span class="s3">;</span>
<span class="s0">}</span><span class="s3">;</span>

<span class="s0">}</span><span class="s3">,</span><span class="s0">{}]</span><span class="s3">,</span><span class="s4">10</span><span class="s0">:[</span><span class="s1">function</span><span class="s0">(require</span><span class="s3">,</span><span class="s0">module</span><span class="s3">,</span><span class="s0">exports){</span>
<span class="s2">'use strict'</span><span class="s3">;</span>


<span class="s0">module.exports = {</span>
  <span class="s0">copy: copy</span><span class="s3">,</span>
  <span class="s0">checkDataType: checkDataType</span><span class="s3">,</span>
  <span class="s0">checkDataTypes: checkDataTypes</span><span class="s3">,</span>
  <span class="s0">coerceToTypes: coerceToTypes</span><span class="s3">,</span>
  <span class="s0">toHash: toHash</span><span class="s3">,</span>
  <span class="s0">getProperty: getProperty</span><span class="s3">,</span>
  <span class="s0">escapeQuotes: escapeQuotes</span><span class="s3">,</span>
  <span class="s0">equal: require(</span><span class="s2">'fast-deep-equal'</span><span class="s0">)</span><span class="s3">,</span>
  <span class="s0">ucs2length: require(</span><span class="s2">'./ucs2length'</span><span class="s0">)</span><span class="s3">,</span>
  <span class="s0">varOccurences: varOccurences</span><span class="s3">,</span>
  <span class="s0">varReplace: varReplace</span><span class="s3">,</span>
  <span class="s0">schemaHasRules: schemaHasRules</span><span class="s3">,</span>
  <span class="s0">schemaHasRulesExcept: schemaHasRulesExcept</span><span class="s3">,</span>
  <span class="s0">schemaUnknownRules: schemaUnknownRules</span><span class="s3">,</span>
  <span class="s0">toQuotedString: toQuotedString</span><span class="s3">,</span>
  <span class="s0">getPathExpr: getPathExpr</span><span class="s3">,</span>
  <span class="s0">getPath: getPath</span><span class="s3">,</span>
  <span class="s0">getData: getData</span><span class="s3">,</span>
  <span class="s0">unescapeFragment: unescapeFragment</span><span class="s3">,</span>
  <span class="s0">unescapeJsonPointer: unescapeJsonPointer</span><span class="s3">,</span>
  <span class="s0">escapeFragment: escapeFragment</span><span class="s3">,</span>
  <span class="s0">escapeJsonPointer: escapeJsonPointer</span>
<span class="s0">}</span><span class="s3">;</span>


<span class="s1">function </span><span class="s0">copy(o</span><span class="s3">, </span><span class="s0">to) {</span>
  <span class="s0">to = to || {}</span><span class="s3">;</span>
  <span class="s1">for </span><span class="s0">(</span><span class="s1">var </span><span class="s0">key </span><span class="s1">in </span><span class="s0">o) to[key] = o[key]</span><span class="s3">;</span>
  <span class="s1">return </span><span class="s0">to</span><span class="s3">;</span>
<span class="s0">}</span>


<span class="s1">function </span><span class="s0">checkDataType(dataType</span><span class="s3">, </span><span class="s0">data</span><span class="s3">, </span><span class="s0">strictNumbers</span><span class="s3">, </span><span class="s0">negate) {</span>
  <span class="s1">var </span><span class="s0">EQUAL = negate ? </span><span class="s2">' !== ' </span><span class="s0">: </span><span class="s2">' === '</span>
    <span class="s3">, </span><span class="s0">AND = negate ? </span><span class="s2">' || ' </span><span class="s0">: </span><span class="s2">' &amp;&amp; '</span>
    <span class="s3">, </span><span class="s0">OK = negate ? </span><span class="s2">'!' </span><span class="s0">: </span><span class="s2">''</span>
    <span class="s3">, </span><span class="s0">NOT = negate ? </span><span class="s2">'' </span><span class="s0">: </span><span class="s2">'!'</span><span class="s3">;</span>
  <span class="s1">switch </span><span class="s0">(dataType) {</span>
    <span class="s1">case </span><span class="s2">'null'</span><span class="s0">: </span><span class="s1">return </span><span class="s0">data + EQUAL + </span><span class="s2">'null'</span><span class="s3">;</span>
    <span class="s1">case </span><span class="s2">'array'</span><span class="s0">: </span><span class="s1">return </span><span class="s0">OK + </span><span class="s2">'Array.isArray(' </span><span class="s0">+ data + </span><span class="s2">')'</span><span class="s3">;</span>
    <span class="s1">case </span><span class="s2">'object'</span><span class="s0">: </span><span class="s1">return </span><span class="s2">'(' </span><span class="s0">+ OK + data + AND +</span>
                          <span class="s2">'typeof ' </span><span class="s0">+ data + EQUAL + </span><span class="s2">'&quot;object&quot;' </span><span class="s0">+ AND +</span>
                          <span class="s0">NOT + </span><span class="s2">'Array.isArray(' </span><span class="s0">+ data + </span><span class="s2">'))'</span><span class="s3">;</span>
    <span class="s1">case </span><span class="s2">'integer'</span><span class="s0">: </span><span class="s1">return </span><span class="s2">'(typeof ' </span><span class="s0">+ data + EQUAL + </span><span class="s2">'&quot;number&quot;' </span><span class="s0">+ AND +</span>
                           <span class="s0">NOT + </span><span class="s2">'(' </span><span class="s0">+ data + </span><span class="s2">' % 1)' </span><span class="s0">+</span>
                           <span class="s0">AND + data + EQUAL + data +</span>
                           <span class="s0">(strictNumbers ? (AND + OK + </span><span class="s2">'isFinite(' </span><span class="s0">+ data + </span><span class="s2">')'</span><span class="s0">) : </span><span class="s2">''</span><span class="s0">) + </span><span class="s2">')'</span><span class="s3">;</span>
    <span class="s1">case </span><span class="s2">'number'</span><span class="s0">: </span><span class="s1">return </span><span class="s2">'(typeof ' </span><span class="s0">+ data + EQUAL + </span><span class="s2">'&quot;' </span><span class="s0">+ dataType + </span><span class="s2">'&quot;' </span><span class="s0">+</span>
                          <span class="s0">(strictNumbers ? (AND + OK + </span><span class="s2">'isFinite(' </span><span class="s0">+ data + </span><span class="s2">')'</span><span class="s0">) : </span><span class="s2">''</span><span class="s0">) + </span><span class="s2">')'</span><span class="s3">;</span>
    <span class="s1">default</span><span class="s0">: </span><span class="s1">return </span><span class="s2">'typeof ' </span><span class="s0">+ data + EQUAL + </span><span class="s2">'&quot;' </span><span class="s0">+ dataType + </span><span class="s2">'&quot;'</span><span class="s3">;</span>
  <span class="s0">}</span>
<span class="s0">}</span>


<span class="s1">function </span><span class="s0">checkDataTypes(dataTypes</span><span class="s3">, </span><span class="s0">data</span><span class="s3">, </span><span class="s0">strictNumbers) {</span>
  <span class="s1">switch </span><span class="s0">(dataTypes.length) {</span>
    <span class="s1">case </span><span class="s4">1</span><span class="s0">: </span><span class="s1">return </span><span class="s0">checkDataType(dataTypes[</span><span class="s4">0</span><span class="s0">]</span><span class="s3">, </span><span class="s0">data</span><span class="s3">, </span><span class="s0">strictNumbers</span><span class="s3">, </span><span class="s1">true</span><span class="s0">)</span><span class="s3">;</span>
    <span class="s1">default</span><span class="s0">:</span>
      <span class="s1">var </span><span class="s0">code = </span><span class="s2">''</span><span class="s3">;</span>
      <span class="s1">var </span><span class="s0">types = toHash(dataTypes)</span><span class="s3">;</span>
      <span class="s1">if </span><span class="s0">(types.array &amp;&amp; types.object) {</span>
        <span class="s0">code = types.null ? </span><span class="s2">'('</span><span class="s0">: </span><span class="s2">'(!' </span><span class="s0">+ data + </span><span class="s2">' || '</span><span class="s3">;</span>
        <span class="s0">code += </span><span class="s2">'typeof ' </span><span class="s0">+ data + </span><span class="s2">' !== &quot;object&quot;)'</span><span class="s3">;</span>
        <span class="s1">delete </span><span class="s0">types.null</span><span class="s3">;</span>
        <span class="s1">delete </span><span class="s0">types.array</span><span class="s3">;</span>
        <span class="s1">delete </span><span class="s0">types.object</span><span class="s3">;</span>
      <span class="s0">}</span>
      <span class="s1">if </span><span class="s0">(types.number) </span><span class="s1">delete </span><span class="s0">types.integer</span><span class="s3">;</span>
      <span class="s1">for </span><span class="s0">(</span><span class="s1">var </span><span class="s0">t </span><span class="s1">in </span><span class="s0">types)</span>
        <span class="s0">code += (code ? </span><span class="s2">' &amp;&amp; ' </span><span class="s0">: </span><span class="s2">'' </span><span class="s0">) + checkDataType(t</span><span class="s3">, </span><span class="s0">data</span><span class="s3">, </span><span class="s0">strictNumbers</span><span class="s3">, </span><span class="s1">true</span><span class="s0">)</span><span class="s3">;</span>

      <span class="s1">return </span><span class="s0">code</span><span class="s3">;</span>
  <span class="s0">}</span>
<span class="s0">}</span>


<span class="s1">var </span><span class="s0">COERCE_TO_TYPES = toHash([ </span><span class="s2">'string'</span><span class="s3">, </span><span class="s2">'number'</span><span class="s3">, </span><span class="s2">'integer'</span><span class="s3">, </span><span class="s2">'boolean'</span><span class="s3">, </span><span class="s2">'null' </span><span class="s0">])</span><span class="s3">;</span>
<span class="s1">function </span><span class="s0">coerceToTypes(optionCoerceTypes</span><span class="s3">, </span><span class="s0">dataTypes) {</span>
  <span class="s1">if </span><span class="s0">(Array.isArray(dataTypes)) {</span>
    <span class="s1">var </span><span class="s0">types = []</span><span class="s3">;</span>
    <span class="s1">for </span><span class="s0">(</span><span class="s1">var </span><span class="s0">i=</span><span class="s4">0</span><span class="s3">; </span><span class="s0">i&lt;dataTypes.length</span><span class="s3">; </span><span class="s0">i++) {</span>
      <span class="s1">var </span><span class="s0">t = dataTypes[i]</span><span class="s3">;</span>
      <span class="s1">if </span><span class="s0">(COERCE_TO_TYPES[t]) types[types.length] = t</span><span class="s3">;</span>
      <span class="s1">else if </span><span class="s0">(optionCoerceTypes === </span><span class="s2">'array' </span><span class="s0">&amp;&amp; t === </span><span class="s2">'array'</span><span class="s0">) types[types.length] = t</span><span class="s3">;</span>
    <span class="s0">}</span>
    <span class="s1">if </span><span class="s0">(types.length) </span><span class="s1">return </span><span class="s0">types</span><span class="s3">;</span>
  <span class="s0">} </span><span class="s1">else if </span><span class="s0">(COERCE_TO_TYPES[dataTypes]) {</span>
    <span class="s1">return </span><span class="s0">[dataTypes]</span><span class="s3">;</span>
  <span class="s0">} </span><span class="s1">else if </span><span class="s0">(optionCoerceTypes === </span><span class="s2">'array' </span><span class="s0">&amp;&amp; dataTypes === </span><span class="s2">'array'</span><span class="s0">) {</span>
    <span class="s1">return </span><span class="s0">[</span><span class="s2">'array'</span><span class="s0">]</span><span class="s3">;</span>
  <span class="s0">}</span>
<span class="s0">}</span>


<span class="s1">function </span><span class="s0">toHash(arr) {</span>
  <span class="s1">var </span><span class="s0">hash = {}</span><span class="s3">;</span>
  <span class="s1">for </span><span class="s0">(</span><span class="s1">var </span><span class="s0">i=</span><span class="s4">0</span><span class="s3">; </span><span class="s0">i&lt;arr.length</span><span class="s3">; </span><span class="s0">i++) hash[arr[i]] = </span><span class="s1">true</span><span class="s3">;</span>
  <span class="s1">return </span><span class="s0">hash</span><span class="s3">;</span>
<span class="s0">}</span>


<span class="s1">var </span><span class="s0">IDENTIFIER = </span><span class="s4">/^[a-z$_][a-z$_0-9]*$/i</span><span class="s3">;</span>
<span class="s1">var </span><span class="s0">SINGLE_QUOTE = </span><span class="s4">/'|\\/g</span><span class="s3">;</span>
<span class="s1">function </span><span class="s0">getProperty(key) {</span>
  <span class="s1">return typeof </span><span class="s0">key == </span><span class="s2">'number'</span>
          <span class="s0">? </span><span class="s2">'[' </span><span class="s0">+ key + </span><span class="s2">']'</span>
          <span class="s0">: IDENTIFIER.test(key)</span>
            <span class="s0">? </span><span class="s2">'.' </span><span class="s0">+ key</span>
            <span class="s0">: </span><span class="s2">&quot;['&quot; </span><span class="s0">+ escapeQuotes(key) + </span><span class="s2">&quot;']&quot;</span><span class="s3">;</span>
<span class="s0">}</span>


<span class="s1">function </span><span class="s0">escapeQuotes(str) {</span>
  <span class="s1">return </span><span class="s0">str.replace(SINGLE_QUOTE</span><span class="s3">, </span><span class="s2">'</span><span class="s3">\\</span><span class="s2">$&amp;'</span><span class="s0">)</span>
            <span class="s0">.replace(</span><span class="s4">/\n/g</span><span class="s3">, </span><span class="s2">'</span><span class="s3">\\</span><span class="s2">n'</span><span class="s0">)</span>
            <span class="s0">.replace(</span><span class="s4">/\r/g</span><span class="s3">, </span><span class="s2">'</span><span class="s3">\\</span><span class="s2">r'</span><span class="s0">)</span>
            <span class="s0">.replace(</span><span class="s4">/\f/g</span><span class="s3">, </span><span class="s2">'</span><span class="s3">\\</span><span class="s2">f'</span><span class="s0">)</span>
            <span class="s0">.replace(</span><span class="s4">/\t/g</span><span class="s3">, </span><span class="s2">'</span><span class="s3">\\</span><span class="s2">t'</span><span class="s0">)</span><span class="s3">;</span>
<span class="s0">}</span>


<span class="s1">function </span><span class="s0">varOccurences(str</span><span class="s3">, </span><span class="s0">dataVar) {</span>
  <span class="s0">dataVar += </span><span class="s2">'[^0-9]'</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">matches = str.match(</span><span class="s1">new </span><span class="s0">RegExp(dataVar</span><span class="s3">, </span><span class="s2">'g'</span><span class="s0">))</span><span class="s3">;</span>
  <span class="s1">return </span><span class="s0">matches ? matches.length : </span><span class="s4">0</span><span class="s3">;</span>
<span class="s0">}</span>


<span class="s1">function </span><span class="s0">varReplace(str</span><span class="s3">, </span><span class="s0">dataVar</span><span class="s3">, </span><span class="s0">expr) {</span>
  <span class="s0">dataVar += </span><span class="s2">'([^0-9])'</span><span class="s3">;</span>
  <span class="s0">expr = expr.replace(</span><span class="s4">/\$/g</span><span class="s3">, </span><span class="s2">'$$$$'</span><span class="s0">)</span><span class="s3">;</span>
  <span class="s1">return </span><span class="s0">str.replace(</span><span class="s1">new </span><span class="s0">RegExp(dataVar</span><span class="s3">, </span><span class="s2">'g'</span><span class="s0">)</span><span class="s3">, </span><span class="s0">expr + </span><span class="s2">'$1'</span><span class="s0">)</span><span class="s3">;</span>
<span class="s0">}</span>


<span class="s1">function </span><span class="s0">schemaHasRules(schema</span><span class="s3">, </span><span class="s0">rules) {</span>
  <span class="s1">if </span><span class="s0">(</span><span class="s1">typeof </span><span class="s0">schema == </span><span class="s2">'boolean'</span><span class="s0">) </span><span class="s1">return </span><span class="s0">!schema</span><span class="s3">;</span>
  <span class="s1">for </span><span class="s0">(</span><span class="s1">var </span><span class="s0">key </span><span class="s1">in </span><span class="s0">schema) </span><span class="s1">if </span><span class="s0">(rules[key]) </span><span class="s1">return true</span><span class="s3">;</span>
<span class="s0">}</span>


<span class="s1">function </span><span class="s0">schemaHasRulesExcept(schema</span><span class="s3">, </span><span class="s0">rules</span><span class="s3">, </span><span class="s0">exceptKeyword) {</span>
  <span class="s1">if </span><span class="s0">(</span><span class="s1">typeof </span><span class="s0">schema == </span><span class="s2">'boolean'</span><span class="s0">) </span><span class="s1">return </span><span class="s0">!schema &amp;&amp; exceptKeyword != </span><span class="s2">'not'</span><span class="s3">;</span>
  <span class="s1">for </span><span class="s0">(</span><span class="s1">var </span><span class="s0">key </span><span class="s1">in </span><span class="s0">schema) </span><span class="s1">if </span><span class="s0">(key != exceptKeyword &amp;&amp; rules[key]) </span><span class="s1">return true</span><span class="s3">;</span>
<span class="s0">}</span>


<span class="s1">function </span><span class="s0">schemaUnknownRules(schema</span><span class="s3">, </span><span class="s0">rules) {</span>
  <span class="s1">if </span><span class="s0">(</span><span class="s1">typeof </span><span class="s0">schema == </span><span class="s2">'boolean'</span><span class="s0">) </span><span class="s1">return</span><span class="s3">;</span>
  <span class="s1">for </span><span class="s0">(</span><span class="s1">var </span><span class="s0">key </span><span class="s1">in </span><span class="s0">schema) </span><span class="s1">if </span><span class="s0">(!rules[key]) </span><span class="s1">return </span><span class="s0">key</span><span class="s3">;</span>
<span class="s0">}</span>


<span class="s1">function </span><span class="s0">toQuotedString(str) {</span>
  <span class="s1">return </span><span class="s2">'</span><span class="s3">\'</span><span class="s2">' </span><span class="s0">+ escapeQuotes(str) + </span><span class="s2">'</span><span class="s3">\'</span><span class="s2">'</span><span class="s3">;</span>
<span class="s0">}</span>


<span class="s1">function </span><span class="s0">getPathExpr(currentPath</span><span class="s3">, </span><span class="s0">expr</span><span class="s3">, </span><span class="s0">jsonPointers</span><span class="s3">, </span><span class="s0">isNumber) {</span>
  <span class="s1">var </span><span class="s0">path = jsonPointers </span><span class="s8">// false by default</span>
              <span class="s0">? </span><span class="s2">'</span><span class="s3">\'</span><span class="s2">/</span><span class="s3">\' </span><span class="s2">+ ' </span><span class="s0">+ expr + (isNumber ? </span><span class="s2">'' </span><span class="s0">: </span><span class="s2">'.replace(/~/g, </span><span class="s3">\'</span><span class="s2">~0</span><span class="s3">\'</span><span class="s2">).replace(/</span><span class="s3">\\</span><span class="s2">//g, </span><span class="s3">\'</span><span class="s2">~1</span><span class="s3">\'</span><span class="s2">)'</span><span class="s0">)</span>
              <span class="s0">: (isNumber ? </span><span class="s2">'</span><span class="s3">\'</span><span class="s2">[</span><span class="s3">\' </span><span class="s2">+ ' </span><span class="s0">+ expr + </span><span class="s2">' + </span><span class="s3">\'</span><span class="s2">]</span><span class="s3">\'</span><span class="s2">' </span><span class="s0">: </span><span class="s2">'</span><span class="s3">\'</span><span class="s2">[</span><span class="s3">\\\'\' </span><span class="s2">+ ' </span><span class="s0">+ expr + </span><span class="s2">' + </span><span class="s3">\'\\\'</span><span class="s2">]</span><span class="s3">\'</span><span class="s2">'</span><span class="s0">)</span><span class="s3">;</span>
  <span class="s1">return </span><span class="s0">joinPaths(currentPath</span><span class="s3">, </span><span class="s0">path)</span><span class="s3">;</span>
<span class="s0">}</span>


<span class="s1">function </span><span class="s0">getPath(currentPath</span><span class="s3">, </span><span class="s0">prop</span><span class="s3">, </span><span class="s0">jsonPointers) {</span>
  <span class="s1">var </span><span class="s0">path = jsonPointers </span><span class="s8">// false by default</span>
              <span class="s0">? toQuotedString(</span><span class="s2">'/' </span><span class="s0">+ escapeJsonPointer(prop))</span>
              <span class="s0">: toQuotedString(getProperty(prop))</span><span class="s3">;</span>
  <span class="s1">return </span><span class="s0">joinPaths(currentPath</span><span class="s3">, </span><span class="s0">path)</span><span class="s3">;</span>
<span class="s0">}</span>


<span class="s1">var </span><span class="s0">JSON_POINTER = </span><span class="s4">/^\/(?:[^~]|~0|~1)*$/</span><span class="s3">;</span>
<span class="s1">var </span><span class="s0">RELATIVE_JSON_POINTER = </span><span class="s4">/^([0-9]+)(#|\/(?:[^~]|~0|~1)*)?$/</span><span class="s3">;</span>
<span class="s1">function </span><span class="s0">getData($data</span><span class="s3">, </span><span class="s0">lvl</span><span class="s3">, </span><span class="s0">paths) {</span>
  <span class="s1">var </span><span class="s0">up</span><span class="s3">, </span><span class="s0">jsonPointer</span><span class="s3">, </span><span class="s0">data</span><span class="s3">, </span><span class="s0">matches</span><span class="s3">;</span>
  <span class="s1">if </span><span class="s0">($data === </span><span class="s2">''</span><span class="s0">) </span><span class="s1">return </span><span class="s2">'rootData'</span><span class="s3">;</span>
  <span class="s1">if </span><span class="s0">($data[</span><span class="s4">0</span><span class="s0">] == </span><span class="s2">'/'</span><span class="s0">) {</span>
    <span class="s1">if </span><span class="s0">(!JSON_POINTER.test($data)) </span><span class="s1">throw new </span><span class="s0">Error(</span><span class="s2">'Invalid JSON-pointer: ' </span><span class="s0">+ $data)</span><span class="s3">;</span>
    <span class="s0">jsonPointer = $data</span><span class="s3">;</span>
    <span class="s0">data = </span><span class="s2">'rootData'</span><span class="s3">;</span>
  <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
    <span class="s0">matches = $data.match(RELATIVE_JSON_POINTER)</span><span class="s3">;</span>
    <span class="s1">if </span><span class="s0">(!matches) </span><span class="s1">throw new </span><span class="s0">Error(</span><span class="s2">'Invalid JSON-pointer: ' </span><span class="s0">+ $data)</span><span class="s3">;</span>
    <span class="s0">up = +matches[</span><span class="s4">1</span><span class="s0">]</span><span class="s3">;</span>
    <span class="s0">jsonPointer = matches[</span><span class="s4">2</span><span class="s0">]</span><span class="s3">;</span>
    <span class="s1">if </span><span class="s0">(jsonPointer == </span><span class="s2">'#'</span><span class="s0">) {</span>
      <span class="s1">if </span><span class="s0">(up &gt;= lvl) </span><span class="s1">throw new </span><span class="s0">Error(</span><span class="s2">'Cannot access property/index ' </span><span class="s0">+ up + </span><span class="s2">' levels up, current level is ' </span><span class="s0">+ lvl)</span><span class="s3">;</span>
      <span class="s1">return </span><span class="s0">paths[lvl - up]</span><span class="s3">;</span>
    <span class="s0">}</span>

    <span class="s1">if </span><span class="s0">(up &gt; lvl) </span><span class="s1">throw new </span><span class="s0">Error(</span><span class="s2">'Cannot access data ' </span><span class="s0">+ up + </span><span class="s2">' levels up, current level is ' </span><span class="s0">+ lvl)</span><span class="s3">;</span>
    <span class="s0">data = </span><span class="s2">'data' </span><span class="s0">+ ((lvl - up) || </span><span class="s2">''</span><span class="s0">)</span><span class="s3">;</span>
    <span class="s1">if </span><span class="s0">(!jsonPointer) </span><span class="s1">return </span><span class="s0">data</span><span class="s3">;</span>
  <span class="s0">}</span>

  <span class="s1">var </span><span class="s0">expr = data</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">segments = jsonPointer.split(</span><span class="s2">'/'</span><span class="s0">)</span><span class="s3">;</span>
  <span class="s1">for </span><span class="s0">(</span><span class="s1">var </span><span class="s0">i=</span><span class="s4">0</span><span class="s3">; </span><span class="s0">i&lt;segments.length</span><span class="s3">; </span><span class="s0">i++) {</span>
    <span class="s1">var </span><span class="s0">segment = segments[i]</span><span class="s3">;</span>
    <span class="s1">if </span><span class="s0">(segment) {</span>
      <span class="s0">data += getProperty(unescapeJsonPointer(segment))</span><span class="s3">;</span>
      <span class="s0">expr += </span><span class="s2">' &amp;&amp; ' </span><span class="s0">+ data</span><span class="s3">;</span>
    <span class="s0">}</span>
  <span class="s0">}</span>
  <span class="s1">return </span><span class="s0">expr</span><span class="s3">;</span>
<span class="s0">}</span>


<span class="s1">function </span><span class="s0">joinPaths (a</span><span class="s3">, </span><span class="s0">b) {</span>
  <span class="s1">if </span><span class="s0">(a == </span><span class="s2">'&quot;&quot;'</span><span class="s0">) </span><span class="s1">return </span><span class="s0">b</span><span class="s3">;</span>
  <span class="s1">return </span><span class="s0">(a + </span><span class="s2">' + ' </span><span class="s0">+ b).replace(</span><span class="s4">/([^\\])' \+ '/g</span><span class="s3">, </span><span class="s2">'$1'</span><span class="s0">)</span><span class="s3">;</span>
<span class="s0">}</span>


<span class="s1">function </span><span class="s0">unescapeFragment(str) {</span>
  <span class="s1">return </span><span class="s0">unescapeJsonPointer(decodeURIComponent(str))</span><span class="s3">;</span>
<span class="s0">}</span>


<span class="s1">function </span><span class="s0">escapeFragment(str) {</span>
  <span class="s1">return </span><span class="s0">encodeURIComponent(escapeJsonPointer(str))</span><span class="s3">;</span>
<span class="s0">}</span>


<span class="s1">function </span><span class="s0">escapeJsonPointer(str) {</span>
  <span class="s1">return </span><span class="s0">str.replace(</span><span class="s4">/~/g</span><span class="s3">, </span><span class="s2">'~0'</span><span class="s0">).replace(</span><span class="s4">/\//g</span><span class="s3">, </span><span class="s2">'~1'</span><span class="s0">)</span><span class="s3">;</span>
<span class="s0">}</span>


<span class="s1">function </span><span class="s0">unescapeJsonPointer(str) {</span>
  <span class="s1">return </span><span class="s0">str.replace(</span><span class="s4">/~1/g</span><span class="s3">, </span><span class="s2">'/'</span><span class="s0">).replace(</span><span class="s4">/~0/g</span><span class="s3">, </span><span class="s2">'~'</span><span class="s0">)</span><span class="s3">;</span>
<span class="s0">}</span>

<span class="s0">}</span><span class="s3">,</span><span class="s0">{</span><span class="s2">&quot;./ucs2length&quot;</span><span class="s0">:</span><span class="s4">9</span><span class="s3">,</span><span class="s2">&quot;fast-deep-equal&quot;</span><span class="s0">:</span><span class="s4">42</span><span class="s0">}]</span><span class="s3">,</span><span class="s4">11</span><span class="s0">:[</span><span class="s1">function</span><span class="s0">(require</span><span class="s3">,</span><span class="s0">module</span><span class="s3">,</span><span class="s0">exports){</span>
<span class="s2">'use strict'</span><span class="s3">;</span>

<span class="s1">var </span><span class="s0">KEYWORDS = [</span>
  <span class="s2">'multipleOf'</span><span class="s3">,</span>
  <span class="s2">'maximum'</span><span class="s3">,</span>
  <span class="s2">'exclusiveMaximum'</span><span class="s3">,</span>
  <span class="s2">'minimum'</span><span class="s3">,</span>
  <span class="s2">'exclusiveMinimum'</span><span class="s3">,</span>
  <span class="s2">'maxLength'</span><span class="s3">,</span>
  <span class="s2">'minLength'</span><span class="s3">,</span>
  <span class="s2">'pattern'</span><span class="s3">,</span>
  <span class="s2">'additionalItems'</span><span class="s3">,</span>
  <span class="s2">'maxItems'</span><span class="s3">,</span>
  <span class="s2">'minItems'</span><span class="s3">,</span>
  <span class="s2">'uniqueItems'</span><span class="s3">,</span>
  <span class="s2">'maxProperties'</span><span class="s3">,</span>
  <span class="s2">'minProperties'</span><span class="s3">,</span>
  <span class="s2">'required'</span><span class="s3">,</span>
  <span class="s2">'additionalProperties'</span><span class="s3">,</span>
  <span class="s2">'enum'</span><span class="s3">,</span>
  <span class="s2">'format'</span><span class="s3">,</span>
  <span class="s2">'const'</span>
<span class="s0">]</span><span class="s3">;</span>

<span class="s0">module.exports = </span><span class="s1">function </span><span class="s0">(metaSchema</span><span class="s3">, </span><span class="s0">keywordsJsonPointers) {</span>
  <span class="s1">for </span><span class="s0">(</span><span class="s1">var </span><span class="s0">i=</span><span class="s4">0</span><span class="s3">; </span><span class="s0">i&lt;keywordsJsonPointers.length</span><span class="s3">; </span><span class="s0">i++) {</span>
    <span class="s0">metaSchema = JSON.parse(JSON.stringify(metaSchema))</span><span class="s3">;</span>
    <span class="s1">var </span><span class="s0">segments = keywordsJsonPointers[i].split(</span><span class="s2">'/'</span><span class="s0">)</span><span class="s3">;</span>
    <span class="s1">var </span><span class="s0">keywords = metaSchema</span><span class="s3">;</span>
    <span class="s1">var </span><span class="s0">j</span><span class="s3">;</span>
    <span class="s1">for </span><span class="s0">(j=</span><span class="s4">1</span><span class="s3">; </span><span class="s0">j&lt;segments.length</span><span class="s3">; </span><span class="s0">j++)</span>
      <span class="s0">keywords = keywords[segments[j]]</span><span class="s3">;</span>

    <span class="s1">for </span><span class="s0">(j=</span><span class="s4">0</span><span class="s3">; </span><span class="s0">j&lt;KEYWORDS.length</span><span class="s3">; </span><span class="s0">j++) {</span>
      <span class="s1">var </span><span class="s0">key = KEYWORDS[j]</span><span class="s3">;</span>
      <span class="s1">var </span><span class="s0">schema = keywords[key]</span><span class="s3">;</span>
      <span class="s1">if </span><span class="s0">(schema) {</span>
        <span class="s0">keywords[key] = {</span>
          <span class="s0">anyOf: [</span>
            <span class="s0">schema</span><span class="s3">,</span>
            <span class="s0">{ $ref: </span><span class="s2">'https://raw.githubusercontent.com/ajv-validator/ajv/master/lib/refs/data.json#' </span><span class="s0">}</span>
          <span class="s0">]</span>
        <span class="s0">}</span><span class="s3">;</span>
      <span class="s0">}</span>
    <span class="s0">}</span>
  <span class="s0">}</span>

  <span class="s1">return </span><span class="s0">metaSchema</span><span class="s3">;</span>
<span class="s0">}</span><span class="s3">;</span>

<span class="s0">}</span><span class="s3">,</span><span class="s0">{}]</span><span class="s3">,</span><span class="s4">12</span><span class="s0">:[</span><span class="s1">function</span><span class="s0">(require</span><span class="s3">,</span><span class="s0">module</span><span class="s3">,</span><span class="s0">exports){</span>
<span class="s2">'use strict'</span><span class="s3">;</span>

<span class="s1">var </span><span class="s0">metaSchema = require(</span><span class="s2">'./refs/json-schema-draft-07.json'</span><span class="s0">)</span><span class="s3">;</span>

<span class="s0">module.exports = {</span>
  <span class="s0">$id: </span><span class="s2">'https://github.com/ajv-validator/ajv/blob/master/lib/definition_schema.js'</span><span class="s3">,</span>
  <span class="s0">definitions: {</span>
    <span class="s0">simpleTypes: metaSchema.definitions.simpleTypes</span>
  <span class="s0">}</span><span class="s3">,</span>
  <span class="s0">type: </span><span class="s2">'object'</span><span class="s3">,</span>
  <span class="s0">dependencies: {</span>
    <span class="s0">schema: [</span><span class="s2">'validate'</span><span class="s0">]</span><span class="s3">,</span>
    <span class="s0">$data: [</span><span class="s2">'validate'</span><span class="s0">]</span><span class="s3">,</span>
    <span class="s0">statements: [</span><span class="s2">'inline'</span><span class="s0">]</span><span class="s3">,</span>
    <span class="s0">valid: {not: {required: [</span><span class="s2">'macro'</span><span class="s0">]}}</span>
  <span class="s0">}</span><span class="s3">,</span>
  <span class="s0">properties: {</span>
    <span class="s0">type: metaSchema.properties.type</span><span class="s3">,</span>
    <span class="s0">schema: {type: </span><span class="s2">'boolean'</span><span class="s0">}</span><span class="s3">,</span>
    <span class="s0">statements: {type: </span><span class="s2">'boolean'</span><span class="s0">}</span><span class="s3">,</span>
    <span class="s0">dependencies: {</span>
      <span class="s0">type: </span><span class="s2">'array'</span><span class="s3">,</span>
      <span class="s0">items: {type: </span><span class="s2">'string'</span><span class="s0">}</span>
    <span class="s0">}</span><span class="s3">,</span>
    <span class="s0">metaSchema: {type: </span><span class="s2">'object'</span><span class="s0">}</span><span class="s3">,</span>
    <span class="s0">modifying: {type: </span><span class="s2">'boolean'</span><span class="s0">}</span><span class="s3">,</span>
    <span class="s0">valid: {type: </span><span class="s2">'boolean'</span><span class="s0">}</span><span class="s3">,</span>
    <span class="s0">$data: {type: </span><span class="s2">'boolean'</span><span class="s0">}</span><span class="s3">,</span>
    <span class="s0">async: {type: </span><span class="s2">'boolean'</span><span class="s0">}</span><span class="s3">,</span>
    <span class="s0">errors: {</span>
      <span class="s0">anyOf: [</span>
        <span class="s0">{type: </span><span class="s2">'boolean'</span><span class="s0">}</span><span class="s3">,</span>
        <span class="s0">{</span><span class="s1">const</span><span class="s0">: </span><span class="s2">'full'</span><span class="s0">}</span>
      <span class="s0">]</span>
    <span class="s0">}</span>
  <span class="s0">}</span>
<span class="s0">}</span><span class="s3">;</span>

<span class="s0">}</span><span class="s3">,</span><span class="s0">{</span><span class="s2">&quot;./refs/json-schema-draft-07.json&quot;</span><span class="s0">:</span><span class="s4">41</span><span class="s0">}]</span><span class="s3">,</span><span class="s4">13</span><span class="s0">:[</span><span class="s1">function</span><span class="s0">(require</span><span class="s3">,</span><span class="s0">module</span><span class="s3">,</span><span class="s0">exports){</span>
<span class="s2">'use strict'</span><span class="s3">;</span>
<span class="s0">module.exports = </span><span class="s1">function </span><span class="s0">generate__limit(it</span><span class="s3">, </span><span class="s0">$keyword</span><span class="s3">, </span><span class="s0">$ruleType) {</span>
  <span class="s1">var </span><span class="s0">out = </span><span class="s2">' '</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$lvl = it.level</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$dataLvl = it.dataLevel</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$schema = it.schema[$keyword]</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$schemaPath = it.schemaPath + it.util.getProperty($keyword)</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$errSchemaPath = it.errSchemaPath + </span><span class="s2">'/' </span><span class="s0">+ $keyword</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$breakOnError = !it.opts.allErrors</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$errorKeyword</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$data = </span><span class="s2">'data' </span><span class="s0">+ ($dataLvl || </span><span class="s2">''</span><span class="s0">)</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$isData = it.opts.$data &amp;&amp; $schema &amp;&amp; $schema.$data</span><span class="s3">,</span>
    <span class="s0">$schemaValue</span><span class="s3">;</span>
  <span class="s1">if </span><span class="s0">($isData) {</span>
    <span class="s0">out += </span><span class="s2">' var schema' </span><span class="s0">+ ($lvl) + </span><span class="s2">' = ' </span><span class="s0">+ (it.util.getData($schema.$data</span><span class="s3">, </span><span class="s0">$dataLvl</span><span class="s3">, </span><span class="s0">it.dataPathArr)) + </span><span class="s2">'; '</span><span class="s3">;</span>
    <span class="s0">$schemaValue = </span><span class="s2">'schema' </span><span class="s0">+ $lvl</span><span class="s3">;</span>
  <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
    <span class="s0">$schemaValue = $schema</span><span class="s3">;</span>
  <span class="s0">}</span>
  <span class="s1">var </span><span class="s0">$isMax = $keyword == </span><span class="s2">'maximum'</span><span class="s3">,</span>
    <span class="s0">$exclusiveKeyword = $isMax ? </span><span class="s2">'exclusiveMaximum' </span><span class="s0">: </span><span class="s2">'exclusiveMinimum'</span><span class="s3">,</span>
    <span class="s0">$schemaExcl = it.schema[$exclusiveKeyword]</span><span class="s3">,</span>
    <span class="s0">$isDataExcl = it.opts.$data &amp;&amp; $schemaExcl &amp;&amp; $schemaExcl.$data</span><span class="s3">,</span>
    <span class="s0">$op = $isMax ? </span><span class="s2">'&lt;' </span><span class="s0">: </span><span class="s2">'&gt;'</span><span class="s3">,</span>
    <span class="s0">$notOp = $isMax ? </span><span class="s2">'&gt;' </span><span class="s0">: </span><span class="s2">'&lt;'</span><span class="s3">,</span>
    <span class="s0">$errorKeyword = undefined</span><span class="s3">;</span>
  <span class="s1">if </span><span class="s0">(!($isData || </span><span class="s1">typeof </span><span class="s0">$schema == </span><span class="s2">'number' </span><span class="s0">|| $schema === undefined)) {</span>
    <span class="s1">throw new </span><span class="s0">Error($keyword + </span><span class="s2">' must be number'</span><span class="s0">)</span><span class="s3">;</span>
  <span class="s0">}</span>
  <span class="s1">if </span><span class="s0">(!($isDataExcl || $schemaExcl === undefined || </span><span class="s1">typeof </span><span class="s0">$schemaExcl == </span><span class="s2">'number' </span><span class="s0">|| </span><span class="s1">typeof </span><span class="s0">$schemaExcl == </span><span class="s2">'boolean'</span><span class="s0">)) {</span>
    <span class="s1">throw new </span><span class="s0">Error($exclusiveKeyword + </span><span class="s2">' must be number or boolean'</span><span class="s0">)</span><span class="s3">;</span>
  <span class="s0">}</span>
  <span class="s1">if </span><span class="s0">($isDataExcl) {</span>
    <span class="s1">var </span><span class="s0">$schemaValueExcl = it.util.getData($schemaExcl.$data</span><span class="s3">, </span><span class="s0">$dataLvl</span><span class="s3">, </span><span class="s0">it.dataPathArr)</span><span class="s3">,</span>
      <span class="s0">$exclusive = </span><span class="s2">'exclusive' </span><span class="s0">+ $lvl</span><span class="s3">,</span>
      <span class="s0">$exclType = </span><span class="s2">'exclType' </span><span class="s0">+ $lvl</span><span class="s3">,</span>
      <span class="s0">$exclIsNumber = </span><span class="s2">'exclIsNumber' </span><span class="s0">+ $lvl</span><span class="s3">,</span>
      <span class="s0">$opExpr = </span><span class="s2">'op' </span><span class="s0">+ $lvl</span><span class="s3">,</span>
      <span class="s0">$opStr = </span><span class="s2">'</span><span class="s3">\' </span><span class="s2">+ ' </span><span class="s0">+ $opExpr + </span><span class="s2">' + </span><span class="s3">\'</span><span class="s2">'</span><span class="s3">;</span>
    <span class="s0">out += </span><span class="s2">' var schemaExcl' </span><span class="s0">+ ($lvl) + </span><span class="s2">' = ' </span><span class="s0">+ ($schemaValueExcl) + </span><span class="s2">'; '</span><span class="s3">;</span>
    <span class="s0">$schemaValueExcl = </span><span class="s2">'schemaExcl' </span><span class="s0">+ $lvl</span><span class="s3">;</span>
    <span class="s0">out += </span><span class="s2">' var ' </span><span class="s0">+ ($exclusive) + </span><span class="s2">'; var ' </span><span class="s0">+ ($exclType) + </span><span class="s2">' = typeof ' </span><span class="s0">+ ($schemaValueExcl) + </span><span class="s2">'; if (' </span><span class="s0">+ ($exclType) + </span><span class="s2">' != </span><span class="s3">\'</span><span class="s2">boolean</span><span class="s3">\' </span><span class="s2">&amp;&amp; ' </span><span class="s0">+ ($exclType) + </span><span class="s2">' != </span><span class="s3">\'</span><span class="s2">undefined</span><span class="s3">\' </span><span class="s2">&amp;&amp; ' </span><span class="s0">+ ($exclType) + </span><span class="s2">' != </span><span class="s3">\'</span><span class="s2">number</span><span class="s3">\'</span><span class="s2">) { '</span><span class="s3">;</span>
    <span class="s1">var </span><span class="s0">$errorKeyword = $exclusiveKeyword</span><span class="s3">;</span>
    <span class="s1">var </span><span class="s0">$$outStack = $$outStack || []</span><span class="s3">;</span>
    <span class="s0">$$outStack.push(out)</span><span class="s3">;</span>
    <span class="s0">out = </span><span class="s2">''</span><span class="s3">; </span><span class="s7">/* istanbul ignore else */</span>
    <span class="s1">if </span><span class="s0">(it.createErrors !== </span><span class="s1">false</span><span class="s0">) {</span>
      <span class="s0">out += </span><span class="s2">' { keyword: </span><span class="s3">\'</span><span class="s2">' </span><span class="s0">+ ($errorKeyword || </span><span class="s2">'_exclusiveLimit'</span><span class="s0">) + </span><span class="s2">'</span><span class="s3">\' </span><span class="s2">, dataPath: (dataPath || </span><span class="s3">\'\'</span><span class="s2">) + ' </span><span class="s0">+ (it.errorPath) + </span><span class="s2">' , schemaPath: ' </span><span class="s0">+ (it.util.toQuotedString($errSchemaPath)) + </span><span class="s2">' , params: {} '</span><span class="s3">;</span>
      <span class="s1">if </span><span class="s0">(it.opts.messages !== </span><span class="s1">false</span><span class="s0">) {</span>
        <span class="s0">out += </span><span class="s2">' , message: </span><span class="s3">\'</span><span class="s2">' </span><span class="s0">+ ($exclusiveKeyword) + </span><span class="s2">' should be boolean</span><span class="s3">\' </span><span class="s2">'</span><span class="s3">;</span>
      <span class="s0">}</span>
      <span class="s1">if </span><span class="s0">(it.opts.verbose) {</span>
        <span class="s0">out += </span><span class="s2">' , schema: validate.schema' </span><span class="s0">+ ($schemaPath) + </span><span class="s2">' , parentSchema: validate.schema' </span><span class="s0">+ (it.schemaPath) + </span><span class="s2">' , data: ' </span><span class="s0">+ ($data) + </span><span class="s2">' '</span><span class="s3">;</span>
      <span class="s0">}</span>
      <span class="s0">out += </span><span class="s2">' } '</span><span class="s3">;</span>
    <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
      <span class="s0">out += </span><span class="s2">' {} '</span><span class="s3">;</span>
    <span class="s0">}</span>
    <span class="s1">var </span><span class="s0">__err = out</span><span class="s3">;</span>
    <span class="s0">out = $$outStack.pop()</span><span class="s3">;</span>
    <span class="s1">if </span><span class="s0">(!it.compositeRule &amp;&amp; $breakOnError) {</span>
      <span class="s7">/* istanbul ignore if */</span>
      <span class="s1">if </span><span class="s0">(it.async) {</span>
        <span class="s0">out += </span><span class="s2">' throw new ValidationError([' </span><span class="s0">+ (__err) + </span><span class="s2">']); '</span><span class="s3">;</span>
      <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
        <span class="s0">out += </span><span class="s2">' validate.errors = [' </span><span class="s0">+ (__err) + </span><span class="s2">']; return false; '</span><span class="s3">;</span>
      <span class="s0">}</span>
    <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
      <span class="s0">out += </span><span class="s2">' var err = ' </span><span class="s0">+ (__err) + </span><span class="s2">';  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; '</span><span class="s3">;</span>
    <span class="s0">}</span>
    <span class="s0">out += </span><span class="s2">' } else if ( '</span><span class="s3">;</span>
    <span class="s1">if </span><span class="s0">($isData) {</span>
      <span class="s0">out += </span><span class="s2">' (' </span><span class="s0">+ ($schemaValue) + </span><span class="s2">' !== undefined &amp;&amp; typeof ' </span><span class="s0">+ ($schemaValue) + </span><span class="s2">' != </span><span class="s3">\'</span><span class="s2">number</span><span class="s3">\'</span><span class="s2">) || '</span><span class="s3">;</span>
    <span class="s0">}</span>
    <span class="s0">out += </span><span class="s2">' ' </span><span class="s0">+ ($exclType) + </span><span class="s2">' == </span><span class="s3">\'</span><span class="s2">number</span><span class="s3">\' </span><span class="s2">? ( (' </span><span class="s0">+ ($exclusive) + </span><span class="s2">' = ' </span><span class="s0">+ ($schemaValue) + </span><span class="s2">' === undefined || ' </span><span class="s0">+ ($schemaValueExcl) + </span><span class="s2">' ' </span><span class="s0">+ ($op) + </span><span class="s2">'= ' </span><span class="s0">+ ($schemaValue) + </span><span class="s2">') ? ' </span><span class="s0">+ ($data) + </span><span class="s2">' ' </span><span class="s0">+ ($notOp) + </span><span class="s2">'= ' </span><span class="s0">+ ($schemaValueExcl) + </span><span class="s2">' : ' </span><span class="s0">+ ($data) + </span><span class="s2">' ' </span><span class="s0">+ ($notOp) + </span><span class="s2">' ' </span><span class="s0">+ ($schemaValue) + </span><span class="s2">' ) : ( (' </span><span class="s0">+ ($exclusive) + </span><span class="s2">' = ' </span><span class="s0">+ ($schemaValueExcl) + </span><span class="s2">' === true) ? ' </span><span class="s0">+ ($data) + </span><span class="s2">' ' </span><span class="s0">+ ($notOp) + </span><span class="s2">'= ' </span><span class="s0">+ ($schemaValue) + </span><span class="s2">' : ' </span><span class="s0">+ ($data) + </span><span class="s2">' ' </span><span class="s0">+ ($notOp) + </span><span class="s2">' ' </span><span class="s0">+ ($schemaValue) + </span><span class="s2">' ) || ' </span><span class="s0">+ ($data) + </span><span class="s2">' !== ' </span><span class="s0">+ ($data) + </span><span class="s2">') { var op' </span><span class="s0">+ ($lvl) + </span><span class="s2">' = ' </span><span class="s0">+ ($exclusive) + </span><span class="s2">' ? </span><span class="s3">\'</span><span class="s2">' </span><span class="s0">+ ($op) + </span><span class="s2">'</span><span class="s3">\' </span><span class="s2">: </span><span class="s3">\'</span><span class="s2">' </span><span class="s0">+ ($op) + </span><span class="s2">'=</span><span class="s3">\'</span><span class="s2">; '</span><span class="s3">;</span>
    <span class="s1">if </span><span class="s0">($schema === undefined) {</span>
      <span class="s0">$errorKeyword = $exclusiveKeyword</span><span class="s3">;</span>
      <span class="s0">$errSchemaPath = it.errSchemaPath + </span><span class="s2">'/' </span><span class="s0">+ $exclusiveKeyword</span><span class="s3">;</span>
      <span class="s0">$schemaValue = $schemaValueExcl</span><span class="s3">;</span>
      <span class="s0">$isData = $isDataExcl</span><span class="s3">;</span>
    <span class="s0">}</span>
  <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
    <span class="s1">var </span><span class="s0">$exclIsNumber = </span><span class="s1">typeof </span><span class="s0">$schemaExcl == </span><span class="s2">'number'</span><span class="s3">,</span>
      <span class="s0">$opStr = $op</span><span class="s3">;</span>
    <span class="s1">if </span><span class="s0">($exclIsNumber &amp;&amp; $isData) {</span>
      <span class="s1">var </span><span class="s0">$opExpr = </span><span class="s2">'</span><span class="s3">\'</span><span class="s2">' </span><span class="s0">+ $opStr + </span><span class="s2">'</span><span class="s3">\'</span><span class="s2">'</span><span class="s3">;</span>
      <span class="s0">out += </span><span class="s2">' if ( '</span><span class="s3">;</span>
      <span class="s1">if </span><span class="s0">($isData) {</span>
        <span class="s0">out += </span><span class="s2">' (' </span><span class="s0">+ ($schemaValue) + </span><span class="s2">' !== undefined &amp;&amp; typeof ' </span><span class="s0">+ ($schemaValue) + </span><span class="s2">' != </span><span class="s3">\'</span><span class="s2">number</span><span class="s3">\'</span><span class="s2">) || '</span><span class="s3">;</span>
      <span class="s0">}</span>
      <span class="s0">out += </span><span class="s2">' ( ' </span><span class="s0">+ ($schemaValue) + </span><span class="s2">' === undefined || ' </span><span class="s0">+ ($schemaExcl) + </span><span class="s2">' ' </span><span class="s0">+ ($op) + </span><span class="s2">'= ' </span><span class="s0">+ ($schemaValue) + </span><span class="s2">' ? ' </span><span class="s0">+ ($data) + </span><span class="s2">' ' </span><span class="s0">+ ($notOp) + </span><span class="s2">'= ' </span><span class="s0">+ ($schemaExcl) + </span><span class="s2">' : ' </span><span class="s0">+ ($data) + </span><span class="s2">' ' </span><span class="s0">+ ($notOp) + </span><span class="s2">' ' </span><span class="s0">+ ($schemaValue) + </span><span class="s2">' ) || ' </span><span class="s0">+ ($data) + </span><span class="s2">' !== ' </span><span class="s0">+ ($data) + </span><span class="s2">') { '</span><span class="s3">;</span>
    <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
      <span class="s1">if </span><span class="s0">($exclIsNumber &amp;&amp; $schema === undefined) {</span>
        <span class="s0">$exclusive = </span><span class="s1">true</span><span class="s3">;</span>
        <span class="s0">$errorKeyword = $exclusiveKeyword</span><span class="s3">;</span>
        <span class="s0">$errSchemaPath = it.errSchemaPath + </span><span class="s2">'/' </span><span class="s0">+ $exclusiveKeyword</span><span class="s3">;</span>
        <span class="s0">$schemaValue = $schemaExcl</span><span class="s3">;</span>
        <span class="s0">$notOp += </span><span class="s2">'='</span><span class="s3">;</span>
      <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
        <span class="s1">if </span><span class="s0">($exclIsNumber) $schemaValue = Math[$isMax ? </span><span class="s2">'min' </span><span class="s0">: </span><span class="s2">'max'</span><span class="s0">]($schemaExcl</span><span class="s3">, </span><span class="s0">$schema)</span><span class="s3">;</span>
        <span class="s1">if </span><span class="s0">($schemaExcl === ($exclIsNumber ? $schemaValue : </span><span class="s1">true</span><span class="s0">)) {</span>
          <span class="s0">$exclusive = </span><span class="s1">true</span><span class="s3">;</span>
          <span class="s0">$errorKeyword = $exclusiveKeyword</span><span class="s3">;</span>
          <span class="s0">$errSchemaPath = it.errSchemaPath + </span><span class="s2">'/' </span><span class="s0">+ $exclusiveKeyword</span><span class="s3">;</span>
          <span class="s0">$notOp += </span><span class="s2">'='</span><span class="s3">;</span>
        <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
          <span class="s0">$exclusive = </span><span class="s1">false</span><span class="s3">;</span>
          <span class="s0">$opStr += </span><span class="s2">'='</span><span class="s3">;</span>
        <span class="s0">}</span>
      <span class="s0">}</span>
      <span class="s1">var </span><span class="s0">$opExpr = </span><span class="s2">'</span><span class="s3">\'</span><span class="s2">' </span><span class="s0">+ $opStr + </span><span class="s2">'</span><span class="s3">\'</span><span class="s2">'</span><span class="s3">;</span>
      <span class="s0">out += </span><span class="s2">' if ( '</span><span class="s3">;</span>
      <span class="s1">if </span><span class="s0">($isData) {</span>
        <span class="s0">out += </span><span class="s2">' (' </span><span class="s0">+ ($schemaValue) + </span><span class="s2">' !== undefined &amp;&amp; typeof ' </span><span class="s0">+ ($schemaValue) + </span><span class="s2">' != </span><span class="s3">\'</span><span class="s2">number</span><span class="s3">\'</span><span class="s2">) || '</span><span class="s3">;</span>
      <span class="s0">}</span>
      <span class="s0">out += </span><span class="s2">' ' </span><span class="s0">+ ($data) + </span><span class="s2">' ' </span><span class="s0">+ ($notOp) + </span><span class="s2">' ' </span><span class="s0">+ ($schemaValue) + </span><span class="s2">' || ' </span><span class="s0">+ ($data) + </span><span class="s2">' !== ' </span><span class="s0">+ ($data) + </span><span class="s2">') { '</span><span class="s3">;</span>
    <span class="s0">}</span>
  <span class="s0">}</span>
  <span class="s0">$errorKeyword = $errorKeyword || $keyword</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$$outStack = $$outStack || []</span><span class="s3">;</span>
  <span class="s0">$$outStack.push(out)</span><span class="s3">;</span>
  <span class="s0">out = </span><span class="s2">''</span><span class="s3">; </span><span class="s7">/* istanbul ignore else */</span>
  <span class="s1">if </span><span class="s0">(it.createErrors !== </span><span class="s1">false</span><span class="s0">) {</span>
    <span class="s0">out += </span><span class="s2">' { keyword: </span><span class="s3">\'</span><span class="s2">' </span><span class="s0">+ ($errorKeyword || </span><span class="s2">'_limit'</span><span class="s0">) + </span><span class="s2">'</span><span class="s3">\' </span><span class="s2">, dataPath: (dataPath || </span><span class="s3">\'\'</span><span class="s2">) + ' </span><span class="s0">+ (it.errorPath) + </span><span class="s2">' , schemaPath: ' </span><span class="s0">+ (it.util.toQuotedString($errSchemaPath)) + </span><span class="s2">' , params: { comparison: ' </span><span class="s0">+ ($opExpr) + </span><span class="s2">', limit: ' </span><span class="s0">+ ($schemaValue) + </span><span class="s2">', exclusive: ' </span><span class="s0">+ ($exclusive) + </span><span class="s2">' } '</span><span class="s3">;</span>
    <span class="s1">if </span><span class="s0">(it.opts.messages !== </span><span class="s1">false</span><span class="s0">) {</span>
      <span class="s0">out += </span><span class="s2">' , message: </span><span class="s3">\'</span><span class="s2">should be ' </span><span class="s0">+ ($opStr) + </span><span class="s2">' '</span><span class="s3">;</span>
      <span class="s1">if </span><span class="s0">($isData) {</span>
        <span class="s0">out += </span><span class="s2">'</span><span class="s3">\' </span><span class="s2">+ ' </span><span class="s0">+ ($schemaValue)</span><span class="s3">;</span>
      <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
        <span class="s0">out += </span><span class="s2">'' </span><span class="s0">+ ($schemaValue) + </span><span class="s2">'</span><span class="s3">\'</span><span class="s2">'</span><span class="s3">;</span>
      <span class="s0">}</span>
    <span class="s0">}</span>
    <span class="s1">if </span><span class="s0">(it.opts.verbose) {</span>
      <span class="s0">out += </span><span class="s2">' , schema:  '</span><span class="s3">;</span>
      <span class="s1">if </span><span class="s0">($isData) {</span>
        <span class="s0">out += </span><span class="s2">'validate.schema' </span><span class="s0">+ ($schemaPath)</span><span class="s3">;</span>
      <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
        <span class="s0">out += </span><span class="s2">'' </span><span class="s0">+ ($schema)</span><span class="s3">;</span>
      <span class="s0">}</span>
      <span class="s0">out += </span><span class="s2">'         , parentSchema: validate.schema' </span><span class="s0">+ (it.schemaPath) + </span><span class="s2">' , data: ' </span><span class="s0">+ ($data) + </span><span class="s2">' '</span><span class="s3">;</span>
    <span class="s0">}</span>
    <span class="s0">out += </span><span class="s2">' } '</span><span class="s3">;</span>
  <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
    <span class="s0">out += </span><span class="s2">' {} '</span><span class="s3">;</span>
  <span class="s0">}</span>
  <span class="s1">var </span><span class="s0">__err = out</span><span class="s3">;</span>
  <span class="s0">out = $$outStack.pop()</span><span class="s3">;</span>
  <span class="s1">if </span><span class="s0">(!it.compositeRule &amp;&amp; $breakOnError) {</span>
    <span class="s7">/* istanbul ignore if */</span>
    <span class="s1">if </span><span class="s0">(it.async) {</span>
      <span class="s0">out += </span><span class="s2">' throw new ValidationError([' </span><span class="s0">+ (__err) + </span><span class="s2">']); '</span><span class="s3">;</span>
    <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
      <span class="s0">out += </span><span class="s2">' validate.errors = [' </span><span class="s0">+ (__err) + </span><span class="s2">']; return false; '</span><span class="s3">;</span>
    <span class="s0">}</span>
  <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
    <span class="s0">out += </span><span class="s2">' var err = ' </span><span class="s0">+ (__err) + </span><span class="s2">';  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; '</span><span class="s3">;</span>
  <span class="s0">}</span>
  <span class="s0">out += </span><span class="s2">' } '</span><span class="s3">;</span>
  <span class="s1">if </span><span class="s0">($breakOnError) {</span>
    <span class="s0">out += </span><span class="s2">' else { '</span><span class="s3">;</span>
  <span class="s0">}</span>
  <span class="s1">return </span><span class="s0">out</span><span class="s3">;</span>
<span class="s0">}</span>

<span class="s0">}</span><span class="s3">,</span><span class="s0">{}]</span><span class="s3">,</span><span class="s4">14</span><span class="s0">:[</span><span class="s1">function</span><span class="s0">(require</span><span class="s3">,</span><span class="s0">module</span><span class="s3">,</span><span class="s0">exports){</span>
<span class="s2">'use strict'</span><span class="s3">;</span>
<span class="s0">module.exports = </span><span class="s1">function </span><span class="s0">generate__limitItems(it</span><span class="s3">, </span><span class="s0">$keyword</span><span class="s3">, </span><span class="s0">$ruleType) {</span>
  <span class="s1">var </span><span class="s0">out = </span><span class="s2">' '</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$lvl = it.level</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$dataLvl = it.dataLevel</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$schema = it.schema[$keyword]</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$schemaPath = it.schemaPath + it.util.getProperty($keyword)</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$errSchemaPath = it.errSchemaPath + </span><span class="s2">'/' </span><span class="s0">+ $keyword</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$breakOnError = !it.opts.allErrors</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$errorKeyword</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$data = </span><span class="s2">'data' </span><span class="s0">+ ($dataLvl || </span><span class="s2">''</span><span class="s0">)</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$isData = it.opts.$data &amp;&amp; $schema &amp;&amp; $schema.$data</span><span class="s3">,</span>
    <span class="s0">$schemaValue</span><span class="s3">;</span>
  <span class="s1">if </span><span class="s0">($isData) {</span>
    <span class="s0">out += </span><span class="s2">' var schema' </span><span class="s0">+ ($lvl) + </span><span class="s2">' = ' </span><span class="s0">+ (it.util.getData($schema.$data</span><span class="s3">, </span><span class="s0">$dataLvl</span><span class="s3">, </span><span class="s0">it.dataPathArr)) + </span><span class="s2">'; '</span><span class="s3">;</span>
    <span class="s0">$schemaValue = </span><span class="s2">'schema' </span><span class="s0">+ $lvl</span><span class="s3">;</span>
  <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
    <span class="s0">$schemaValue = $schema</span><span class="s3">;</span>
  <span class="s0">}</span>
  <span class="s1">if </span><span class="s0">(!($isData || </span><span class="s1">typeof </span><span class="s0">$schema == </span><span class="s2">'number'</span><span class="s0">)) {</span>
    <span class="s1">throw new </span><span class="s0">Error($keyword + </span><span class="s2">' must be number'</span><span class="s0">)</span><span class="s3">;</span>
  <span class="s0">}</span>
  <span class="s1">var </span><span class="s0">$op = $keyword == </span><span class="s2">'maxItems' </span><span class="s0">? </span><span class="s2">'&gt;' </span><span class="s0">: </span><span class="s2">'&lt;'</span><span class="s3">;</span>
  <span class="s0">out += </span><span class="s2">'if ( '</span><span class="s3">;</span>
  <span class="s1">if </span><span class="s0">($isData) {</span>
    <span class="s0">out += </span><span class="s2">' (' </span><span class="s0">+ ($schemaValue) + </span><span class="s2">' !== undefined &amp;&amp; typeof ' </span><span class="s0">+ ($schemaValue) + </span><span class="s2">' != </span><span class="s3">\'</span><span class="s2">number</span><span class="s3">\'</span><span class="s2">) || '</span><span class="s3">;</span>
  <span class="s0">}</span>
  <span class="s0">out += </span><span class="s2">' ' </span><span class="s0">+ ($data) + </span><span class="s2">'.length ' </span><span class="s0">+ ($op) + </span><span class="s2">' ' </span><span class="s0">+ ($schemaValue) + </span><span class="s2">') { '</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$errorKeyword = $keyword</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$$outStack = $$outStack || []</span><span class="s3">;</span>
  <span class="s0">$$outStack.push(out)</span><span class="s3">;</span>
  <span class="s0">out = </span><span class="s2">''</span><span class="s3">; </span><span class="s7">/* istanbul ignore else */</span>
  <span class="s1">if </span><span class="s0">(it.createErrors !== </span><span class="s1">false</span><span class="s0">) {</span>
    <span class="s0">out += </span><span class="s2">' { keyword: </span><span class="s3">\'</span><span class="s2">' </span><span class="s0">+ ($errorKeyword || </span><span class="s2">'_limitItems'</span><span class="s0">) + </span><span class="s2">'</span><span class="s3">\' </span><span class="s2">, dataPath: (dataPath || </span><span class="s3">\'\'</span><span class="s2">) + ' </span><span class="s0">+ (it.errorPath) + </span><span class="s2">' , schemaPath: ' </span><span class="s0">+ (it.util.toQuotedString($errSchemaPath)) + </span><span class="s2">' , params: { limit: ' </span><span class="s0">+ ($schemaValue) + </span><span class="s2">' } '</span><span class="s3">;</span>
    <span class="s1">if </span><span class="s0">(it.opts.messages !== </span><span class="s1">false</span><span class="s0">) {</span>
      <span class="s0">out += </span><span class="s2">' , message: </span><span class="s3">\'</span><span class="s2">should NOT have '</span><span class="s3">;</span>
      <span class="s1">if </span><span class="s0">($keyword == </span><span class="s2">'maxItems'</span><span class="s0">) {</span>
        <span class="s0">out += </span><span class="s2">'more'</span><span class="s3">;</span>
      <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
        <span class="s0">out += </span><span class="s2">'fewer'</span><span class="s3">;</span>
      <span class="s0">}</span>
      <span class="s0">out += </span><span class="s2">' than '</span><span class="s3">;</span>
      <span class="s1">if </span><span class="s0">($isData) {</span>
        <span class="s0">out += </span><span class="s2">'</span><span class="s3">\' </span><span class="s2">+ ' </span><span class="s0">+ ($schemaValue) + </span><span class="s2">' + </span><span class="s3">\'</span><span class="s2">'</span><span class="s3">;</span>
      <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
        <span class="s0">out += </span><span class="s2">'' </span><span class="s0">+ ($schema)</span><span class="s3">;</span>
      <span class="s0">}</span>
      <span class="s0">out += </span><span class="s2">' items</span><span class="s3">\' </span><span class="s2">'</span><span class="s3">;</span>
    <span class="s0">}</span>
    <span class="s1">if </span><span class="s0">(it.opts.verbose) {</span>
      <span class="s0">out += </span><span class="s2">' , schema:  '</span><span class="s3">;</span>
      <span class="s1">if </span><span class="s0">($isData) {</span>
        <span class="s0">out += </span><span class="s2">'validate.schema' </span><span class="s0">+ ($schemaPath)</span><span class="s3">;</span>
      <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
        <span class="s0">out += </span><span class="s2">'' </span><span class="s0">+ ($schema)</span><span class="s3">;</span>
      <span class="s0">}</span>
      <span class="s0">out += </span><span class="s2">'         , parentSchema: validate.schema' </span><span class="s0">+ (it.schemaPath) + </span><span class="s2">' , data: ' </span><span class="s0">+ ($data) + </span><span class="s2">' '</span><span class="s3">;</span>
    <span class="s0">}</span>
    <span class="s0">out += </span><span class="s2">' } '</span><span class="s3">;</span>
  <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
    <span class="s0">out += </span><span class="s2">' {} '</span><span class="s3">;</span>
  <span class="s0">}</span>
  <span class="s1">var </span><span class="s0">__err = out</span><span class="s3">;</span>
  <span class="s0">out = $$outStack.pop()</span><span class="s3">;</span>
  <span class="s1">if </span><span class="s0">(!it.compositeRule &amp;&amp; $breakOnError) {</span>
    <span class="s7">/* istanbul ignore if */</span>
    <span class="s1">if </span><span class="s0">(it.async) {</span>
      <span class="s0">out += </span><span class="s2">' throw new ValidationError([' </span><span class="s0">+ (__err) + </span><span class="s2">']); '</span><span class="s3">;</span>
    <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
      <span class="s0">out += </span><span class="s2">' validate.errors = [' </span><span class="s0">+ (__err) + </span><span class="s2">']; return false; '</span><span class="s3">;</span>
    <span class="s0">}</span>
  <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
    <span class="s0">out += </span><span class="s2">' var err = ' </span><span class="s0">+ (__err) + </span><span class="s2">';  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; '</span><span class="s3">;</span>
  <span class="s0">}</span>
  <span class="s0">out += </span><span class="s2">'} '</span><span class="s3">;</span>
  <span class="s1">if </span><span class="s0">($breakOnError) {</span>
    <span class="s0">out += </span><span class="s2">' else { '</span><span class="s3">;</span>
  <span class="s0">}</span>
  <span class="s1">return </span><span class="s0">out</span><span class="s3">;</span>
<span class="s0">}</span>

<span class="s0">}</span><span class="s3">,</span><span class="s0">{}]</span><span class="s3">,</span><span class="s4">15</span><span class="s0">:[</span><span class="s1">function</span><span class="s0">(require</span><span class="s3">,</span><span class="s0">module</span><span class="s3">,</span><span class="s0">exports){</span>
<span class="s2">'use strict'</span><span class="s3">;</span>
<span class="s0">module.exports = </span><span class="s1">function </span><span class="s0">generate__limitLength(it</span><span class="s3">, </span><span class="s0">$keyword</span><span class="s3">, </span><span class="s0">$ruleType) {</span>
  <span class="s1">var </span><span class="s0">out = </span><span class="s2">' '</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$lvl = it.level</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$dataLvl = it.dataLevel</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$schema = it.schema[$keyword]</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$schemaPath = it.schemaPath + it.util.getProperty($keyword)</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$errSchemaPath = it.errSchemaPath + </span><span class="s2">'/' </span><span class="s0">+ $keyword</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$breakOnError = !it.opts.allErrors</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$errorKeyword</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$data = </span><span class="s2">'data' </span><span class="s0">+ ($dataLvl || </span><span class="s2">''</span><span class="s0">)</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$isData = it.opts.$data &amp;&amp; $schema &amp;&amp; $schema.$data</span><span class="s3">,</span>
    <span class="s0">$schemaValue</span><span class="s3">;</span>
  <span class="s1">if </span><span class="s0">($isData) {</span>
    <span class="s0">out += </span><span class="s2">' var schema' </span><span class="s0">+ ($lvl) + </span><span class="s2">' = ' </span><span class="s0">+ (it.util.getData($schema.$data</span><span class="s3">, </span><span class="s0">$dataLvl</span><span class="s3">, </span><span class="s0">it.dataPathArr)) + </span><span class="s2">'; '</span><span class="s3">;</span>
    <span class="s0">$schemaValue = </span><span class="s2">'schema' </span><span class="s0">+ $lvl</span><span class="s3">;</span>
  <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
    <span class="s0">$schemaValue = $schema</span><span class="s3">;</span>
  <span class="s0">}</span>
  <span class="s1">if </span><span class="s0">(!($isData || </span><span class="s1">typeof </span><span class="s0">$schema == </span><span class="s2">'number'</span><span class="s0">)) {</span>
    <span class="s1">throw new </span><span class="s0">Error($keyword + </span><span class="s2">' must be number'</span><span class="s0">)</span><span class="s3">;</span>
  <span class="s0">}</span>
  <span class="s1">var </span><span class="s0">$op = $keyword == </span><span class="s2">'maxLength' </span><span class="s0">? </span><span class="s2">'&gt;' </span><span class="s0">: </span><span class="s2">'&lt;'</span><span class="s3">;</span>
  <span class="s0">out += </span><span class="s2">'if ( '</span><span class="s3">;</span>
  <span class="s1">if </span><span class="s0">($isData) {</span>
    <span class="s0">out += </span><span class="s2">' (' </span><span class="s0">+ ($schemaValue) + </span><span class="s2">' !== undefined &amp;&amp; typeof ' </span><span class="s0">+ ($schemaValue) + </span><span class="s2">' != </span><span class="s3">\'</span><span class="s2">number</span><span class="s3">\'</span><span class="s2">) || '</span><span class="s3">;</span>
  <span class="s0">}</span>
  <span class="s1">if </span><span class="s0">(it.opts.unicode === </span><span class="s1">false</span><span class="s0">) {</span>
    <span class="s0">out += </span><span class="s2">' ' </span><span class="s0">+ ($data) + </span><span class="s2">'.length '</span><span class="s3">;</span>
  <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
    <span class="s0">out += </span><span class="s2">' ucs2length(' </span><span class="s0">+ ($data) + </span><span class="s2">') '</span><span class="s3">;</span>
  <span class="s0">}</span>
  <span class="s0">out += </span><span class="s2">' ' </span><span class="s0">+ ($op) + </span><span class="s2">' ' </span><span class="s0">+ ($schemaValue) + </span><span class="s2">') { '</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$errorKeyword = $keyword</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$$outStack = $$outStack || []</span><span class="s3">;</span>
  <span class="s0">$$outStack.push(out)</span><span class="s3">;</span>
  <span class="s0">out = </span><span class="s2">''</span><span class="s3">; </span><span class="s7">/* istanbul ignore else */</span>
  <span class="s1">if </span><span class="s0">(it.createErrors !== </span><span class="s1">false</span><span class="s0">) {</span>
    <span class="s0">out += </span><span class="s2">' { keyword: </span><span class="s3">\'</span><span class="s2">' </span><span class="s0">+ ($errorKeyword || </span><span class="s2">'_limitLength'</span><span class="s0">) + </span><span class="s2">'</span><span class="s3">\' </span><span class="s2">, dataPath: (dataPath || </span><span class="s3">\'\'</span><span class="s2">) + ' </span><span class="s0">+ (it.errorPath) + </span><span class="s2">' , schemaPath: ' </span><span class="s0">+ (it.util.toQuotedString($errSchemaPath)) + </span><span class="s2">' , params: { limit: ' </span><span class="s0">+ ($schemaValue) + </span><span class="s2">' } '</span><span class="s3">;</span>
    <span class="s1">if </span><span class="s0">(it.opts.messages !== </span><span class="s1">false</span><span class="s0">) {</span>
      <span class="s0">out += </span><span class="s2">' , message: </span><span class="s3">\'</span><span class="s2">should NOT be '</span><span class="s3">;</span>
      <span class="s1">if </span><span class="s0">($keyword == </span><span class="s2">'maxLength'</span><span class="s0">) {</span>
        <span class="s0">out += </span><span class="s2">'longer'</span><span class="s3">;</span>
      <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
        <span class="s0">out += </span><span class="s2">'shorter'</span><span class="s3">;</span>
      <span class="s0">}</span>
      <span class="s0">out += </span><span class="s2">' than '</span><span class="s3">;</span>
      <span class="s1">if </span><span class="s0">($isData) {</span>
        <span class="s0">out += </span><span class="s2">'</span><span class="s3">\' </span><span class="s2">+ ' </span><span class="s0">+ ($schemaValue) + </span><span class="s2">' + </span><span class="s3">\'</span><span class="s2">'</span><span class="s3">;</span>
      <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
        <span class="s0">out += </span><span class="s2">'' </span><span class="s0">+ ($schema)</span><span class="s3">;</span>
      <span class="s0">}</span>
      <span class="s0">out += </span><span class="s2">' characters</span><span class="s3">\' </span><span class="s2">'</span><span class="s3">;</span>
    <span class="s0">}</span>
    <span class="s1">if </span><span class="s0">(it.opts.verbose) {</span>
      <span class="s0">out += </span><span class="s2">' , schema:  '</span><span class="s3">;</span>
      <span class="s1">if </span><span class="s0">($isData) {</span>
        <span class="s0">out += </span><span class="s2">'validate.schema' </span><span class="s0">+ ($schemaPath)</span><span class="s3">;</span>
      <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
        <span class="s0">out += </span><span class="s2">'' </span><span class="s0">+ ($schema)</span><span class="s3">;</span>
      <span class="s0">}</span>
      <span class="s0">out += </span><span class="s2">'         , parentSchema: validate.schema' </span><span class="s0">+ (it.schemaPath) + </span><span class="s2">' , data: ' </span><span class="s0">+ ($data) + </span><span class="s2">' '</span><span class="s3">;</span>
    <span class="s0">}</span>
    <span class="s0">out += </span><span class="s2">' } '</span><span class="s3">;</span>
  <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
    <span class="s0">out += </span><span class="s2">' {} '</span><span class="s3">;</span>
  <span class="s0">}</span>
  <span class="s1">var </span><span class="s0">__err = out</span><span class="s3">;</span>
  <span class="s0">out = $$outStack.pop()</span><span class="s3">;</span>
  <span class="s1">if </span><span class="s0">(!it.compositeRule &amp;&amp; $breakOnError) {</span>
    <span class="s7">/* istanbul ignore if */</span>
    <span class="s1">if </span><span class="s0">(it.async) {</span>
      <span class="s0">out += </span><span class="s2">' throw new ValidationError([' </span><span class="s0">+ (__err) + </span><span class="s2">']); '</span><span class="s3">;</span>
    <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
      <span class="s0">out += </span><span class="s2">' validate.errors = [' </span><span class="s0">+ (__err) + </span><span class="s2">']; return false; '</span><span class="s3">;</span>
    <span class="s0">}</span>
  <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
    <span class="s0">out += </span><span class="s2">' var err = ' </span><span class="s0">+ (__err) + </span><span class="s2">';  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; '</span><span class="s3">;</span>
  <span class="s0">}</span>
  <span class="s0">out += </span><span class="s2">'} '</span><span class="s3">;</span>
  <span class="s1">if </span><span class="s0">($breakOnError) {</span>
    <span class="s0">out += </span><span class="s2">' else { '</span><span class="s3">;</span>
  <span class="s0">}</span>
  <span class="s1">return </span><span class="s0">out</span><span class="s3">;</span>
<span class="s0">}</span>

<span class="s0">}</span><span class="s3">,</span><span class="s0">{}]</span><span class="s3">,</span><span class="s4">16</span><span class="s0">:[</span><span class="s1">function</span><span class="s0">(require</span><span class="s3">,</span><span class="s0">module</span><span class="s3">,</span><span class="s0">exports){</span>
<span class="s2">'use strict'</span><span class="s3">;</span>
<span class="s0">module.exports = </span><span class="s1">function </span><span class="s0">generate__limitProperties(it</span><span class="s3">, </span><span class="s0">$keyword</span><span class="s3">, </span><span class="s0">$ruleType) {</span>
  <span class="s1">var </span><span class="s0">out = </span><span class="s2">' '</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$lvl = it.level</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$dataLvl = it.dataLevel</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$schema = it.schema[$keyword]</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$schemaPath = it.schemaPath + it.util.getProperty($keyword)</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$errSchemaPath = it.errSchemaPath + </span><span class="s2">'/' </span><span class="s0">+ $keyword</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$breakOnError = !it.opts.allErrors</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$errorKeyword</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$data = </span><span class="s2">'data' </span><span class="s0">+ ($dataLvl || </span><span class="s2">''</span><span class="s0">)</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$isData = it.opts.$data &amp;&amp; $schema &amp;&amp; $schema.$data</span><span class="s3">,</span>
    <span class="s0">$schemaValue</span><span class="s3">;</span>
  <span class="s1">if </span><span class="s0">($isData) {</span>
    <span class="s0">out += </span><span class="s2">' var schema' </span><span class="s0">+ ($lvl) + </span><span class="s2">' = ' </span><span class="s0">+ (it.util.getData($schema.$data</span><span class="s3">, </span><span class="s0">$dataLvl</span><span class="s3">, </span><span class="s0">it.dataPathArr)) + </span><span class="s2">'; '</span><span class="s3">;</span>
    <span class="s0">$schemaValue = </span><span class="s2">'schema' </span><span class="s0">+ $lvl</span><span class="s3">;</span>
  <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
    <span class="s0">$schemaValue = $schema</span><span class="s3">;</span>
  <span class="s0">}</span>
  <span class="s1">if </span><span class="s0">(!($isData || </span><span class="s1">typeof </span><span class="s0">$schema == </span><span class="s2">'number'</span><span class="s0">)) {</span>
    <span class="s1">throw new </span><span class="s0">Error($keyword + </span><span class="s2">' must be number'</span><span class="s0">)</span><span class="s3">;</span>
  <span class="s0">}</span>
  <span class="s1">var </span><span class="s0">$op = $keyword == </span><span class="s2">'maxProperties' </span><span class="s0">? </span><span class="s2">'&gt;' </span><span class="s0">: </span><span class="s2">'&lt;'</span><span class="s3">;</span>
  <span class="s0">out += </span><span class="s2">'if ( '</span><span class="s3">;</span>
  <span class="s1">if </span><span class="s0">($isData) {</span>
    <span class="s0">out += </span><span class="s2">' (' </span><span class="s0">+ ($schemaValue) + </span><span class="s2">' !== undefined &amp;&amp; typeof ' </span><span class="s0">+ ($schemaValue) + </span><span class="s2">' != </span><span class="s3">\'</span><span class="s2">number</span><span class="s3">\'</span><span class="s2">) || '</span><span class="s3">;</span>
  <span class="s0">}</span>
  <span class="s0">out += </span><span class="s2">' Object.keys(' </span><span class="s0">+ ($data) + </span><span class="s2">').length ' </span><span class="s0">+ ($op) + </span><span class="s2">' ' </span><span class="s0">+ ($schemaValue) + </span><span class="s2">') { '</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$errorKeyword = $keyword</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$$outStack = $$outStack || []</span><span class="s3">;</span>
  <span class="s0">$$outStack.push(out)</span><span class="s3">;</span>
  <span class="s0">out = </span><span class="s2">''</span><span class="s3">; </span><span class="s7">/* istanbul ignore else */</span>
  <span class="s1">if </span><span class="s0">(it.createErrors !== </span><span class="s1">false</span><span class="s0">) {</span>
    <span class="s0">out += </span><span class="s2">' { keyword: </span><span class="s3">\'</span><span class="s2">' </span><span class="s0">+ ($errorKeyword || </span><span class="s2">'_limitProperties'</span><span class="s0">) + </span><span class="s2">'</span><span class="s3">\' </span><span class="s2">, dataPath: (dataPath || </span><span class="s3">\'\'</span><span class="s2">) + ' </span><span class="s0">+ (it.errorPath) + </span><span class="s2">' , schemaPath: ' </span><span class="s0">+ (it.util.toQuotedString($errSchemaPath)) + </span><span class="s2">' , params: { limit: ' </span><span class="s0">+ ($schemaValue) + </span><span class="s2">' } '</span><span class="s3">;</span>
    <span class="s1">if </span><span class="s0">(it.opts.messages !== </span><span class="s1">false</span><span class="s0">) {</span>
      <span class="s0">out += </span><span class="s2">' , message: </span><span class="s3">\'</span><span class="s2">should NOT have '</span><span class="s3">;</span>
      <span class="s1">if </span><span class="s0">($keyword == </span><span class="s2">'maxProperties'</span><span class="s0">) {</span>
        <span class="s0">out += </span><span class="s2">'more'</span><span class="s3">;</span>
      <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
        <span class="s0">out += </span><span class="s2">'fewer'</span><span class="s3">;</span>
      <span class="s0">}</span>
      <span class="s0">out += </span><span class="s2">' than '</span><span class="s3">;</span>
      <span class="s1">if </span><span class="s0">($isData) {</span>
        <span class="s0">out += </span><span class="s2">'</span><span class="s3">\' </span><span class="s2">+ ' </span><span class="s0">+ ($schemaValue) + </span><span class="s2">' + </span><span class="s3">\'</span><span class="s2">'</span><span class="s3">;</span>
      <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
        <span class="s0">out += </span><span class="s2">'' </span><span class="s0">+ ($schema)</span><span class="s3">;</span>
      <span class="s0">}</span>
      <span class="s0">out += </span><span class="s2">' properties</span><span class="s3">\' </span><span class="s2">'</span><span class="s3">;</span>
    <span class="s0">}</span>
    <span class="s1">if </span><span class="s0">(it.opts.verbose) {</span>
      <span class="s0">out += </span><span class="s2">' , schema:  '</span><span class="s3">;</span>
      <span class="s1">if </span><span class="s0">($isData) {</span>
        <span class="s0">out += </span><span class="s2">'validate.schema' </span><span class="s0">+ ($schemaPath)</span><span class="s3">;</span>
      <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
        <span class="s0">out += </span><span class="s2">'' </span><span class="s0">+ ($schema)</span><span class="s3">;</span>
      <span class="s0">}</span>
      <span class="s0">out += </span><span class="s2">'         , parentSchema: validate.schema' </span><span class="s0">+ (it.schemaPath) + </span><span class="s2">' , data: ' </span><span class="s0">+ ($data) + </span><span class="s2">' '</span><span class="s3">;</span>
    <span class="s0">}</span>
    <span class="s0">out += </span><span class="s2">' } '</span><span class="s3">;</span>
  <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
    <span class="s0">out += </span><span class="s2">' {} '</span><span class="s3">;</span>
  <span class="s0">}</span>
  <span class="s1">var </span><span class="s0">__err = out</span><span class="s3">;</span>
  <span class="s0">out = $$outStack.pop()</span><span class="s3">;</span>
  <span class="s1">if </span><span class="s0">(!it.compositeRule &amp;&amp; $breakOnError) {</span>
    <span class="s7">/* istanbul ignore if */</span>
    <span class="s1">if </span><span class="s0">(it.async) {</span>
      <span class="s0">out += </span><span class="s2">' throw new ValidationError([' </span><span class="s0">+ (__err) + </span><span class="s2">']); '</span><span class="s3">;</span>
    <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
      <span class="s0">out += </span><span class="s2">' validate.errors = [' </span><span class="s0">+ (__err) + </span><span class="s2">']; return false; '</span><span class="s3">;</span>
    <span class="s0">}</span>
  <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
    <span class="s0">out += </span><span class="s2">' var err = ' </span><span class="s0">+ (__err) + </span><span class="s2">';  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; '</span><span class="s3">;</span>
  <span class="s0">}</span>
  <span class="s0">out += </span><span class="s2">'} '</span><span class="s3">;</span>
  <span class="s1">if </span><span class="s0">($breakOnError) {</span>
    <span class="s0">out += </span><span class="s2">' else { '</span><span class="s3">;</span>
  <span class="s0">}</span>
  <span class="s1">return </span><span class="s0">out</span><span class="s3">;</span>
<span class="s0">}</span>

<span class="s0">}</span><span class="s3">,</span><span class="s0">{}]</span><span class="s3">,</span><span class="s4">17</span><span class="s0">:[</span><span class="s1">function</span><span class="s0">(require</span><span class="s3">,</span><span class="s0">module</span><span class="s3">,</span><span class="s0">exports){</span>
<span class="s2">'use strict'</span><span class="s3">;</span>
<span class="s0">module.exports = </span><span class="s1">function </span><span class="s0">generate_allOf(it</span><span class="s3">, </span><span class="s0">$keyword</span><span class="s3">, </span><span class="s0">$ruleType) {</span>
  <span class="s1">var </span><span class="s0">out = </span><span class="s2">' '</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$schema = it.schema[$keyword]</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$schemaPath = it.schemaPath + it.util.getProperty($keyword)</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$errSchemaPath = it.errSchemaPath + </span><span class="s2">'/' </span><span class="s0">+ $keyword</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$breakOnError = !it.opts.allErrors</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$it = it.util.copy(it)</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$closingBraces = </span><span class="s2">''</span><span class="s3">;</span>
  <span class="s0">$it.level++</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$nextValid = </span><span class="s2">'valid' </span><span class="s0">+ $it.level</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$currentBaseId = $it.baseId</span><span class="s3">,</span>
    <span class="s0">$allSchemasEmpty = </span><span class="s1">true</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">arr1 = $schema</span><span class="s3">;</span>
  <span class="s1">if </span><span class="s0">(arr1) {</span>
    <span class="s1">var </span><span class="s0">$sch</span><span class="s3">, </span><span class="s0">$i = -</span><span class="s4">1</span><span class="s3">,</span>
      <span class="s0">l1 = arr1.length - </span><span class="s4">1</span><span class="s3">;</span>
    <span class="s1">while </span><span class="s0">($i &lt; l1) {</span>
      <span class="s0">$sch = arr1[$i += </span><span class="s4">1</span><span class="s0">]</span><span class="s3">;</span>
      <span class="s1">if </span><span class="s0">((it.opts.strictKeywords ? (</span><span class="s1">typeof </span><span class="s0">$sch == </span><span class="s2">'object' </span><span class="s0">&amp;&amp; Object.keys($sch).length &gt; </span><span class="s4">0</span><span class="s0">) || $sch === </span><span class="s1">false </span><span class="s0">: it.util.schemaHasRules($sch</span><span class="s3">, </span><span class="s0">it.RULES.all))) {</span>
        <span class="s0">$allSchemasEmpty = </span><span class="s1">false</span><span class="s3">;</span>
        <span class="s0">$it.schema = $sch</span><span class="s3">;</span>
        <span class="s0">$it.schemaPath = $schemaPath + </span><span class="s2">'[' </span><span class="s0">+ $i + </span><span class="s2">']'</span><span class="s3">;</span>
        <span class="s0">$it.errSchemaPath = $errSchemaPath + </span><span class="s2">'/' </span><span class="s0">+ $i</span><span class="s3">;</span>
        <span class="s0">out += </span><span class="s2">'  ' </span><span class="s0">+ (it.validate($it)) + </span><span class="s2">' '</span><span class="s3">;</span>
        <span class="s0">$it.baseId = $currentBaseId</span><span class="s3">;</span>
        <span class="s1">if </span><span class="s0">($breakOnError) {</span>
          <span class="s0">out += </span><span class="s2">' if (' </span><span class="s0">+ ($nextValid) + </span><span class="s2">') { '</span><span class="s3">;</span>
          <span class="s0">$closingBraces += </span><span class="s2">'}'</span><span class="s3">;</span>
        <span class="s0">}</span>
      <span class="s0">}</span>
    <span class="s0">}</span>
  <span class="s0">}</span>
  <span class="s1">if </span><span class="s0">($breakOnError) {</span>
    <span class="s1">if </span><span class="s0">($allSchemasEmpty) {</span>
      <span class="s0">out += </span><span class="s2">' if (true) { '</span><span class="s3">;</span>
    <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
      <span class="s0">out += </span><span class="s2">' ' </span><span class="s0">+ ($closingBraces.slice(</span><span class="s4">0</span><span class="s3">, </span><span class="s0">-</span><span class="s4">1</span><span class="s0">)) + </span><span class="s2">' '</span><span class="s3">;</span>
    <span class="s0">}</span>
  <span class="s0">}</span>
  <span class="s1">return </span><span class="s0">out</span><span class="s3">;</span>
<span class="s0">}</span>

<span class="s0">}</span><span class="s3">,</span><span class="s0">{}]</span><span class="s3">,</span><span class="s4">18</span><span class="s0">:[</span><span class="s1">function</span><span class="s0">(require</span><span class="s3">,</span><span class="s0">module</span><span class="s3">,</span><span class="s0">exports){</span>
<span class="s2">'use strict'</span><span class="s3">;</span>
<span class="s0">module.exports = </span><span class="s1">function </span><span class="s0">generate_anyOf(it</span><span class="s3">, </span><span class="s0">$keyword</span><span class="s3">, </span><span class="s0">$ruleType) {</span>
  <span class="s1">var </span><span class="s0">out = </span><span class="s2">' '</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$lvl = it.level</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$dataLvl = it.dataLevel</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$schema = it.schema[$keyword]</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$schemaPath = it.schemaPath + it.util.getProperty($keyword)</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$errSchemaPath = it.errSchemaPath + </span><span class="s2">'/' </span><span class="s0">+ $keyword</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$breakOnError = !it.opts.allErrors</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$data = </span><span class="s2">'data' </span><span class="s0">+ ($dataLvl || </span><span class="s2">''</span><span class="s0">)</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$valid = </span><span class="s2">'valid' </span><span class="s0">+ $lvl</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$errs = </span><span class="s2">'errs__' </span><span class="s0">+ $lvl</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$it = it.util.copy(it)</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$closingBraces = </span><span class="s2">''</span><span class="s3">;</span>
  <span class="s0">$it.level++</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$nextValid = </span><span class="s2">'valid' </span><span class="s0">+ $it.level</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$noEmptySchema = $schema.every(</span><span class="s1">function</span><span class="s0">($sch) {</span>
    <span class="s1">return </span><span class="s0">(it.opts.strictKeywords ? (</span><span class="s1">typeof </span><span class="s0">$sch == </span><span class="s2">'object' </span><span class="s0">&amp;&amp; Object.keys($sch).length &gt; </span><span class="s4">0</span><span class="s0">) || $sch === </span><span class="s1">false </span><span class="s0">: it.util.schemaHasRules($sch</span><span class="s3">, </span><span class="s0">it.RULES.all))</span><span class="s3">;</span>
  <span class="s0">})</span><span class="s3">;</span>
  <span class="s1">if </span><span class="s0">($noEmptySchema) {</span>
    <span class="s1">var </span><span class="s0">$currentBaseId = $it.baseId</span><span class="s3">;</span>
    <span class="s0">out += </span><span class="s2">' var ' </span><span class="s0">+ ($errs) + </span><span class="s2">' = errors; var ' </span><span class="s0">+ ($valid) + </span><span class="s2">' = false;  '</span><span class="s3">;</span>
    <span class="s1">var </span><span class="s0">$wasComposite = it.compositeRule</span><span class="s3">;</span>
    <span class="s0">it.compositeRule = $it.compositeRule = </span><span class="s1">true</span><span class="s3">;</span>
    <span class="s1">var </span><span class="s0">arr1 = $schema</span><span class="s3">;</span>
    <span class="s1">if </span><span class="s0">(arr1) {</span>
      <span class="s1">var </span><span class="s0">$sch</span><span class="s3">, </span><span class="s0">$i = -</span><span class="s4">1</span><span class="s3">,</span>
        <span class="s0">l1 = arr1.length - </span><span class="s4">1</span><span class="s3">;</span>
      <span class="s1">while </span><span class="s0">($i &lt; l1) {</span>
        <span class="s0">$sch = arr1[$i += </span><span class="s4">1</span><span class="s0">]</span><span class="s3">;</span>
        <span class="s0">$it.schema = $sch</span><span class="s3">;</span>
        <span class="s0">$it.schemaPath = $schemaPath + </span><span class="s2">'[' </span><span class="s0">+ $i + </span><span class="s2">']'</span><span class="s3">;</span>
        <span class="s0">$it.errSchemaPath = $errSchemaPath + </span><span class="s2">'/' </span><span class="s0">+ $i</span><span class="s3">;</span>
        <span class="s0">out += </span><span class="s2">'  ' </span><span class="s0">+ (it.validate($it)) + </span><span class="s2">' '</span><span class="s3">;</span>
        <span class="s0">$it.baseId = $currentBaseId</span><span class="s3">;</span>
        <span class="s0">out += </span><span class="s2">' ' </span><span class="s0">+ ($valid) + </span><span class="s2">' = ' </span><span class="s0">+ ($valid) + </span><span class="s2">' || ' </span><span class="s0">+ ($nextValid) + </span><span class="s2">'; if (!' </span><span class="s0">+ ($valid) + </span><span class="s2">') { '</span><span class="s3">;</span>
        <span class="s0">$closingBraces += </span><span class="s2">'}'</span><span class="s3">;</span>
      <span class="s0">}</span>
    <span class="s0">}</span>
    <span class="s0">it.compositeRule = $it.compositeRule = $wasComposite</span><span class="s3">;</span>
    <span class="s0">out += </span><span class="s2">' ' </span><span class="s0">+ ($closingBraces) + </span><span class="s2">' if (!' </span><span class="s0">+ ($valid) + </span><span class="s2">') {   var err =   '</span><span class="s3">; </span><span class="s7">/* istanbul ignore else */</span>
    <span class="s1">if </span><span class="s0">(it.createErrors !== </span><span class="s1">false</span><span class="s0">) {</span>
      <span class="s0">out += </span><span class="s2">' { keyword: </span><span class="s3">\'</span><span class="s2">' </span><span class="s0">+ (</span><span class="s2">'anyOf'</span><span class="s0">) + </span><span class="s2">'</span><span class="s3">\' </span><span class="s2">, dataPath: (dataPath || </span><span class="s3">\'\'</span><span class="s2">) + ' </span><span class="s0">+ (it.errorPath) + </span><span class="s2">' , schemaPath: ' </span><span class="s0">+ (it.util.toQuotedString($errSchemaPath)) + </span><span class="s2">' , params: {} '</span><span class="s3">;</span>
      <span class="s1">if </span><span class="s0">(it.opts.messages !== </span><span class="s1">false</span><span class="s0">) {</span>
        <span class="s0">out += </span><span class="s2">' , message: </span><span class="s3">\'</span><span class="s2">should match some schema in anyOf</span><span class="s3">\' </span><span class="s2">'</span><span class="s3">;</span>
      <span class="s0">}</span>
      <span class="s1">if </span><span class="s0">(it.opts.verbose) {</span>
        <span class="s0">out += </span><span class="s2">' , schema: validate.schema' </span><span class="s0">+ ($schemaPath) + </span><span class="s2">' , parentSchema: validate.schema' </span><span class="s0">+ (it.schemaPath) + </span><span class="s2">' , data: ' </span><span class="s0">+ ($data) + </span><span class="s2">' '</span><span class="s3">;</span>
      <span class="s0">}</span>
      <span class="s0">out += </span><span class="s2">' } '</span><span class="s3">;</span>
    <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
      <span class="s0">out += </span><span class="s2">' {} '</span><span class="s3">;</span>
    <span class="s0">}</span>
    <span class="s0">out += </span><span class="s2">';  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; '</span><span class="s3">;</span>
    <span class="s1">if </span><span class="s0">(!it.compositeRule &amp;&amp; $breakOnError) {</span>
      <span class="s7">/* istanbul ignore if */</span>
      <span class="s1">if </span><span class="s0">(it.async) {</span>
        <span class="s0">out += </span><span class="s2">' throw new ValidationError(vErrors); '</span><span class="s3">;</span>
      <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
        <span class="s0">out += </span><span class="s2">' validate.errors = vErrors; return false; '</span><span class="s3">;</span>
      <span class="s0">}</span>
    <span class="s0">}</span>
    <span class="s0">out += </span><span class="s2">' } else {  errors = ' </span><span class="s0">+ ($errs) + </span><span class="s2">'; if (vErrors !== null) { if (' </span><span class="s0">+ ($errs) + </span><span class="s2">') vErrors.length = ' </span><span class="s0">+ ($errs) + </span><span class="s2">'; else vErrors = null; } '</span><span class="s3">;</span>
    <span class="s1">if </span><span class="s0">(it.opts.allErrors) {</span>
      <span class="s0">out += </span><span class="s2">' } '</span><span class="s3">;</span>
    <span class="s0">}</span>
  <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
    <span class="s1">if </span><span class="s0">($breakOnError) {</span>
      <span class="s0">out += </span><span class="s2">' if (true) { '</span><span class="s3">;</span>
    <span class="s0">}</span>
  <span class="s0">}</span>
  <span class="s1">return </span><span class="s0">out</span><span class="s3">;</span>
<span class="s0">}</span>

<span class="s0">}</span><span class="s3">,</span><span class="s0">{}]</span><span class="s3">,</span><span class="s4">19</span><span class="s0">:[</span><span class="s1">function</span><span class="s0">(require</span><span class="s3">,</span><span class="s0">module</span><span class="s3">,</span><span class="s0">exports){</span>
<span class="s2">'use strict'</span><span class="s3">;</span>
<span class="s0">module.exports = </span><span class="s1">function </span><span class="s0">generate_comment(it</span><span class="s3">, </span><span class="s0">$keyword</span><span class="s3">, </span><span class="s0">$ruleType) {</span>
  <span class="s1">var </span><span class="s0">out = </span><span class="s2">' '</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$schema = it.schema[$keyword]</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$errSchemaPath = it.errSchemaPath + </span><span class="s2">'/' </span><span class="s0">+ $keyword</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$breakOnError = !it.opts.allErrors</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$comment = it.util.toQuotedString($schema)</span><span class="s3">;</span>
  <span class="s1">if </span><span class="s0">(it.opts.$comment === </span><span class="s1">true</span><span class="s0">) {</span>
    <span class="s0">out += </span><span class="s2">' console.log(' </span><span class="s0">+ ($comment) + </span><span class="s2">');'</span><span class="s3">;</span>
  <span class="s0">} </span><span class="s1">else if </span><span class="s0">(</span><span class="s1">typeof </span><span class="s0">it.opts.$comment == </span><span class="s2">'function'</span><span class="s0">) {</span>
    <span class="s0">out += </span><span class="s2">' self._opts.$comment(' </span><span class="s0">+ ($comment) + </span><span class="s2">', ' </span><span class="s0">+ (it.util.toQuotedString($errSchemaPath)) + </span><span class="s2">', validate.root.schema);'</span><span class="s3">;</span>
  <span class="s0">}</span>
  <span class="s1">return </span><span class="s0">out</span><span class="s3">;</span>
<span class="s0">}</span>

<span class="s0">}</span><span class="s3">,</span><span class="s0">{}]</span><span class="s3">,</span><span class="s4">20</span><span class="s0">:[</span><span class="s1">function</span><span class="s0">(require</span><span class="s3">,</span><span class="s0">module</span><span class="s3">,</span><span class="s0">exports){</span>
<span class="s2">'use strict'</span><span class="s3">;</span>
<span class="s0">module.exports = </span><span class="s1">function </span><span class="s0">generate_const(it</span><span class="s3">, </span><span class="s0">$keyword</span><span class="s3">, </span><span class="s0">$ruleType) {</span>
  <span class="s1">var </span><span class="s0">out = </span><span class="s2">' '</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$lvl = it.level</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$dataLvl = it.dataLevel</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$schema = it.schema[$keyword]</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$schemaPath = it.schemaPath + it.util.getProperty($keyword)</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$errSchemaPath = it.errSchemaPath + </span><span class="s2">'/' </span><span class="s0">+ $keyword</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$breakOnError = !it.opts.allErrors</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$data = </span><span class="s2">'data' </span><span class="s0">+ ($dataLvl || </span><span class="s2">''</span><span class="s0">)</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$valid = </span><span class="s2">'valid' </span><span class="s0">+ $lvl</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$isData = it.opts.$data &amp;&amp; $schema &amp;&amp; $schema.$data</span><span class="s3">,</span>
    <span class="s0">$schemaValue</span><span class="s3">;</span>
  <span class="s1">if </span><span class="s0">($isData) {</span>
    <span class="s0">out += </span><span class="s2">' var schema' </span><span class="s0">+ ($lvl) + </span><span class="s2">' = ' </span><span class="s0">+ (it.util.getData($schema.$data</span><span class="s3">, </span><span class="s0">$dataLvl</span><span class="s3">, </span><span class="s0">it.dataPathArr)) + </span><span class="s2">'; '</span><span class="s3">;</span>
    <span class="s0">$schemaValue = </span><span class="s2">'schema' </span><span class="s0">+ $lvl</span><span class="s3">;</span>
  <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
    <span class="s0">$schemaValue = $schema</span><span class="s3">;</span>
  <span class="s0">}</span>
  <span class="s1">if </span><span class="s0">(!$isData) {</span>
    <span class="s0">out += </span><span class="s2">' var schema' </span><span class="s0">+ ($lvl) + </span><span class="s2">' = validate.schema' </span><span class="s0">+ ($schemaPath) + </span><span class="s2">';'</span><span class="s3">;</span>
  <span class="s0">}</span>
  <span class="s0">out += </span><span class="s2">'var ' </span><span class="s0">+ ($valid) + </span><span class="s2">' = equal(' </span><span class="s0">+ ($data) + </span><span class="s2">', schema' </span><span class="s0">+ ($lvl) + </span><span class="s2">'); if (!' </span><span class="s0">+ ($valid) + </span><span class="s2">') {   '</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$$outStack = $$outStack || []</span><span class="s3">;</span>
  <span class="s0">$$outStack.push(out)</span><span class="s3">;</span>
  <span class="s0">out = </span><span class="s2">''</span><span class="s3">; </span><span class="s7">/* istanbul ignore else */</span>
  <span class="s1">if </span><span class="s0">(it.createErrors !== </span><span class="s1">false</span><span class="s0">) {</span>
    <span class="s0">out += </span><span class="s2">' { keyword: </span><span class="s3">\'</span><span class="s2">' </span><span class="s0">+ (</span><span class="s2">'const'</span><span class="s0">) + </span><span class="s2">'</span><span class="s3">\' </span><span class="s2">, dataPath: (dataPath || </span><span class="s3">\'\'</span><span class="s2">) + ' </span><span class="s0">+ (it.errorPath) + </span><span class="s2">' , schemaPath: ' </span><span class="s0">+ (it.util.toQuotedString($errSchemaPath)) + </span><span class="s2">' , params: { allowedValue: schema' </span><span class="s0">+ ($lvl) + </span><span class="s2">' } '</span><span class="s3">;</span>
    <span class="s1">if </span><span class="s0">(it.opts.messages !== </span><span class="s1">false</span><span class="s0">) {</span>
      <span class="s0">out += </span><span class="s2">' , message: </span><span class="s3">\'</span><span class="s2">should be equal to constant</span><span class="s3">\' </span><span class="s2">'</span><span class="s3">;</span>
    <span class="s0">}</span>
    <span class="s1">if </span><span class="s0">(it.opts.verbose) {</span>
      <span class="s0">out += </span><span class="s2">' , schema: validate.schema' </span><span class="s0">+ ($schemaPath) + </span><span class="s2">' , parentSchema: validate.schema' </span><span class="s0">+ (it.schemaPath) + </span><span class="s2">' , data: ' </span><span class="s0">+ ($data) + </span><span class="s2">' '</span><span class="s3">;</span>
    <span class="s0">}</span>
    <span class="s0">out += </span><span class="s2">' } '</span><span class="s3">;</span>
  <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
    <span class="s0">out += </span><span class="s2">' {} '</span><span class="s3">;</span>
  <span class="s0">}</span>
  <span class="s1">var </span><span class="s0">__err = out</span><span class="s3">;</span>
  <span class="s0">out = $$outStack.pop()</span><span class="s3">;</span>
  <span class="s1">if </span><span class="s0">(!it.compositeRule &amp;&amp; $breakOnError) {</span>
    <span class="s7">/* istanbul ignore if */</span>
    <span class="s1">if </span><span class="s0">(it.async) {</span>
      <span class="s0">out += </span><span class="s2">' throw new ValidationError([' </span><span class="s0">+ (__err) + </span><span class="s2">']); '</span><span class="s3">;</span>
    <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
      <span class="s0">out += </span><span class="s2">' validate.errors = [' </span><span class="s0">+ (__err) + </span><span class="s2">']; return false; '</span><span class="s3">;</span>
    <span class="s0">}</span>
  <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
    <span class="s0">out += </span><span class="s2">' var err = ' </span><span class="s0">+ (__err) + </span><span class="s2">';  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; '</span><span class="s3">;</span>
  <span class="s0">}</span>
  <span class="s0">out += </span><span class="s2">' }'</span><span class="s3">;</span>
  <span class="s1">if </span><span class="s0">($breakOnError) {</span>
    <span class="s0">out += </span><span class="s2">' else { '</span><span class="s3">;</span>
  <span class="s0">}</span>
  <span class="s1">return </span><span class="s0">out</span><span class="s3">;</span>
<span class="s0">}</span>

<span class="s0">}</span><span class="s3">,</span><span class="s0">{}]</span><span class="s3">,</span><span class="s4">21</span><span class="s0">:[</span><span class="s1">function</span><span class="s0">(require</span><span class="s3">,</span><span class="s0">module</span><span class="s3">,</span><span class="s0">exports){</span>
<span class="s2">'use strict'</span><span class="s3">;</span>
<span class="s0">module.exports = </span><span class="s1">function </span><span class="s0">generate_contains(it</span><span class="s3">, </span><span class="s0">$keyword</span><span class="s3">, </span><span class="s0">$ruleType) {</span>
  <span class="s1">var </span><span class="s0">out = </span><span class="s2">' '</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$lvl = it.level</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$dataLvl = it.dataLevel</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$schema = it.schema[$keyword]</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$schemaPath = it.schemaPath + it.util.getProperty($keyword)</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$errSchemaPath = it.errSchemaPath + </span><span class="s2">'/' </span><span class="s0">+ $keyword</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$breakOnError = !it.opts.allErrors</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$data = </span><span class="s2">'data' </span><span class="s0">+ ($dataLvl || </span><span class="s2">''</span><span class="s0">)</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$valid = </span><span class="s2">'valid' </span><span class="s0">+ $lvl</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$errs = </span><span class="s2">'errs__' </span><span class="s0">+ $lvl</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$it = it.util.copy(it)</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$closingBraces = </span><span class="s2">''</span><span class="s3">;</span>
  <span class="s0">$it.level++</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$nextValid = </span><span class="s2">'valid' </span><span class="s0">+ $it.level</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$idx = </span><span class="s2">'i' </span><span class="s0">+ $lvl</span><span class="s3">,</span>
    <span class="s0">$dataNxt = $it.dataLevel = it.dataLevel + </span><span class="s4">1</span><span class="s3">,</span>
    <span class="s0">$nextData = </span><span class="s2">'data' </span><span class="s0">+ $dataNxt</span><span class="s3">,</span>
    <span class="s0">$currentBaseId = it.baseId</span><span class="s3">,</span>
    <span class="s0">$nonEmptySchema = (it.opts.strictKeywords ? (</span><span class="s1">typeof </span><span class="s0">$schema == </span><span class="s2">'object' </span><span class="s0">&amp;&amp; Object.keys($schema).length &gt; </span><span class="s4">0</span><span class="s0">) || $schema === </span><span class="s1">false </span><span class="s0">: it.util.schemaHasRules($schema</span><span class="s3">, </span><span class="s0">it.RULES.all))</span><span class="s3">;</span>
  <span class="s0">out += </span><span class="s2">'var ' </span><span class="s0">+ ($errs) + </span><span class="s2">' = errors;var ' </span><span class="s0">+ ($valid) + </span><span class="s2">';'</span><span class="s3">;</span>
  <span class="s1">if </span><span class="s0">($nonEmptySchema) {</span>
    <span class="s1">var </span><span class="s0">$wasComposite = it.compositeRule</span><span class="s3">;</span>
    <span class="s0">it.compositeRule = $it.compositeRule = </span><span class="s1">true</span><span class="s3">;</span>
    <span class="s0">$it.schema = $schema</span><span class="s3">;</span>
    <span class="s0">$it.schemaPath = $schemaPath</span><span class="s3">;</span>
    <span class="s0">$it.errSchemaPath = $errSchemaPath</span><span class="s3">;</span>
    <span class="s0">out += </span><span class="s2">' var ' </span><span class="s0">+ ($nextValid) + </span><span class="s2">' = false; for (var ' </span><span class="s0">+ ($idx) + </span><span class="s2">' = 0; ' </span><span class="s0">+ ($idx) + </span><span class="s2">' &lt; ' </span><span class="s0">+ ($data) + </span><span class="s2">'.length; ' </span><span class="s0">+ ($idx) + </span><span class="s2">'++) { '</span><span class="s3">;</span>
    <span class="s0">$it.errorPath = it.util.getPathExpr(it.errorPath</span><span class="s3">, </span><span class="s0">$idx</span><span class="s3">, </span><span class="s0">it.opts.jsonPointers</span><span class="s3">, </span><span class="s1">true</span><span class="s0">)</span><span class="s3">;</span>
    <span class="s1">var </span><span class="s0">$passData = $data + </span><span class="s2">'[' </span><span class="s0">+ $idx + </span><span class="s2">']'</span><span class="s3">;</span>
    <span class="s0">$it.dataPathArr[$dataNxt] = $idx</span><span class="s3">;</span>
    <span class="s1">var </span><span class="s0">$code = it.validate($it)</span><span class="s3">;</span>
    <span class="s0">$it.baseId = $currentBaseId</span><span class="s3">;</span>
    <span class="s1">if </span><span class="s0">(it.util.varOccurences($code</span><span class="s3">, </span><span class="s0">$nextData) &lt; </span><span class="s4">2</span><span class="s0">) {</span>
      <span class="s0">out += </span><span class="s2">' ' </span><span class="s0">+ (it.util.varReplace($code</span><span class="s3">, </span><span class="s0">$nextData</span><span class="s3">, </span><span class="s0">$passData)) + </span><span class="s2">' '</span><span class="s3">;</span>
    <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
      <span class="s0">out += </span><span class="s2">' var ' </span><span class="s0">+ ($nextData) + </span><span class="s2">' = ' </span><span class="s0">+ ($passData) + </span><span class="s2">'; ' </span><span class="s0">+ ($code) + </span><span class="s2">' '</span><span class="s3">;</span>
    <span class="s0">}</span>
    <span class="s0">out += </span><span class="s2">' if (' </span><span class="s0">+ ($nextValid) + </span><span class="s2">') break; }  '</span><span class="s3">;</span>
    <span class="s0">it.compositeRule = $it.compositeRule = $wasComposite</span><span class="s3">;</span>
    <span class="s0">out += </span><span class="s2">' ' </span><span class="s0">+ ($closingBraces) + </span><span class="s2">' if (!' </span><span class="s0">+ ($nextValid) + </span><span class="s2">') {'</span><span class="s3">;</span>
  <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
    <span class="s0">out += </span><span class="s2">' if (' </span><span class="s0">+ ($data) + </span><span class="s2">'.length == 0) {'</span><span class="s3">;</span>
  <span class="s0">}</span>
  <span class="s1">var </span><span class="s0">$$outStack = $$outStack || []</span><span class="s3">;</span>
  <span class="s0">$$outStack.push(out)</span><span class="s3">;</span>
  <span class="s0">out = </span><span class="s2">''</span><span class="s3">; </span><span class="s7">/* istanbul ignore else */</span>
  <span class="s1">if </span><span class="s0">(it.createErrors !== </span><span class="s1">false</span><span class="s0">) {</span>
    <span class="s0">out += </span><span class="s2">' { keyword: </span><span class="s3">\'</span><span class="s2">' </span><span class="s0">+ (</span><span class="s2">'contains'</span><span class="s0">) + </span><span class="s2">'</span><span class="s3">\' </span><span class="s2">, dataPath: (dataPath || </span><span class="s3">\'\'</span><span class="s2">) + ' </span><span class="s0">+ (it.errorPath) + </span><span class="s2">' , schemaPath: ' </span><span class="s0">+ (it.util.toQuotedString($errSchemaPath)) + </span><span class="s2">' , params: {} '</span><span class="s3">;</span>
    <span class="s1">if </span><span class="s0">(it.opts.messages !== </span><span class="s1">false</span><span class="s0">) {</span>
      <span class="s0">out += </span><span class="s2">' , message: </span><span class="s3">\'</span><span class="s2">should contain a valid item</span><span class="s3">\' </span><span class="s2">'</span><span class="s3">;</span>
    <span class="s0">}</span>
    <span class="s1">if </span><span class="s0">(it.opts.verbose) {</span>
      <span class="s0">out += </span><span class="s2">' , schema: validate.schema' </span><span class="s0">+ ($schemaPath) + </span><span class="s2">' , parentSchema: validate.schema' </span><span class="s0">+ (it.schemaPath) + </span><span class="s2">' , data: ' </span><span class="s0">+ ($data) + </span><span class="s2">' '</span><span class="s3">;</span>
    <span class="s0">}</span>
    <span class="s0">out += </span><span class="s2">' } '</span><span class="s3">;</span>
  <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
    <span class="s0">out += </span><span class="s2">' {} '</span><span class="s3">;</span>
  <span class="s0">}</span>
  <span class="s1">var </span><span class="s0">__err = out</span><span class="s3">;</span>
  <span class="s0">out = $$outStack.pop()</span><span class="s3">;</span>
  <span class="s1">if </span><span class="s0">(!it.compositeRule &amp;&amp; $breakOnError) {</span>
    <span class="s7">/* istanbul ignore if */</span>
    <span class="s1">if </span><span class="s0">(it.async) {</span>
      <span class="s0">out += </span><span class="s2">' throw new ValidationError([' </span><span class="s0">+ (__err) + </span><span class="s2">']); '</span><span class="s3">;</span>
    <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
      <span class="s0">out += </span><span class="s2">' validate.errors = [' </span><span class="s0">+ (__err) + </span><span class="s2">']; return false; '</span><span class="s3">;</span>
    <span class="s0">}</span>
  <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
    <span class="s0">out += </span><span class="s2">' var err = ' </span><span class="s0">+ (__err) + </span><span class="s2">';  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; '</span><span class="s3">;</span>
  <span class="s0">}</span>
  <span class="s0">out += </span><span class="s2">' } else { '</span><span class="s3">;</span>
  <span class="s1">if </span><span class="s0">($nonEmptySchema) {</span>
    <span class="s0">out += </span><span class="s2">'  errors = ' </span><span class="s0">+ ($errs) + </span><span class="s2">'; if (vErrors !== null) { if (' </span><span class="s0">+ ($errs) + </span><span class="s2">') vErrors.length = ' </span><span class="s0">+ ($errs) + </span><span class="s2">'; else vErrors = null; } '</span><span class="s3">;</span>
  <span class="s0">}</span>
  <span class="s1">if </span><span class="s0">(it.opts.allErrors) {</span>
    <span class="s0">out += </span><span class="s2">' } '</span><span class="s3">;</span>
  <span class="s0">}</span>
  <span class="s1">return </span><span class="s0">out</span><span class="s3">;</span>
<span class="s0">}</span>

<span class="s0">}</span><span class="s3">,</span><span class="s0">{}]</span><span class="s3">,</span><span class="s4">22</span><span class="s0">:[</span><span class="s1">function</span><span class="s0">(require</span><span class="s3">,</span><span class="s0">module</span><span class="s3">,</span><span class="s0">exports){</span>
<span class="s2">'use strict'</span><span class="s3">;</span>
<span class="s0">module.exports = </span><span class="s1">function </span><span class="s0">generate_custom(it</span><span class="s3">, </span><span class="s0">$keyword</span><span class="s3">, </span><span class="s0">$ruleType) {</span>
  <span class="s1">var </span><span class="s0">out = </span><span class="s2">' '</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$lvl = it.level</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$dataLvl = it.dataLevel</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$schema = it.schema[$keyword]</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$schemaPath = it.schemaPath + it.util.getProperty($keyword)</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$errSchemaPath = it.errSchemaPath + </span><span class="s2">'/' </span><span class="s0">+ $keyword</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$breakOnError = !it.opts.allErrors</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$errorKeyword</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$data = </span><span class="s2">'data' </span><span class="s0">+ ($dataLvl || </span><span class="s2">''</span><span class="s0">)</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$valid = </span><span class="s2">'valid' </span><span class="s0">+ $lvl</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$errs = </span><span class="s2">'errs__' </span><span class="s0">+ $lvl</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$isData = it.opts.$data &amp;&amp; $schema &amp;&amp; $schema.$data</span><span class="s3">,</span>
    <span class="s0">$schemaValue</span><span class="s3">;</span>
  <span class="s1">if </span><span class="s0">($isData) {</span>
    <span class="s0">out += </span><span class="s2">' var schema' </span><span class="s0">+ ($lvl) + </span><span class="s2">' = ' </span><span class="s0">+ (it.util.getData($schema.$data</span><span class="s3">, </span><span class="s0">$dataLvl</span><span class="s3">, </span><span class="s0">it.dataPathArr)) + </span><span class="s2">'; '</span><span class="s3">;</span>
    <span class="s0">$schemaValue = </span><span class="s2">'schema' </span><span class="s0">+ $lvl</span><span class="s3">;</span>
  <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
    <span class="s0">$schemaValue = $schema</span><span class="s3">;</span>
  <span class="s0">}</span>
  <span class="s1">var </span><span class="s0">$rule = </span><span class="s1">this</span><span class="s3">,</span>
    <span class="s0">$definition = </span><span class="s2">'definition' </span><span class="s0">+ $lvl</span><span class="s3">,</span>
    <span class="s0">$rDef = $rule.definition</span><span class="s3">,</span>
    <span class="s0">$closingBraces = </span><span class="s2">''</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$compile</span><span class="s3">, </span><span class="s0">$inline</span><span class="s3">, </span><span class="s0">$macro</span><span class="s3">, </span><span class="s0">$ruleValidate</span><span class="s3">, </span><span class="s0">$validateCode</span><span class="s3">;</span>
  <span class="s1">if </span><span class="s0">($isData &amp;&amp; $rDef.$data) {</span>
    <span class="s0">$validateCode = </span><span class="s2">'keywordValidate' </span><span class="s0">+ $lvl</span><span class="s3">;</span>
    <span class="s1">var </span><span class="s0">$validateSchema = $rDef.validateSchema</span><span class="s3">;</span>
    <span class="s0">out += </span><span class="s2">' var ' </span><span class="s0">+ ($definition) + </span><span class="s2">' = RULES.custom[</span><span class="s3">\'</span><span class="s2">' </span><span class="s0">+ ($keyword) + </span><span class="s2">'</span><span class="s3">\'</span><span class="s2">].definition; var ' </span><span class="s0">+ ($validateCode) + </span><span class="s2">' = ' </span><span class="s0">+ ($definition) + </span><span class="s2">'.validate;'</span><span class="s3">;</span>
  <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
    <span class="s0">$ruleValidate = it.useCustomRule($rule</span><span class="s3">, </span><span class="s0">$schema</span><span class="s3">, </span><span class="s0">it.schema</span><span class="s3">, </span><span class="s0">it)</span><span class="s3">;</span>
    <span class="s1">if </span><span class="s0">(!$ruleValidate) </span><span class="s1">return</span><span class="s3">;</span>
    <span class="s0">$schemaValue = </span><span class="s2">'validate.schema' </span><span class="s0">+ $schemaPath</span><span class="s3">;</span>
    <span class="s0">$validateCode = $ruleValidate.code</span><span class="s3">;</span>
    <span class="s0">$compile = $rDef.compile</span><span class="s3">;</span>
    <span class="s0">$inline = $rDef.inline</span><span class="s3">;</span>
    <span class="s0">$macro = $rDef.macro</span><span class="s3">;</span>
  <span class="s0">}</span>
  <span class="s1">var </span><span class="s0">$ruleErrs = $validateCode + </span><span class="s2">'.errors'</span><span class="s3">,</span>
    <span class="s0">$i = </span><span class="s2">'i' </span><span class="s0">+ $lvl</span><span class="s3">,</span>
    <span class="s0">$ruleErr = </span><span class="s2">'ruleErr' </span><span class="s0">+ $lvl</span><span class="s3">,</span>
    <span class="s0">$asyncKeyword = $rDef.async</span><span class="s3">;</span>
  <span class="s1">if </span><span class="s0">($asyncKeyword &amp;&amp; !it.async) </span><span class="s1">throw new </span><span class="s0">Error(</span><span class="s2">'async keyword in sync schema'</span><span class="s0">)</span><span class="s3">;</span>
  <span class="s1">if </span><span class="s0">(!($inline || $macro)) {</span>
    <span class="s0">out += </span><span class="s2">'' </span><span class="s0">+ ($ruleErrs) + </span><span class="s2">' = null;'</span><span class="s3">;</span>
  <span class="s0">}</span>
  <span class="s0">out += </span><span class="s2">'var ' </span><span class="s0">+ ($errs) + </span><span class="s2">' = errors;var ' </span><span class="s0">+ ($valid) + </span><span class="s2">';'</span><span class="s3">;</span>
  <span class="s1">if </span><span class="s0">($isData &amp;&amp; $rDef.$data) {</span>
    <span class="s0">$closingBraces += </span><span class="s2">'}'</span><span class="s3">;</span>
    <span class="s0">out += </span><span class="s2">' if (' </span><span class="s0">+ ($schemaValue) + </span><span class="s2">' === undefined) { ' </span><span class="s0">+ ($valid) + </span><span class="s2">' = true; } else { '</span><span class="s3">;</span>
    <span class="s1">if </span><span class="s0">($validateSchema) {</span>
      <span class="s0">$closingBraces += </span><span class="s2">'}'</span><span class="s3">;</span>
      <span class="s0">out += </span><span class="s2">' ' </span><span class="s0">+ ($valid) + </span><span class="s2">' = ' </span><span class="s0">+ ($definition) + </span><span class="s2">'.validateSchema(' </span><span class="s0">+ ($schemaValue) + </span><span class="s2">'); if (' </span><span class="s0">+ ($valid) + </span><span class="s2">') { '</span><span class="s3">;</span>
    <span class="s0">}</span>
  <span class="s0">}</span>
  <span class="s1">if </span><span class="s0">($inline) {</span>
    <span class="s1">if </span><span class="s0">($rDef.statements) {</span>
      <span class="s0">out += </span><span class="s2">' ' </span><span class="s0">+ ($ruleValidate.validate) + </span><span class="s2">' '</span><span class="s3">;</span>
    <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
      <span class="s0">out += </span><span class="s2">' ' </span><span class="s0">+ ($valid) + </span><span class="s2">' = ' </span><span class="s0">+ ($ruleValidate.validate) + </span><span class="s2">'; '</span><span class="s3">;</span>
    <span class="s0">}</span>
  <span class="s0">} </span><span class="s1">else if </span><span class="s0">($macro) {</span>
    <span class="s1">var </span><span class="s0">$it = it.util.copy(it)</span><span class="s3">;</span>
    <span class="s1">var </span><span class="s0">$closingBraces = </span><span class="s2">''</span><span class="s3">;</span>
    <span class="s0">$it.level++</span><span class="s3">;</span>
    <span class="s1">var </span><span class="s0">$nextValid = </span><span class="s2">'valid' </span><span class="s0">+ $it.level</span><span class="s3">;</span>
    <span class="s0">$it.schema = $ruleValidate.validate</span><span class="s3">;</span>
    <span class="s0">$it.schemaPath = </span><span class="s2">''</span><span class="s3">;</span>
    <span class="s1">var </span><span class="s0">$wasComposite = it.compositeRule</span><span class="s3">;</span>
    <span class="s0">it.compositeRule = $it.compositeRule = </span><span class="s1">true</span><span class="s3">;</span>
    <span class="s1">var </span><span class="s0">$code = it.validate($it).replace(</span><span class="s4">/validate\.schema/g</span><span class="s3">, </span><span class="s0">$validateCode)</span><span class="s3">;</span>
    <span class="s0">it.compositeRule = $it.compositeRule = $wasComposite</span><span class="s3">;</span>
    <span class="s0">out += </span><span class="s2">' ' </span><span class="s0">+ ($code)</span><span class="s3">;</span>
  <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
    <span class="s1">var </span><span class="s0">$$outStack = $$outStack || []</span><span class="s3">;</span>
    <span class="s0">$$outStack.push(out)</span><span class="s3">;</span>
    <span class="s0">out = </span><span class="s2">''</span><span class="s3">;</span>
    <span class="s0">out += </span><span class="s2">'  ' </span><span class="s0">+ ($validateCode) + </span><span class="s2">'.call( '</span><span class="s3">;</span>
    <span class="s1">if </span><span class="s0">(it.opts.passContext) {</span>
      <span class="s0">out += </span><span class="s2">'this'</span><span class="s3">;</span>
    <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
      <span class="s0">out += </span><span class="s2">'self'</span><span class="s3">;</span>
    <span class="s0">}</span>
    <span class="s1">if </span><span class="s0">($compile || $rDef.schema === </span><span class="s1">false</span><span class="s0">) {</span>
      <span class="s0">out += </span><span class="s2">' , ' </span><span class="s0">+ ($data) + </span><span class="s2">' '</span><span class="s3">;</span>
    <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
      <span class="s0">out += </span><span class="s2">' , ' </span><span class="s0">+ ($schemaValue) + </span><span class="s2">' , ' </span><span class="s0">+ ($data) + </span><span class="s2">' , validate.schema' </span><span class="s0">+ (it.schemaPath) + </span><span class="s2">' '</span><span class="s3">;</span>
    <span class="s0">}</span>
    <span class="s0">out += </span><span class="s2">' , (dataPath || </span><span class="s3">\'\'</span><span class="s2">)'</span><span class="s3">;</span>
    <span class="s1">if </span><span class="s0">(it.errorPath != </span><span class="s2">'&quot;&quot;'</span><span class="s0">) {</span>
      <span class="s0">out += </span><span class="s2">' + ' </span><span class="s0">+ (it.errorPath)</span><span class="s3">;</span>
    <span class="s0">}</span>
    <span class="s1">var </span><span class="s0">$parentData = $dataLvl ? </span><span class="s2">'data' </span><span class="s0">+ (($dataLvl - </span><span class="s4">1</span><span class="s0">) || </span><span class="s2">''</span><span class="s0">) : </span><span class="s2">'parentData'</span><span class="s3">,</span>
      <span class="s0">$parentDataProperty = $dataLvl ? it.dataPathArr[$dataLvl] : </span><span class="s2">'parentDataProperty'</span><span class="s3">;</span>
    <span class="s0">out += </span><span class="s2">' , ' </span><span class="s0">+ ($parentData) + </span><span class="s2">' , ' </span><span class="s0">+ ($parentDataProperty) + </span><span class="s2">' , rootData )  '</span><span class="s3">;</span>
    <span class="s1">var </span><span class="s0">def_callRuleValidate = out</span><span class="s3">;</span>
    <span class="s0">out = $$outStack.pop()</span><span class="s3">;</span>
    <span class="s1">if </span><span class="s0">($rDef.errors === </span><span class="s1">false</span><span class="s0">) {</span>
      <span class="s0">out += </span><span class="s2">' ' </span><span class="s0">+ ($valid) + </span><span class="s2">' = '</span><span class="s3">;</span>
      <span class="s1">if </span><span class="s0">($asyncKeyword) {</span>
        <span class="s0">out += </span><span class="s2">'await '</span><span class="s3">;</span>
      <span class="s0">}</span>
      <span class="s0">out += </span><span class="s2">'' </span><span class="s0">+ (def_callRuleValidate) + </span><span class="s2">'; '</span><span class="s3">;</span>
    <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
      <span class="s1">if </span><span class="s0">($asyncKeyword) {</span>
        <span class="s0">$ruleErrs = </span><span class="s2">'customErrors' </span><span class="s0">+ $lvl</span><span class="s3">;</span>
        <span class="s0">out += </span><span class="s2">' var ' </span><span class="s0">+ ($ruleErrs) + </span><span class="s2">' = null; try { ' </span><span class="s0">+ ($valid) + </span><span class="s2">' = await ' </span><span class="s0">+ (def_callRuleValidate) + </span><span class="s2">'; } catch (e) { ' </span><span class="s0">+ ($valid) + </span><span class="s2">' = false; if (e instanceof ValidationError) ' </span><span class="s0">+ ($ruleErrs) + </span><span class="s2">' = e.errors; else throw e; } '</span><span class="s3">;</span>
      <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
        <span class="s0">out += </span><span class="s2">' ' </span><span class="s0">+ ($ruleErrs) + </span><span class="s2">' = null; ' </span><span class="s0">+ ($valid) + </span><span class="s2">' = ' </span><span class="s0">+ (def_callRuleValidate) + </span><span class="s2">'; '</span><span class="s3">;</span>
      <span class="s0">}</span>
    <span class="s0">}</span>
  <span class="s0">}</span>
  <span class="s1">if </span><span class="s0">($rDef.modifying) {</span>
    <span class="s0">out += </span><span class="s2">' if (' </span><span class="s0">+ ($parentData) + </span><span class="s2">') ' </span><span class="s0">+ ($data) + </span><span class="s2">' = ' </span><span class="s0">+ ($parentData) + </span><span class="s2">'[' </span><span class="s0">+ ($parentDataProperty) + </span><span class="s2">'];'</span><span class="s3">;</span>
  <span class="s0">}</span>
  <span class="s0">out += </span><span class="s2">'' </span><span class="s0">+ ($closingBraces)</span><span class="s3">;</span>
  <span class="s1">if </span><span class="s0">($rDef.valid) {</span>
    <span class="s1">if </span><span class="s0">($breakOnError) {</span>
      <span class="s0">out += </span><span class="s2">' if (true) { '</span><span class="s3">;</span>
    <span class="s0">}</span>
  <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
    <span class="s0">out += </span><span class="s2">' if ( '</span><span class="s3">;</span>
    <span class="s1">if </span><span class="s0">($rDef.valid === undefined) {</span>
      <span class="s0">out += </span><span class="s2">' !'</span><span class="s3">;</span>
      <span class="s1">if </span><span class="s0">($macro) {</span>
        <span class="s0">out += </span><span class="s2">'' </span><span class="s0">+ ($nextValid)</span><span class="s3">;</span>
      <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
        <span class="s0">out += </span><span class="s2">'' </span><span class="s0">+ ($valid)</span><span class="s3">;</span>
      <span class="s0">}</span>
    <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
      <span class="s0">out += </span><span class="s2">' ' </span><span class="s0">+ (!$rDef.valid) + </span><span class="s2">' '</span><span class="s3">;</span>
    <span class="s0">}</span>
    <span class="s0">out += </span><span class="s2">') { '</span><span class="s3">;</span>
    <span class="s0">$errorKeyword = $rule.keyword</span><span class="s3">;</span>
    <span class="s1">var </span><span class="s0">$$outStack = $$outStack || []</span><span class="s3">;</span>
    <span class="s0">$$outStack.push(out)</span><span class="s3">;</span>
    <span class="s0">out = </span><span class="s2">''</span><span class="s3">;</span>
    <span class="s1">var </span><span class="s0">$$outStack = $$outStack || []</span><span class="s3">;</span>
    <span class="s0">$$outStack.push(out)</span><span class="s3">;</span>
    <span class="s0">out = </span><span class="s2">''</span><span class="s3">; </span><span class="s7">/* istanbul ignore else */</span>
    <span class="s1">if </span><span class="s0">(it.createErrors !== </span><span class="s1">false</span><span class="s0">) {</span>
      <span class="s0">out += </span><span class="s2">' { keyword: </span><span class="s3">\'</span><span class="s2">' </span><span class="s0">+ ($errorKeyword || </span><span class="s2">'custom'</span><span class="s0">) + </span><span class="s2">'</span><span class="s3">\' </span><span class="s2">, dataPath: (dataPath || </span><span class="s3">\'\'</span><span class="s2">) + ' </span><span class="s0">+ (it.errorPath) + </span><span class="s2">' , schemaPath: ' </span><span class="s0">+ (it.util.toQuotedString($errSchemaPath)) + </span><span class="s2">' , params: { keyword: </span><span class="s3">\'</span><span class="s2">' </span><span class="s0">+ ($rule.keyword) + </span><span class="s2">'</span><span class="s3">\' </span><span class="s2">} '</span><span class="s3">;</span>
      <span class="s1">if </span><span class="s0">(it.opts.messages !== </span><span class="s1">false</span><span class="s0">) {</span>
        <span class="s0">out += </span><span class="s2">' , message: </span><span class="s3">\'</span><span class="s2">should pass &quot;' </span><span class="s0">+ ($rule.keyword) + </span><span class="s2">'&quot; keyword validation</span><span class="s3">\' </span><span class="s2">'</span><span class="s3">;</span>
      <span class="s0">}</span>
      <span class="s1">if </span><span class="s0">(it.opts.verbose) {</span>
        <span class="s0">out += </span><span class="s2">' , schema: validate.schema' </span><span class="s0">+ ($schemaPath) + </span><span class="s2">' , parentSchema: validate.schema' </span><span class="s0">+ (it.schemaPath) + </span><span class="s2">' , data: ' </span><span class="s0">+ ($data) + </span><span class="s2">' '</span><span class="s3">;</span>
      <span class="s0">}</span>
      <span class="s0">out += </span><span class="s2">' } '</span><span class="s3">;</span>
    <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
      <span class="s0">out += </span><span class="s2">' {} '</span><span class="s3">;</span>
    <span class="s0">}</span>
    <span class="s1">var </span><span class="s0">__err = out</span><span class="s3">;</span>
    <span class="s0">out = $$outStack.pop()</span><span class="s3">;</span>
    <span class="s1">if </span><span class="s0">(!it.compositeRule &amp;&amp; $breakOnError) {</span>
      <span class="s7">/* istanbul ignore if */</span>
      <span class="s1">if </span><span class="s0">(it.async) {</span>
        <span class="s0">out += </span><span class="s2">' throw new ValidationError([' </span><span class="s0">+ (__err) + </span><span class="s2">']); '</span><span class="s3">;</span>
      <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
        <span class="s0">out += </span><span class="s2">' validate.errors = [' </span><span class="s0">+ (__err) + </span><span class="s2">']; return false; '</span><span class="s3">;</span>
      <span class="s0">}</span>
    <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
      <span class="s0">out += </span><span class="s2">' var err = ' </span><span class="s0">+ (__err) + </span><span class="s2">';  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; '</span><span class="s3">;</span>
    <span class="s0">}</span>
    <span class="s1">var </span><span class="s0">def_customError = out</span><span class="s3">;</span>
    <span class="s0">out = $$outStack.pop()</span><span class="s3">;</span>
    <span class="s1">if </span><span class="s0">($inline) {</span>
      <span class="s1">if </span><span class="s0">($rDef.errors) {</span>
        <span class="s1">if </span><span class="s0">($rDef.errors != </span><span class="s2">'full'</span><span class="s0">) {</span>
          <span class="s0">out += </span><span class="s2">'  for (var ' </span><span class="s0">+ ($i) + </span><span class="s2">'=' </span><span class="s0">+ ($errs) + </span><span class="s2">'; ' </span><span class="s0">+ ($i) + </span><span class="s2">'&lt;errors; ' </span><span class="s0">+ ($i) + </span><span class="s2">'++) { var ' </span><span class="s0">+ ($ruleErr) + </span><span class="s2">' = vErrors[' </span><span class="s0">+ ($i) + </span><span class="s2">']; if (' </span><span class="s0">+ ($ruleErr) + </span><span class="s2">'.dataPath === undefined) ' </span><span class="s0">+ ($ruleErr) + </span><span class="s2">'.dataPath = (dataPath || </span><span class="s3">\'\'</span><span class="s2">) + ' </span><span class="s0">+ (it.errorPath) + </span><span class="s2">'; if (' </span><span class="s0">+ ($ruleErr) + </span><span class="s2">'.schemaPath === undefined) { ' </span><span class="s0">+ ($ruleErr) + </span><span class="s2">'.schemaPath = &quot;' </span><span class="s0">+ ($errSchemaPath) + </span><span class="s2">'&quot;; } '</span><span class="s3">;</span>
          <span class="s1">if </span><span class="s0">(it.opts.verbose) {</span>
            <span class="s0">out += </span><span class="s2">' ' </span><span class="s0">+ ($ruleErr) + </span><span class="s2">'.schema = ' </span><span class="s0">+ ($schemaValue) + </span><span class="s2">'; ' </span><span class="s0">+ ($ruleErr) + </span><span class="s2">'.data = ' </span><span class="s0">+ ($data) + </span><span class="s2">'; '</span><span class="s3">;</span>
          <span class="s0">}</span>
          <span class="s0">out += </span><span class="s2">' } '</span><span class="s3">;</span>
        <span class="s0">}</span>
      <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
        <span class="s1">if </span><span class="s0">($rDef.errors === </span><span class="s1">false</span><span class="s0">) {</span>
          <span class="s0">out += </span><span class="s2">' ' </span><span class="s0">+ (def_customError) + </span><span class="s2">' '</span><span class="s3">;</span>
        <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
          <span class="s0">out += </span><span class="s2">' if (' </span><span class="s0">+ ($errs) + </span><span class="s2">' == errors) { ' </span><span class="s0">+ (def_customError) + </span><span class="s2">' } else {  for (var ' </span><span class="s0">+ ($i) + </span><span class="s2">'=' </span><span class="s0">+ ($errs) + </span><span class="s2">'; ' </span><span class="s0">+ ($i) + </span><span class="s2">'&lt;errors; ' </span><span class="s0">+ ($i) + </span><span class="s2">'++) { var ' </span><span class="s0">+ ($ruleErr) + </span><span class="s2">' = vErrors[' </span><span class="s0">+ ($i) + </span><span class="s2">']; if (' </span><span class="s0">+ ($ruleErr) + </span><span class="s2">'.dataPath === undefined) ' </span><span class="s0">+ ($ruleErr) + </span><span class="s2">'.dataPath = (dataPath || </span><span class="s3">\'\'</span><span class="s2">) + ' </span><span class="s0">+ (it.errorPath) + </span><span class="s2">'; if (' </span><span class="s0">+ ($ruleErr) + </span><span class="s2">'.schemaPath === undefined) { ' </span><span class="s0">+ ($ruleErr) + </span><span class="s2">'.schemaPath = &quot;' </span><span class="s0">+ ($errSchemaPath) + </span><span class="s2">'&quot;; } '</span><span class="s3">;</span>
          <span class="s1">if </span><span class="s0">(it.opts.verbose) {</span>
            <span class="s0">out += </span><span class="s2">' ' </span><span class="s0">+ ($ruleErr) + </span><span class="s2">'.schema = ' </span><span class="s0">+ ($schemaValue) + </span><span class="s2">'; ' </span><span class="s0">+ ($ruleErr) + </span><span class="s2">'.data = ' </span><span class="s0">+ ($data) + </span><span class="s2">'; '</span><span class="s3">;</span>
          <span class="s0">}</span>
          <span class="s0">out += </span><span class="s2">' } } '</span><span class="s3">;</span>
        <span class="s0">}</span>
      <span class="s0">}</span>
    <span class="s0">} </span><span class="s1">else if </span><span class="s0">($macro) {</span>
      <span class="s0">out += </span><span class="s2">'   var err =   '</span><span class="s3">; </span><span class="s7">/* istanbul ignore else */</span>
      <span class="s1">if </span><span class="s0">(it.createErrors !== </span><span class="s1">false</span><span class="s0">) {</span>
        <span class="s0">out += </span><span class="s2">' { keyword: </span><span class="s3">\'</span><span class="s2">' </span><span class="s0">+ ($errorKeyword || </span><span class="s2">'custom'</span><span class="s0">) + </span><span class="s2">'</span><span class="s3">\' </span><span class="s2">, dataPath: (dataPath || </span><span class="s3">\'\'</span><span class="s2">) + ' </span><span class="s0">+ (it.errorPath) + </span><span class="s2">' , schemaPath: ' </span><span class="s0">+ (it.util.toQuotedString($errSchemaPath)) + </span><span class="s2">' , params: { keyword: </span><span class="s3">\'</span><span class="s2">' </span><span class="s0">+ ($rule.keyword) + </span><span class="s2">'</span><span class="s3">\' </span><span class="s2">} '</span><span class="s3">;</span>
        <span class="s1">if </span><span class="s0">(it.opts.messages !== </span><span class="s1">false</span><span class="s0">) {</span>
          <span class="s0">out += </span><span class="s2">' , message: </span><span class="s3">\'</span><span class="s2">should pass &quot;' </span><span class="s0">+ ($rule.keyword) + </span><span class="s2">'&quot; keyword validation</span><span class="s3">\' </span><span class="s2">'</span><span class="s3">;</span>
        <span class="s0">}</span>
        <span class="s1">if </span><span class="s0">(it.opts.verbose) {</span>
          <span class="s0">out += </span><span class="s2">' , schema: validate.schema' </span><span class="s0">+ ($schemaPath) + </span><span class="s2">' , parentSchema: validate.schema' </span><span class="s0">+ (it.schemaPath) + </span><span class="s2">' , data: ' </span><span class="s0">+ ($data) + </span><span class="s2">' '</span><span class="s3">;</span>
        <span class="s0">}</span>
        <span class="s0">out += </span><span class="s2">' } '</span><span class="s3">;</span>
      <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
        <span class="s0">out += </span><span class="s2">' {} '</span><span class="s3">;</span>
      <span class="s0">}</span>
      <span class="s0">out += </span><span class="s2">';  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; '</span><span class="s3">;</span>
      <span class="s1">if </span><span class="s0">(!it.compositeRule &amp;&amp; $breakOnError) {</span>
        <span class="s7">/* istanbul ignore if */</span>
        <span class="s1">if </span><span class="s0">(it.async) {</span>
          <span class="s0">out += </span><span class="s2">' throw new ValidationError(vErrors); '</span><span class="s3">;</span>
        <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
          <span class="s0">out += </span><span class="s2">' validate.errors = vErrors; return false; '</span><span class="s3">;</span>
        <span class="s0">}</span>
      <span class="s0">}</span>
    <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
      <span class="s1">if </span><span class="s0">($rDef.errors === </span><span class="s1">false</span><span class="s0">) {</span>
        <span class="s0">out += </span><span class="s2">' ' </span><span class="s0">+ (def_customError) + </span><span class="s2">' '</span><span class="s3">;</span>
      <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
        <span class="s0">out += </span><span class="s2">' if (Array.isArray(' </span><span class="s0">+ ($ruleErrs) + </span><span class="s2">')) { if (vErrors === null) vErrors = ' </span><span class="s0">+ ($ruleErrs) + </span><span class="s2">'; else vErrors = vErrors.concat(' </span><span class="s0">+ ($ruleErrs) + </span><span class="s2">'); errors = vErrors.length;  for (var ' </span><span class="s0">+ ($i) + </span><span class="s2">'=' </span><span class="s0">+ ($errs) + </span><span class="s2">'; ' </span><span class="s0">+ ($i) + </span><span class="s2">'&lt;errors; ' </span><span class="s0">+ ($i) + </span><span class="s2">'++) { var ' </span><span class="s0">+ ($ruleErr) + </span><span class="s2">' = vErrors[' </span><span class="s0">+ ($i) + </span><span class="s2">']; if (' </span><span class="s0">+ ($ruleErr) + </span><span class="s2">'.dataPath === undefined) ' </span><span class="s0">+ ($ruleErr) + </span><span class="s2">'.dataPath = (dataPath || </span><span class="s3">\'\'</span><span class="s2">) + ' </span><span class="s0">+ (it.errorPath) + </span><span class="s2">';  ' </span><span class="s0">+ ($ruleErr) + </span><span class="s2">'.schemaPath = &quot;' </span><span class="s0">+ ($errSchemaPath) + </span><span class="s2">'&quot;;  '</span><span class="s3">;</span>
        <span class="s1">if </span><span class="s0">(it.opts.verbose) {</span>
          <span class="s0">out += </span><span class="s2">' ' </span><span class="s0">+ ($ruleErr) + </span><span class="s2">'.schema = ' </span><span class="s0">+ ($schemaValue) + </span><span class="s2">'; ' </span><span class="s0">+ ($ruleErr) + </span><span class="s2">'.data = ' </span><span class="s0">+ ($data) + </span><span class="s2">'; '</span><span class="s3">;</span>
        <span class="s0">}</span>
        <span class="s0">out += </span><span class="s2">' } } else { ' </span><span class="s0">+ (def_customError) + </span><span class="s2">' } '</span><span class="s3">;</span>
      <span class="s0">}</span>
    <span class="s0">}</span>
    <span class="s0">out += </span><span class="s2">' } '</span><span class="s3">;</span>
    <span class="s1">if </span><span class="s0">($breakOnError) {</span>
      <span class="s0">out += </span><span class="s2">' else { '</span><span class="s3">;</span>
    <span class="s0">}</span>
  <span class="s0">}</span>
  <span class="s1">return </span><span class="s0">out</span><span class="s3">;</span>
<span class="s0">}</span>

<span class="s0">}</span><span class="s3">,</span><span class="s0">{}]</span><span class="s3">,</span><span class="s4">23</span><span class="s0">:[</span><span class="s1">function</span><span class="s0">(require</span><span class="s3">,</span><span class="s0">module</span><span class="s3">,</span><span class="s0">exports){</span>
<span class="s2">'use strict'</span><span class="s3">;</span>
<span class="s0">module.exports = </span><span class="s1">function </span><span class="s0">generate_dependencies(it</span><span class="s3">, </span><span class="s0">$keyword</span><span class="s3">, </span><span class="s0">$ruleType) {</span>
  <span class="s1">var </span><span class="s0">out = </span><span class="s2">' '</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$lvl = it.level</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$dataLvl = it.dataLevel</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$schema = it.schema[$keyword]</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$schemaPath = it.schemaPath + it.util.getProperty($keyword)</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$errSchemaPath = it.errSchemaPath + </span><span class="s2">'/' </span><span class="s0">+ $keyword</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$breakOnError = !it.opts.allErrors</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$data = </span><span class="s2">'data' </span><span class="s0">+ ($dataLvl || </span><span class="s2">''</span><span class="s0">)</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$errs = </span><span class="s2">'errs__' </span><span class="s0">+ $lvl</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$it = it.util.copy(it)</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$closingBraces = </span><span class="s2">''</span><span class="s3">;</span>
  <span class="s0">$it.level++</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$nextValid = </span><span class="s2">'valid' </span><span class="s0">+ $it.level</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$schemaDeps = {}</span><span class="s3">,</span>
    <span class="s0">$propertyDeps = {}</span><span class="s3">,</span>
    <span class="s0">$ownProperties = it.opts.ownProperties</span><span class="s3">;</span>
  <span class="s1">for </span><span class="s0">($property </span><span class="s1">in </span><span class="s0">$schema) {</span>
    <span class="s1">if </span><span class="s0">($property == </span><span class="s2">'__proto__'</span><span class="s0">) </span><span class="s1">continue</span><span class="s3">;</span>
    <span class="s1">var </span><span class="s0">$sch = $schema[$property]</span><span class="s3">;</span>
    <span class="s1">var </span><span class="s0">$deps = Array.isArray($sch) ? $propertyDeps : $schemaDeps</span><span class="s3">;</span>
    <span class="s0">$deps[$property] = $sch</span><span class="s3">;</span>
  <span class="s0">}</span>
  <span class="s0">out += </span><span class="s2">'var ' </span><span class="s0">+ ($errs) + </span><span class="s2">' = errors;'</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$currentErrorPath = it.errorPath</span><span class="s3">;</span>
  <span class="s0">out += </span><span class="s2">'var missing' </span><span class="s0">+ ($lvl) + </span><span class="s2">';'</span><span class="s3">;</span>
  <span class="s1">for </span><span class="s0">(</span><span class="s1">var </span><span class="s0">$property </span><span class="s1">in </span><span class="s0">$propertyDeps) {</span>
    <span class="s0">$deps = $propertyDeps[$property]</span><span class="s3">;</span>
    <span class="s1">if </span><span class="s0">($deps.length) {</span>
      <span class="s0">out += </span><span class="s2">' if ( ' </span><span class="s0">+ ($data) + (it.util.getProperty($property)) + </span><span class="s2">' !== undefined '</span><span class="s3">;</span>
      <span class="s1">if </span><span class="s0">($ownProperties) {</span>
        <span class="s0">out += </span><span class="s2">' &amp;&amp; Object.prototype.hasOwnProperty.call(' </span><span class="s0">+ ($data) + </span><span class="s2">', </span><span class="s3">\'</span><span class="s2">' </span><span class="s0">+ (it.util.escapeQuotes($property)) + </span><span class="s2">'</span><span class="s3">\'</span><span class="s2">) '</span><span class="s3">;</span>
      <span class="s0">}</span>
      <span class="s1">if </span><span class="s0">($breakOnError) {</span>
        <span class="s0">out += </span><span class="s2">' &amp;&amp; ( '</span><span class="s3">;</span>
        <span class="s1">var </span><span class="s0">arr1 = $deps</span><span class="s3">;</span>
        <span class="s1">if </span><span class="s0">(arr1) {</span>
          <span class="s1">var </span><span class="s0">$propertyKey</span><span class="s3">, </span><span class="s0">$i = -</span><span class="s4">1</span><span class="s3">,</span>
            <span class="s0">l1 = arr1.length - </span><span class="s4">1</span><span class="s3">;</span>
          <span class="s1">while </span><span class="s0">($i &lt; l1) {</span>
            <span class="s0">$propertyKey = arr1[$i += </span><span class="s4">1</span><span class="s0">]</span><span class="s3">;</span>
            <span class="s1">if </span><span class="s0">($i) {</span>
              <span class="s0">out += </span><span class="s2">' || '</span><span class="s3">;</span>
            <span class="s0">}</span>
            <span class="s1">var </span><span class="s0">$prop = it.util.getProperty($propertyKey)</span><span class="s3">,</span>
              <span class="s0">$useData = $data + $prop</span><span class="s3">;</span>
            <span class="s0">out += </span><span class="s2">' ( ( ' </span><span class="s0">+ ($useData) + </span><span class="s2">' === undefined '</span><span class="s3">;</span>
            <span class="s1">if </span><span class="s0">($ownProperties) {</span>
              <span class="s0">out += </span><span class="s2">' || ! Object.prototype.hasOwnProperty.call(' </span><span class="s0">+ ($data) + </span><span class="s2">', </span><span class="s3">\'</span><span class="s2">' </span><span class="s0">+ (it.util.escapeQuotes($propertyKey)) + </span><span class="s2">'</span><span class="s3">\'</span><span class="s2">) '</span><span class="s3">;</span>
            <span class="s0">}</span>
            <span class="s0">out += </span><span class="s2">') &amp;&amp; (missing' </span><span class="s0">+ ($lvl) + </span><span class="s2">' = ' </span><span class="s0">+ (it.util.toQuotedString(it.opts.jsonPointers ? $propertyKey : $prop)) + </span><span class="s2">') ) '</span><span class="s3">;</span>
          <span class="s0">}</span>
        <span class="s0">}</span>
        <span class="s0">out += </span><span class="s2">')) {  '</span><span class="s3">;</span>
        <span class="s1">var </span><span class="s0">$propertyPath = </span><span class="s2">'missing' </span><span class="s0">+ $lvl</span><span class="s3">,</span>
          <span class="s0">$missingProperty = </span><span class="s2">'</span><span class="s3">\' </span><span class="s2">+ ' </span><span class="s0">+ $propertyPath + </span><span class="s2">' + </span><span class="s3">\'</span><span class="s2">'</span><span class="s3">;</span>
        <span class="s1">if </span><span class="s0">(it.opts._errorDataPathProperty) {</span>
          <span class="s0">it.errorPath = it.opts.jsonPointers ? it.util.getPathExpr($currentErrorPath</span><span class="s3">, </span><span class="s0">$propertyPath</span><span class="s3">, </span><span class="s1">true</span><span class="s0">) : $currentErrorPath + </span><span class="s2">' + ' </span><span class="s0">+ $propertyPath</span><span class="s3">;</span>
        <span class="s0">}</span>
        <span class="s1">var </span><span class="s0">$$outStack = $$outStack || []</span><span class="s3">;</span>
        <span class="s0">$$outStack.push(out)</span><span class="s3">;</span>
        <span class="s0">out = </span><span class="s2">''</span><span class="s3">; </span><span class="s7">/* istanbul ignore else */</span>
        <span class="s1">if </span><span class="s0">(it.createErrors !== </span><span class="s1">false</span><span class="s0">) {</span>
          <span class="s0">out += </span><span class="s2">' { keyword: </span><span class="s3">\'</span><span class="s2">' </span><span class="s0">+ (</span><span class="s2">'dependencies'</span><span class="s0">) + </span><span class="s2">'</span><span class="s3">\' </span><span class="s2">, dataPath: (dataPath || </span><span class="s3">\'\'</span><span class="s2">) + ' </span><span class="s0">+ (it.errorPath) + </span><span class="s2">' , schemaPath: ' </span><span class="s0">+ (it.util.toQuotedString($errSchemaPath)) + </span><span class="s2">' , params: { property: </span><span class="s3">\'</span><span class="s2">' </span><span class="s0">+ (it.util.escapeQuotes($property)) + </span><span class="s2">'</span><span class="s3">\'</span><span class="s2">, missingProperty: </span><span class="s3">\'</span><span class="s2">' </span><span class="s0">+ ($missingProperty) + </span><span class="s2">'</span><span class="s3">\'</span><span class="s2">, depsCount: ' </span><span class="s0">+ ($deps.length) + </span><span class="s2">', deps: </span><span class="s3">\'</span><span class="s2">' </span><span class="s0">+ (it.util.escapeQuotes($deps.length == </span><span class="s4">1 </span><span class="s0">? $deps[</span><span class="s4">0</span><span class="s0">] : $deps.join(</span><span class="s2">&quot;, &quot;</span><span class="s0">))) + </span><span class="s2">'</span><span class="s3">\' </span><span class="s2">} '</span><span class="s3">;</span>
          <span class="s1">if </span><span class="s0">(it.opts.messages !== </span><span class="s1">false</span><span class="s0">) {</span>
            <span class="s0">out += </span><span class="s2">' , message: </span><span class="s3">\'</span><span class="s2">should have '</span><span class="s3">;</span>
            <span class="s1">if </span><span class="s0">($deps.length == </span><span class="s4">1</span><span class="s0">) {</span>
              <span class="s0">out += </span><span class="s2">'property ' </span><span class="s0">+ (it.util.escapeQuotes($deps[</span><span class="s4">0</span><span class="s0">]))</span><span class="s3">;</span>
            <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
              <span class="s0">out += </span><span class="s2">'properties ' </span><span class="s0">+ (it.util.escapeQuotes($deps.join(</span><span class="s2">&quot;, &quot;</span><span class="s0">)))</span><span class="s3">;</span>
            <span class="s0">}</span>
            <span class="s0">out += </span><span class="s2">' when property ' </span><span class="s0">+ (it.util.escapeQuotes($property)) + </span><span class="s2">' is present</span><span class="s3">\' </span><span class="s2">'</span><span class="s3">;</span>
          <span class="s0">}</span>
          <span class="s1">if </span><span class="s0">(it.opts.verbose) {</span>
            <span class="s0">out += </span><span class="s2">' , schema: validate.schema' </span><span class="s0">+ ($schemaPath) + </span><span class="s2">' , parentSchema: validate.schema' </span><span class="s0">+ (it.schemaPath) + </span><span class="s2">' , data: ' </span><span class="s0">+ ($data) + </span><span class="s2">' '</span><span class="s3">;</span>
          <span class="s0">}</span>
          <span class="s0">out += </span><span class="s2">' } '</span><span class="s3">;</span>
        <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
          <span class="s0">out += </span><span class="s2">' {} '</span><span class="s3">;</span>
        <span class="s0">}</span>
        <span class="s1">var </span><span class="s0">__err = out</span><span class="s3">;</span>
        <span class="s0">out = $$outStack.pop()</span><span class="s3">;</span>
        <span class="s1">if </span><span class="s0">(!it.compositeRule &amp;&amp; $breakOnError) {</span>
          <span class="s7">/* istanbul ignore if */</span>
          <span class="s1">if </span><span class="s0">(it.async) {</span>
            <span class="s0">out += </span><span class="s2">' throw new ValidationError([' </span><span class="s0">+ (__err) + </span><span class="s2">']); '</span><span class="s3">;</span>
          <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
            <span class="s0">out += </span><span class="s2">' validate.errors = [' </span><span class="s0">+ (__err) + </span><span class="s2">']; return false; '</span><span class="s3">;</span>
          <span class="s0">}</span>
        <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
          <span class="s0">out += </span><span class="s2">' var err = ' </span><span class="s0">+ (__err) + </span><span class="s2">';  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; '</span><span class="s3">;</span>
        <span class="s0">}</span>
      <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
        <span class="s0">out += </span><span class="s2">' ) { '</span><span class="s3">;</span>
        <span class="s1">var </span><span class="s0">arr2 = $deps</span><span class="s3">;</span>
        <span class="s1">if </span><span class="s0">(arr2) {</span>
          <span class="s1">var </span><span class="s0">$propertyKey</span><span class="s3">, </span><span class="s0">i2 = -</span><span class="s4">1</span><span class="s3">,</span>
            <span class="s0">l2 = arr2.length - </span><span class="s4">1</span><span class="s3">;</span>
          <span class="s1">while </span><span class="s0">(i2 &lt; l2) {</span>
            <span class="s0">$propertyKey = arr2[i2 += </span><span class="s4">1</span><span class="s0">]</span><span class="s3">;</span>
            <span class="s1">var </span><span class="s0">$prop = it.util.getProperty($propertyKey)</span><span class="s3">,</span>
              <span class="s0">$missingProperty = it.util.escapeQuotes($propertyKey)</span><span class="s3">,</span>
              <span class="s0">$useData = $data + $prop</span><span class="s3">;</span>
            <span class="s1">if </span><span class="s0">(it.opts._errorDataPathProperty) {</span>
              <span class="s0">it.errorPath = it.util.getPath($currentErrorPath</span><span class="s3">, </span><span class="s0">$propertyKey</span><span class="s3">, </span><span class="s0">it.opts.jsonPointers)</span><span class="s3">;</span>
            <span class="s0">}</span>
            <span class="s0">out += </span><span class="s2">' if ( ' </span><span class="s0">+ ($useData) + </span><span class="s2">' === undefined '</span><span class="s3">;</span>
            <span class="s1">if </span><span class="s0">($ownProperties) {</span>
              <span class="s0">out += </span><span class="s2">' || ! Object.prototype.hasOwnProperty.call(' </span><span class="s0">+ ($data) + </span><span class="s2">', </span><span class="s3">\'</span><span class="s2">' </span><span class="s0">+ (it.util.escapeQuotes($propertyKey)) + </span><span class="s2">'</span><span class="s3">\'</span><span class="s2">) '</span><span class="s3">;</span>
            <span class="s0">}</span>
            <span class="s0">out += </span><span class="s2">') {  var err =   '</span><span class="s3">; </span><span class="s7">/* istanbul ignore else */</span>
            <span class="s1">if </span><span class="s0">(it.createErrors !== </span><span class="s1">false</span><span class="s0">) {</span>
              <span class="s0">out += </span><span class="s2">' { keyword: </span><span class="s3">\'</span><span class="s2">' </span><span class="s0">+ (</span><span class="s2">'dependencies'</span><span class="s0">) + </span><span class="s2">'</span><span class="s3">\' </span><span class="s2">, dataPath: (dataPath || </span><span class="s3">\'\'</span><span class="s2">) + ' </span><span class="s0">+ (it.errorPath) + </span><span class="s2">' , schemaPath: ' </span><span class="s0">+ (it.util.toQuotedString($errSchemaPath)) + </span><span class="s2">' , params: { property: </span><span class="s3">\'</span><span class="s2">' </span><span class="s0">+ (it.util.escapeQuotes($property)) + </span><span class="s2">'</span><span class="s3">\'</span><span class="s2">, missingProperty: </span><span class="s3">\'</span><span class="s2">' </span><span class="s0">+ ($missingProperty) + </span><span class="s2">'</span><span class="s3">\'</span><span class="s2">, depsCount: ' </span><span class="s0">+ ($deps.length) + </span><span class="s2">', deps: </span><span class="s3">\'</span><span class="s2">' </span><span class="s0">+ (it.util.escapeQuotes($deps.length == </span><span class="s4">1 </span><span class="s0">? $deps[</span><span class="s4">0</span><span class="s0">] : $deps.join(</span><span class="s2">&quot;, &quot;</span><span class="s0">))) + </span><span class="s2">'</span><span class="s3">\' </span><span class="s2">} '</span><span class="s3">;</span>
              <span class="s1">if </span><span class="s0">(it.opts.messages !== </span><span class="s1">false</span><span class="s0">) {</span>
                <span class="s0">out += </span><span class="s2">' , message: </span><span class="s3">\'</span><span class="s2">should have '</span><span class="s3">;</span>
                <span class="s1">if </span><span class="s0">($deps.length == </span><span class="s4">1</span><span class="s0">) {</span>
                  <span class="s0">out += </span><span class="s2">'property ' </span><span class="s0">+ (it.util.escapeQuotes($deps[</span><span class="s4">0</span><span class="s0">]))</span><span class="s3">;</span>
                <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
                  <span class="s0">out += </span><span class="s2">'properties ' </span><span class="s0">+ (it.util.escapeQuotes($deps.join(</span><span class="s2">&quot;, &quot;</span><span class="s0">)))</span><span class="s3">;</span>
                <span class="s0">}</span>
                <span class="s0">out += </span><span class="s2">' when property ' </span><span class="s0">+ (it.util.escapeQuotes($property)) + </span><span class="s2">' is present</span><span class="s3">\' </span><span class="s2">'</span><span class="s3">;</span>
              <span class="s0">}</span>
              <span class="s1">if </span><span class="s0">(it.opts.verbose) {</span>
                <span class="s0">out += </span><span class="s2">' , schema: validate.schema' </span><span class="s0">+ ($schemaPath) + </span><span class="s2">' , parentSchema: validate.schema' </span><span class="s0">+ (it.schemaPath) + </span><span class="s2">' , data: ' </span><span class="s0">+ ($data) + </span><span class="s2">' '</span><span class="s3">;</span>
              <span class="s0">}</span>
              <span class="s0">out += </span><span class="s2">' } '</span><span class="s3">;</span>
            <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
              <span class="s0">out += </span><span class="s2">' {} '</span><span class="s3">;</span>
            <span class="s0">}</span>
            <span class="s0">out += </span><span class="s2">';  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; } '</span><span class="s3">;</span>
          <span class="s0">}</span>
        <span class="s0">}</span>
      <span class="s0">}</span>
      <span class="s0">out += </span><span class="s2">' }   '</span><span class="s3">;</span>
      <span class="s1">if </span><span class="s0">($breakOnError) {</span>
        <span class="s0">$closingBraces += </span><span class="s2">'}'</span><span class="s3">;</span>
        <span class="s0">out += </span><span class="s2">' else { '</span><span class="s3">;</span>
      <span class="s0">}</span>
    <span class="s0">}</span>
  <span class="s0">}</span>
  <span class="s0">it.errorPath = $currentErrorPath</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$currentBaseId = $it.baseId</span><span class="s3">;</span>
  <span class="s1">for </span><span class="s0">(</span><span class="s1">var </span><span class="s0">$property </span><span class="s1">in </span><span class="s0">$schemaDeps) {</span>
    <span class="s1">var </span><span class="s0">$sch = $schemaDeps[$property]</span><span class="s3">;</span>
    <span class="s1">if </span><span class="s0">((it.opts.strictKeywords ? (</span><span class="s1">typeof </span><span class="s0">$sch == </span><span class="s2">'object' </span><span class="s0">&amp;&amp; Object.keys($sch).length &gt; </span><span class="s4">0</span><span class="s0">) || $sch === </span><span class="s1">false </span><span class="s0">: it.util.schemaHasRules($sch</span><span class="s3">, </span><span class="s0">it.RULES.all))) {</span>
      <span class="s0">out += </span><span class="s2">' ' </span><span class="s0">+ ($nextValid) + </span><span class="s2">' = true; if ( ' </span><span class="s0">+ ($data) + (it.util.getProperty($property)) + </span><span class="s2">' !== undefined '</span><span class="s3">;</span>
      <span class="s1">if </span><span class="s0">($ownProperties) {</span>
        <span class="s0">out += </span><span class="s2">' &amp;&amp; Object.prototype.hasOwnProperty.call(' </span><span class="s0">+ ($data) + </span><span class="s2">', </span><span class="s3">\'</span><span class="s2">' </span><span class="s0">+ (it.util.escapeQuotes($property)) + </span><span class="s2">'</span><span class="s3">\'</span><span class="s2">) '</span><span class="s3">;</span>
      <span class="s0">}</span>
      <span class="s0">out += </span><span class="s2">') { '</span><span class="s3">;</span>
      <span class="s0">$it.schema = $sch</span><span class="s3">;</span>
      <span class="s0">$it.schemaPath = $schemaPath + it.util.getProperty($property)</span><span class="s3">;</span>
      <span class="s0">$it.errSchemaPath = $errSchemaPath + </span><span class="s2">'/' </span><span class="s0">+ it.util.escapeFragment($property)</span><span class="s3">;</span>
      <span class="s0">out += </span><span class="s2">'  ' </span><span class="s0">+ (it.validate($it)) + </span><span class="s2">' '</span><span class="s3">;</span>
      <span class="s0">$it.baseId = $currentBaseId</span><span class="s3">;</span>
      <span class="s0">out += </span><span class="s2">' }  '</span><span class="s3">;</span>
      <span class="s1">if </span><span class="s0">($breakOnError) {</span>
        <span class="s0">out += </span><span class="s2">' if (' </span><span class="s0">+ ($nextValid) + </span><span class="s2">') { '</span><span class="s3">;</span>
        <span class="s0">$closingBraces += </span><span class="s2">'}'</span><span class="s3">;</span>
      <span class="s0">}</span>
    <span class="s0">}</span>
  <span class="s0">}</span>
  <span class="s1">if </span><span class="s0">($breakOnError) {</span>
    <span class="s0">out += </span><span class="s2">'   ' </span><span class="s0">+ ($closingBraces) + </span><span class="s2">' if (' </span><span class="s0">+ ($errs) + </span><span class="s2">' == errors) {'</span><span class="s3">;</span>
  <span class="s0">}</span>
  <span class="s1">return </span><span class="s0">out</span><span class="s3">;</span>
<span class="s0">}</span>

<span class="s0">}</span><span class="s3">,</span><span class="s0">{}]</span><span class="s3">,</span><span class="s4">24</span><span class="s0">:[</span><span class="s1">function</span><span class="s0">(require</span><span class="s3">,</span><span class="s0">module</span><span class="s3">,</span><span class="s0">exports){</span>
<span class="s2">'use strict'</span><span class="s3">;</span>
<span class="s0">module.exports = </span><span class="s1">function </span><span class="s0">generate_enum(it</span><span class="s3">, </span><span class="s0">$keyword</span><span class="s3">, </span><span class="s0">$ruleType) {</span>
  <span class="s1">var </span><span class="s0">out = </span><span class="s2">' '</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$lvl = it.level</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$dataLvl = it.dataLevel</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$schema = it.schema[$keyword]</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$schemaPath = it.schemaPath + it.util.getProperty($keyword)</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$errSchemaPath = it.errSchemaPath + </span><span class="s2">'/' </span><span class="s0">+ $keyword</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$breakOnError = !it.opts.allErrors</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$data = </span><span class="s2">'data' </span><span class="s0">+ ($dataLvl || </span><span class="s2">''</span><span class="s0">)</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$valid = </span><span class="s2">'valid' </span><span class="s0">+ $lvl</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$isData = it.opts.$data &amp;&amp; $schema &amp;&amp; $schema.$data</span><span class="s3">,</span>
    <span class="s0">$schemaValue</span><span class="s3">;</span>
  <span class="s1">if </span><span class="s0">($isData) {</span>
    <span class="s0">out += </span><span class="s2">' var schema' </span><span class="s0">+ ($lvl) + </span><span class="s2">' = ' </span><span class="s0">+ (it.util.getData($schema.$data</span><span class="s3">, </span><span class="s0">$dataLvl</span><span class="s3">, </span><span class="s0">it.dataPathArr)) + </span><span class="s2">'; '</span><span class="s3">;</span>
    <span class="s0">$schemaValue = </span><span class="s2">'schema' </span><span class="s0">+ $lvl</span><span class="s3">;</span>
  <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
    <span class="s0">$schemaValue = $schema</span><span class="s3">;</span>
  <span class="s0">}</span>
  <span class="s1">var </span><span class="s0">$i = </span><span class="s2">'i' </span><span class="s0">+ $lvl</span><span class="s3">,</span>
    <span class="s0">$vSchema = </span><span class="s2">'schema' </span><span class="s0">+ $lvl</span><span class="s3">;</span>
  <span class="s1">if </span><span class="s0">(!$isData) {</span>
    <span class="s0">out += </span><span class="s2">' var ' </span><span class="s0">+ ($vSchema) + </span><span class="s2">' = validate.schema' </span><span class="s0">+ ($schemaPath) + </span><span class="s2">';'</span><span class="s3">;</span>
  <span class="s0">}</span>
  <span class="s0">out += </span><span class="s2">'var ' </span><span class="s0">+ ($valid) + </span><span class="s2">';'</span><span class="s3">;</span>
  <span class="s1">if </span><span class="s0">($isData) {</span>
    <span class="s0">out += </span><span class="s2">' if (schema' </span><span class="s0">+ ($lvl) + </span><span class="s2">' === undefined) ' </span><span class="s0">+ ($valid) + </span><span class="s2">' = true; else if (!Array.isArray(schema' </span><span class="s0">+ ($lvl) + </span><span class="s2">')) ' </span><span class="s0">+ ($valid) + </span><span class="s2">' = false; else {'</span><span class="s3">;</span>
  <span class="s0">}</span>
  <span class="s0">out += </span><span class="s2">'' </span><span class="s0">+ ($valid) + </span><span class="s2">' = false;for (var ' </span><span class="s0">+ ($i) + </span><span class="s2">'=0; ' </span><span class="s0">+ ($i) + </span><span class="s2">'&lt;' </span><span class="s0">+ ($vSchema) + </span><span class="s2">'.length; ' </span><span class="s0">+ ($i) + </span><span class="s2">'++) if (equal(' </span><span class="s0">+ ($data) + </span><span class="s2">', ' </span><span class="s0">+ ($vSchema) + </span><span class="s2">'[' </span><span class="s0">+ ($i) + </span><span class="s2">'])) { ' </span><span class="s0">+ ($valid) + </span><span class="s2">' = true; break; }'</span><span class="s3">;</span>
  <span class="s1">if </span><span class="s0">($isData) {</span>
    <span class="s0">out += </span><span class="s2">'  }  '</span><span class="s3">;</span>
  <span class="s0">}</span>
  <span class="s0">out += </span><span class="s2">' if (!' </span><span class="s0">+ ($valid) + </span><span class="s2">') {   '</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$$outStack = $$outStack || []</span><span class="s3">;</span>
  <span class="s0">$$outStack.push(out)</span><span class="s3">;</span>
  <span class="s0">out = </span><span class="s2">''</span><span class="s3">; </span><span class="s7">/* istanbul ignore else */</span>
  <span class="s1">if </span><span class="s0">(it.createErrors !== </span><span class="s1">false</span><span class="s0">) {</span>
    <span class="s0">out += </span><span class="s2">' { keyword: </span><span class="s3">\'</span><span class="s2">' </span><span class="s0">+ (</span><span class="s2">'enum'</span><span class="s0">) + </span><span class="s2">'</span><span class="s3">\' </span><span class="s2">, dataPath: (dataPath || </span><span class="s3">\'\'</span><span class="s2">) + ' </span><span class="s0">+ (it.errorPath) + </span><span class="s2">' , schemaPath: ' </span><span class="s0">+ (it.util.toQuotedString($errSchemaPath)) + </span><span class="s2">' , params: { allowedValues: schema' </span><span class="s0">+ ($lvl) + </span><span class="s2">' } '</span><span class="s3">;</span>
    <span class="s1">if </span><span class="s0">(it.opts.messages !== </span><span class="s1">false</span><span class="s0">) {</span>
      <span class="s0">out += </span><span class="s2">' , message: </span><span class="s3">\'</span><span class="s2">should be equal to one of the allowed values</span><span class="s3">\' </span><span class="s2">'</span><span class="s3">;</span>
    <span class="s0">}</span>
    <span class="s1">if </span><span class="s0">(it.opts.verbose) {</span>
      <span class="s0">out += </span><span class="s2">' , schema: validate.schema' </span><span class="s0">+ ($schemaPath) + </span><span class="s2">' , parentSchema: validate.schema' </span><span class="s0">+ (it.schemaPath) + </span><span class="s2">' , data: ' </span><span class="s0">+ ($data) + </span><span class="s2">' '</span><span class="s3">;</span>
    <span class="s0">}</span>
    <span class="s0">out += </span><span class="s2">' } '</span><span class="s3">;</span>
  <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
    <span class="s0">out += </span><span class="s2">' {} '</span><span class="s3">;</span>
  <span class="s0">}</span>
  <span class="s1">var </span><span class="s0">__err = out</span><span class="s3">;</span>
  <span class="s0">out = $$outStack.pop()</span><span class="s3">;</span>
  <span class="s1">if </span><span class="s0">(!it.compositeRule &amp;&amp; $breakOnError) {</span>
    <span class="s7">/* istanbul ignore if */</span>
    <span class="s1">if </span><span class="s0">(it.async) {</span>
      <span class="s0">out += </span><span class="s2">' throw new ValidationError([' </span><span class="s0">+ (__err) + </span><span class="s2">']); '</span><span class="s3">;</span>
    <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
      <span class="s0">out += </span><span class="s2">' validate.errors = [' </span><span class="s0">+ (__err) + </span><span class="s2">']; return false; '</span><span class="s3">;</span>
    <span class="s0">}</span>
  <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
    <span class="s0">out += </span><span class="s2">' var err = ' </span><span class="s0">+ (__err) + </span><span class="s2">';  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; '</span><span class="s3">;</span>
  <span class="s0">}</span>
  <span class="s0">out += </span><span class="s2">' }'</span><span class="s3">;</span>
  <span class="s1">if </span><span class="s0">($breakOnError) {</span>
    <span class="s0">out += </span><span class="s2">' else { '</span><span class="s3">;</span>
  <span class="s0">}</span>
  <span class="s1">return </span><span class="s0">out</span><span class="s3">;</span>
<span class="s0">}</span>

<span class="s0">}</span><span class="s3">,</span><span class="s0">{}]</span><span class="s3">,</span><span class="s4">25</span><span class="s0">:[</span><span class="s1">function</span><span class="s0">(require</span><span class="s3">,</span><span class="s0">module</span><span class="s3">,</span><span class="s0">exports){</span>
<span class="s2">'use strict'</span><span class="s3">;</span>
<span class="s0">module.exports = </span><span class="s1">function </span><span class="s0">generate_format(it</span><span class="s3">, </span><span class="s0">$keyword</span><span class="s3">, </span><span class="s0">$ruleType) {</span>
  <span class="s1">var </span><span class="s0">out = </span><span class="s2">' '</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$lvl = it.level</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$dataLvl = it.dataLevel</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$schema = it.schema[$keyword]</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$schemaPath = it.schemaPath + it.util.getProperty($keyword)</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$errSchemaPath = it.errSchemaPath + </span><span class="s2">'/' </span><span class="s0">+ $keyword</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$breakOnError = !it.opts.allErrors</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$data = </span><span class="s2">'data' </span><span class="s0">+ ($dataLvl || </span><span class="s2">''</span><span class="s0">)</span><span class="s3">;</span>
  <span class="s1">if </span><span class="s0">(it.opts.format === </span><span class="s1">false</span><span class="s0">) {</span>
    <span class="s1">if </span><span class="s0">($breakOnError) {</span>
      <span class="s0">out += </span><span class="s2">' if (true) { '</span><span class="s3">;</span>
    <span class="s0">}</span>
    <span class="s1">return </span><span class="s0">out</span><span class="s3">;</span>
  <span class="s0">}</span>
  <span class="s1">var </span><span class="s0">$isData = it.opts.$data &amp;&amp; $schema &amp;&amp; $schema.$data</span><span class="s3">,</span>
    <span class="s0">$schemaValue</span><span class="s3">;</span>
  <span class="s1">if </span><span class="s0">($isData) {</span>
    <span class="s0">out += </span><span class="s2">' var schema' </span><span class="s0">+ ($lvl) + </span><span class="s2">' = ' </span><span class="s0">+ (it.util.getData($schema.$data</span><span class="s3">, </span><span class="s0">$dataLvl</span><span class="s3">, </span><span class="s0">it.dataPathArr)) + </span><span class="s2">'; '</span><span class="s3">;</span>
    <span class="s0">$schemaValue = </span><span class="s2">'schema' </span><span class="s0">+ $lvl</span><span class="s3">;</span>
  <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
    <span class="s0">$schemaValue = $schema</span><span class="s3">;</span>
  <span class="s0">}</span>
  <span class="s1">var </span><span class="s0">$unknownFormats = it.opts.unknownFormats</span><span class="s3">,</span>
    <span class="s0">$allowUnknown = Array.isArray($unknownFormats)</span><span class="s3">;</span>
  <span class="s1">if </span><span class="s0">($isData) {</span>
    <span class="s1">var </span><span class="s0">$format = </span><span class="s2">'format' </span><span class="s0">+ $lvl</span><span class="s3">,</span>
      <span class="s0">$isObject = </span><span class="s2">'isObject' </span><span class="s0">+ $lvl</span><span class="s3">,</span>
      <span class="s0">$formatType = </span><span class="s2">'formatType' </span><span class="s0">+ $lvl</span><span class="s3">;</span>
    <span class="s0">out += </span><span class="s2">' var ' </span><span class="s0">+ ($format) + </span><span class="s2">' = formats[' </span><span class="s0">+ ($schemaValue) + </span><span class="s2">']; var ' </span><span class="s0">+ ($isObject) + </span><span class="s2">' = typeof ' </span><span class="s0">+ ($format) + </span><span class="s2">' == </span><span class="s3">\'</span><span class="s2">object</span><span class="s3">\' </span><span class="s2">&amp;&amp; !(' </span><span class="s0">+ ($format) + </span><span class="s2">' instanceof RegExp) &amp;&amp; ' </span><span class="s0">+ ($format) + </span><span class="s2">'.validate; var ' </span><span class="s0">+ ($formatType) + </span><span class="s2">' = ' </span><span class="s0">+ ($isObject) + </span><span class="s2">' &amp;&amp; ' </span><span class="s0">+ ($format) + </span><span class="s2">'.type || </span><span class="s3">\'</span><span class="s2">string</span><span class="s3">\'</span><span class="s2">; if (' </span><span class="s0">+ ($isObject) + </span><span class="s2">') { '</span><span class="s3">;</span>
    <span class="s1">if </span><span class="s0">(it.async) {</span>
      <span class="s0">out += </span><span class="s2">' var async' </span><span class="s0">+ ($lvl) + </span><span class="s2">' = ' </span><span class="s0">+ ($format) + </span><span class="s2">'.async; '</span><span class="s3">;</span>
    <span class="s0">}</span>
    <span class="s0">out += </span><span class="s2">' ' </span><span class="s0">+ ($format) + </span><span class="s2">' = ' </span><span class="s0">+ ($format) + </span><span class="s2">'.validate; } if (  '</span><span class="s3">;</span>
    <span class="s1">if </span><span class="s0">($isData) {</span>
      <span class="s0">out += </span><span class="s2">' (' </span><span class="s0">+ ($schemaValue) + </span><span class="s2">' !== undefined &amp;&amp; typeof ' </span><span class="s0">+ ($schemaValue) + </span><span class="s2">' != </span><span class="s3">\'</span><span class="s2">string</span><span class="s3">\'</span><span class="s2">) || '</span><span class="s3">;</span>
    <span class="s0">}</span>
    <span class="s0">out += </span><span class="s2">' ('</span><span class="s3">;</span>
    <span class="s1">if </span><span class="s0">($unknownFormats != </span><span class="s2">'ignore'</span><span class="s0">) {</span>
      <span class="s0">out += </span><span class="s2">' (' </span><span class="s0">+ ($schemaValue) + </span><span class="s2">' &amp;&amp; !' </span><span class="s0">+ ($format) + </span><span class="s2">' '</span><span class="s3">;</span>
      <span class="s1">if </span><span class="s0">($allowUnknown) {</span>
        <span class="s0">out += </span><span class="s2">' &amp;&amp; self._opts.unknownFormats.indexOf(' </span><span class="s0">+ ($schemaValue) + </span><span class="s2">') == -1 '</span><span class="s3">;</span>
      <span class="s0">}</span>
      <span class="s0">out += </span><span class="s2">') || '</span><span class="s3">;</span>
    <span class="s0">}</span>
    <span class="s0">out += </span><span class="s2">' (' </span><span class="s0">+ ($format) + </span><span class="s2">' &amp;&amp; ' </span><span class="s0">+ ($formatType) + </span><span class="s2">' == </span><span class="s3">\'</span><span class="s2">' </span><span class="s0">+ ($ruleType) + </span><span class="s2">'</span><span class="s3">\' </span><span class="s2">&amp;&amp; !(typeof ' </span><span class="s0">+ ($format) + </span><span class="s2">' == </span><span class="s3">\'</span><span class="s2">function</span><span class="s3">\' </span><span class="s2">? '</span><span class="s3">;</span>
    <span class="s1">if </span><span class="s0">(it.async) {</span>
      <span class="s0">out += </span><span class="s2">' (async' </span><span class="s0">+ ($lvl) + </span><span class="s2">' ? await ' </span><span class="s0">+ ($format) + </span><span class="s2">'(' </span><span class="s0">+ ($data) + </span><span class="s2">') : ' </span><span class="s0">+ ($format) + </span><span class="s2">'(' </span><span class="s0">+ ($data) + </span><span class="s2">')) '</span><span class="s3">;</span>
    <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
      <span class="s0">out += </span><span class="s2">' ' </span><span class="s0">+ ($format) + </span><span class="s2">'(' </span><span class="s0">+ ($data) + </span><span class="s2">') '</span><span class="s3">;</span>
    <span class="s0">}</span>
    <span class="s0">out += </span><span class="s2">' : ' </span><span class="s0">+ ($format) + </span><span class="s2">'.test(' </span><span class="s0">+ ($data) + </span><span class="s2">'))))) {'</span><span class="s3">;</span>
  <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
    <span class="s1">var </span><span class="s0">$format = it.formats[$schema]</span><span class="s3">;</span>
    <span class="s1">if </span><span class="s0">(!$format) {</span>
      <span class="s1">if </span><span class="s0">($unknownFormats == </span><span class="s2">'ignore'</span><span class="s0">) {</span>
        <span class="s0">it.logger.warn(</span><span class="s2">'unknown format &quot;' </span><span class="s0">+ $schema + </span><span class="s2">'&quot; ignored in schema at path &quot;' </span><span class="s0">+ it.errSchemaPath + </span><span class="s2">'&quot;'</span><span class="s0">)</span><span class="s3">;</span>
        <span class="s1">if </span><span class="s0">($breakOnError) {</span>
          <span class="s0">out += </span><span class="s2">' if (true) { '</span><span class="s3">;</span>
        <span class="s0">}</span>
        <span class="s1">return </span><span class="s0">out</span><span class="s3">;</span>
      <span class="s0">} </span><span class="s1">else if </span><span class="s0">($allowUnknown &amp;&amp; $unknownFormats.indexOf($schema) &gt;= </span><span class="s4">0</span><span class="s0">) {</span>
        <span class="s1">if </span><span class="s0">($breakOnError) {</span>
          <span class="s0">out += </span><span class="s2">' if (true) { '</span><span class="s3">;</span>
        <span class="s0">}</span>
        <span class="s1">return </span><span class="s0">out</span><span class="s3">;</span>
      <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
        <span class="s1">throw new </span><span class="s0">Error(</span><span class="s2">'unknown format &quot;' </span><span class="s0">+ $schema + </span><span class="s2">'&quot; is used in schema at path &quot;' </span><span class="s0">+ it.errSchemaPath + </span><span class="s2">'&quot;'</span><span class="s0">)</span><span class="s3">;</span>
      <span class="s0">}</span>
    <span class="s0">}</span>
    <span class="s1">var </span><span class="s0">$isObject = </span><span class="s1">typeof </span><span class="s0">$format == </span><span class="s2">'object' </span><span class="s0">&amp;&amp; !($format </span><span class="s1">instanceof </span><span class="s0">RegExp) &amp;&amp; $format.validate</span><span class="s3">;</span>
    <span class="s1">var </span><span class="s0">$formatType = $isObject &amp;&amp; $format.type || </span><span class="s2">'string'</span><span class="s3">;</span>
    <span class="s1">if </span><span class="s0">($isObject) {</span>
      <span class="s1">var </span><span class="s0">$async = $format.async === </span><span class="s1">true</span><span class="s3">;</span>
      <span class="s0">$format = $format.validate</span><span class="s3">;</span>
    <span class="s0">}</span>
    <span class="s1">if </span><span class="s0">($formatType != $ruleType) {</span>
      <span class="s1">if </span><span class="s0">($breakOnError) {</span>
        <span class="s0">out += </span><span class="s2">' if (true) { '</span><span class="s3">;</span>
      <span class="s0">}</span>
      <span class="s1">return </span><span class="s0">out</span><span class="s3">;</span>
    <span class="s0">}</span>
    <span class="s1">if </span><span class="s0">($async) {</span>
      <span class="s1">if </span><span class="s0">(!it.async) </span><span class="s1">throw new </span><span class="s0">Error(</span><span class="s2">'async format in sync schema'</span><span class="s0">)</span><span class="s3">;</span>
      <span class="s1">var </span><span class="s0">$formatRef = </span><span class="s2">'formats' </span><span class="s0">+ it.util.getProperty($schema) + </span><span class="s2">'.validate'</span><span class="s3">;</span>
      <span class="s0">out += </span><span class="s2">' if (!(await ' </span><span class="s0">+ ($formatRef) + </span><span class="s2">'(' </span><span class="s0">+ ($data) + </span><span class="s2">'))) { '</span><span class="s3">;</span>
    <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
      <span class="s0">out += </span><span class="s2">' if (! '</span><span class="s3">;</span>
      <span class="s1">var </span><span class="s0">$formatRef = </span><span class="s2">'formats' </span><span class="s0">+ it.util.getProperty($schema)</span><span class="s3">;</span>
      <span class="s1">if </span><span class="s0">($isObject) $formatRef += </span><span class="s2">'.validate'</span><span class="s3">;</span>
      <span class="s1">if </span><span class="s0">(</span><span class="s1">typeof </span><span class="s0">$format == </span><span class="s2">'function'</span><span class="s0">) {</span>
        <span class="s0">out += </span><span class="s2">' ' </span><span class="s0">+ ($formatRef) + </span><span class="s2">'(' </span><span class="s0">+ ($data) + </span><span class="s2">') '</span><span class="s3">;</span>
      <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
        <span class="s0">out += </span><span class="s2">' ' </span><span class="s0">+ ($formatRef) + </span><span class="s2">'.test(' </span><span class="s0">+ ($data) + </span><span class="s2">') '</span><span class="s3">;</span>
      <span class="s0">}</span>
      <span class="s0">out += </span><span class="s2">') { '</span><span class="s3">;</span>
    <span class="s0">}</span>
  <span class="s0">}</span>
  <span class="s1">var </span><span class="s0">$$outStack = $$outStack || []</span><span class="s3">;</span>
  <span class="s0">$$outStack.push(out)</span><span class="s3">;</span>
  <span class="s0">out = </span><span class="s2">''</span><span class="s3">; </span><span class="s7">/* istanbul ignore else */</span>
  <span class="s1">if </span><span class="s0">(it.createErrors !== </span><span class="s1">false</span><span class="s0">) {</span>
    <span class="s0">out += </span><span class="s2">' { keyword: </span><span class="s3">\'</span><span class="s2">' </span><span class="s0">+ (</span><span class="s2">'format'</span><span class="s0">) + </span><span class="s2">'</span><span class="s3">\' </span><span class="s2">, dataPath: (dataPath || </span><span class="s3">\'\'</span><span class="s2">) + ' </span><span class="s0">+ (it.errorPath) + </span><span class="s2">' , schemaPath: ' </span><span class="s0">+ (it.util.toQuotedString($errSchemaPath)) + </span><span class="s2">' , params: { format:  '</span><span class="s3">;</span>
    <span class="s1">if </span><span class="s0">($isData) {</span>
      <span class="s0">out += </span><span class="s2">'' </span><span class="s0">+ ($schemaValue)</span><span class="s3">;</span>
    <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
      <span class="s0">out += </span><span class="s2">'' </span><span class="s0">+ (it.util.toQuotedString($schema))</span><span class="s3">;</span>
    <span class="s0">}</span>
    <span class="s0">out += </span><span class="s2">'  } '</span><span class="s3">;</span>
    <span class="s1">if </span><span class="s0">(it.opts.messages !== </span><span class="s1">false</span><span class="s0">) {</span>
      <span class="s0">out += </span><span class="s2">' , message: </span><span class="s3">\'</span><span class="s2">should match format &quot;'</span><span class="s3">;</span>
      <span class="s1">if </span><span class="s0">($isData) {</span>
        <span class="s0">out += </span><span class="s2">'</span><span class="s3">\' </span><span class="s2">+ ' </span><span class="s0">+ ($schemaValue) + </span><span class="s2">' + </span><span class="s3">\'</span><span class="s2">'</span><span class="s3">;</span>
      <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
        <span class="s0">out += </span><span class="s2">'' </span><span class="s0">+ (it.util.escapeQuotes($schema))</span><span class="s3">;</span>
      <span class="s0">}</span>
      <span class="s0">out += </span><span class="s2">'&quot;</span><span class="s3">\' </span><span class="s2">'</span><span class="s3">;</span>
    <span class="s0">}</span>
    <span class="s1">if </span><span class="s0">(it.opts.verbose) {</span>
      <span class="s0">out += </span><span class="s2">' , schema:  '</span><span class="s3">;</span>
      <span class="s1">if </span><span class="s0">($isData) {</span>
        <span class="s0">out += </span><span class="s2">'validate.schema' </span><span class="s0">+ ($schemaPath)</span><span class="s3">;</span>
      <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
        <span class="s0">out += </span><span class="s2">'' </span><span class="s0">+ (it.util.toQuotedString($schema))</span><span class="s3">;</span>
      <span class="s0">}</span>
      <span class="s0">out += </span><span class="s2">'         , parentSchema: validate.schema' </span><span class="s0">+ (it.schemaPath) + </span><span class="s2">' , data: ' </span><span class="s0">+ ($data) + </span><span class="s2">' '</span><span class="s3">;</span>
    <span class="s0">}</span>
    <span class="s0">out += </span><span class="s2">' } '</span><span class="s3">;</span>
  <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
    <span class="s0">out += </span><span class="s2">' {} '</span><span class="s3">;</span>
  <span class="s0">}</span>
  <span class="s1">var </span><span class="s0">__err = out</span><span class="s3">;</span>
  <span class="s0">out = $$outStack.pop()</span><span class="s3">;</span>
  <span class="s1">if </span><span class="s0">(!it.compositeRule &amp;&amp; $breakOnError) {</span>
    <span class="s7">/* istanbul ignore if */</span>
    <span class="s1">if </span><span class="s0">(it.async) {</span>
      <span class="s0">out += </span><span class="s2">' throw new ValidationError([' </span><span class="s0">+ (__err) + </span><span class="s2">']); '</span><span class="s3">;</span>
    <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
      <span class="s0">out += </span><span class="s2">' validate.errors = [' </span><span class="s0">+ (__err) + </span><span class="s2">']; return false; '</span><span class="s3">;</span>
    <span class="s0">}</span>
  <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
    <span class="s0">out += </span><span class="s2">' var err = ' </span><span class="s0">+ (__err) + </span><span class="s2">';  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; '</span><span class="s3">;</span>
  <span class="s0">}</span>
  <span class="s0">out += </span><span class="s2">' } '</span><span class="s3">;</span>
  <span class="s1">if </span><span class="s0">($breakOnError) {</span>
    <span class="s0">out += </span><span class="s2">' else { '</span><span class="s3">;</span>
  <span class="s0">}</span>
  <span class="s1">return </span><span class="s0">out</span><span class="s3">;</span>
<span class="s0">}</span>

<span class="s0">}</span><span class="s3">,</span><span class="s0">{}]</span><span class="s3">,</span><span class="s4">26</span><span class="s0">:[</span><span class="s1">function</span><span class="s0">(require</span><span class="s3">,</span><span class="s0">module</span><span class="s3">,</span><span class="s0">exports){</span>
<span class="s2">'use strict'</span><span class="s3">;</span>
<span class="s0">module.exports = </span><span class="s1">function </span><span class="s0">generate_if(it</span><span class="s3">, </span><span class="s0">$keyword</span><span class="s3">, </span><span class="s0">$ruleType) {</span>
  <span class="s1">var </span><span class="s0">out = </span><span class="s2">' '</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$lvl = it.level</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$dataLvl = it.dataLevel</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$schema = it.schema[$keyword]</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$schemaPath = it.schemaPath + it.util.getProperty($keyword)</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$errSchemaPath = it.errSchemaPath + </span><span class="s2">'/' </span><span class="s0">+ $keyword</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$breakOnError = !it.opts.allErrors</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$data = </span><span class="s2">'data' </span><span class="s0">+ ($dataLvl || </span><span class="s2">''</span><span class="s0">)</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$valid = </span><span class="s2">'valid' </span><span class="s0">+ $lvl</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$errs = </span><span class="s2">'errs__' </span><span class="s0">+ $lvl</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$it = it.util.copy(it)</span><span class="s3">;</span>
  <span class="s0">$it.level++</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$nextValid = </span><span class="s2">'valid' </span><span class="s0">+ $it.level</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$thenSch = it.schema[</span><span class="s2">'then'</span><span class="s0">]</span><span class="s3">,</span>
    <span class="s0">$elseSch = it.schema[</span><span class="s2">'else'</span><span class="s0">]</span><span class="s3">,</span>
    <span class="s0">$thenPresent = $thenSch !== undefined &amp;&amp; (it.opts.strictKeywords ? (</span><span class="s1">typeof </span><span class="s0">$thenSch == </span><span class="s2">'object' </span><span class="s0">&amp;&amp; Object.keys($thenSch).length &gt; </span><span class="s4">0</span><span class="s0">) || $thenSch === </span><span class="s1">false </span><span class="s0">: it.util.schemaHasRules($thenSch</span><span class="s3">, </span><span class="s0">it.RULES.all))</span><span class="s3">,</span>
    <span class="s0">$elsePresent = $elseSch !== undefined &amp;&amp; (it.opts.strictKeywords ? (</span><span class="s1">typeof </span><span class="s0">$elseSch == </span><span class="s2">'object' </span><span class="s0">&amp;&amp; Object.keys($elseSch).length &gt; </span><span class="s4">0</span><span class="s0">) || $elseSch === </span><span class="s1">false </span><span class="s0">: it.util.schemaHasRules($elseSch</span><span class="s3">, </span><span class="s0">it.RULES.all))</span><span class="s3">,</span>
    <span class="s0">$currentBaseId = $it.baseId</span><span class="s3">;</span>
  <span class="s1">if </span><span class="s0">($thenPresent || $elsePresent) {</span>
    <span class="s1">var </span><span class="s0">$ifClause</span><span class="s3">;</span>
    <span class="s0">$it.createErrors = </span><span class="s1">false</span><span class="s3">;</span>
    <span class="s0">$it.schema = $schema</span><span class="s3">;</span>
    <span class="s0">$it.schemaPath = $schemaPath</span><span class="s3">;</span>
    <span class="s0">$it.errSchemaPath = $errSchemaPath</span><span class="s3">;</span>
    <span class="s0">out += </span><span class="s2">' var ' </span><span class="s0">+ ($errs) + </span><span class="s2">' = errors; var ' </span><span class="s0">+ ($valid) + </span><span class="s2">' = true;  '</span><span class="s3">;</span>
    <span class="s1">var </span><span class="s0">$wasComposite = it.compositeRule</span><span class="s3">;</span>
    <span class="s0">it.compositeRule = $it.compositeRule = </span><span class="s1">true</span><span class="s3">;</span>
    <span class="s0">out += </span><span class="s2">'  ' </span><span class="s0">+ (it.validate($it)) + </span><span class="s2">' '</span><span class="s3">;</span>
    <span class="s0">$it.baseId = $currentBaseId</span><span class="s3">;</span>
    <span class="s0">$it.createErrors = </span><span class="s1">true</span><span class="s3">;</span>
    <span class="s0">out += </span><span class="s2">'  errors = ' </span><span class="s0">+ ($errs) + </span><span class="s2">'; if (vErrors !== null) { if (' </span><span class="s0">+ ($errs) + </span><span class="s2">') vErrors.length = ' </span><span class="s0">+ ($errs) + </span><span class="s2">'; else vErrors = null; }  '</span><span class="s3">;</span>
    <span class="s0">it.compositeRule = $it.compositeRule = $wasComposite</span><span class="s3">;</span>
    <span class="s1">if </span><span class="s0">($thenPresent) {</span>
      <span class="s0">out += </span><span class="s2">' if (' </span><span class="s0">+ ($nextValid) + </span><span class="s2">') {  '</span><span class="s3">;</span>
      <span class="s0">$it.schema = it.schema[</span><span class="s2">'then'</span><span class="s0">]</span><span class="s3">;</span>
      <span class="s0">$it.schemaPath = it.schemaPath + </span><span class="s2">'.then'</span><span class="s3">;</span>
      <span class="s0">$it.errSchemaPath = it.errSchemaPath + </span><span class="s2">'/then'</span><span class="s3">;</span>
      <span class="s0">out += </span><span class="s2">'  ' </span><span class="s0">+ (it.validate($it)) + </span><span class="s2">' '</span><span class="s3">;</span>
      <span class="s0">$it.baseId = $currentBaseId</span><span class="s3">;</span>
      <span class="s0">out += </span><span class="s2">' ' </span><span class="s0">+ ($valid) + </span><span class="s2">' = ' </span><span class="s0">+ ($nextValid) + </span><span class="s2">'; '</span><span class="s3">;</span>
      <span class="s1">if </span><span class="s0">($thenPresent &amp;&amp; $elsePresent) {</span>
        <span class="s0">$ifClause = </span><span class="s2">'ifClause' </span><span class="s0">+ $lvl</span><span class="s3">;</span>
        <span class="s0">out += </span><span class="s2">' var ' </span><span class="s0">+ ($ifClause) + </span><span class="s2">' = </span><span class="s3">\'</span><span class="s2">then</span><span class="s3">\'</span><span class="s2">; '</span><span class="s3">;</span>
      <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
        <span class="s0">$ifClause = </span><span class="s2">'</span><span class="s3">\'</span><span class="s2">then</span><span class="s3">\'</span><span class="s2">'</span><span class="s3">;</span>
      <span class="s0">}</span>
      <span class="s0">out += </span><span class="s2">' } '</span><span class="s3">;</span>
      <span class="s1">if </span><span class="s0">($elsePresent) {</span>
        <span class="s0">out += </span><span class="s2">' else { '</span><span class="s3">;</span>
      <span class="s0">}</span>
    <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
      <span class="s0">out += </span><span class="s2">' if (!' </span><span class="s0">+ ($nextValid) + </span><span class="s2">') { '</span><span class="s3">;</span>
    <span class="s0">}</span>
    <span class="s1">if </span><span class="s0">($elsePresent) {</span>
      <span class="s0">$it.schema = it.schema[</span><span class="s2">'else'</span><span class="s0">]</span><span class="s3">;</span>
      <span class="s0">$it.schemaPath = it.schemaPath + </span><span class="s2">'.else'</span><span class="s3">;</span>
      <span class="s0">$it.errSchemaPath = it.errSchemaPath + </span><span class="s2">'/else'</span><span class="s3">;</span>
      <span class="s0">out += </span><span class="s2">'  ' </span><span class="s0">+ (it.validate($it)) + </span><span class="s2">' '</span><span class="s3">;</span>
      <span class="s0">$it.baseId = $currentBaseId</span><span class="s3">;</span>
      <span class="s0">out += </span><span class="s2">' ' </span><span class="s0">+ ($valid) + </span><span class="s2">' = ' </span><span class="s0">+ ($nextValid) + </span><span class="s2">'; '</span><span class="s3">;</span>
      <span class="s1">if </span><span class="s0">($thenPresent &amp;&amp; $elsePresent) {</span>
        <span class="s0">$ifClause = </span><span class="s2">'ifClause' </span><span class="s0">+ $lvl</span><span class="s3">;</span>
        <span class="s0">out += </span><span class="s2">' var ' </span><span class="s0">+ ($ifClause) + </span><span class="s2">' = </span><span class="s3">\'</span><span class="s2">else</span><span class="s3">\'</span><span class="s2">; '</span><span class="s3">;</span>
      <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
        <span class="s0">$ifClause = </span><span class="s2">'</span><span class="s3">\'</span><span class="s2">else</span><span class="s3">\'</span><span class="s2">'</span><span class="s3">;</span>
      <span class="s0">}</span>
      <span class="s0">out += </span><span class="s2">' } '</span><span class="s3">;</span>
    <span class="s0">}</span>
    <span class="s0">out += </span><span class="s2">' if (!' </span><span class="s0">+ ($valid) + </span><span class="s2">') {   var err =   '</span><span class="s3">; </span><span class="s7">/* istanbul ignore else */</span>
    <span class="s1">if </span><span class="s0">(it.createErrors !== </span><span class="s1">false</span><span class="s0">) {</span>
      <span class="s0">out += </span><span class="s2">' { keyword: </span><span class="s3">\'</span><span class="s2">' </span><span class="s0">+ (</span><span class="s2">'if'</span><span class="s0">) + </span><span class="s2">'</span><span class="s3">\' </span><span class="s2">, dataPath: (dataPath || </span><span class="s3">\'\'</span><span class="s2">) + ' </span><span class="s0">+ (it.errorPath) + </span><span class="s2">' , schemaPath: ' </span><span class="s0">+ (it.util.toQuotedString($errSchemaPath)) + </span><span class="s2">' , params: { failingKeyword: ' </span><span class="s0">+ ($ifClause) + </span><span class="s2">' } '</span><span class="s3">;</span>
      <span class="s1">if </span><span class="s0">(it.opts.messages !== </span><span class="s1">false</span><span class="s0">) {</span>
        <span class="s0">out += </span><span class="s2">' , message: </span><span class="s3">\'</span><span class="s2">should match &quot;</span><span class="s3">\' </span><span class="s2">+ ' </span><span class="s0">+ ($ifClause) + </span><span class="s2">' + </span><span class="s3">\'</span><span class="s2">&quot; schema</span><span class="s3">\' </span><span class="s2">'</span><span class="s3">;</span>
      <span class="s0">}</span>
      <span class="s1">if </span><span class="s0">(it.opts.verbose) {</span>
        <span class="s0">out += </span><span class="s2">' , schema: validate.schema' </span><span class="s0">+ ($schemaPath) + </span><span class="s2">' , parentSchema: validate.schema' </span><span class="s0">+ (it.schemaPath) + </span><span class="s2">' , data: ' </span><span class="s0">+ ($data) + </span><span class="s2">' '</span><span class="s3">;</span>
      <span class="s0">}</span>
      <span class="s0">out += </span><span class="s2">' } '</span><span class="s3">;</span>
    <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
      <span class="s0">out += </span><span class="s2">' {} '</span><span class="s3">;</span>
    <span class="s0">}</span>
    <span class="s0">out += </span><span class="s2">';  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; '</span><span class="s3">;</span>
    <span class="s1">if </span><span class="s0">(!it.compositeRule &amp;&amp; $breakOnError) {</span>
      <span class="s7">/* istanbul ignore if */</span>
      <span class="s1">if </span><span class="s0">(it.async) {</span>
        <span class="s0">out += </span><span class="s2">' throw new ValidationError(vErrors); '</span><span class="s3">;</span>
      <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
        <span class="s0">out += </span><span class="s2">' validate.errors = vErrors; return false; '</span><span class="s3">;</span>
      <span class="s0">}</span>
    <span class="s0">}</span>
    <span class="s0">out += </span><span class="s2">' }   '</span><span class="s3">;</span>
    <span class="s1">if </span><span class="s0">($breakOnError) {</span>
      <span class="s0">out += </span><span class="s2">' else { '</span><span class="s3">;</span>
    <span class="s0">}</span>
  <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
    <span class="s1">if </span><span class="s0">($breakOnError) {</span>
      <span class="s0">out += </span><span class="s2">' if (true) { '</span><span class="s3">;</span>
    <span class="s0">}</span>
  <span class="s0">}</span>
  <span class="s1">return </span><span class="s0">out</span><span class="s3">;</span>
<span class="s0">}</span>

<span class="s0">}</span><span class="s3">,</span><span class="s0">{}]</span><span class="s3">,</span><span class="s4">27</span><span class="s0">:[</span><span class="s1">function</span><span class="s0">(require</span><span class="s3">,</span><span class="s0">module</span><span class="s3">,</span><span class="s0">exports){</span>
<span class="s2">'use strict'</span><span class="s3">;</span>

<span class="s8">//all requires must be explicit because browserify won't work with dynamic requires</span>
<span class="s0">module.exports = {</span>
  <span class="s2">'$ref'</span><span class="s0">: require(</span><span class="s2">'./ref'</span><span class="s0">)</span><span class="s3">,</span>
  <span class="s0">allOf: require(</span><span class="s2">'./allOf'</span><span class="s0">)</span><span class="s3">,</span>
  <span class="s0">anyOf: require(</span><span class="s2">'./anyOf'</span><span class="s0">)</span><span class="s3">,</span>
  <span class="s2">'$comment'</span><span class="s0">: require(</span><span class="s2">'./comment'</span><span class="s0">)</span><span class="s3">,</span>
  <span class="s1">const</span><span class="s0">: require(</span><span class="s2">'./const'</span><span class="s0">)</span><span class="s3">,</span>
  <span class="s0">contains: require(</span><span class="s2">'./contains'</span><span class="s0">)</span><span class="s3">,</span>
  <span class="s0">dependencies: require(</span><span class="s2">'./dependencies'</span><span class="s0">)</span><span class="s3">,</span>
  <span class="s2">'enum'</span><span class="s0">: require(</span><span class="s2">'./enum'</span><span class="s0">)</span><span class="s3">,</span>
  <span class="s0">format: require(</span><span class="s2">'./format'</span><span class="s0">)</span><span class="s3">,</span>
  <span class="s2">'if'</span><span class="s0">: require(</span><span class="s2">'./if'</span><span class="s0">)</span><span class="s3">,</span>
  <span class="s0">items: require(</span><span class="s2">'./items'</span><span class="s0">)</span><span class="s3">,</span>
  <span class="s0">maximum: require(</span><span class="s2">'./_limit'</span><span class="s0">)</span><span class="s3">,</span>
  <span class="s0">minimum: require(</span><span class="s2">'./_limit'</span><span class="s0">)</span><span class="s3">,</span>
  <span class="s0">maxItems: require(</span><span class="s2">'./_limitItems'</span><span class="s0">)</span><span class="s3">,</span>
  <span class="s0">minItems: require(</span><span class="s2">'./_limitItems'</span><span class="s0">)</span><span class="s3">,</span>
  <span class="s0">maxLength: require(</span><span class="s2">'./_limitLength'</span><span class="s0">)</span><span class="s3">,</span>
  <span class="s0">minLength: require(</span><span class="s2">'./_limitLength'</span><span class="s0">)</span><span class="s3">,</span>
  <span class="s0">maxProperties: require(</span><span class="s2">'./_limitProperties'</span><span class="s0">)</span><span class="s3">,</span>
  <span class="s0">minProperties: require(</span><span class="s2">'./_limitProperties'</span><span class="s0">)</span><span class="s3">,</span>
  <span class="s0">multipleOf: require(</span><span class="s2">'./multipleOf'</span><span class="s0">)</span><span class="s3">,</span>
  <span class="s0">not: require(</span><span class="s2">'./not'</span><span class="s0">)</span><span class="s3">,</span>
  <span class="s0">oneOf: require(</span><span class="s2">'./oneOf'</span><span class="s0">)</span><span class="s3">,</span>
  <span class="s0">pattern: require(</span><span class="s2">'./pattern'</span><span class="s0">)</span><span class="s3">,</span>
  <span class="s0">properties: require(</span><span class="s2">'./properties'</span><span class="s0">)</span><span class="s3">,</span>
  <span class="s0">propertyNames: require(</span><span class="s2">'./propertyNames'</span><span class="s0">)</span><span class="s3">,</span>
  <span class="s0">required: require(</span><span class="s2">'./required'</span><span class="s0">)</span><span class="s3">,</span>
  <span class="s0">uniqueItems: require(</span><span class="s2">'./uniqueItems'</span><span class="s0">)</span><span class="s3">,</span>
  <span class="s0">validate: require(</span><span class="s2">'./validate'</span><span class="s0">)</span>
<span class="s0">}</span><span class="s3">;</span>

<span class="s0">}</span><span class="s3">,</span><span class="s0">{</span><span class="s2">&quot;./_limit&quot;</span><span class="s0">:</span><span class="s4">13</span><span class="s3">,</span><span class="s2">&quot;./_limitItems&quot;</span><span class="s0">:</span><span class="s4">14</span><span class="s3">,</span><span class="s2">&quot;./_limitLength&quot;</span><span class="s0">:</span><span class="s4">15</span><span class="s3">,</span><span class="s2">&quot;./_limitProperties&quot;</span><span class="s0">:</span><span class="s4">16</span><span class="s3">,</span><span class="s2">&quot;./allOf&quot;</span><span class="s0">:</span><span class="s4">17</span><span class="s3">,</span><span class="s2">&quot;./anyOf&quot;</span><span class="s0">:</span><span class="s4">18</span><span class="s3">,</span><span class="s2">&quot;./comment&quot;</span><span class="s0">:</span><span class="s4">19</span><span class="s3">,</span><span class="s2">&quot;./const&quot;</span><span class="s0">:</span><span class="s4">20</span><span class="s3">,</span><span class="s2">&quot;./contains&quot;</span><span class="s0">:</span><span class="s4">21</span><span class="s3">,</span><span class="s2">&quot;./dependencies&quot;</span><span class="s0">:</span><span class="s4">23</span><span class="s3">,</span><span class="s2">&quot;./enum&quot;</span><span class="s0">:</span><span class="s4">24</span><span class="s3">,</span><span class="s2">&quot;./format&quot;</span><span class="s0">:</span><span class="s4">25</span><span class="s3">,</span><span class="s2">&quot;./if&quot;</span><span class="s0">:</span><span class="s4">26</span><span class="s3">,</span><span class="s2">&quot;./items&quot;</span><span class="s0">:</span><span class="s4">28</span><span class="s3">,</span><span class="s2">&quot;./multipleOf&quot;</span><span class="s0">:</span><span class="s4">29</span><span class="s3">,</span><span class="s2">&quot;./not&quot;</span><span class="s0">:</span><span class="s4">30</span><span class="s3">,</span><span class="s2">&quot;./oneOf&quot;</span><span class="s0">:</span><span class="s4">31</span><span class="s3">,</span><span class="s2">&quot;./pattern&quot;</span><span class="s0">:</span><span class="s4">32</span><span class="s3">,</span><span class="s2">&quot;./properties&quot;</span><span class="s0">:</span><span class="s4">33</span><span class="s3">,</span><span class="s2">&quot;./propertyNames&quot;</span><span class="s0">:</span><span class="s4">34</span><span class="s3">,</span><span class="s2">&quot;./ref&quot;</span><span class="s0">:</span><span class="s4">35</span><span class="s3">,</span><span class="s2">&quot;./required&quot;</span><span class="s0">:</span><span class="s4">36</span><span class="s3">,</span><span class="s2">&quot;./uniqueItems&quot;</span><span class="s0">:</span><span class="s4">37</span><span class="s3">,</span><span class="s2">&quot;./validate&quot;</span><span class="s0">:</span><span class="s4">38</span><span class="s0">}]</span><span class="s3">,</span><span class="s4">28</span><span class="s0">:[</span><span class="s1">function</span><span class="s0">(require</span><span class="s3">,</span><span class="s0">module</span><span class="s3">,</span><span class="s0">exports){</span>
<span class="s2">'use strict'</span><span class="s3">;</span>
<span class="s0">module.exports = </span><span class="s1">function </span><span class="s0">generate_items(it</span><span class="s3">, </span><span class="s0">$keyword</span><span class="s3">, </span><span class="s0">$ruleType) {</span>
  <span class="s1">var </span><span class="s0">out = </span><span class="s2">' '</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$lvl = it.level</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$dataLvl = it.dataLevel</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$schema = it.schema[$keyword]</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$schemaPath = it.schemaPath + it.util.getProperty($keyword)</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$errSchemaPath = it.errSchemaPath + </span><span class="s2">'/' </span><span class="s0">+ $keyword</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$breakOnError = !it.opts.allErrors</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$data = </span><span class="s2">'data' </span><span class="s0">+ ($dataLvl || </span><span class="s2">''</span><span class="s0">)</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$valid = </span><span class="s2">'valid' </span><span class="s0">+ $lvl</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$errs = </span><span class="s2">'errs__' </span><span class="s0">+ $lvl</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$it = it.util.copy(it)</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$closingBraces = </span><span class="s2">''</span><span class="s3">;</span>
  <span class="s0">$it.level++</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$nextValid = </span><span class="s2">'valid' </span><span class="s0">+ $it.level</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$idx = </span><span class="s2">'i' </span><span class="s0">+ $lvl</span><span class="s3">,</span>
    <span class="s0">$dataNxt = $it.dataLevel = it.dataLevel + </span><span class="s4">1</span><span class="s3">,</span>
    <span class="s0">$nextData = </span><span class="s2">'data' </span><span class="s0">+ $dataNxt</span><span class="s3">,</span>
    <span class="s0">$currentBaseId = it.baseId</span><span class="s3">;</span>
  <span class="s0">out += </span><span class="s2">'var ' </span><span class="s0">+ ($errs) + </span><span class="s2">' = errors;var ' </span><span class="s0">+ ($valid) + </span><span class="s2">';'</span><span class="s3">;</span>
  <span class="s1">if </span><span class="s0">(Array.isArray($schema)) {</span>
    <span class="s1">var </span><span class="s0">$additionalItems = it.schema.additionalItems</span><span class="s3">;</span>
    <span class="s1">if </span><span class="s0">($additionalItems === </span><span class="s1">false</span><span class="s0">) {</span>
      <span class="s0">out += </span><span class="s2">' ' </span><span class="s0">+ ($valid) + </span><span class="s2">' = ' </span><span class="s0">+ ($data) + </span><span class="s2">'.length &lt;= ' </span><span class="s0">+ ($schema.length) + </span><span class="s2">'; '</span><span class="s3">;</span>
      <span class="s1">var </span><span class="s0">$currErrSchemaPath = $errSchemaPath</span><span class="s3">;</span>
      <span class="s0">$errSchemaPath = it.errSchemaPath + </span><span class="s2">'/additionalItems'</span><span class="s3">;</span>
      <span class="s0">out += </span><span class="s2">'  if (!' </span><span class="s0">+ ($valid) + </span><span class="s2">') {   '</span><span class="s3">;</span>
      <span class="s1">var </span><span class="s0">$$outStack = $$outStack || []</span><span class="s3">;</span>
      <span class="s0">$$outStack.push(out)</span><span class="s3">;</span>
      <span class="s0">out = </span><span class="s2">''</span><span class="s3">; </span><span class="s7">/* istanbul ignore else */</span>
      <span class="s1">if </span><span class="s0">(it.createErrors !== </span><span class="s1">false</span><span class="s0">) {</span>
        <span class="s0">out += </span><span class="s2">' { keyword: </span><span class="s3">\'</span><span class="s2">' </span><span class="s0">+ (</span><span class="s2">'additionalItems'</span><span class="s0">) + </span><span class="s2">'</span><span class="s3">\' </span><span class="s2">, dataPath: (dataPath || </span><span class="s3">\'\'</span><span class="s2">) + ' </span><span class="s0">+ (it.errorPath) + </span><span class="s2">' , schemaPath: ' </span><span class="s0">+ (it.util.toQuotedString($errSchemaPath)) + </span><span class="s2">' , params: { limit: ' </span><span class="s0">+ ($schema.length) + </span><span class="s2">' } '</span><span class="s3">;</span>
        <span class="s1">if </span><span class="s0">(it.opts.messages !== </span><span class="s1">false</span><span class="s0">) {</span>
          <span class="s0">out += </span><span class="s2">' , message: </span><span class="s3">\'</span><span class="s2">should NOT have more than ' </span><span class="s0">+ ($schema.length) + </span><span class="s2">' items</span><span class="s3">\' </span><span class="s2">'</span><span class="s3">;</span>
        <span class="s0">}</span>
        <span class="s1">if </span><span class="s0">(it.opts.verbose) {</span>
          <span class="s0">out += </span><span class="s2">' , schema: false , parentSchema: validate.schema' </span><span class="s0">+ (it.schemaPath) + </span><span class="s2">' , data: ' </span><span class="s0">+ ($data) + </span><span class="s2">' '</span><span class="s3">;</span>
        <span class="s0">}</span>
        <span class="s0">out += </span><span class="s2">' } '</span><span class="s3">;</span>
      <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
        <span class="s0">out += </span><span class="s2">' {} '</span><span class="s3">;</span>
      <span class="s0">}</span>
      <span class="s1">var </span><span class="s0">__err = out</span><span class="s3">;</span>
      <span class="s0">out = $$outStack.pop()</span><span class="s3">;</span>
      <span class="s1">if </span><span class="s0">(!it.compositeRule &amp;&amp; $breakOnError) {</span>
        <span class="s7">/* istanbul ignore if */</span>
        <span class="s1">if </span><span class="s0">(it.async) {</span>
          <span class="s0">out += </span><span class="s2">' throw new ValidationError([' </span><span class="s0">+ (__err) + </span><span class="s2">']); '</span><span class="s3">;</span>
        <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
          <span class="s0">out += </span><span class="s2">' validate.errors = [' </span><span class="s0">+ (__err) + </span><span class="s2">']; return false; '</span><span class="s3">;</span>
        <span class="s0">}</span>
      <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
        <span class="s0">out += </span><span class="s2">' var err = ' </span><span class="s0">+ (__err) + </span><span class="s2">';  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; '</span><span class="s3">;</span>
      <span class="s0">}</span>
      <span class="s0">out += </span><span class="s2">' } '</span><span class="s3">;</span>
      <span class="s0">$errSchemaPath = $currErrSchemaPath</span><span class="s3">;</span>
      <span class="s1">if </span><span class="s0">($breakOnError) {</span>
        <span class="s0">$closingBraces += </span><span class="s2">'}'</span><span class="s3">;</span>
        <span class="s0">out += </span><span class="s2">' else { '</span><span class="s3">;</span>
      <span class="s0">}</span>
    <span class="s0">}</span>
    <span class="s1">var </span><span class="s0">arr1 = $schema</span><span class="s3">;</span>
    <span class="s1">if </span><span class="s0">(arr1) {</span>
      <span class="s1">var </span><span class="s0">$sch</span><span class="s3">, </span><span class="s0">$i = -</span><span class="s4">1</span><span class="s3">,</span>
        <span class="s0">l1 = arr1.length - </span><span class="s4">1</span><span class="s3">;</span>
      <span class="s1">while </span><span class="s0">($i &lt; l1) {</span>
        <span class="s0">$sch = arr1[$i += </span><span class="s4">1</span><span class="s0">]</span><span class="s3">;</span>
        <span class="s1">if </span><span class="s0">((it.opts.strictKeywords ? (</span><span class="s1">typeof </span><span class="s0">$sch == </span><span class="s2">'object' </span><span class="s0">&amp;&amp; Object.keys($sch).length &gt; </span><span class="s4">0</span><span class="s0">) || $sch === </span><span class="s1">false </span><span class="s0">: it.util.schemaHasRules($sch</span><span class="s3">, </span><span class="s0">it.RULES.all))) {</span>
          <span class="s0">out += </span><span class="s2">' ' </span><span class="s0">+ ($nextValid) + </span><span class="s2">' = true; if (' </span><span class="s0">+ ($data) + </span><span class="s2">'.length &gt; ' </span><span class="s0">+ ($i) + </span><span class="s2">') { '</span><span class="s3">;</span>
          <span class="s1">var </span><span class="s0">$passData = $data + </span><span class="s2">'[' </span><span class="s0">+ $i + </span><span class="s2">']'</span><span class="s3">;</span>
          <span class="s0">$it.schema = $sch</span><span class="s3">;</span>
          <span class="s0">$it.schemaPath = $schemaPath + </span><span class="s2">'[' </span><span class="s0">+ $i + </span><span class="s2">']'</span><span class="s3">;</span>
          <span class="s0">$it.errSchemaPath = $errSchemaPath + </span><span class="s2">'/' </span><span class="s0">+ $i</span><span class="s3">;</span>
          <span class="s0">$it.errorPath = it.util.getPathExpr(it.errorPath</span><span class="s3">, </span><span class="s0">$i</span><span class="s3">, </span><span class="s0">it.opts.jsonPointers</span><span class="s3">, </span><span class="s1">true</span><span class="s0">)</span><span class="s3">;</span>
          <span class="s0">$it.dataPathArr[$dataNxt] = $i</span><span class="s3">;</span>
          <span class="s1">var </span><span class="s0">$code = it.validate($it)</span><span class="s3">;</span>
          <span class="s0">$it.baseId = $currentBaseId</span><span class="s3">;</span>
          <span class="s1">if </span><span class="s0">(it.util.varOccurences($code</span><span class="s3">, </span><span class="s0">$nextData) &lt; </span><span class="s4">2</span><span class="s0">) {</span>
            <span class="s0">out += </span><span class="s2">' ' </span><span class="s0">+ (it.util.varReplace($code</span><span class="s3">, </span><span class="s0">$nextData</span><span class="s3">, </span><span class="s0">$passData)) + </span><span class="s2">' '</span><span class="s3">;</span>
          <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
            <span class="s0">out += </span><span class="s2">' var ' </span><span class="s0">+ ($nextData) + </span><span class="s2">' = ' </span><span class="s0">+ ($passData) + </span><span class="s2">'; ' </span><span class="s0">+ ($code) + </span><span class="s2">' '</span><span class="s3">;</span>
          <span class="s0">}</span>
          <span class="s0">out += </span><span class="s2">' }  '</span><span class="s3">;</span>
          <span class="s1">if </span><span class="s0">($breakOnError) {</span>
            <span class="s0">out += </span><span class="s2">' if (' </span><span class="s0">+ ($nextValid) + </span><span class="s2">') { '</span><span class="s3">;</span>
            <span class="s0">$closingBraces += </span><span class="s2">'}'</span><span class="s3">;</span>
          <span class="s0">}</span>
        <span class="s0">}</span>
      <span class="s0">}</span>
    <span class="s0">}</span>
    <span class="s1">if </span><span class="s0">(</span><span class="s1">typeof </span><span class="s0">$additionalItems == </span><span class="s2">'object' </span><span class="s0">&amp;&amp; (it.opts.strictKeywords ? (</span><span class="s1">typeof </span><span class="s0">$additionalItems == </span><span class="s2">'object' </span><span class="s0">&amp;&amp; Object.keys($additionalItems).length &gt; </span><span class="s4">0</span><span class="s0">) || $additionalItems === </span><span class="s1">false </span><span class="s0">: it.util.schemaHasRules($additionalItems</span><span class="s3">, </span><span class="s0">it.RULES.all))) {</span>
      <span class="s0">$it.schema = $additionalItems</span><span class="s3">;</span>
      <span class="s0">$it.schemaPath = it.schemaPath + </span><span class="s2">'.additionalItems'</span><span class="s3">;</span>
      <span class="s0">$it.errSchemaPath = it.errSchemaPath + </span><span class="s2">'/additionalItems'</span><span class="s3">;</span>
      <span class="s0">out += </span><span class="s2">' ' </span><span class="s0">+ ($nextValid) + </span><span class="s2">' = true; if (' </span><span class="s0">+ ($data) + </span><span class="s2">'.length &gt; ' </span><span class="s0">+ ($schema.length) + </span><span class="s2">') {  for (var ' </span><span class="s0">+ ($idx) + </span><span class="s2">' = ' </span><span class="s0">+ ($schema.length) + </span><span class="s2">'; ' </span><span class="s0">+ ($idx) + </span><span class="s2">' &lt; ' </span><span class="s0">+ ($data) + </span><span class="s2">'.length; ' </span><span class="s0">+ ($idx) + </span><span class="s2">'++) { '</span><span class="s3">;</span>
      <span class="s0">$it.errorPath = it.util.getPathExpr(it.errorPath</span><span class="s3">, </span><span class="s0">$idx</span><span class="s3">, </span><span class="s0">it.opts.jsonPointers</span><span class="s3">, </span><span class="s1">true</span><span class="s0">)</span><span class="s3">;</span>
      <span class="s1">var </span><span class="s0">$passData = $data + </span><span class="s2">'[' </span><span class="s0">+ $idx + </span><span class="s2">']'</span><span class="s3">;</span>
      <span class="s0">$it.dataPathArr[$dataNxt] = $idx</span><span class="s3">;</span>
      <span class="s1">var </span><span class="s0">$code = it.validate($it)</span><span class="s3">;</span>
      <span class="s0">$it.baseId = $currentBaseId</span><span class="s3">;</span>
      <span class="s1">if </span><span class="s0">(it.util.varOccurences($code</span><span class="s3">, </span><span class="s0">$nextData) &lt; </span><span class="s4">2</span><span class="s0">) {</span>
        <span class="s0">out += </span><span class="s2">' ' </span><span class="s0">+ (it.util.varReplace($code</span><span class="s3">, </span><span class="s0">$nextData</span><span class="s3">, </span><span class="s0">$passData)) + </span><span class="s2">' '</span><span class="s3">;</span>
      <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
        <span class="s0">out += </span><span class="s2">' var ' </span><span class="s0">+ ($nextData) + </span><span class="s2">' = ' </span><span class="s0">+ ($passData) + </span><span class="s2">'; ' </span><span class="s0">+ ($code) + </span><span class="s2">' '</span><span class="s3">;</span>
      <span class="s0">}</span>
      <span class="s1">if </span><span class="s0">($breakOnError) {</span>
        <span class="s0">out += </span><span class="s2">' if (!' </span><span class="s0">+ ($nextValid) + </span><span class="s2">') break; '</span><span class="s3">;</span>
      <span class="s0">}</span>
      <span class="s0">out += </span><span class="s2">' } }  '</span><span class="s3">;</span>
      <span class="s1">if </span><span class="s0">($breakOnError) {</span>
        <span class="s0">out += </span><span class="s2">' if (' </span><span class="s0">+ ($nextValid) + </span><span class="s2">') { '</span><span class="s3">;</span>
        <span class="s0">$closingBraces += </span><span class="s2">'}'</span><span class="s3">;</span>
      <span class="s0">}</span>
    <span class="s0">}</span>
  <span class="s0">} </span><span class="s1">else if </span><span class="s0">((it.opts.strictKeywords ? (</span><span class="s1">typeof </span><span class="s0">$schema == </span><span class="s2">'object' </span><span class="s0">&amp;&amp; Object.keys($schema).length &gt; </span><span class="s4">0</span><span class="s0">) || $schema === </span><span class="s1">false </span><span class="s0">: it.util.schemaHasRules($schema</span><span class="s3">, </span><span class="s0">it.RULES.all))) {</span>
    <span class="s0">$it.schema = $schema</span><span class="s3">;</span>
    <span class="s0">$it.schemaPath = $schemaPath</span><span class="s3">;</span>
    <span class="s0">$it.errSchemaPath = $errSchemaPath</span><span class="s3">;</span>
    <span class="s0">out += </span><span class="s2">'  for (var ' </span><span class="s0">+ ($idx) + </span><span class="s2">' = ' </span><span class="s0">+ (</span><span class="s4">0</span><span class="s0">) + </span><span class="s2">'; ' </span><span class="s0">+ ($idx) + </span><span class="s2">' &lt; ' </span><span class="s0">+ ($data) + </span><span class="s2">'.length; ' </span><span class="s0">+ ($idx) + </span><span class="s2">'++) { '</span><span class="s3">;</span>
    <span class="s0">$it.errorPath = it.util.getPathExpr(it.errorPath</span><span class="s3">, </span><span class="s0">$idx</span><span class="s3">, </span><span class="s0">it.opts.jsonPointers</span><span class="s3">, </span><span class="s1">true</span><span class="s0">)</span><span class="s3">;</span>
    <span class="s1">var </span><span class="s0">$passData = $data + </span><span class="s2">'[' </span><span class="s0">+ $idx + </span><span class="s2">']'</span><span class="s3">;</span>
    <span class="s0">$it.dataPathArr[$dataNxt] = $idx</span><span class="s3">;</span>
    <span class="s1">var </span><span class="s0">$code = it.validate($it)</span><span class="s3">;</span>
    <span class="s0">$it.baseId = $currentBaseId</span><span class="s3">;</span>
    <span class="s1">if </span><span class="s0">(it.util.varOccurences($code</span><span class="s3">, </span><span class="s0">$nextData) &lt; </span><span class="s4">2</span><span class="s0">) {</span>
      <span class="s0">out += </span><span class="s2">' ' </span><span class="s0">+ (it.util.varReplace($code</span><span class="s3">, </span><span class="s0">$nextData</span><span class="s3">, </span><span class="s0">$passData)) + </span><span class="s2">' '</span><span class="s3">;</span>
    <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
      <span class="s0">out += </span><span class="s2">' var ' </span><span class="s0">+ ($nextData) + </span><span class="s2">' = ' </span><span class="s0">+ ($passData) + </span><span class="s2">'; ' </span><span class="s0">+ ($code) + </span><span class="s2">' '</span><span class="s3">;</span>
    <span class="s0">}</span>
    <span class="s1">if </span><span class="s0">($breakOnError) {</span>
      <span class="s0">out += </span><span class="s2">' if (!' </span><span class="s0">+ ($nextValid) + </span><span class="s2">') break; '</span><span class="s3">;</span>
    <span class="s0">}</span>
    <span class="s0">out += </span><span class="s2">' }'</span><span class="s3">;</span>
  <span class="s0">}</span>
  <span class="s1">if </span><span class="s0">($breakOnError) {</span>
    <span class="s0">out += </span><span class="s2">' ' </span><span class="s0">+ ($closingBraces) + </span><span class="s2">' if (' </span><span class="s0">+ ($errs) + </span><span class="s2">' == errors) {'</span><span class="s3">;</span>
  <span class="s0">}</span>
  <span class="s1">return </span><span class="s0">out</span><span class="s3">;</span>
<span class="s0">}</span>

<span class="s0">}</span><span class="s3">,</span><span class="s0">{}]</span><span class="s3">,</span><span class="s4">29</span><span class="s0">:[</span><span class="s1">function</span><span class="s0">(require</span><span class="s3">,</span><span class="s0">module</span><span class="s3">,</span><span class="s0">exports){</span>
<span class="s2">'use strict'</span><span class="s3">;</span>
<span class="s0">module.exports = </span><span class="s1">function </span><span class="s0">generate_multipleOf(it</span><span class="s3">, </span><span class="s0">$keyword</span><span class="s3">, </span><span class="s0">$ruleType) {</span>
  <span class="s1">var </span><span class="s0">out = </span><span class="s2">' '</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$lvl = it.level</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$dataLvl = it.dataLevel</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$schema = it.schema[$keyword]</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$schemaPath = it.schemaPath + it.util.getProperty($keyword)</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$errSchemaPath = it.errSchemaPath + </span><span class="s2">'/' </span><span class="s0">+ $keyword</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$breakOnError = !it.opts.allErrors</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$data = </span><span class="s2">'data' </span><span class="s0">+ ($dataLvl || </span><span class="s2">''</span><span class="s0">)</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$isData = it.opts.$data &amp;&amp; $schema &amp;&amp; $schema.$data</span><span class="s3">,</span>
    <span class="s0">$schemaValue</span><span class="s3">;</span>
  <span class="s1">if </span><span class="s0">($isData) {</span>
    <span class="s0">out += </span><span class="s2">' var schema' </span><span class="s0">+ ($lvl) + </span><span class="s2">' = ' </span><span class="s0">+ (it.util.getData($schema.$data</span><span class="s3">, </span><span class="s0">$dataLvl</span><span class="s3">, </span><span class="s0">it.dataPathArr)) + </span><span class="s2">'; '</span><span class="s3">;</span>
    <span class="s0">$schemaValue = </span><span class="s2">'schema' </span><span class="s0">+ $lvl</span><span class="s3">;</span>
  <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
    <span class="s0">$schemaValue = $schema</span><span class="s3">;</span>
  <span class="s0">}</span>
  <span class="s1">if </span><span class="s0">(!($isData || </span><span class="s1">typeof </span><span class="s0">$schema == </span><span class="s2">'number'</span><span class="s0">)) {</span>
    <span class="s1">throw new </span><span class="s0">Error($keyword + </span><span class="s2">' must be number'</span><span class="s0">)</span><span class="s3">;</span>
  <span class="s0">}</span>
  <span class="s0">out += </span><span class="s2">'var division' </span><span class="s0">+ ($lvl) + </span><span class="s2">';if ('</span><span class="s3">;</span>
  <span class="s1">if </span><span class="s0">($isData) {</span>
    <span class="s0">out += </span><span class="s2">' ' </span><span class="s0">+ ($schemaValue) + </span><span class="s2">' !== undefined &amp;&amp; ( typeof ' </span><span class="s0">+ ($schemaValue) + </span><span class="s2">' != </span><span class="s3">\'</span><span class="s2">number</span><span class="s3">\' </span><span class="s2">|| '</span><span class="s3">;</span>
  <span class="s0">}</span>
  <span class="s0">out += </span><span class="s2">' (division' </span><span class="s0">+ ($lvl) + </span><span class="s2">' = ' </span><span class="s0">+ ($data) + </span><span class="s2">' / ' </span><span class="s0">+ ($schemaValue) + </span><span class="s2">', '</span><span class="s3">;</span>
  <span class="s1">if </span><span class="s0">(it.opts.multipleOfPrecision) {</span>
    <span class="s0">out += </span><span class="s2">' Math.abs(Math.round(division' </span><span class="s0">+ ($lvl) + </span><span class="s2">') - division' </span><span class="s0">+ ($lvl) + </span><span class="s2">') &gt; 1e-' </span><span class="s0">+ (it.opts.multipleOfPrecision) + </span><span class="s2">' '</span><span class="s3">;</span>
  <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
    <span class="s0">out += </span><span class="s2">' division' </span><span class="s0">+ ($lvl) + </span><span class="s2">' !== parseInt(division' </span><span class="s0">+ ($lvl) + </span><span class="s2">') '</span><span class="s3">;</span>
  <span class="s0">}</span>
  <span class="s0">out += </span><span class="s2">' ) '</span><span class="s3">;</span>
  <span class="s1">if </span><span class="s0">($isData) {</span>
    <span class="s0">out += </span><span class="s2">'  )  '</span><span class="s3">;</span>
  <span class="s0">}</span>
  <span class="s0">out += </span><span class="s2">' ) {   '</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$$outStack = $$outStack || []</span><span class="s3">;</span>
  <span class="s0">$$outStack.push(out)</span><span class="s3">;</span>
  <span class="s0">out = </span><span class="s2">''</span><span class="s3">; </span><span class="s7">/* istanbul ignore else */</span>
  <span class="s1">if </span><span class="s0">(it.createErrors !== </span><span class="s1">false</span><span class="s0">) {</span>
    <span class="s0">out += </span><span class="s2">' { keyword: </span><span class="s3">\'</span><span class="s2">' </span><span class="s0">+ (</span><span class="s2">'multipleOf'</span><span class="s0">) + </span><span class="s2">'</span><span class="s3">\' </span><span class="s2">, dataPath: (dataPath || </span><span class="s3">\'\'</span><span class="s2">) + ' </span><span class="s0">+ (it.errorPath) + </span><span class="s2">' , schemaPath: ' </span><span class="s0">+ (it.util.toQuotedString($errSchemaPath)) + </span><span class="s2">' , params: { multipleOf: ' </span><span class="s0">+ ($schemaValue) + </span><span class="s2">' } '</span><span class="s3">;</span>
    <span class="s1">if </span><span class="s0">(it.opts.messages !== </span><span class="s1">false</span><span class="s0">) {</span>
      <span class="s0">out += </span><span class="s2">' , message: </span><span class="s3">\'</span><span class="s2">should be multiple of '</span><span class="s3">;</span>
      <span class="s1">if </span><span class="s0">($isData) {</span>
        <span class="s0">out += </span><span class="s2">'</span><span class="s3">\' </span><span class="s2">+ ' </span><span class="s0">+ ($schemaValue)</span><span class="s3">;</span>
      <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
        <span class="s0">out += </span><span class="s2">'' </span><span class="s0">+ ($schemaValue) + </span><span class="s2">'</span><span class="s3">\'</span><span class="s2">'</span><span class="s3">;</span>
      <span class="s0">}</span>
    <span class="s0">}</span>
    <span class="s1">if </span><span class="s0">(it.opts.verbose) {</span>
      <span class="s0">out += </span><span class="s2">' , schema:  '</span><span class="s3">;</span>
      <span class="s1">if </span><span class="s0">($isData) {</span>
        <span class="s0">out += </span><span class="s2">'validate.schema' </span><span class="s0">+ ($schemaPath)</span><span class="s3">;</span>
      <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
        <span class="s0">out += </span><span class="s2">'' </span><span class="s0">+ ($schema)</span><span class="s3">;</span>
      <span class="s0">}</span>
      <span class="s0">out += </span><span class="s2">'         , parentSchema: validate.schema' </span><span class="s0">+ (it.schemaPath) + </span><span class="s2">' , data: ' </span><span class="s0">+ ($data) + </span><span class="s2">' '</span><span class="s3">;</span>
    <span class="s0">}</span>
    <span class="s0">out += </span><span class="s2">' } '</span><span class="s3">;</span>
  <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
    <span class="s0">out += </span><span class="s2">' {} '</span><span class="s3">;</span>
  <span class="s0">}</span>
  <span class="s1">var </span><span class="s0">__err = out</span><span class="s3">;</span>
  <span class="s0">out = $$outStack.pop()</span><span class="s3">;</span>
  <span class="s1">if </span><span class="s0">(!it.compositeRule &amp;&amp; $breakOnError) {</span>
    <span class="s7">/* istanbul ignore if */</span>
    <span class="s1">if </span><span class="s0">(it.async) {</span>
      <span class="s0">out += </span><span class="s2">' throw new ValidationError([' </span><span class="s0">+ (__err) + </span><span class="s2">']); '</span><span class="s3">;</span>
    <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
      <span class="s0">out += </span><span class="s2">' validate.errors = [' </span><span class="s0">+ (__err) + </span><span class="s2">']; return false; '</span><span class="s3">;</span>
    <span class="s0">}</span>
  <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
    <span class="s0">out += </span><span class="s2">' var err = ' </span><span class="s0">+ (__err) + </span><span class="s2">';  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; '</span><span class="s3">;</span>
  <span class="s0">}</span>
  <span class="s0">out += </span><span class="s2">'} '</span><span class="s3">;</span>
  <span class="s1">if </span><span class="s0">($breakOnError) {</span>
    <span class="s0">out += </span><span class="s2">' else { '</span><span class="s3">;</span>
  <span class="s0">}</span>
  <span class="s1">return </span><span class="s0">out</span><span class="s3">;</span>
<span class="s0">}</span>

<span class="s0">}</span><span class="s3">,</span><span class="s0">{}]</span><span class="s3">,</span><span class="s4">30</span><span class="s0">:[</span><span class="s1">function</span><span class="s0">(require</span><span class="s3">,</span><span class="s0">module</span><span class="s3">,</span><span class="s0">exports){</span>
<span class="s2">'use strict'</span><span class="s3">;</span>
<span class="s0">module.exports = </span><span class="s1">function </span><span class="s0">generate_not(it</span><span class="s3">, </span><span class="s0">$keyword</span><span class="s3">, </span><span class="s0">$ruleType) {</span>
  <span class="s1">var </span><span class="s0">out = </span><span class="s2">' '</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$lvl = it.level</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$dataLvl = it.dataLevel</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$schema = it.schema[$keyword]</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$schemaPath = it.schemaPath + it.util.getProperty($keyword)</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$errSchemaPath = it.errSchemaPath + </span><span class="s2">'/' </span><span class="s0">+ $keyword</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$breakOnError = !it.opts.allErrors</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$data = </span><span class="s2">'data' </span><span class="s0">+ ($dataLvl || </span><span class="s2">''</span><span class="s0">)</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$errs = </span><span class="s2">'errs__' </span><span class="s0">+ $lvl</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$it = it.util.copy(it)</span><span class="s3">;</span>
  <span class="s0">$it.level++</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$nextValid = </span><span class="s2">'valid' </span><span class="s0">+ $it.level</span><span class="s3">;</span>
  <span class="s1">if </span><span class="s0">((it.opts.strictKeywords ? (</span><span class="s1">typeof </span><span class="s0">$schema == </span><span class="s2">'object' </span><span class="s0">&amp;&amp; Object.keys($schema).length &gt; </span><span class="s4">0</span><span class="s0">) || $schema === </span><span class="s1">false </span><span class="s0">: it.util.schemaHasRules($schema</span><span class="s3">, </span><span class="s0">it.RULES.all))) {</span>
    <span class="s0">$it.schema = $schema</span><span class="s3">;</span>
    <span class="s0">$it.schemaPath = $schemaPath</span><span class="s3">;</span>
    <span class="s0">$it.errSchemaPath = $errSchemaPath</span><span class="s3">;</span>
    <span class="s0">out += </span><span class="s2">' var ' </span><span class="s0">+ ($errs) + </span><span class="s2">' = errors;  '</span><span class="s3">;</span>
    <span class="s1">var </span><span class="s0">$wasComposite = it.compositeRule</span><span class="s3">;</span>
    <span class="s0">it.compositeRule = $it.compositeRule = </span><span class="s1">true</span><span class="s3">;</span>
    <span class="s0">$it.createErrors = </span><span class="s1">false</span><span class="s3">;</span>
    <span class="s1">var </span><span class="s0">$allErrorsOption</span><span class="s3">;</span>
    <span class="s1">if </span><span class="s0">($it.opts.allErrors) {</span>
      <span class="s0">$allErrorsOption = $it.opts.allErrors</span><span class="s3">;</span>
      <span class="s0">$it.opts.allErrors = </span><span class="s1">false</span><span class="s3">;</span>
    <span class="s0">}</span>
    <span class="s0">out += </span><span class="s2">' ' </span><span class="s0">+ (it.validate($it)) + </span><span class="s2">' '</span><span class="s3">;</span>
    <span class="s0">$it.createErrors = </span><span class="s1">true</span><span class="s3">;</span>
    <span class="s1">if </span><span class="s0">($allErrorsOption) $it.opts.allErrors = $allErrorsOption</span><span class="s3">;</span>
    <span class="s0">it.compositeRule = $it.compositeRule = $wasComposite</span><span class="s3">;</span>
    <span class="s0">out += </span><span class="s2">' if (' </span><span class="s0">+ ($nextValid) + </span><span class="s2">') {   '</span><span class="s3">;</span>
    <span class="s1">var </span><span class="s0">$$outStack = $$outStack || []</span><span class="s3">;</span>
    <span class="s0">$$outStack.push(out)</span><span class="s3">;</span>
    <span class="s0">out = </span><span class="s2">''</span><span class="s3">; </span><span class="s7">/* istanbul ignore else */</span>
    <span class="s1">if </span><span class="s0">(it.createErrors !== </span><span class="s1">false</span><span class="s0">) {</span>
      <span class="s0">out += </span><span class="s2">' { keyword: </span><span class="s3">\'</span><span class="s2">' </span><span class="s0">+ (</span><span class="s2">'not'</span><span class="s0">) + </span><span class="s2">'</span><span class="s3">\' </span><span class="s2">, dataPath: (dataPath || </span><span class="s3">\'\'</span><span class="s2">) + ' </span><span class="s0">+ (it.errorPath) + </span><span class="s2">' , schemaPath: ' </span><span class="s0">+ (it.util.toQuotedString($errSchemaPath)) + </span><span class="s2">' , params: {} '</span><span class="s3">;</span>
      <span class="s1">if </span><span class="s0">(it.opts.messages !== </span><span class="s1">false</span><span class="s0">) {</span>
        <span class="s0">out += </span><span class="s2">' , message: </span><span class="s3">\'</span><span class="s2">should NOT be valid</span><span class="s3">\' </span><span class="s2">'</span><span class="s3">;</span>
      <span class="s0">}</span>
      <span class="s1">if </span><span class="s0">(it.opts.verbose) {</span>
        <span class="s0">out += </span><span class="s2">' , schema: validate.schema' </span><span class="s0">+ ($schemaPath) + </span><span class="s2">' , parentSchema: validate.schema' </span><span class="s0">+ (it.schemaPath) + </span><span class="s2">' , data: ' </span><span class="s0">+ ($data) + </span><span class="s2">' '</span><span class="s3">;</span>
      <span class="s0">}</span>
      <span class="s0">out += </span><span class="s2">' } '</span><span class="s3">;</span>
    <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
      <span class="s0">out += </span><span class="s2">' {} '</span><span class="s3">;</span>
    <span class="s0">}</span>
    <span class="s1">var </span><span class="s0">__err = out</span><span class="s3">;</span>
    <span class="s0">out = $$outStack.pop()</span><span class="s3">;</span>
    <span class="s1">if </span><span class="s0">(!it.compositeRule &amp;&amp; $breakOnError) {</span>
      <span class="s7">/* istanbul ignore if */</span>
      <span class="s1">if </span><span class="s0">(it.async) {</span>
        <span class="s0">out += </span><span class="s2">' throw new ValidationError([' </span><span class="s0">+ (__err) + </span><span class="s2">']); '</span><span class="s3">;</span>
      <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
        <span class="s0">out += </span><span class="s2">' validate.errors = [' </span><span class="s0">+ (__err) + </span><span class="s2">']; return false; '</span><span class="s3">;</span>
      <span class="s0">}</span>
    <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
      <span class="s0">out += </span><span class="s2">' var err = ' </span><span class="s0">+ (__err) + </span><span class="s2">';  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; '</span><span class="s3">;</span>
    <span class="s0">}</span>
    <span class="s0">out += </span><span class="s2">' } else {  errors = ' </span><span class="s0">+ ($errs) + </span><span class="s2">'; if (vErrors !== null) { if (' </span><span class="s0">+ ($errs) + </span><span class="s2">') vErrors.length = ' </span><span class="s0">+ ($errs) + </span><span class="s2">'; else vErrors = null; } '</span><span class="s3">;</span>
    <span class="s1">if </span><span class="s0">(it.opts.allErrors) {</span>
      <span class="s0">out += </span><span class="s2">' } '</span><span class="s3">;</span>
    <span class="s0">}</span>
  <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
    <span class="s0">out += </span><span class="s2">'  var err =   '</span><span class="s3">; </span><span class="s7">/* istanbul ignore else */</span>
    <span class="s1">if </span><span class="s0">(it.createErrors !== </span><span class="s1">false</span><span class="s0">) {</span>
      <span class="s0">out += </span><span class="s2">' { keyword: </span><span class="s3">\'</span><span class="s2">' </span><span class="s0">+ (</span><span class="s2">'not'</span><span class="s0">) + </span><span class="s2">'</span><span class="s3">\' </span><span class="s2">, dataPath: (dataPath || </span><span class="s3">\'\'</span><span class="s2">) + ' </span><span class="s0">+ (it.errorPath) + </span><span class="s2">' , schemaPath: ' </span><span class="s0">+ (it.util.toQuotedString($errSchemaPath)) + </span><span class="s2">' , params: {} '</span><span class="s3">;</span>
      <span class="s1">if </span><span class="s0">(it.opts.messages !== </span><span class="s1">false</span><span class="s0">) {</span>
        <span class="s0">out += </span><span class="s2">' , message: </span><span class="s3">\'</span><span class="s2">should NOT be valid</span><span class="s3">\' </span><span class="s2">'</span><span class="s3">;</span>
      <span class="s0">}</span>
      <span class="s1">if </span><span class="s0">(it.opts.verbose) {</span>
        <span class="s0">out += </span><span class="s2">' , schema: validate.schema' </span><span class="s0">+ ($schemaPath) + </span><span class="s2">' , parentSchema: validate.schema' </span><span class="s0">+ (it.schemaPath) + </span><span class="s2">' , data: ' </span><span class="s0">+ ($data) + </span><span class="s2">' '</span><span class="s3">;</span>
      <span class="s0">}</span>
      <span class="s0">out += </span><span class="s2">' } '</span><span class="s3">;</span>
    <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
      <span class="s0">out += </span><span class="s2">' {} '</span><span class="s3">;</span>
    <span class="s0">}</span>
    <span class="s0">out += </span><span class="s2">';  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; '</span><span class="s3">;</span>
    <span class="s1">if </span><span class="s0">($breakOnError) {</span>
      <span class="s0">out += </span><span class="s2">' if (false) { '</span><span class="s3">;</span>
    <span class="s0">}</span>
  <span class="s0">}</span>
  <span class="s1">return </span><span class="s0">out</span><span class="s3">;</span>
<span class="s0">}</span>

<span class="s0">}</span><span class="s3">,</span><span class="s0">{}]</span><span class="s3">,</span><span class="s4">31</span><span class="s0">:[</span><span class="s1">function</span><span class="s0">(require</span><span class="s3">,</span><span class="s0">module</span><span class="s3">,</span><span class="s0">exports){</span>
<span class="s2">'use strict'</span><span class="s3">;</span>
<span class="s0">module.exports = </span><span class="s1">function </span><span class="s0">generate_oneOf(it</span><span class="s3">, </span><span class="s0">$keyword</span><span class="s3">, </span><span class="s0">$ruleType) {</span>
  <span class="s1">var </span><span class="s0">out = </span><span class="s2">' '</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$lvl = it.level</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$dataLvl = it.dataLevel</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$schema = it.schema[$keyword]</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$schemaPath = it.schemaPath + it.util.getProperty($keyword)</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$errSchemaPath = it.errSchemaPath + </span><span class="s2">'/' </span><span class="s0">+ $keyword</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$breakOnError = !it.opts.allErrors</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$data = </span><span class="s2">'data' </span><span class="s0">+ ($dataLvl || </span><span class="s2">''</span><span class="s0">)</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$valid = </span><span class="s2">'valid' </span><span class="s0">+ $lvl</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$errs = </span><span class="s2">'errs__' </span><span class="s0">+ $lvl</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$it = it.util.copy(it)</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$closingBraces = </span><span class="s2">''</span><span class="s3">;</span>
  <span class="s0">$it.level++</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$nextValid = </span><span class="s2">'valid' </span><span class="s0">+ $it.level</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$currentBaseId = $it.baseId</span><span class="s3">,</span>
    <span class="s0">$prevValid = </span><span class="s2">'prevValid' </span><span class="s0">+ $lvl</span><span class="s3">,</span>
    <span class="s0">$passingSchemas = </span><span class="s2">'passingSchemas' </span><span class="s0">+ $lvl</span><span class="s3">;</span>
  <span class="s0">out += </span><span class="s2">'var ' </span><span class="s0">+ ($errs) + </span><span class="s2">' = errors , ' </span><span class="s0">+ ($prevValid) + </span><span class="s2">' = false , ' </span><span class="s0">+ ($valid) + </span><span class="s2">' = false , ' </span><span class="s0">+ ($passingSchemas) + </span><span class="s2">' = null; '</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$wasComposite = it.compositeRule</span><span class="s3">;</span>
  <span class="s0">it.compositeRule = $it.compositeRule = </span><span class="s1">true</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">arr1 = $schema</span><span class="s3">;</span>
  <span class="s1">if </span><span class="s0">(arr1) {</span>
    <span class="s1">var </span><span class="s0">$sch</span><span class="s3">, </span><span class="s0">$i = -</span><span class="s4">1</span><span class="s3">,</span>
      <span class="s0">l1 = arr1.length - </span><span class="s4">1</span><span class="s3">;</span>
    <span class="s1">while </span><span class="s0">($i &lt; l1) {</span>
      <span class="s0">$sch = arr1[$i += </span><span class="s4">1</span><span class="s0">]</span><span class="s3">;</span>
      <span class="s1">if </span><span class="s0">((it.opts.strictKeywords ? (</span><span class="s1">typeof </span><span class="s0">$sch == </span><span class="s2">'object' </span><span class="s0">&amp;&amp; Object.keys($sch).length &gt; </span><span class="s4">0</span><span class="s0">) || $sch === </span><span class="s1">false </span><span class="s0">: it.util.schemaHasRules($sch</span><span class="s3">, </span><span class="s0">it.RULES.all))) {</span>
        <span class="s0">$it.schema = $sch</span><span class="s3">;</span>
        <span class="s0">$it.schemaPath = $schemaPath + </span><span class="s2">'[' </span><span class="s0">+ $i + </span><span class="s2">']'</span><span class="s3">;</span>
        <span class="s0">$it.errSchemaPath = $errSchemaPath + </span><span class="s2">'/' </span><span class="s0">+ $i</span><span class="s3">;</span>
        <span class="s0">out += </span><span class="s2">'  ' </span><span class="s0">+ (it.validate($it)) + </span><span class="s2">' '</span><span class="s3">;</span>
        <span class="s0">$it.baseId = $currentBaseId</span><span class="s3">;</span>
      <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
        <span class="s0">out += </span><span class="s2">' var ' </span><span class="s0">+ ($nextValid) + </span><span class="s2">' = true; '</span><span class="s3">;</span>
      <span class="s0">}</span>
      <span class="s1">if </span><span class="s0">($i) {</span>
        <span class="s0">out += </span><span class="s2">' if (' </span><span class="s0">+ ($nextValid) + </span><span class="s2">' &amp;&amp; ' </span><span class="s0">+ ($prevValid) + </span><span class="s2">') { ' </span><span class="s0">+ ($valid) + </span><span class="s2">' = false; ' </span><span class="s0">+ ($passingSchemas) + </span><span class="s2">' = [' </span><span class="s0">+ ($passingSchemas) + </span><span class="s2">', ' </span><span class="s0">+ ($i) + </span><span class="s2">']; } else { '</span><span class="s3">;</span>
        <span class="s0">$closingBraces += </span><span class="s2">'}'</span><span class="s3">;</span>
      <span class="s0">}</span>
      <span class="s0">out += </span><span class="s2">' if (' </span><span class="s0">+ ($nextValid) + </span><span class="s2">') { ' </span><span class="s0">+ ($valid) + </span><span class="s2">' = ' </span><span class="s0">+ ($prevValid) + </span><span class="s2">' = true; ' </span><span class="s0">+ ($passingSchemas) + </span><span class="s2">' = ' </span><span class="s0">+ ($i) + </span><span class="s2">'; }'</span><span class="s3">;</span>
    <span class="s0">}</span>
  <span class="s0">}</span>
  <span class="s0">it.compositeRule = $it.compositeRule = $wasComposite</span><span class="s3">;</span>
  <span class="s0">out += </span><span class="s2">'' </span><span class="s0">+ ($closingBraces) + </span><span class="s2">'if (!' </span><span class="s0">+ ($valid) + </span><span class="s2">') {   var err =   '</span><span class="s3">; </span><span class="s7">/* istanbul ignore else */</span>
  <span class="s1">if </span><span class="s0">(it.createErrors !== </span><span class="s1">false</span><span class="s0">) {</span>
    <span class="s0">out += </span><span class="s2">' { keyword: </span><span class="s3">\'</span><span class="s2">' </span><span class="s0">+ (</span><span class="s2">'oneOf'</span><span class="s0">) + </span><span class="s2">'</span><span class="s3">\' </span><span class="s2">, dataPath: (dataPath || </span><span class="s3">\'\'</span><span class="s2">) + ' </span><span class="s0">+ (it.errorPath) + </span><span class="s2">' , schemaPath: ' </span><span class="s0">+ (it.util.toQuotedString($errSchemaPath)) + </span><span class="s2">' , params: { passingSchemas: ' </span><span class="s0">+ ($passingSchemas) + </span><span class="s2">' } '</span><span class="s3">;</span>
    <span class="s1">if </span><span class="s0">(it.opts.messages !== </span><span class="s1">false</span><span class="s0">) {</span>
      <span class="s0">out += </span><span class="s2">' , message: </span><span class="s3">\'</span><span class="s2">should match exactly one schema in oneOf</span><span class="s3">\' </span><span class="s2">'</span><span class="s3">;</span>
    <span class="s0">}</span>
    <span class="s1">if </span><span class="s0">(it.opts.verbose) {</span>
      <span class="s0">out += </span><span class="s2">' , schema: validate.schema' </span><span class="s0">+ ($schemaPath) + </span><span class="s2">' , parentSchema: validate.schema' </span><span class="s0">+ (it.schemaPath) + </span><span class="s2">' , data: ' </span><span class="s0">+ ($data) + </span><span class="s2">' '</span><span class="s3">;</span>
    <span class="s0">}</span>
    <span class="s0">out += </span><span class="s2">' } '</span><span class="s3">;</span>
  <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
    <span class="s0">out += </span><span class="s2">' {} '</span><span class="s3">;</span>
  <span class="s0">}</span>
  <span class="s0">out += </span><span class="s2">';  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; '</span><span class="s3">;</span>
  <span class="s1">if </span><span class="s0">(!it.compositeRule &amp;&amp; $breakOnError) {</span>
    <span class="s7">/* istanbul ignore if */</span>
    <span class="s1">if </span><span class="s0">(it.async) {</span>
      <span class="s0">out += </span><span class="s2">' throw new ValidationError(vErrors); '</span><span class="s3">;</span>
    <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
      <span class="s0">out += </span><span class="s2">' validate.errors = vErrors; return false; '</span><span class="s3">;</span>
    <span class="s0">}</span>
  <span class="s0">}</span>
  <span class="s0">out += </span><span class="s2">'} else {  errors = ' </span><span class="s0">+ ($errs) + </span><span class="s2">'; if (vErrors !== null) { if (' </span><span class="s0">+ ($errs) + </span><span class="s2">') vErrors.length = ' </span><span class="s0">+ ($errs) + </span><span class="s2">'; else vErrors = null; }'</span><span class="s3">;</span>
  <span class="s1">if </span><span class="s0">(it.opts.allErrors) {</span>
    <span class="s0">out += </span><span class="s2">' } '</span><span class="s3">;</span>
  <span class="s0">}</span>
  <span class="s1">return </span><span class="s0">out</span><span class="s3">;</span>
<span class="s0">}</span>

<span class="s0">}</span><span class="s3">,</span><span class="s0">{}]</span><span class="s3">,</span><span class="s4">32</span><span class="s0">:[</span><span class="s1">function</span><span class="s0">(require</span><span class="s3">,</span><span class="s0">module</span><span class="s3">,</span><span class="s0">exports){</span>
<span class="s2">'use strict'</span><span class="s3">;</span>
<span class="s0">module.exports = </span><span class="s1">function </span><span class="s0">generate_pattern(it</span><span class="s3">, </span><span class="s0">$keyword</span><span class="s3">, </span><span class="s0">$ruleType) {</span>
  <span class="s1">var </span><span class="s0">out = </span><span class="s2">' '</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$lvl = it.level</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$dataLvl = it.dataLevel</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$schema = it.schema[$keyword]</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$schemaPath = it.schemaPath + it.util.getProperty($keyword)</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$errSchemaPath = it.errSchemaPath + </span><span class="s2">'/' </span><span class="s0">+ $keyword</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$breakOnError = !it.opts.allErrors</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$data = </span><span class="s2">'data' </span><span class="s0">+ ($dataLvl || </span><span class="s2">''</span><span class="s0">)</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$isData = it.opts.$data &amp;&amp; $schema &amp;&amp; $schema.$data</span><span class="s3">,</span>
    <span class="s0">$schemaValue</span><span class="s3">;</span>
  <span class="s1">if </span><span class="s0">($isData) {</span>
    <span class="s0">out += </span><span class="s2">' var schema' </span><span class="s0">+ ($lvl) + </span><span class="s2">' = ' </span><span class="s0">+ (it.util.getData($schema.$data</span><span class="s3">, </span><span class="s0">$dataLvl</span><span class="s3">, </span><span class="s0">it.dataPathArr)) + </span><span class="s2">'; '</span><span class="s3">;</span>
    <span class="s0">$schemaValue = </span><span class="s2">'schema' </span><span class="s0">+ $lvl</span><span class="s3">;</span>
  <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
    <span class="s0">$schemaValue = $schema</span><span class="s3">;</span>
  <span class="s0">}</span>
  <span class="s1">var </span><span class="s0">$regexp = $isData ? </span><span class="s2">'(new RegExp(' </span><span class="s0">+ $schemaValue + </span><span class="s2">'))' </span><span class="s0">: it.usePattern($schema)</span><span class="s3">;</span>
  <span class="s0">out += </span><span class="s2">'if ( '</span><span class="s3">;</span>
  <span class="s1">if </span><span class="s0">($isData) {</span>
    <span class="s0">out += </span><span class="s2">' (' </span><span class="s0">+ ($schemaValue) + </span><span class="s2">' !== undefined &amp;&amp; typeof ' </span><span class="s0">+ ($schemaValue) + </span><span class="s2">' != </span><span class="s3">\'</span><span class="s2">string</span><span class="s3">\'</span><span class="s2">) || '</span><span class="s3">;</span>
  <span class="s0">}</span>
  <span class="s0">out += </span><span class="s2">' !' </span><span class="s0">+ ($regexp) + </span><span class="s2">'.test(' </span><span class="s0">+ ($data) + </span><span class="s2">') ) {   '</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$$outStack = $$outStack || []</span><span class="s3">;</span>
  <span class="s0">$$outStack.push(out)</span><span class="s3">;</span>
  <span class="s0">out = </span><span class="s2">''</span><span class="s3">; </span><span class="s7">/* istanbul ignore else */</span>
  <span class="s1">if </span><span class="s0">(it.createErrors !== </span><span class="s1">false</span><span class="s0">) {</span>
    <span class="s0">out += </span><span class="s2">' { keyword: </span><span class="s3">\'</span><span class="s2">' </span><span class="s0">+ (</span><span class="s2">'pattern'</span><span class="s0">) + </span><span class="s2">'</span><span class="s3">\' </span><span class="s2">, dataPath: (dataPath || </span><span class="s3">\'\'</span><span class="s2">) + ' </span><span class="s0">+ (it.errorPath) + </span><span class="s2">' , schemaPath: ' </span><span class="s0">+ (it.util.toQuotedString($errSchemaPath)) + </span><span class="s2">' , params: { pattern:  '</span><span class="s3">;</span>
    <span class="s1">if </span><span class="s0">($isData) {</span>
      <span class="s0">out += </span><span class="s2">'' </span><span class="s0">+ ($schemaValue)</span><span class="s3">;</span>
    <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
      <span class="s0">out += </span><span class="s2">'' </span><span class="s0">+ (it.util.toQuotedString($schema))</span><span class="s3">;</span>
    <span class="s0">}</span>
    <span class="s0">out += </span><span class="s2">'  } '</span><span class="s3">;</span>
    <span class="s1">if </span><span class="s0">(it.opts.messages !== </span><span class="s1">false</span><span class="s0">) {</span>
      <span class="s0">out += </span><span class="s2">' , message: </span><span class="s3">\'</span><span class="s2">should match pattern &quot;'</span><span class="s3">;</span>
      <span class="s1">if </span><span class="s0">($isData) {</span>
        <span class="s0">out += </span><span class="s2">'</span><span class="s3">\' </span><span class="s2">+ ' </span><span class="s0">+ ($schemaValue) + </span><span class="s2">' + </span><span class="s3">\'</span><span class="s2">'</span><span class="s3">;</span>
      <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
        <span class="s0">out += </span><span class="s2">'' </span><span class="s0">+ (it.util.escapeQuotes($schema))</span><span class="s3">;</span>
      <span class="s0">}</span>
      <span class="s0">out += </span><span class="s2">'&quot;</span><span class="s3">\' </span><span class="s2">'</span><span class="s3">;</span>
    <span class="s0">}</span>
    <span class="s1">if </span><span class="s0">(it.opts.verbose) {</span>
      <span class="s0">out += </span><span class="s2">' , schema:  '</span><span class="s3">;</span>
      <span class="s1">if </span><span class="s0">($isData) {</span>
        <span class="s0">out += </span><span class="s2">'validate.schema' </span><span class="s0">+ ($schemaPath)</span><span class="s3">;</span>
      <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
        <span class="s0">out += </span><span class="s2">'' </span><span class="s0">+ (it.util.toQuotedString($schema))</span><span class="s3">;</span>
      <span class="s0">}</span>
      <span class="s0">out += </span><span class="s2">'         , parentSchema: validate.schema' </span><span class="s0">+ (it.schemaPath) + </span><span class="s2">' , data: ' </span><span class="s0">+ ($data) + </span><span class="s2">' '</span><span class="s3">;</span>
    <span class="s0">}</span>
    <span class="s0">out += </span><span class="s2">' } '</span><span class="s3">;</span>
  <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
    <span class="s0">out += </span><span class="s2">' {} '</span><span class="s3">;</span>
  <span class="s0">}</span>
  <span class="s1">var </span><span class="s0">__err = out</span><span class="s3">;</span>
  <span class="s0">out = $$outStack.pop()</span><span class="s3">;</span>
  <span class="s1">if </span><span class="s0">(!it.compositeRule &amp;&amp; $breakOnError) {</span>
    <span class="s7">/* istanbul ignore if */</span>
    <span class="s1">if </span><span class="s0">(it.async) {</span>
      <span class="s0">out += </span><span class="s2">' throw new ValidationError([' </span><span class="s0">+ (__err) + </span><span class="s2">']); '</span><span class="s3">;</span>
    <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
      <span class="s0">out += </span><span class="s2">' validate.errors = [' </span><span class="s0">+ (__err) + </span><span class="s2">']; return false; '</span><span class="s3">;</span>
    <span class="s0">}</span>
  <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
    <span class="s0">out += </span><span class="s2">' var err = ' </span><span class="s0">+ (__err) + </span><span class="s2">';  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; '</span><span class="s3">;</span>
  <span class="s0">}</span>
  <span class="s0">out += </span><span class="s2">'} '</span><span class="s3">;</span>
  <span class="s1">if </span><span class="s0">($breakOnError) {</span>
    <span class="s0">out += </span><span class="s2">' else { '</span><span class="s3">;</span>
  <span class="s0">}</span>
  <span class="s1">return </span><span class="s0">out</span><span class="s3">;</span>
<span class="s0">}</span>

<span class="s0">}</span><span class="s3">,</span><span class="s0">{}]</span><span class="s3">,</span><span class="s4">33</span><span class="s0">:[</span><span class="s1">function</span><span class="s0">(require</span><span class="s3">,</span><span class="s0">module</span><span class="s3">,</span><span class="s0">exports){</span>
<span class="s2">'use strict'</span><span class="s3">;</span>
<span class="s0">module.exports = </span><span class="s1">function </span><span class="s0">generate_properties(it</span><span class="s3">, </span><span class="s0">$keyword</span><span class="s3">, </span><span class="s0">$ruleType) {</span>
  <span class="s1">var </span><span class="s0">out = </span><span class="s2">' '</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$lvl = it.level</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$dataLvl = it.dataLevel</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$schema = it.schema[$keyword]</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$schemaPath = it.schemaPath + it.util.getProperty($keyword)</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$errSchemaPath = it.errSchemaPath + </span><span class="s2">'/' </span><span class="s0">+ $keyword</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$breakOnError = !it.opts.allErrors</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$data = </span><span class="s2">'data' </span><span class="s0">+ ($dataLvl || </span><span class="s2">''</span><span class="s0">)</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$errs = </span><span class="s2">'errs__' </span><span class="s0">+ $lvl</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$it = it.util.copy(it)</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$closingBraces = </span><span class="s2">''</span><span class="s3">;</span>
  <span class="s0">$it.level++</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$nextValid = </span><span class="s2">'valid' </span><span class="s0">+ $it.level</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$key = </span><span class="s2">'key' </span><span class="s0">+ $lvl</span><span class="s3">,</span>
    <span class="s0">$idx = </span><span class="s2">'idx' </span><span class="s0">+ $lvl</span><span class="s3">,</span>
    <span class="s0">$dataNxt = $it.dataLevel = it.dataLevel + </span><span class="s4">1</span><span class="s3">,</span>
    <span class="s0">$nextData = </span><span class="s2">'data' </span><span class="s0">+ $dataNxt</span><span class="s3">,</span>
    <span class="s0">$dataProperties = </span><span class="s2">'dataProperties' </span><span class="s0">+ $lvl</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$schemaKeys = Object.keys($schema || {}).filter(notProto)</span><span class="s3">,</span>
    <span class="s0">$pProperties = it.schema.patternProperties || {}</span><span class="s3">,</span>
    <span class="s0">$pPropertyKeys = Object.keys($pProperties).filter(notProto)</span><span class="s3">,</span>
    <span class="s0">$aProperties = it.schema.additionalProperties</span><span class="s3">,</span>
    <span class="s0">$someProperties = $schemaKeys.length || $pPropertyKeys.length</span><span class="s3">,</span>
    <span class="s0">$noAdditional = $aProperties === </span><span class="s1">false</span><span class="s3">,</span>
    <span class="s0">$additionalIsSchema = </span><span class="s1">typeof </span><span class="s0">$aProperties == </span><span class="s2">'object' </span><span class="s0">&amp;&amp; Object.keys($aProperties).length</span><span class="s3">,</span>
    <span class="s0">$removeAdditional = it.opts.removeAdditional</span><span class="s3">,</span>
    <span class="s0">$checkAdditional = $noAdditional || $additionalIsSchema || $removeAdditional</span><span class="s3">,</span>
    <span class="s0">$ownProperties = it.opts.ownProperties</span><span class="s3">,</span>
    <span class="s0">$currentBaseId = it.baseId</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$required = it.schema.required</span><span class="s3">;</span>
  <span class="s1">if </span><span class="s0">($required &amp;&amp; !(it.opts.$data &amp;&amp; $required.$data) &amp;&amp; $required.length &lt; it.opts.loopRequired) {</span>
    <span class="s1">var </span><span class="s0">$requiredHash = it.util.toHash($required)</span><span class="s3">;</span>
  <span class="s0">}</span>

  <span class="s1">function </span><span class="s0">notProto(p) {</span>
    <span class="s1">return </span><span class="s0">p !== </span><span class="s2">'__proto__'</span><span class="s3">;</span>
  <span class="s0">}</span>
  <span class="s0">out += </span><span class="s2">'var ' </span><span class="s0">+ ($errs) + </span><span class="s2">' = errors;var ' </span><span class="s0">+ ($nextValid) + </span><span class="s2">' = true;'</span><span class="s3">;</span>
  <span class="s1">if </span><span class="s0">($ownProperties) {</span>
    <span class="s0">out += </span><span class="s2">' var ' </span><span class="s0">+ ($dataProperties) + </span><span class="s2">' = undefined;'</span><span class="s3">;</span>
  <span class="s0">}</span>
  <span class="s1">if </span><span class="s0">($checkAdditional) {</span>
    <span class="s1">if </span><span class="s0">($ownProperties) {</span>
      <span class="s0">out += </span><span class="s2">' ' </span><span class="s0">+ ($dataProperties) + </span><span class="s2">' = ' </span><span class="s0">+ ($dataProperties) + </span><span class="s2">' || Object.keys(' </span><span class="s0">+ ($data) + </span><span class="s2">'); for (var ' </span><span class="s0">+ ($idx) + </span><span class="s2">'=0; ' </span><span class="s0">+ ($idx) + </span><span class="s2">'&lt;' </span><span class="s0">+ ($dataProperties) + </span><span class="s2">'.length; ' </span><span class="s0">+ ($idx) + </span><span class="s2">'++) { var ' </span><span class="s0">+ ($key) + </span><span class="s2">' = ' </span><span class="s0">+ ($dataProperties) + </span><span class="s2">'[' </span><span class="s0">+ ($idx) + </span><span class="s2">']; '</span><span class="s3">;</span>
    <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
      <span class="s0">out += </span><span class="s2">' for (var ' </span><span class="s0">+ ($key) + </span><span class="s2">' in ' </span><span class="s0">+ ($data) + </span><span class="s2">') { '</span><span class="s3">;</span>
    <span class="s0">}</span>
    <span class="s1">if </span><span class="s0">($someProperties) {</span>
      <span class="s0">out += </span><span class="s2">' var isAdditional' </span><span class="s0">+ ($lvl) + </span><span class="s2">' = !(false '</span><span class="s3">;</span>
      <span class="s1">if </span><span class="s0">($schemaKeys.length) {</span>
        <span class="s1">if </span><span class="s0">($schemaKeys.length &gt; </span><span class="s4">8</span><span class="s0">) {</span>
          <span class="s0">out += </span><span class="s2">' || validate.schema' </span><span class="s0">+ ($schemaPath) + </span><span class="s2">'.hasOwnProperty(' </span><span class="s0">+ ($key) + </span><span class="s2">') '</span><span class="s3">;</span>
        <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
          <span class="s1">var </span><span class="s0">arr1 = $schemaKeys</span><span class="s3">;</span>
          <span class="s1">if </span><span class="s0">(arr1) {</span>
            <span class="s1">var </span><span class="s0">$propertyKey</span><span class="s3">, </span><span class="s0">i1 = -</span><span class="s4">1</span><span class="s3">,</span>
              <span class="s0">l1 = arr1.length - </span><span class="s4">1</span><span class="s3">;</span>
            <span class="s1">while </span><span class="s0">(i1 &lt; l1) {</span>
              <span class="s0">$propertyKey = arr1[i1 += </span><span class="s4">1</span><span class="s0">]</span><span class="s3">;</span>
              <span class="s0">out += </span><span class="s2">' || ' </span><span class="s0">+ ($key) + </span><span class="s2">' == ' </span><span class="s0">+ (it.util.toQuotedString($propertyKey)) + </span><span class="s2">' '</span><span class="s3">;</span>
            <span class="s0">}</span>
          <span class="s0">}</span>
        <span class="s0">}</span>
      <span class="s0">}</span>
      <span class="s1">if </span><span class="s0">($pPropertyKeys.length) {</span>
        <span class="s1">var </span><span class="s0">arr2 = $pPropertyKeys</span><span class="s3">;</span>
        <span class="s1">if </span><span class="s0">(arr2) {</span>
          <span class="s1">var </span><span class="s0">$pProperty</span><span class="s3">, </span><span class="s0">$i = -</span><span class="s4">1</span><span class="s3">,</span>
            <span class="s0">l2 = arr2.length - </span><span class="s4">1</span><span class="s3">;</span>
          <span class="s1">while </span><span class="s0">($i &lt; l2) {</span>
            <span class="s0">$pProperty = arr2[$i += </span><span class="s4">1</span><span class="s0">]</span><span class="s3">;</span>
            <span class="s0">out += </span><span class="s2">' || ' </span><span class="s0">+ (it.usePattern($pProperty)) + </span><span class="s2">'.test(' </span><span class="s0">+ ($key) + </span><span class="s2">') '</span><span class="s3">;</span>
          <span class="s0">}</span>
        <span class="s0">}</span>
      <span class="s0">}</span>
      <span class="s0">out += </span><span class="s2">' ); if (isAdditional' </span><span class="s0">+ ($lvl) + </span><span class="s2">') { '</span><span class="s3">;</span>
    <span class="s0">}</span>
    <span class="s1">if </span><span class="s0">($removeAdditional == </span><span class="s2">'all'</span><span class="s0">) {</span>
      <span class="s0">out += </span><span class="s2">' delete ' </span><span class="s0">+ ($data) + </span><span class="s2">'[' </span><span class="s0">+ ($key) + </span><span class="s2">']; '</span><span class="s3">;</span>
    <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
      <span class="s1">var </span><span class="s0">$currentErrorPath = it.errorPath</span><span class="s3">;</span>
      <span class="s1">var </span><span class="s0">$additionalProperty = </span><span class="s2">'</span><span class="s3">\' </span><span class="s2">+ ' </span><span class="s0">+ $key + </span><span class="s2">' + </span><span class="s3">\'</span><span class="s2">'</span><span class="s3">;</span>
      <span class="s1">if </span><span class="s0">(it.opts._errorDataPathProperty) {</span>
        <span class="s0">it.errorPath = it.util.getPathExpr(it.errorPath</span><span class="s3">, </span><span class="s0">$key</span><span class="s3">, </span><span class="s0">it.opts.jsonPointers)</span><span class="s3">;</span>
      <span class="s0">}</span>
      <span class="s1">if </span><span class="s0">($noAdditional) {</span>
        <span class="s1">if </span><span class="s0">($removeAdditional) {</span>
          <span class="s0">out += </span><span class="s2">' delete ' </span><span class="s0">+ ($data) + </span><span class="s2">'[' </span><span class="s0">+ ($key) + </span><span class="s2">']; '</span><span class="s3">;</span>
        <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
          <span class="s0">out += </span><span class="s2">' ' </span><span class="s0">+ ($nextValid) + </span><span class="s2">' = false; '</span><span class="s3">;</span>
          <span class="s1">var </span><span class="s0">$currErrSchemaPath = $errSchemaPath</span><span class="s3">;</span>
          <span class="s0">$errSchemaPath = it.errSchemaPath + </span><span class="s2">'/additionalProperties'</span><span class="s3">;</span>
          <span class="s1">var </span><span class="s0">$$outStack = $$outStack || []</span><span class="s3">;</span>
          <span class="s0">$$outStack.push(out)</span><span class="s3">;</span>
          <span class="s0">out = </span><span class="s2">''</span><span class="s3">; </span><span class="s7">/* istanbul ignore else */</span>
          <span class="s1">if </span><span class="s0">(it.createErrors !== </span><span class="s1">false</span><span class="s0">) {</span>
            <span class="s0">out += </span><span class="s2">' { keyword: </span><span class="s3">\'</span><span class="s2">' </span><span class="s0">+ (</span><span class="s2">'additionalProperties'</span><span class="s0">) + </span><span class="s2">'</span><span class="s3">\' </span><span class="s2">, dataPath: (dataPath || </span><span class="s3">\'\'</span><span class="s2">) + ' </span><span class="s0">+ (it.errorPath) + </span><span class="s2">' , schemaPath: ' </span><span class="s0">+ (it.util.toQuotedString($errSchemaPath)) + </span><span class="s2">' , params: { additionalProperty: </span><span class="s3">\'</span><span class="s2">' </span><span class="s0">+ ($additionalProperty) + </span><span class="s2">'</span><span class="s3">\' </span><span class="s2">} '</span><span class="s3">;</span>
            <span class="s1">if </span><span class="s0">(it.opts.messages !== </span><span class="s1">false</span><span class="s0">) {</span>
              <span class="s0">out += </span><span class="s2">' , message: </span><span class="s3">\'</span><span class="s2">'</span><span class="s3">;</span>
              <span class="s1">if </span><span class="s0">(it.opts._errorDataPathProperty) {</span>
                <span class="s0">out += </span><span class="s2">'is an invalid additional property'</span><span class="s3">;</span>
              <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
                <span class="s0">out += </span><span class="s2">'should NOT have additional properties'</span><span class="s3">;</span>
              <span class="s0">}</span>
              <span class="s0">out += </span><span class="s2">'</span><span class="s3">\' </span><span class="s2">'</span><span class="s3">;</span>
            <span class="s0">}</span>
            <span class="s1">if </span><span class="s0">(it.opts.verbose) {</span>
              <span class="s0">out += </span><span class="s2">' , schema: false , parentSchema: validate.schema' </span><span class="s0">+ (it.schemaPath) + </span><span class="s2">' , data: ' </span><span class="s0">+ ($data) + </span><span class="s2">' '</span><span class="s3">;</span>
            <span class="s0">}</span>
            <span class="s0">out += </span><span class="s2">' } '</span><span class="s3">;</span>
          <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
            <span class="s0">out += </span><span class="s2">' {} '</span><span class="s3">;</span>
          <span class="s0">}</span>
          <span class="s1">var </span><span class="s0">__err = out</span><span class="s3">;</span>
          <span class="s0">out = $$outStack.pop()</span><span class="s3">;</span>
          <span class="s1">if </span><span class="s0">(!it.compositeRule &amp;&amp; $breakOnError) {</span>
            <span class="s7">/* istanbul ignore if */</span>
            <span class="s1">if </span><span class="s0">(it.async) {</span>
              <span class="s0">out += </span><span class="s2">' throw new ValidationError([' </span><span class="s0">+ (__err) + </span><span class="s2">']); '</span><span class="s3">;</span>
            <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
              <span class="s0">out += </span><span class="s2">' validate.errors = [' </span><span class="s0">+ (__err) + </span><span class="s2">']; return false; '</span><span class="s3">;</span>
            <span class="s0">}</span>
          <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
            <span class="s0">out += </span><span class="s2">' var err = ' </span><span class="s0">+ (__err) + </span><span class="s2">';  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; '</span><span class="s3">;</span>
          <span class="s0">}</span>
          <span class="s0">$errSchemaPath = $currErrSchemaPath</span><span class="s3">;</span>
          <span class="s1">if </span><span class="s0">($breakOnError) {</span>
            <span class="s0">out += </span><span class="s2">' break; '</span><span class="s3">;</span>
          <span class="s0">}</span>
        <span class="s0">}</span>
      <span class="s0">} </span><span class="s1">else if </span><span class="s0">($additionalIsSchema) {</span>
        <span class="s1">if </span><span class="s0">($removeAdditional == </span><span class="s2">'failing'</span><span class="s0">) {</span>
          <span class="s0">out += </span><span class="s2">' var ' </span><span class="s0">+ ($errs) + </span><span class="s2">' = errors;  '</span><span class="s3">;</span>
          <span class="s1">var </span><span class="s0">$wasComposite = it.compositeRule</span><span class="s3">;</span>
          <span class="s0">it.compositeRule = $it.compositeRule = </span><span class="s1">true</span><span class="s3">;</span>
          <span class="s0">$it.schema = $aProperties</span><span class="s3">;</span>
          <span class="s0">$it.schemaPath = it.schemaPath + </span><span class="s2">'.additionalProperties'</span><span class="s3">;</span>
          <span class="s0">$it.errSchemaPath = it.errSchemaPath + </span><span class="s2">'/additionalProperties'</span><span class="s3">;</span>
          <span class="s0">$it.errorPath = it.opts._errorDataPathProperty ? it.errorPath : it.util.getPathExpr(it.errorPath</span><span class="s3">, </span><span class="s0">$key</span><span class="s3">, </span><span class="s0">it.opts.jsonPointers)</span><span class="s3">;</span>
          <span class="s1">var </span><span class="s0">$passData = $data + </span><span class="s2">'[' </span><span class="s0">+ $key + </span><span class="s2">']'</span><span class="s3">;</span>
          <span class="s0">$it.dataPathArr[$dataNxt] = $key</span><span class="s3">;</span>
          <span class="s1">var </span><span class="s0">$code = it.validate($it)</span><span class="s3">;</span>
          <span class="s0">$it.baseId = $currentBaseId</span><span class="s3">;</span>
          <span class="s1">if </span><span class="s0">(it.util.varOccurences($code</span><span class="s3">, </span><span class="s0">$nextData) &lt; </span><span class="s4">2</span><span class="s0">) {</span>
            <span class="s0">out += </span><span class="s2">' ' </span><span class="s0">+ (it.util.varReplace($code</span><span class="s3">, </span><span class="s0">$nextData</span><span class="s3">, </span><span class="s0">$passData)) + </span><span class="s2">' '</span><span class="s3">;</span>
          <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
            <span class="s0">out += </span><span class="s2">' var ' </span><span class="s0">+ ($nextData) + </span><span class="s2">' = ' </span><span class="s0">+ ($passData) + </span><span class="s2">'; ' </span><span class="s0">+ ($code) + </span><span class="s2">' '</span><span class="s3">;</span>
          <span class="s0">}</span>
          <span class="s0">out += </span><span class="s2">' if (!' </span><span class="s0">+ ($nextValid) + </span><span class="s2">') { errors = ' </span><span class="s0">+ ($errs) + </span><span class="s2">'; if (validate.errors !== null) { if (errors) validate.errors.length = errors; else validate.errors = null; } delete ' </span><span class="s0">+ ($data) + </span><span class="s2">'[' </span><span class="s0">+ ($key) + </span><span class="s2">']; }  '</span><span class="s3">;</span>
          <span class="s0">it.compositeRule = $it.compositeRule = $wasComposite</span><span class="s3">;</span>
        <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
          <span class="s0">$it.schema = $aProperties</span><span class="s3">;</span>
          <span class="s0">$it.schemaPath = it.schemaPath + </span><span class="s2">'.additionalProperties'</span><span class="s3">;</span>
          <span class="s0">$it.errSchemaPath = it.errSchemaPath + </span><span class="s2">'/additionalProperties'</span><span class="s3">;</span>
          <span class="s0">$it.errorPath = it.opts._errorDataPathProperty ? it.errorPath : it.util.getPathExpr(it.errorPath</span><span class="s3">, </span><span class="s0">$key</span><span class="s3">, </span><span class="s0">it.opts.jsonPointers)</span><span class="s3">;</span>
          <span class="s1">var </span><span class="s0">$passData = $data + </span><span class="s2">'[' </span><span class="s0">+ $key + </span><span class="s2">']'</span><span class="s3">;</span>
          <span class="s0">$it.dataPathArr[$dataNxt] = $key</span><span class="s3">;</span>
          <span class="s1">var </span><span class="s0">$code = it.validate($it)</span><span class="s3">;</span>
          <span class="s0">$it.baseId = $currentBaseId</span><span class="s3">;</span>
          <span class="s1">if </span><span class="s0">(it.util.varOccurences($code</span><span class="s3">, </span><span class="s0">$nextData) &lt; </span><span class="s4">2</span><span class="s0">) {</span>
            <span class="s0">out += </span><span class="s2">' ' </span><span class="s0">+ (it.util.varReplace($code</span><span class="s3">, </span><span class="s0">$nextData</span><span class="s3">, </span><span class="s0">$passData)) + </span><span class="s2">' '</span><span class="s3">;</span>
          <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
            <span class="s0">out += </span><span class="s2">' var ' </span><span class="s0">+ ($nextData) + </span><span class="s2">' = ' </span><span class="s0">+ ($passData) + </span><span class="s2">'; ' </span><span class="s0">+ ($code) + </span><span class="s2">' '</span><span class="s3">;</span>
          <span class="s0">}</span>
          <span class="s1">if </span><span class="s0">($breakOnError) {</span>
            <span class="s0">out += </span><span class="s2">' if (!' </span><span class="s0">+ ($nextValid) + </span><span class="s2">') break; '</span><span class="s3">;</span>
          <span class="s0">}</span>
        <span class="s0">}</span>
      <span class="s0">}</span>
      <span class="s0">it.errorPath = $currentErrorPath</span><span class="s3">;</span>
    <span class="s0">}</span>
    <span class="s1">if </span><span class="s0">($someProperties) {</span>
      <span class="s0">out += </span><span class="s2">' } '</span><span class="s3">;</span>
    <span class="s0">}</span>
    <span class="s0">out += </span><span class="s2">' }  '</span><span class="s3">;</span>
    <span class="s1">if </span><span class="s0">($breakOnError) {</span>
      <span class="s0">out += </span><span class="s2">' if (' </span><span class="s0">+ ($nextValid) + </span><span class="s2">') { '</span><span class="s3">;</span>
      <span class="s0">$closingBraces += </span><span class="s2">'}'</span><span class="s3">;</span>
    <span class="s0">}</span>
  <span class="s0">}</span>
  <span class="s1">var </span><span class="s0">$useDefaults = it.opts.useDefaults &amp;&amp; !it.compositeRule</span><span class="s3">;</span>
  <span class="s1">if </span><span class="s0">($schemaKeys.length) {</span>
    <span class="s1">var </span><span class="s0">arr3 = $schemaKeys</span><span class="s3">;</span>
    <span class="s1">if </span><span class="s0">(arr3) {</span>
      <span class="s1">var </span><span class="s0">$propertyKey</span><span class="s3">, </span><span class="s0">i3 = -</span><span class="s4">1</span><span class="s3">,</span>
        <span class="s0">l3 = arr3.length - </span><span class="s4">1</span><span class="s3">;</span>
      <span class="s1">while </span><span class="s0">(i3 &lt; l3) {</span>
        <span class="s0">$propertyKey = arr3[i3 += </span><span class="s4">1</span><span class="s0">]</span><span class="s3">;</span>
        <span class="s1">var </span><span class="s0">$sch = $schema[$propertyKey]</span><span class="s3">;</span>
        <span class="s1">if </span><span class="s0">((it.opts.strictKeywords ? (</span><span class="s1">typeof </span><span class="s0">$sch == </span><span class="s2">'object' </span><span class="s0">&amp;&amp; Object.keys($sch).length &gt; </span><span class="s4">0</span><span class="s0">) || $sch === </span><span class="s1">false </span><span class="s0">: it.util.schemaHasRules($sch</span><span class="s3">, </span><span class="s0">it.RULES.all))) {</span>
          <span class="s1">var </span><span class="s0">$prop = it.util.getProperty($propertyKey)</span><span class="s3">,</span>
            <span class="s0">$passData = $data + $prop</span><span class="s3">,</span>
            <span class="s0">$hasDefault = $useDefaults &amp;&amp; $sch.default !== undefined</span><span class="s3">;</span>
          <span class="s0">$it.schema = $sch</span><span class="s3">;</span>
          <span class="s0">$it.schemaPath = $schemaPath + $prop</span><span class="s3">;</span>
          <span class="s0">$it.errSchemaPath = $errSchemaPath + </span><span class="s2">'/' </span><span class="s0">+ it.util.escapeFragment($propertyKey)</span><span class="s3">;</span>
          <span class="s0">$it.errorPath = it.util.getPath(it.errorPath</span><span class="s3">, </span><span class="s0">$propertyKey</span><span class="s3">, </span><span class="s0">it.opts.jsonPointers)</span><span class="s3">;</span>
          <span class="s0">$it.dataPathArr[$dataNxt] = it.util.toQuotedString($propertyKey)</span><span class="s3">;</span>
          <span class="s1">var </span><span class="s0">$code = it.validate($it)</span><span class="s3">;</span>
          <span class="s0">$it.baseId = $currentBaseId</span><span class="s3">;</span>
          <span class="s1">if </span><span class="s0">(it.util.varOccurences($code</span><span class="s3">, </span><span class="s0">$nextData) &lt; </span><span class="s4">2</span><span class="s0">) {</span>
            <span class="s0">$code = it.util.varReplace($code</span><span class="s3">, </span><span class="s0">$nextData</span><span class="s3">, </span><span class="s0">$passData)</span><span class="s3">;</span>
            <span class="s1">var </span><span class="s0">$useData = $passData</span><span class="s3">;</span>
          <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
            <span class="s1">var </span><span class="s0">$useData = $nextData</span><span class="s3">;</span>
            <span class="s0">out += </span><span class="s2">' var ' </span><span class="s0">+ ($nextData) + </span><span class="s2">' = ' </span><span class="s0">+ ($passData) + </span><span class="s2">'; '</span><span class="s3">;</span>
          <span class="s0">}</span>
          <span class="s1">if </span><span class="s0">($hasDefault) {</span>
            <span class="s0">out += </span><span class="s2">' ' </span><span class="s0">+ ($code) + </span><span class="s2">' '</span><span class="s3">;</span>
          <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
            <span class="s1">if </span><span class="s0">($requiredHash &amp;&amp; $requiredHash[$propertyKey]) {</span>
              <span class="s0">out += </span><span class="s2">' if ( ' </span><span class="s0">+ ($useData) + </span><span class="s2">' === undefined '</span><span class="s3">;</span>
              <span class="s1">if </span><span class="s0">($ownProperties) {</span>
                <span class="s0">out += </span><span class="s2">' || ! Object.prototype.hasOwnProperty.call(' </span><span class="s0">+ ($data) + </span><span class="s2">', </span><span class="s3">\'</span><span class="s2">' </span><span class="s0">+ (it.util.escapeQuotes($propertyKey)) + </span><span class="s2">'</span><span class="s3">\'</span><span class="s2">) '</span><span class="s3">;</span>
              <span class="s0">}</span>
              <span class="s0">out += </span><span class="s2">') { ' </span><span class="s0">+ ($nextValid) + </span><span class="s2">' = false; '</span><span class="s3">;</span>
              <span class="s1">var </span><span class="s0">$currentErrorPath = it.errorPath</span><span class="s3">,</span>
                <span class="s0">$currErrSchemaPath = $errSchemaPath</span><span class="s3">,</span>
                <span class="s0">$missingProperty = it.util.escapeQuotes($propertyKey)</span><span class="s3">;</span>
              <span class="s1">if </span><span class="s0">(it.opts._errorDataPathProperty) {</span>
                <span class="s0">it.errorPath = it.util.getPath($currentErrorPath</span><span class="s3">, </span><span class="s0">$propertyKey</span><span class="s3">, </span><span class="s0">it.opts.jsonPointers)</span><span class="s3">;</span>
              <span class="s0">}</span>
              <span class="s0">$errSchemaPath = it.errSchemaPath + </span><span class="s2">'/required'</span><span class="s3">;</span>
              <span class="s1">var </span><span class="s0">$$outStack = $$outStack || []</span><span class="s3">;</span>
              <span class="s0">$$outStack.push(out)</span><span class="s3">;</span>
              <span class="s0">out = </span><span class="s2">''</span><span class="s3">; </span><span class="s7">/* istanbul ignore else */</span>
              <span class="s1">if </span><span class="s0">(it.createErrors !== </span><span class="s1">false</span><span class="s0">) {</span>
                <span class="s0">out += </span><span class="s2">' { keyword: </span><span class="s3">\'</span><span class="s2">' </span><span class="s0">+ (</span><span class="s2">'required'</span><span class="s0">) + </span><span class="s2">'</span><span class="s3">\' </span><span class="s2">, dataPath: (dataPath || </span><span class="s3">\'\'</span><span class="s2">) + ' </span><span class="s0">+ (it.errorPath) + </span><span class="s2">' , schemaPath: ' </span><span class="s0">+ (it.util.toQuotedString($errSchemaPath)) + </span><span class="s2">' , params: { missingProperty: </span><span class="s3">\'</span><span class="s2">' </span><span class="s0">+ ($missingProperty) + </span><span class="s2">'</span><span class="s3">\' </span><span class="s2">} '</span><span class="s3">;</span>
                <span class="s1">if </span><span class="s0">(it.opts.messages !== </span><span class="s1">false</span><span class="s0">) {</span>
                  <span class="s0">out += </span><span class="s2">' , message: </span><span class="s3">\'</span><span class="s2">'</span><span class="s3">;</span>
                  <span class="s1">if </span><span class="s0">(it.opts._errorDataPathProperty) {</span>
                    <span class="s0">out += </span><span class="s2">'is a required property'</span><span class="s3">;</span>
                  <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
                    <span class="s0">out += </span><span class="s2">'should have required property </span><span class="s3">\\\'</span><span class="s2">' </span><span class="s0">+ ($missingProperty) + </span><span class="s2">'</span><span class="s3">\\\'</span><span class="s2">'</span><span class="s3">;</span>
                  <span class="s0">}</span>
                  <span class="s0">out += </span><span class="s2">'</span><span class="s3">\' </span><span class="s2">'</span><span class="s3">;</span>
                <span class="s0">}</span>
                <span class="s1">if </span><span class="s0">(it.opts.verbose) {</span>
                  <span class="s0">out += </span><span class="s2">' , schema: validate.schema' </span><span class="s0">+ ($schemaPath) + </span><span class="s2">' , parentSchema: validate.schema' </span><span class="s0">+ (it.schemaPath) + </span><span class="s2">' , data: ' </span><span class="s0">+ ($data) + </span><span class="s2">' '</span><span class="s3">;</span>
                <span class="s0">}</span>
                <span class="s0">out += </span><span class="s2">' } '</span><span class="s3">;</span>
              <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
                <span class="s0">out += </span><span class="s2">' {} '</span><span class="s3">;</span>
              <span class="s0">}</span>
              <span class="s1">var </span><span class="s0">__err = out</span><span class="s3">;</span>
              <span class="s0">out = $$outStack.pop()</span><span class="s3">;</span>
              <span class="s1">if </span><span class="s0">(!it.compositeRule &amp;&amp; $breakOnError) {</span>
                <span class="s7">/* istanbul ignore if */</span>
                <span class="s1">if </span><span class="s0">(it.async) {</span>
                  <span class="s0">out += </span><span class="s2">' throw new ValidationError([' </span><span class="s0">+ (__err) + </span><span class="s2">']); '</span><span class="s3">;</span>
                <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
                  <span class="s0">out += </span><span class="s2">' validate.errors = [' </span><span class="s0">+ (__err) + </span><span class="s2">']; return false; '</span><span class="s3">;</span>
                <span class="s0">}</span>
              <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
                <span class="s0">out += </span><span class="s2">' var err = ' </span><span class="s0">+ (__err) + </span><span class="s2">';  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; '</span><span class="s3">;</span>
              <span class="s0">}</span>
              <span class="s0">$errSchemaPath = $currErrSchemaPath</span><span class="s3">;</span>
              <span class="s0">it.errorPath = $currentErrorPath</span><span class="s3">;</span>
              <span class="s0">out += </span><span class="s2">' } else { '</span><span class="s3">;</span>
            <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
              <span class="s1">if </span><span class="s0">($breakOnError) {</span>
                <span class="s0">out += </span><span class="s2">' if ( ' </span><span class="s0">+ ($useData) + </span><span class="s2">' === undefined '</span><span class="s3">;</span>
                <span class="s1">if </span><span class="s0">($ownProperties) {</span>
                  <span class="s0">out += </span><span class="s2">' || ! Object.prototype.hasOwnProperty.call(' </span><span class="s0">+ ($data) + </span><span class="s2">', </span><span class="s3">\'</span><span class="s2">' </span><span class="s0">+ (it.util.escapeQuotes($propertyKey)) + </span><span class="s2">'</span><span class="s3">\'</span><span class="s2">) '</span><span class="s3">;</span>
                <span class="s0">}</span>
                <span class="s0">out += </span><span class="s2">') { ' </span><span class="s0">+ ($nextValid) + </span><span class="s2">' = true; } else { '</span><span class="s3">;</span>
              <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
                <span class="s0">out += </span><span class="s2">' if (' </span><span class="s0">+ ($useData) + </span><span class="s2">' !== undefined '</span><span class="s3">;</span>
                <span class="s1">if </span><span class="s0">($ownProperties) {</span>
                  <span class="s0">out += </span><span class="s2">' &amp;&amp;   Object.prototype.hasOwnProperty.call(' </span><span class="s0">+ ($data) + </span><span class="s2">', </span><span class="s3">\'</span><span class="s2">' </span><span class="s0">+ (it.util.escapeQuotes($propertyKey)) + </span><span class="s2">'</span><span class="s3">\'</span><span class="s2">) '</span><span class="s3">;</span>
                <span class="s0">}</span>
                <span class="s0">out += </span><span class="s2">' ) { '</span><span class="s3">;</span>
              <span class="s0">}</span>
            <span class="s0">}</span>
            <span class="s0">out += </span><span class="s2">' ' </span><span class="s0">+ ($code) + </span><span class="s2">' } '</span><span class="s3">;</span>
          <span class="s0">}</span>
        <span class="s0">}</span>
        <span class="s1">if </span><span class="s0">($breakOnError) {</span>
          <span class="s0">out += </span><span class="s2">' if (' </span><span class="s0">+ ($nextValid) + </span><span class="s2">') { '</span><span class="s3">;</span>
          <span class="s0">$closingBraces += </span><span class="s2">'}'</span><span class="s3">;</span>
        <span class="s0">}</span>
      <span class="s0">}</span>
    <span class="s0">}</span>
  <span class="s0">}</span>
  <span class="s1">if </span><span class="s0">($pPropertyKeys.length) {</span>
    <span class="s1">var </span><span class="s0">arr4 = $pPropertyKeys</span><span class="s3">;</span>
    <span class="s1">if </span><span class="s0">(arr4) {</span>
      <span class="s1">var </span><span class="s0">$pProperty</span><span class="s3">, </span><span class="s0">i4 = -</span><span class="s4">1</span><span class="s3">,</span>
        <span class="s0">l4 = arr4.length - </span><span class="s4">1</span><span class="s3">;</span>
      <span class="s1">while </span><span class="s0">(i4 &lt; l4) {</span>
        <span class="s0">$pProperty = arr4[i4 += </span><span class="s4">1</span><span class="s0">]</span><span class="s3">;</span>
        <span class="s1">var </span><span class="s0">$sch = $pProperties[$pProperty]</span><span class="s3">;</span>
        <span class="s1">if </span><span class="s0">((it.opts.strictKeywords ? (</span><span class="s1">typeof </span><span class="s0">$sch == </span><span class="s2">'object' </span><span class="s0">&amp;&amp; Object.keys($sch).length &gt; </span><span class="s4">0</span><span class="s0">) || $sch === </span><span class="s1">false </span><span class="s0">: it.util.schemaHasRules($sch</span><span class="s3">, </span><span class="s0">it.RULES.all))) {</span>
          <span class="s0">$it.schema = $sch</span><span class="s3">;</span>
          <span class="s0">$it.schemaPath = it.schemaPath + </span><span class="s2">'.patternProperties' </span><span class="s0">+ it.util.getProperty($pProperty)</span><span class="s3">;</span>
          <span class="s0">$it.errSchemaPath = it.errSchemaPath + </span><span class="s2">'/patternProperties/' </span><span class="s0">+ it.util.escapeFragment($pProperty)</span><span class="s3">;</span>
          <span class="s1">if </span><span class="s0">($ownProperties) {</span>
            <span class="s0">out += </span><span class="s2">' ' </span><span class="s0">+ ($dataProperties) + </span><span class="s2">' = ' </span><span class="s0">+ ($dataProperties) + </span><span class="s2">' || Object.keys(' </span><span class="s0">+ ($data) + </span><span class="s2">'); for (var ' </span><span class="s0">+ ($idx) + </span><span class="s2">'=0; ' </span><span class="s0">+ ($idx) + </span><span class="s2">'&lt;' </span><span class="s0">+ ($dataProperties) + </span><span class="s2">'.length; ' </span><span class="s0">+ ($idx) + </span><span class="s2">'++) { var ' </span><span class="s0">+ ($key) + </span><span class="s2">' = ' </span><span class="s0">+ ($dataProperties) + </span><span class="s2">'[' </span><span class="s0">+ ($idx) + </span><span class="s2">']; '</span><span class="s3">;</span>
          <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
            <span class="s0">out += </span><span class="s2">' for (var ' </span><span class="s0">+ ($key) + </span><span class="s2">' in ' </span><span class="s0">+ ($data) + </span><span class="s2">') { '</span><span class="s3">;</span>
          <span class="s0">}</span>
          <span class="s0">out += </span><span class="s2">' if (' </span><span class="s0">+ (it.usePattern($pProperty)) + </span><span class="s2">'.test(' </span><span class="s0">+ ($key) + </span><span class="s2">')) { '</span><span class="s3">;</span>
          <span class="s0">$it.errorPath = it.util.getPathExpr(it.errorPath</span><span class="s3">, </span><span class="s0">$key</span><span class="s3">, </span><span class="s0">it.opts.jsonPointers)</span><span class="s3">;</span>
          <span class="s1">var </span><span class="s0">$passData = $data + </span><span class="s2">'[' </span><span class="s0">+ $key + </span><span class="s2">']'</span><span class="s3">;</span>
          <span class="s0">$it.dataPathArr[$dataNxt] = $key</span><span class="s3">;</span>
          <span class="s1">var </span><span class="s0">$code = it.validate($it)</span><span class="s3">;</span>
          <span class="s0">$it.baseId = $currentBaseId</span><span class="s3">;</span>
          <span class="s1">if </span><span class="s0">(it.util.varOccurences($code</span><span class="s3">, </span><span class="s0">$nextData) &lt; </span><span class="s4">2</span><span class="s0">) {</span>
            <span class="s0">out += </span><span class="s2">' ' </span><span class="s0">+ (it.util.varReplace($code</span><span class="s3">, </span><span class="s0">$nextData</span><span class="s3">, </span><span class="s0">$passData)) + </span><span class="s2">' '</span><span class="s3">;</span>
          <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
            <span class="s0">out += </span><span class="s2">' var ' </span><span class="s0">+ ($nextData) + </span><span class="s2">' = ' </span><span class="s0">+ ($passData) + </span><span class="s2">'; ' </span><span class="s0">+ ($code) + </span><span class="s2">' '</span><span class="s3">;</span>
          <span class="s0">}</span>
          <span class="s1">if </span><span class="s0">($breakOnError) {</span>
            <span class="s0">out += </span><span class="s2">' if (!' </span><span class="s0">+ ($nextValid) + </span><span class="s2">') break; '</span><span class="s3">;</span>
          <span class="s0">}</span>
          <span class="s0">out += </span><span class="s2">' } '</span><span class="s3">;</span>
          <span class="s1">if </span><span class="s0">($breakOnError) {</span>
            <span class="s0">out += </span><span class="s2">' else ' </span><span class="s0">+ ($nextValid) + </span><span class="s2">' = true; '</span><span class="s3">;</span>
          <span class="s0">}</span>
          <span class="s0">out += </span><span class="s2">' }  '</span><span class="s3">;</span>
          <span class="s1">if </span><span class="s0">($breakOnError) {</span>
            <span class="s0">out += </span><span class="s2">' if (' </span><span class="s0">+ ($nextValid) + </span><span class="s2">') { '</span><span class="s3">;</span>
            <span class="s0">$closingBraces += </span><span class="s2">'}'</span><span class="s3">;</span>
          <span class="s0">}</span>
        <span class="s0">}</span>
      <span class="s0">}</span>
    <span class="s0">}</span>
  <span class="s0">}</span>
  <span class="s1">if </span><span class="s0">($breakOnError) {</span>
    <span class="s0">out += </span><span class="s2">' ' </span><span class="s0">+ ($closingBraces) + </span><span class="s2">' if (' </span><span class="s0">+ ($errs) + </span><span class="s2">' == errors) {'</span><span class="s3">;</span>
  <span class="s0">}</span>
  <span class="s1">return </span><span class="s0">out</span><span class="s3">;</span>
<span class="s0">}</span>

<span class="s0">}</span><span class="s3">,</span><span class="s0">{}]</span><span class="s3">,</span><span class="s4">34</span><span class="s0">:[</span><span class="s1">function</span><span class="s0">(require</span><span class="s3">,</span><span class="s0">module</span><span class="s3">,</span><span class="s0">exports){</span>
<span class="s2">'use strict'</span><span class="s3">;</span>
<span class="s0">module.exports = </span><span class="s1">function </span><span class="s0">generate_propertyNames(it</span><span class="s3">, </span><span class="s0">$keyword</span><span class="s3">, </span><span class="s0">$ruleType) {</span>
  <span class="s1">var </span><span class="s0">out = </span><span class="s2">' '</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$lvl = it.level</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$dataLvl = it.dataLevel</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$schema = it.schema[$keyword]</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$schemaPath = it.schemaPath + it.util.getProperty($keyword)</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$errSchemaPath = it.errSchemaPath + </span><span class="s2">'/' </span><span class="s0">+ $keyword</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$breakOnError = !it.opts.allErrors</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$data = </span><span class="s2">'data' </span><span class="s0">+ ($dataLvl || </span><span class="s2">''</span><span class="s0">)</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$errs = </span><span class="s2">'errs__' </span><span class="s0">+ $lvl</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$it = it.util.copy(it)</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$closingBraces = </span><span class="s2">''</span><span class="s3">;</span>
  <span class="s0">$it.level++</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$nextValid = </span><span class="s2">'valid' </span><span class="s0">+ $it.level</span><span class="s3">;</span>
  <span class="s0">out += </span><span class="s2">'var ' </span><span class="s0">+ ($errs) + </span><span class="s2">' = errors;'</span><span class="s3">;</span>
  <span class="s1">if </span><span class="s0">((it.opts.strictKeywords ? (</span><span class="s1">typeof </span><span class="s0">$schema == </span><span class="s2">'object' </span><span class="s0">&amp;&amp; Object.keys($schema).length &gt; </span><span class="s4">0</span><span class="s0">) || $schema === </span><span class="s1">false </span><span class="s0">: it.util.schemaHasRules($schema</span><span class="s3">, </span><span class="s0">it.RULES.all))) {</span>
    <span class="s0">$it.schema = $schema</span><span class="s3">;</span>
    <span class="s0">$it.schemaPath = $schemaPath</span><span class="s3">;</span>
    <span class="s0">$it.errSchemaPath = $errSchemaPath</span><span class="s3">;</span>
    <span class="s1">var </span><span class="s0">$key = </span><span class="s2">'key' </span><span class="s0">+ $lvl</span><span class="s3">,</span>
      <span class="s0">$idx = </span><span class="s2">'idx' </span><span class="s0">+ $lvl</span><span class="s3">,</span>
      <span class="s0">$i = </span><span class="s2">'i' </span><span class="s0">+ $lvl</span><span class="s3">,</span>
      <span class="s0">$invalidName = </span><span class="s2">'</span><span class="s3">\' </span><span class="s2">+ ' </span><span class="s0">+ $key + </span><span class="s2">' + </span><span class="s3">\'</span><span class="s2">'</span><span class="s3">,</span>
      <span class="s0">$dataNxt = $it.dataLevel = it.dataLevel + </span><span class="s4">1</span><span class="s3">,</span>
      <span class="s0">$nextData = </span><span class="s2">'data' </span><span class="s0">+ $dataNxt</span><span class="s3">,</span>
      <span class="s0">$dataProperties = </span><span class="s2">'dataProperties' </span><span class="s0">+ $lvl</span><span class="s3">,</span>
      <span class="s0">$ownProperties = it.opts.ownProperties</span><span class="s3">,</span>
      <span class="s0">$currentBaseId = it.baseId</span><span class="s3">;</span>
    <span class="s1">if </span><span class="s0">($ownProperties) {</span>
      <span class="s0">out += </span><span class="s2">' var ' </span><span class="s0">+ ($dataProperties) + </span><span class="s2">' = undefined; '</span><span class="s3">;</span>
    <span class="s0">}</span>
    <span class="s1">if </span><span class="s0">($ownProperties) {</span>
      <span class="s0">out += </span><span class="s2">' ' </span><span class="s0">+ ($dataProperties) + </span><span class="s2">' = ' </span><span class="s0">+ ($dataProperties) + </span><span class="s2">' || Object.keys(' </span><span class="s0">+ ($data) + </span><span class="s2">'); for (var ' </span><span class="s0">+ ($idx) + </span><span class="s2">'=0; ' </span><span class="s0">+ ($idx) + </span><span class="s2">'&lt;' </span><span class="s0">+ ($dataProperties) + </span><span class="s2">'.length; ' </span><span class="s0">+ ($idx) + </span><span class="s2">'++) { var ' </span><span class="s0">+ ($key) + </span><span class="s2">' = ' </span><span class="s0">+ ($dataProperties) + </span><span class="s2">'[' </span><span class="s0">+ ($idx) + </span><span class="s2">']; '</span><span class="s3">;</span>
    <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
      <span class="s0">out += </span><span class="s2">' for (var ' </span><span class="s0">+ ($key) + </span><span class="s2">' in ' </span><span class="s0">+ ($data) + </span><span class="s2">') { '</span><span class="s3">;</span>
    <span class="s0">}</span>
    <span class="s0">out += </span><span class="s2">' var startErrs' </span><span class="s0">+ ($lvl) + </span><span class="s2">' = errors; '</span><span class="s3">;</span>
    <span class="s1">var </span><span class="s0">$passData = $key</span><span class="s3">;</span>
    <span class="s1">var </span><span class="s0">$wasComposite = it.compositeRule</span><span class="s3">;</span>
    <span class="s0">it.compositeRule = $it.compositeRule = </span><span class="s1">true</span><span class="s3">;</span>
    <span class="s1">var </span><span class="s0">$code = it.validate($it)</span><span class="s3">;</span>
    <span class="s0">$it.baseId = $currentBaseId</span><span class="s3">;</span>
    <span class="s1">if </span><span class="s0">(it.util.varOccurences($code</span><span class="s3">, </span><span class="s0">$nextData) &lt; </span><span class="s4">2</span><span class="s0">) {</span>
      <span class="s0">out += </span><span class="s2">' ' </span><span class="s0">+ (it.util.varReplace($code</span><span class="s3">, </span><span class="s0">$nextData</span><span class="s3">, </span><span class="s0">$passData)) + </span><span class="s2">' '</span><span class="s3">;</span>
    <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
      <span class="s0">out += </span><span class="s2">' var ' </span><span class="s0">+ ($nextData) + </span><span class="s2">' = ' </span><span class="s0">+ ($passData) + </span><span class="s2">'; ' </span><span class="s0">+ ($code) + </span><span class="s2">' '</span><span class="s3">;</span>
    <span class="s0">}</span>
    <span class="s0">it.compositeRule = $it.compositeRule = $wasComposite</span><span class="s3">;</span>
    <span class="s0">out += </span><span class="s2">' if (!' </span><span class="s0">+ ($nextValid) + </span><span class="s2">') { for (var ' </span><span class="s0">+ ($i) + </span><span class="s2">'=startErrs' </span><span class="s0">+ ($lvl) + </span><span class="s2">'; ' </span><span class="s0">+ ($i) + </span><span class="s2">'&lt;errors; ' </span><span class="s0">+ ($i) + </span><span class="s2">'++) { vErrors[' </span><span class="s0">+ ($i) + </span><span class="s2">'].propertyName = ' </span><span class="s0">+ ($key) + </span><span class="s2">'; }   var err =   '</span><span class="s3">; </span><span class="s7">/* istanbul ignore else */</span>
    <span class="s1">if </span><span class="s0">(it.createErrors !== </span><span class="s1">false</span><span class="s0">) {</span>
      <span class="s0">out += </span><span class="s2">' { keyword: </span><span class="s3">\'</span><span class="s2">' </span><span class="s0">+ (</span><span class="s2">'propertyNames'</span><span class="s0">) + </span><span class="s2">'</span><span class="s3">\' </span><span class="s2">, dataPath: (dataPath || </span><span class="s3">\'\'</span><span class="s2">) + ' </span><span class="s0">+ (it.errorPath) + </span><span class="s2">' , schemaPath: ' </span><span class="s0">+ (it.util.toQuotedString($errSchemaPath)) + </span><span class="s2">' , params: { propertyName: </span><span class="s3">\'</span><span class="s2">' </span><span class="s0">+ ($invalidName) + </span><span class="s2">'</span><span class="s3">\' </span><span class="s2">} '</span><span class="s3">;</span>
      <span class="s1">if </span><span class="s0">(it.opts.messages !== </span><span class="s1">false</span><span class="s0">) {</span>
        <span class="s0">out += </span><span class="s2">' , message: </span><span class="s3">\'</span><span class="s2">property name </span><span class="s3">\\\'</span><span class="s2">' </span><span class="s0">+ ($invalidName) + </span><span class="s2">'</span><span class="s3">\\\' </span><span class="s2">is invalid</span><span class="s3">\' </span><span class="s2">'</span><span class="s3">;</span>
      <span class="s0">}</span>
      <span class="s1">if </span><span class="s0">(it.opts.verbose) {</span>
        <span class="s0">out += </span><span class="s2">' , schema: validate.schema' </span><span class="s0">+ ($schemaPath) + </span><span class="s2">' , parentSchema: validate.schema' </span><span class="s0">+ (it.schemaPath) + </span><span class="s2">' , data: ' </span><span class="s0">+ ($data) + </span><span class="s2">' '</span><span class="s3">;</span>
      <span class="s0">}</span>
      <span class="s0">out += </span><span class="s2">' } '</span><span class="s3">;</span>
    <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
      <span class="s0">out += </span><span class="s2">' {} '</span><span class="s3">;</span>
    <span class="s0">}</span>
    <span class="s0">out += </span><span class="s2">';  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; '</span><span class="s3">;</span>
    <span class="s1">if </span><span class="s0">(!it.compositeRule &amp;&amp; $breakOnError) {</span>
      <span class="s7">/* istanbul ignore if */</span>
      <span class="s1">if </span><span class="s0">(it.async) {</span>
        <span class="s0">out += </span><span class="s2">' throw new ValidationError(vErrors); '</span><span class="s3">;</span>
      <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
        <span class="s0">out += </span><span class="s2">' validate.errors = vErrors; return false; '</span><span class="s3">;</span>
      <span class="s0">}</span>
    <span class="s0">}</span>
    <span class="s1">if </span><span class="s0">($breakOnError) {</span>
      <span class="s0">out += </span><span class="s2">' break; '</span><span class="s3">;</span>
    <span class="s0">}</span>
    <span class="s0">out += </span><span class="s2">' } }'</span><span class="s3">;</span>
  <span class="s0">}</span>
  <span class="s1">if </span><span class="s0">($breakOnError) {</span>
    <span class="s0">out += </span><span class="s2">' ' </span><span class="s0">+ ($closingBraces) + </span><span class="s2">' if (' </span><span class="s0">+ ($errs) + </span><span class="s2">' == errors) {'</span><span class="s3">;</span>
  <span class="s0">}</span>
  <span class="s1">return </span><span class="s0">out</span><span class="s3">;</span>
<span class="s0">}</span>

<span class="s0">}</span><span class="s3">,</span><span class="s0">{}]</span><span class="s3">,</span><span class="s4">35</span><span class="s0">:[</span><span class="s1">function</span><span class="s0">(require</span><span class="s3">,</span><span class="s0">module</span><span class="s3">,</span><span class="s0">exports){</span>
<span class="s2">'use strict'</span><span class="s3">;</span>
<span class="s0">module.exports = </span><span class="s1">function </span><span class="s0">generate_ref(it</span><span class="s3">, </span><span class="s0">$keyword</span><span class="s3">, </span><span class="s0">$ruleType) {</span>
  <span class="s1">var </span><span class="s0">out = </span><span class="s2">' '</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$lvl = it.level</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$dataLvl = it.dataLevel</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$schema = it.schema[$keyword]</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$errSchemaPath = it.errSchemaPath + </span><span class="s2">'/' </span><span class="s0">+ $keyword</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$breakOnError = !it.opts.allErrors</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$data = </span><span class="s2">'data' </span><span class="s0">+ ($dataLvl || </span><span class="s2">''</span><span class="s0">)</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$valid = </span><span class="s2">'valid' </span><span class="s0">+ $lvl</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$async</span><span class="s3">, </span><span class="s0">$refCode</span><span class="s3">;</span>
  <span class="s1">if </span><span class="s0">($schema == </span><span class="s2">'#' </span><span class="s0">|| $schema == </span><span class="s2">'#/'</span><span class="s0">) {</span>
    <span class="s1">if </span><span class="s0">(it.isRoot) {</span>
      <span class="s0">$async = it.async</span><span class="s3">;</span>
      <span class="s0">$refCode = </span><span class="s2">'validate'</span><span class="s3">;</span>
    <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
      <span class="s0">$async = it.root.schema.$async === </span><span class="s1">true</span><span class="s3">;</span>
      <span class="s0">$refCode = </span><span class="s2">'root.refVal[0]'</span><span class="s3">;</span>
    <span class="s0">}</span>
  <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
    <span class="s1">var </span><span class="s0">$refVal = it.resolveRef(it.baseId</span><span class="s3">, </span><span class="s0">$schema</span><span class="s3">, </span><span class="s0">it.isRoot)</span><span class="s3">;</span>
    <span class="s1">if </span><span class="s0">($refVal === undefined) {</span>
      <span class="s1">var </span><span class="s0">$message = it.MissingRefError.message(it.baseId</span><span class="s3">, </span><span class="s0">$schema)</span><span class="s3">;</span>
      <span class="s1">if </span><span class="s0">(it.opts.missingRefs == </span><span class="s2">'fail'</span><span class="s0">) {</span>
        <span class="s0">it.logger.error($message)</span><span class="s3">;</span>
        <span class="s1">var </span><span class="s0">$$outStack = $$outStack || []</span><span class="s3">;</span>
        <span class="s0">$$outStack.push(out)</span><span class="s3">;</span>
        <span class="s0">out = </span><span class="s2">''</span><span class="s3">; </span><span class="s7">/* istanbul ignore else */</span>
        <span class="s1">if </span><span class="s0">(it.createErrors !== </span><span class="s1">false</span><span class="s0">) {</span>
          <span class="s0">out += </span><span class="s2">' { keyword: </span><span class="s3">\'</span><span class="s2">' </span><span class="s0">+ (</span><span class="s2">'$ref'</span><span class="s0">) + </span><span class="s2">'</span><span class="s3">\' </span><span class="s2">, dataPath: (dataPath || </span><span class="s3">\'\'</span><span class="s2">) + ' </span><span class="s0">+ (it.errorPath) + </span><span class="s2">' , schemaPath: ' </span><span class="s0">+ (it.util.toQuotedString($errSchemaPath)) + </span><span class="s2">' , params: { ref: </span><span class="s3">\'</span><span class="s2">' </span><span class="s0">+ (it.util.escapeQuotes($schema)) + </span><span class="s2">'</span><span class="s3">\' </span><span class="s2">} '</span><span class="s3">;</span>
          <span class="s1">if </span><span class="s0">(it.opts.messages !== </span><span class="s1">false</span><span class="s0">) {</span>
            <span class="s0">out += </span><span class="s2">' , message: </span><span class="s3">\'</span><span class="s2">can</span><span class="s3">\\\'</span><span class="s2">t resolve reference ' </span><span class="s0">+ (it.util.escapeQuotes($schema)) + </span><span class="s2">'</span><span class="s3">\' </span><span class="s2">'</span><span class="s3">;</span>
          <span class="s0">}</span>
          <span class="s1">if </span><span class="s0">(it.opts.verbose) {</span>
            <span class="s0">out += </span><span class="s2">' , schema: ' </span><span class="s0">+ (it.util.toQuotedString($schema)) + </span><span class="s2">' , parentSchema: validate.schema' </span><span class="s0">+ (it.schemaPath) + </span><span class="s2">' , data: ' </span><span class="s0">+ ($data) + </span><span class="s2">' '</span><span class="s3">;</span>
          <span class="s0">}</span>
          <span class="s0">out += </span><span class="s2">' } '</span><span class="s3">;</span>
        <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
          <span class="s0">out += </span><span class="s2">' {} '</span><span class="s3">;</span>
        <span class="s0">}</span>
        <span class="s1">var </span><span class="s0">__err = out</span><span class="s3">;</span>
        <span class="s0">out = $$outStack.pop()</span><span class="s3">;</span>
        <span class="s1">if </span><span class="s0">(!it.compositeRule &amp;&amp; $breakOnError) {</span>
          <span class="s7">/* istanbul ignore if */</span>
          <span class="s1">if </span><span class="s0">(it.async) {</span>
            <span class="s0">out += </span><span class="s2">' throw new ValidationError([' </span><span class="s0">+ (__err) + </span><span class="s2">']); '</span><span class="s3">;</span>
          <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
            <span class="s0">out += </span><span class="s2">' validate.errors = [' </span><span class="s0">+ (__err) + </span><span class="s2">']; return false; '</span><span class="s3">;</span>
          <span class="s0">}</span>
        <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
          <span class="s0">out += </span><span class="s2">' var err = ' </span><span class="s0">+ (__err) + </span><span class="s2">';  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; '</span><span class="s3">;</span>
        <span class="s0">}</span>
        <span class="s1">if </span><span class="s0">($breakOnError) {</span>
          <span class="s0">out += </span><span class="s2">' if (false) { '</span><span class="s3">;</span>
        <span class="s0">}</span>
      <span class="s0">} </span><span class="s1">else if </span><span class="s0">(it.opts.missingRefs == </span><span class="s2">'ignore'</span><span class="s0">) {</span>
        <span class="s0">it.logger.warn($message)</span><span class="s3">;</span>
        <span class="s1">if </span><span class="s0">($breakOnError) {</span>
          <span class="s0">out += </span><span class="s2">' if (true) { '</span><span class="s3">;</span>
        <span class="s0">}</span>
      <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
        <span class="s1">throw new </span><span class="s0">it.MissingRefError(it.baseId</span><span class="s3">, </span><span class="s0">$schema</span><span class="s3">, </span><span class="s0">$message)</span><span class="s3">;</span>
      <span class="s0">}</span>
    <span class="s0">} </span><span class="s1">else if </span><span class="s0">($refVal.inline) {</span>
      <span class="s1">var </span><span class="s0">$it = it.util.copy(it)</span><span class="s3">;</span>
      <span class="s0">$it.level++</span><span class="s3">;</span>
      <span class="s1">var </span><span class="s0">$nextValid = </span><span class="s2">'valid' </span><span class="s0">+ $it.level</span><span class="s3">;</span>
      <span class="s0">$it.schema = $refVal.schema</span><span class="s3">;</span>
      <span class="s0">$it.schemaPath = </span><span class="s2">''</span><span class="s3">;</span>
      <span class="s0">$it.errSchemaPath = $schema</span><span class="s3">;</span>
      <span class="s1">var </span><span class="s0">$code = it.validate($it).replace(</span><span class="s4">/validate\.schema/g</span><span class="s3">, </span><span class="s0">$refVal.code)</span><span class="s3">;</span>
      <span class="s0">out += </span><span class="s2">' ' </span><span class="s0">+ ($code) + </span><span class="s2">' '</span><span class="s3">;</span>
      <span class="s1">if </span><span class="s0">($breakOnError) {</span>
        <span class="s0">out += </span><span class="s2">' if (' </span><span class="s0">+ ($nextValid) + </span><span class="s2">') { '</span><span class="s3">;</span>
      <span class="s0">}</span>
    <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
      <span class="s0">$async = $refVal.$async === </span><span class="s1">true </span><span class="s0">|| (it.async &amp;&amp; $refVal.$async !== </span><span class="s1">false</span><span class="s0">)</span><span class="s3">;</span>
      <span class="s0">$refCode = $refVal.code</span><span class="s3">;</span>
    <span class="s0">}</span>
  <span class="s0">}</span>
  <span class="s1">if </span><span class="s0">($refCode) {</span>
    <span class="s1">var </span><span class="s0">$$outStack = $$outStack || []</span><span class="s3">;</span>
    <span class="s0">$$outStack.push(out)</span><span class="s3">;</span>
    <span class="s0">out = </span><span class="s2">''</span><span class="s3">;</span>
    <span class="s1">if </span><span class="s0">(it.opts.passContext) {</span>
      <span class="s0">out += </span><span class="s2">' ' </span><span class="s0">+ ($refCode) + </span><span class="s2">'.call(this, '</span><span class="s3">;</span>
    <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
      <span class="s0">out += </span><span class="s2">' ' </span><span class="s0">+ ($refCode) + </span><span class="s2">'( '</span><span class="s3">;</span>
    <span class="s0">}</span>
    <span class="s0">out += </span><span class="s2">' ' </span><span class="s0">+ ($data) + </span><span class="s2">', (dataPath || </span><span class="s3">\'\'</span><span class="s2">)'</span><span class="s3">;</span>
    <span class="s1">if </span><span class="s0">(it.errorPath != </span><span class="s2">'&quot;&quot;'</span><span class="s0">) {</span>
      <span class="s0">out += </span><span class="s2">' + ' </span><span class="s0">+ (it.errorPath)</span><span class="s3">;</span>
    <span class="s0">}</span>
    <span class="s1">var </span><span class="s0">$parentData = $dataLvl ? </span><span class="s2">'data' </span><span class="s0">+ (($dataLvl - </span><span class="s4">1</span><span class="s0">) || </span><span class="s2">''</span><span class="s0">) : </span><span class="s2">'parentData'</span><span class="s3">,</span>
      <span class="s0">$parentDataProperty = $dataLvl ? it.dataPathArr[$dataLvl] : </span><span class="s2">'parentDataProperty'</span><span class="s3">;</span>
    <span class="s0">out += </span><span class="s2">' , ' </span><span class="s0">+ ($parentData) + </span><span class="s2">' , ' </span><span class="s0">+ ($parentDataProperty) + </span><span class="s2">', rootData)  '</span><span class="s3">;</span>
    <span class="s1">var </span><span class="s0">__callValidate = out</span><span class="s3">;</span>
    <span class="s0">out = $$outStack.pop()</span><span class="s3">;</span>
    <span class="s1">if </span><span class="s0">($async) {</span>
      <span class="s1">if </span><span class="s0">(!it.async) </span><span class="s1">throw new </span><span class="s0">Error(</span><span class="s2">'async schema referenced by sync schema'</span><span class="s0">)</span><span class="s3">;</span>
      <span class="s1">if </span><span class="s0">($breakOnError) {</span>
        <span class="s0">out += </span><span class="s2">' var ' </span><span class="s0">+ ($valid) + </span><span class="s2">'; '</span><span class="s3">;</span>
      <span class="s0">}</span>
      <span class="s0">out += </span><span class="s2">' try { await ' </span><span class="s0">+ (__callValidate) + </span><span class="s2">'; '</span><span class="s3">;</span>
      <span class="s1">if </span><span class="s0">($breakOnError) {</span>
        <span class="s0">out += </span><span class="s2">' ' </span><span class="s0">+ ($valid) + </span><span class="s2">' = true; '</span><span class="s3">;</span>
      <span class="s0">}</span>
      <span class="s0">out += </span><span class="s2">' } catch (e) { if (!(e instanceof ValidationError)) throw e; if (vErrors === null) vErrors = e.errors; else vErrors = vErrors.concat(e.errors); errors = vErrors.length; '</span><span class="s3">;</span>
      <span class="s1">if </span><span class="s0">($breakOnError) {</span>
        <span class="s0">out += </span><span class="s2">' ' </span><span class="s0">+ ($valid) + </span><span class="s2">' = false; '</span><span class="s3">;</span>
      <span class="s0">}</span>
      <span class="s0">out += </span><span class="s2">' } '</span><span class="s3">;</span>
      <span class="s1">if </span><span class="s0">($breakOnError) {</span>
        <span class="s0">out += </span><span class="s2">' if (' </span><span class="s0">+ ($valid) + </span><span class="s2">') { '</span><span class="s3">;</span>
      <span class="s0">}</span>
    <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
      <span class="s0">out += </span><span class="s2">' if (!' </span><span class="s0">+ (__callValidate) + </span><span class="s2">') { if (vErrors === null) vErrors = ' </span><span class="s0">+ ($refCode) + </span><span class="s2">'.errors; else vErrors = vErrors.concat(' </span><span class="s0">+ ($refCode) + </span><span class="s2">'.errors); errors = vErrors.length; } '</span><span class="s3">;</span>
      <span class="s1">if </span><span class="s0">($breakOnError) {</span>
        <span class="s0">out += </span><span class="s2">' else { '</span><span class="s3">;</span>
      <span class="s0">}</span>
    <span class="s0">}</span>
  <span class="s0">}</span>
  <span class="s1">return </span><span class="s0">out</span><span class="s3">;</span>
<span class="s0">}</span>

<span class="s0">}</span><span class="s3">,</span><span class="s0">{}]</span><span class="s3">,</span><span class="s4">36</span><span class="s0">:[</span><span class="s1">function</span><span class="s0">(require</span><span class="s3">,</span><span class="s0">module</span><span class="s3">,</span><span class="s0">exports){</span>
<span class="s2">'use strict'</span><span class="s3">;</span>
<span class="s0">module.exports = </span><span class="s1">function </span><span class="s0">generate_required(it</span><span class="s3">, </span><span class="s0">$keyword</span><span class="s3">, </span><span class="s0">$ruleType) {</span>
  <span class="s1">var </span><span class="s0">out = </span><span class="s2">' '</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$lvl = it.level</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$dataLvl = it.dataLevel</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$schema = it.schema[$keyword]</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$schemaPath = it.schemaPath + it.util.getProperty($keyword)</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$errSchemaPath = it.errSchemaPath + </span><span class="s2">'/' </span><span class="s0">+ $keyword</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$breakOnError = !it.opts.allErrors</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$data = </span><span class="s2">'data' </span><span class="s0">+ ($dataLvl || </span><span class="s2">''</span><span class="s0">)</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$valid = </span><span class="s2">'valid' </span><span class="s0">+ $lvl</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$isData = it.opts.$data &amp;&amp; $schema &amp;&amp; $schema.$data</span><span class="s3">,</span>
    <span class="s0">$schemaValue</span><span class="s3">;</span>
  <span class="s1">if </span><span class="s0">($isData) {</span>
    <span class="s0">out += </span><span class="s2">' var schema' </span><span class="s0">+ ($lvl) + </span><span class="s2">' = ' </span><span class="s0">+ (it.util.getData($schema.$data</span><span class="s3">, </span><span class="s0">$dataLvl</span><span class="s3">, </span><span class="s0">it.dataPathArr)) + </span><span class="s2">'; '</span><span class="s3">;</span>
    <span class="s0">$schemaValue = </span><span class="s2">'schema' </span><span class="s0">+ $lvl</span><span class="s3">;</span>
  <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
    <span class="s0">$schemaValue = $schema</span><span class="s3">;</span>
  <span class="s0">}</span>
  <span class="s1">var </span><span class="s0">$vSchema = </span><span class="s2">'schema' </span><span class="s0">+ $lvl</span><span class="s3">;</span>
  <span class="s1">if </span><span class="s0">(!$isData) {</span>
    <span class="s1">if </span><span class="s0">($schema.length &lt; it.opts.loopRequired &amp;&amp; it.schema.properties &amp;&amp; Object.keys(it.schema.properties).length) {</span>
      <span class="s1">var </span><span class="s0">$required = []</span><span class="s3">;</span>
      <span class="s1">var </span><span class="s0">arr1 = $schema</span><span class="s3">;</span>
      <span class="s1">if </span><span class="s0">(arr1) {</span>
        <span class="s1">var </span><span class="s0">$property</span><span class="s3">, </span><span class="s0">i1 = -</span><span class="s4">1</span><span class="s3">,</span>
          <span class="s0">l1 = arr1.length - </span><span class="s4">1</span><span class="s3">;</span>
        <span class="s1">while </span><span class="s0">(i1 &lt; l1) {</span>
          <span class="s0">$property = arr1[i1 += </span><span class="s4">1</span><span class="s0">]</span><span class="s3">;</span>
          <span class="s1">var </span><span class="s0">$propertySch = it.schema.properties[$property]</span><span class="s3">;</span>
          <span class="s1">if </span><span class="s0">(!($propertySch &amp;&amp; (it.opts.strictKeywords ? (</span><span class="s1">typeof </span><span class="s0">$propertySch == </span><span class="s2">'object' </span><span class="s0">&amp;&amp; Object.keys($propertySch).length &gt; </span><span class="s4">0</span><span class="s0">) || $propertySch === </span><span class="s1">false </span><span class="s0">: it.util.schemaHasRules($propertySch</span><span class="s3">, </span><span class="s0">it.RULES.all)))) {</span>
            <span class="s0">$required[$required.length] = $property</span><span class="s3">;</span>
          <span class="s0">}</span>
        <span class="s0">}</span>
      <span class="s0">}</span>
    <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
      <span class="s1">var </span><span class="s0">$required = $schema</span><span class="s3">;</span>
    <span class="s0">}</span>
  <span class="s0">}</span>
  <span class="s1">if </span><span class="s0">($isData || $required.length) {</span>
    <span class="s1">var </span><span class="s0">$currentErrorPath = it.errorPath</span><span class="s3">,</span>
      <span class="s0">$loopRequired = $isData || $required.length &gt;= it.opts.loopRequired</span><span class="s3">,</span>
      <span class="s0">$ownProperties = it.opts.ownProperties</span><span class="s3">;</span>
    <span class="s1">if </span><span class="s0">($breakOnError) {</span>
      <span class="s0">out += </span><span class="s2">' var missing' </span><span class="s0">+ ($lvl) + </span><span class="s2">'; '</span><span class="s3">;</span>
      <span class="s1">if </span><span class="s0">($loopRequired) {</span>
        <span class="s1">if </span><span class="s0">(!$isData) {</span>
          <span class="s0">out += </span><span class="s2">' var ' </span><span class="s0">+ ($vSchema) + </span><span class="s2">' = validate.schema' </span><span class="s0">+ ($schemaPath) + </span><span class="s2">'; '</span><span class="s3">;</span>
        <span class="s0">}</span>
        <span class="s1">var </span><span class="s0">$i = </span><span class="s2">'i' </span><span class="s0">+ $lvl</span><span class="s3">,</span>
          <span class="s0">$propertyPath = </span><span class="s2">'schema' </span><span class="s0">+ $lvl + </span><span class="s2">'[' </span><span class="s0">+ $i + </span><span class="s2">']'</span><span class="s3">,</span>
          <span class="s0">$missingProperty = </span><span class="s2">'</span><span class="s3">\' </span><span class="s2">+ ' </span><span class="s0">+ $propertyPath + </span><span class="s2">' + </span><span class="s3">\'</span><span class="s2">'</span><span class="s3">;</span>
        <span class="s1">if </span><span class="s0">(it.opts._errorDataPathProperty) {</span>
          <span class="s0">it.errorPath = it.util.getPathExpr($currentErrorPath</span><span class="s3">, </span><span class="s0">$propertyPath</span><span class="s3">, </span><span class="s0">it.opts.jsonPointers)</span><span class="s3">;</span>
        <span class="s0">}</span>
        <span class="s0">out += </span><span class="s2">' var ' </span><span class="s0">+ ($valid) + </span><span class="s2">' = true; '</span><span class="s3">;</span>
        <span class="s1">if </span><span class="s0">($isData) {</span>
          <span class="s0">out += </span><span class="s2">' if (schema' </span><span class="s0">+ ($lvl) + </span><span class="s2">' === undefined) ' </span><span class="s0">+ ($valid) + </span><span class="s2">' = true; else if (!Array.isArray(schema' </span><span class="s0">+ ($lvl) + </span><span class="s2">')) ' </span><span class="s0">+ ($valid) + </span><span class="s2">' = false; else {'</span><span class="s3">;</span>
        <span class="s0">}</span>
        <span class="s0">out += </span><span class="s2">' for (var ' </span><span class="s0">+ ($i) + </span><span class="s2">' = 0; ' </span><span class="s0">+ ($i) + </span><span class="s2">' &lt; ' </span><span class="s0">+ ($vSchema) + </span><span class="s2">'.length; ' </span><span class="s0">+ ($i) + </span><span class="s2">'++) { ' </span><span class="s0">+ ($valid) + </span><span class="s2">' = ' </span><span class="s0">+ ($data) + </span><span class="s2">'[' </span><span class="s0">+ ($vSchema) + </span><span class="s2">'[' </span><span class="s0">+ ($i) + </span><span class="s2">']] !== undefined '</span><span class="s3">;</span>
        <span class="s1">if </span><span class="s0">($ownProperties) {</span>
          <span class="s0">out += </span><span class="s2">' &amp;&amp;   Object.prototype.hasOwnProperty.call(' </span><span class="s0">+ ($data) + </span><span class="s2">', ' </span><span class="s0">+ ($vSchema) + </span><span class="s2">'[' </span><span class="s0">+ ($i) + </span><span class="s2">']) '</span><span class="s3">;</span>
        <span class="s0">}</span>
        <span class="s0">out += </span><span class="s2">'; if (!' </span><span class="s0">+ ($valid) + </span><span class="s2">') break; } '</span><span class="s3">;</span>
        <span class="s1">if </span><span class="s0">($isData) {</span>
          <span class="s0">out += </span><span class="s2">'  }  '</span><span class="s3">;</span>
        <span class="s0">}</span>
        <span class="s0">out += </span><span class="s2">'  if (!' </span><span class="s0">+ ($valid) + </span><span class="s2">') {   '</span><span class="s3">;</span>
        <span class="s1">var </span><span class="s0">$$outStack = $$outStack || []</span><span class="s3">;</span>
        <span class="s0">$$outStack.push(out)</span><span class="s3">;</span>
        <span class="s0">out = </span><span class="s2">''</span><span class="s3">; </span><span class="s7">/* istanbul ignore else */</span>
        <span class="s1">if </span><span class="s0">(it.createErrors !== </span><span class="s1">false</span><span class="s0">) {</span>
          <span class="s0">out += </span><span class="s2">' { keyword: </span><span class="s3">\'</span><span class="s2">' </span><span class="s0">+ (</span><span class="s2">'required'</span><span class="s0">) + </span><span class="s2">'</span><span class="s3">\' </span><span class="s2">, dataPath: (dataPath || </span><span class="s3">\'\'</span><span class="s2">) + ' </span><span class="s0">+ (it.errorPath) + </span><span class="s2">' , schemaPath: ' </span><span class="s0">+ (it.util.toQuotedString($errSchemaPath)) + </span><span class="s2">' , params: { missingProperty: </span><span class="s3">\'</span><span class="s2">' </span><span class="s0">+ ($missingProperty) + </span><span class="s2">'</span><span class="s3">\' </span><span class="s2">} '</span><span class="s3">;</span>
          <span class="s1">if </span><span class="s0">(it.opts.messages !== </span><span class="s1">false</span><span class="s0">) {</span>
            <span class="s0">out += </span><span class="s2">' , message: </span><span class="s3">\'</span><span class="s2">'</span><span class="s3">;</span>
            <span class="s1">if </span><span class="s0">(it.opts._errorDataPathProperty) {</span>
              <span class="s0">out += </span><span class="s2">'is a required property'</span><span class="s3">;</span>
            <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
              <span class="s0">out += </span><span class="s2">'should have required property </span><span class="s3">\\\'</span><span class="s2">' </span><span class="s0">+ ($missingProperty) + </span><span class="s2">'</span><span class="s3">\\\'</span><span class="s2">'</span><span class="s3">;</span>
            <span class="s0">}</span>
            <span class="s0">out += </span><span class="s2">'</span><span class="s3">\' </span><span class="s2">'</span><span class="s3">;</span>
          <span class="s0">}</span>
          <span class="s1">if </span><span class="s0">(it.opts.verbose) {</span>
            <span class="s0">out += </span><span class="s2">' , schema: validate.schema' </span><span class="s0">+ ($schemaPath) + </span><span class="s2">' , parentSchema: validate.schema' </span><span class="s0">+ (it.schemaPath) + </span><span class="s2">' , data: ' </span><span class="s0">+ ($data) + </span><span class="s2">' '</span><span class="s3">;</span>
          <span class="s0">}</span>
          <span class="s0">out += </span><span class="s2">' } '</span><span class="s3">;</span>
        <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
          <span class="s0">out += </span><span class="s2">' {} '</span><span class="s3">;</span>
        <span class="s0">}</span>
        <span class="s1">var </span><span class="s0">__err = out</span><span class="s3">;</span>
        <span class="s0">out = $$outStack.pop()</span><span class="s3">;</span>
        <span class="s1">if </span><span class="s0">(!it.compositeRule &amp;&amp; $breakOnError) {</span>
          <span class="s7">/* istanbul ignore if */</span>
          <span class="s1">if </span><span class="s0">(it.async) {</span>
            <span class="s0">out += </span><span class="s2">' throw new ValidationError([' </span><span class="s0">+ (__err) + </span><span class="s2">']); '</span><span class="s3">;</span>
          <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
            <span class="s0">out += </span><span class="s2">' validate.errors = [' </span><span class="s0">+ (__err) + </span><span class="s2">']; return false; '</span><span class="s3">;</span>
          <span class="s0">}</span>
        <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
          <span class="s0">out += </span><span class="s2">' var err = ' </span><span class="s0">+ (__err) + </span><span class="s2">';  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; '</span><span class="s3">;</span>
        <span class="s0">}</span>
        <span class="s0">out += </span><span class="s2">' } else { '</span><span class="s3">;</span>
      <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
        <span class="s0">out += </span><span class="s2">' if ( '</span><span class="s3">;</span>
        <span class="s1">var </span><span class="s0">arr2 = $required</span><span class="s3">;</span>
        <span class="s1">if </span><span class="s0">(arr2) {</span>
          <span class="s1">var </span><span class="s0">$propertyKey</span><span class="s3">, </span><span class="s0">$i = -</span><span class="s4">1</span><span class="s3">,</span>
            <span class="s0">l2 = arr2.length - </span><span class="s4">1</span><span class="s3">;</span>
          <span class="s1">while </span><span class="s0">($i &lt; l2) {</span>
            <span class="s0">$propertyKey = arr2[$i += </span><span class="s4">1</span><span class="s0">]</span><span class="s3">;</span>
            <span class="s1">if </span><span class="s0">($i) {</span>
              <span class="s0">out += </span><span class="s2">' || '</span><span class="s3">;</span>
            <span class="s0">}</span>
            <span class="s1">var </span><span class="s0">$prop = it.util.getProperty($propertyKey)</span><span class="s3">,</span>
              <span class="s0">$useData = $data + $prop</span><span class="s3">;</span>
            <span class="s0">out += </span><span class="s2">' ( ( ' </span><span class="s0">+ ($useData) + </span><span class="s2">' === undefined '</span><span class="s3">;</span>
            <span class="s1">if </span><span class="s0">($ownProperties) {</span>
              <span class="s0">out += </span><span class="s2">' || ! Object.prototype.hasOwnProperty.call(' </span><span class="s0">+ ($data) + </span><span class="s2">', </span><span class="s3">\'</span><span class="s2">' </span><span class="s0">+ (it.util.escapeQuotes($propertyKey)) + </span><span class="s2">'</span><span class="s3">\'</span><span class="s2">) '</span><span class="s3">;</span>
            <span class="s0">}</span>
            <span class="s0">out += </span><span class="s2">') &amp;&amp; (missing' </span><span class="s0">+ ($lvl) + </span><span class="s2">' = ' </span><span class="s0">+ (it.util.toQuotedString(it.opts.jsonPointers ? $propertyKey : $prop)) + </span><span class="s2">') ) '</span><span class="s3">;</span>
          <span class="s0">}</span>
        <span class="s0">}</span>
        <span class="s0">out += </span><span class="s2">') {  '</span><span class="s3">;</span>
        <span class="s1">var </span><span class="s0">$propertyPath = </span><span class="s2">'missing' </span><span class="s0">+ $lvl</span><span class="s3">,</span>
          <span class="s0">$missingProperty = </span><span class="s2">'</span><span class="s3">\' </span><span class="s2">+ ' </span><span class="s0">+ $propertyPath + </span><span class="s2">' + </span><span class="s3">\'</span><span class="s2">'</span><span class="s3">;</span>
        <span class="s1">if </span><span class="s0">(it.opts._errorDataPathProperty) {</span>
          <span class="s0">it.errorPath = it.opts.jsonPointers ? it.util.getPathExpr($currentErrorPath</span><span class="s3">, </span><span class="s0">$propertyPath</span><span class="s3">, </span><span class="s1">true</span><span class="s0">) : $currentErrorPath + </span><span class="s2">' + ' </span><span class="s0">+ $propertyPath</span><span class="s3">;</span>
        <span class="s0">}</span>
        <span class="s1">var </span><span class="s0">$$outStack = $$outStack || []</span><span class="s3">;</span>
        <span class="s0">$$outStack.push(out)</span><span class="s3">;</span>
        <span class="s0">out = </span><span class="s2">''</span><span class="s3">; </span><span class="s7">/* istanbul ignore else */</span>
        <span class="s1">if </span><span class="s0">(it.createErrors !== </span><span class="s1">false</span><span class="s0">) {</span>
          <span class="s0">out += </span><span class="s2">' { keyword: </span><span class="s3">\'</span><span class="s2">' </span><span class="s0">+ (</span><span class="s2">'required'</span><span class="s0">) + </span><span class="s2">'</span><span class="s3">\' </span><span class="s2">, dataPath: (dataPath || </span><span class="s3">\'\'</span><span class="s2">) + ' </span><span class="s0">+ (it.errorPath) + </span><span class="s2">' , schemaPath: ' </span><span class="s0">+ (it.util.toQuotedString($errSchemaPath)) + </span><span class="s2">' , params: { missingProperty: </span><span class="s3">\'</span><span class="s2">' </span><span class="s0">+ ($missingProperty) + </span><span class="s2">'</span><span class="s3">\' </span><span class="s2">} '</span><span class="s3">;</span>
          <span class="s1">if </span><span class="s0">(it.opts.messages !== </span><span class="s1">false</span><span class="s0">) {</span>
            <span class="s0">out += </span><span class="s2">' , message: </span><span class="s3">\'</span><span class="s2">'</span><span class="s3">;</span>
            <span class="s1">if </span><span class="s0">(it.opts._errorDataPathProperty) {</span>
              <span class="s0">out += </span><span class="s2">'is a required property'</span><span class="s3">;</span>
            <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
              <span class="s0">out += </span><span class="s2">'should have required property </span><span class="s3">\\\'</span><span class="s2">' </span><span class="s0">+ ($missingProperty) + </span><span class="s2">'</span><span class="s3">\\\'</span><span class="s2">'</span><span class="s3">;</span>
            <span class="s0">}</span>
            <span class="s0">out += </span><span class="s2">'</span><span class="s3">\' </span><span class="s2">'</span><span class="s3">;</span>
          <span class="s0">}</span>
          <span class="s1">if </span><span class="s0">(it.opts.verbose) {</span>
            <span class="s0">out += </span><span class="s2">' , schema: validate.schema' </span><span class="s0">+ ($schemaPath) + </span><span class="s2">' , parentSchema: validate.schema' </span><span class="s0">+ (it.schemaPath) + </span><span class="s2">' , data: ' </span><span class="s0">+ ($data) + </span><span class="s2">' '</span><span class="s3">;</span>
          <span class="s0">}</span>
          <span class="s0">out += </span><span class="s2">' } '</span><span class="s3">;</span>
        <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
          <span class="s0">out += </span><span class="s2">' {} '</span><span class="s3">;</span>
        <span class="s0">}</span>
        <span class="s1">var </span><span class="s0">__err = out</span><span class="s3">;</span>
        <span class="s0">out = $$outStack.pop()</span><span class="s3">;</span>
        <span class="s1">if </span><span class="s0">(!it.compositeRule &amp;&amp; $breakOnError) {</span>
          <span class="s7">/* istanbul ignore if */</span>
          <span class="s1">if </span><span class="s0">(it.async) {</span>
            <span class="s0">out += </span><span class="s2">' throw new ValidationError([' </span><span class="s0">+ (__err) + </span><span class="s2">']); '</span><span class="s3">;</span>
          <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
            <span class="s0">out += </span><span class="s2">' validate.errors = [' </span><span class="s0">+ (__err) + </span><span class="s2">']; return false; '</span><span class="s3">;</span>
          <span class="s0">}</span>
        <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
          <span class="s0">out += </span><span class="s2">' var err = ' </span><span class="s0">+ (__err) + </span><span class="s2">';  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; '</span><span class="s3">;</span>
        <span class="s0">}</span>
        <span class="s0">out += </span><span class="s2">' } else { '</span><span class="s3">;</span>
      <span class="s0">}</span>
    <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
      <span class="s1">if </span><span class="s0">($loopRequired) {</span>
        <span class="s1">if </span><span class="s0">(!$isData) {</span>
          <span class="s0">out += </span><span class="s2">' var ' </span><span class="s0">+ ($vSchema) + </span><span class="s2">' = validate.schema' </span><span class="s0">+ ($schemaPath) + </span><span class="s2">'; '</span><span class="s3">;</span>
        <span class="s0">}</span>
        <span class="s1">var </span><span class="s0">$i = </span><span class="s2">'i' </span><span class="s0">+ $lvl</span><span class="s3">,</span>
          <span class="s0">$propertyPath = </span><span class="s2">'schema' </span><span class="s0">+ $lvl + </span><span class="s2">'[' </span><span class="s0">+ $i + </span><span class="s2">']'</span><span class="s3">,</span>
          <span class="s0">$missingProperty = </span><span class="s2">'</span><span class="s3">\' </span><span class="s2">+ ' </span><span class="s0">+ $propertyPath + </span><span class="s2">' + </span><span class="s3">\'</span><span class="s2">'</span><span class="s3">;</span>
        <span class="s1">if </span><span class="s0">(it.opts._errorDataPathProperty) {</span>
          <span class="s0">it.errorPath = it.util.getPathExpr($currentErrorPath</span><span class="s3">, </span><span class="s0">$propertyPath</span><span class="s3">, </span><span class="s0">it.opts.jsonPointers)</span><span class="s3">;</span>
        <span class="s0">}</span>
        <span class="s1">if </span><span class="s0">($isData) {</span>
          <span class="s0">out += </span><span class="s2">' if (' </span><span class="s0">+ ($vSchema) + </span><span class="s2">' &amp;&amp; !Array.isArray(' </span><span class="s0">+ ($vSchema) + </span><span class="s2">')) {  var err =   '</span><span class="s3">; </span><span class="s7">/* istanbul ignore else */</span>
          <span class="s1">if </span><span class="s0">(it.createErrors !== </span><span class="s1">false</span><span class="s0">) {</span>
            <span class="s0">out += </span><span class="s2">' { keyword: </span><span class="s3">\'</span><span class="s2">' </span><span class="s0">+ (</span><span class="s2">'required'</span><span class="s0">) + </span><span class="s2">'</span><span class="s3">\' </span><span class="s2">, dataPath: (dataPath || </span><span class="s3">\'\'</span><span class="s2">) + ' </span><span class="s0">+ (it.errorPath) + </span><span class="s2">' , schemaPath: ' </span><span class="s0">+ (it.util.toQuotedString($errSchemaPath)) + </span><span class="s2">' , params: { missingProperty: </span><span class="s3">\'</span><span class="s2">' </span><span class="s0">+ ($missingProperty) + </span><span class="s2">'</span><span class="s3">\' </span><span class="s2">} '</span><span class="s3">;</span>
            <span class="s1">if </span><span class="s0">(it.opts.messages !== </span><span class="s1">false</span><span class="s0">) {</span>
              <span class="s0">out += </span><span class="s2">' , message: </span><span class="s3">\'</span><span class="s2">'</span><span class="s3">;</span>
              <span class="s1">if </span><span class="s0">(it.opts._errorDataPathProperty) {</span>
                <span class="s0">out += </span><span class="s2">'is a required property'</span><span class="s3">;</span>
              <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
                <span class="s0">out += </span><span class="s2">'should have required property </span><span class="s3">\\\'</span><span class="s2">' </span><span class="s0">+ ($missingProperty) + </span><span class="s2">'</span><span class="s3">\\\'</span><span class="s2">'</span><span class="s3">;</span>
              <span class="s0">}</span>
              <span class="s0">out += </span><span class="s2">'</span><span class="s3">\' </span><span class="s2">'</span><span class="s3">;</span>
            <span class="s0">}</span>
            <span class="s1">if </span><span class="s0">(it.opts.verbose) {</span>
              <span class="s0">out += </span><span class="s2">' , schema: validate.schema' </span><span class="s0">+ ($schemaPath) + </span><span class="s2">' , parentSchema: validate.schema' </span><span class="s0">+ (it.schemaPath) + </span><span class="s2">' , data: ' </span><span class="s0">+ ($data) + </span><span class="s2">' '</span><span class="s3">;</span>
            <span class="s0">}</span>
            <span class="s0">out += </span><span class="s2">' } '</span><span class="s3">;</span>
          <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
            <span class="s0">out += </span><span class="s2">' {} '</span><span class="s3">;</span>
          <span class="s0">}</span>
          <span class="s0">out += </span><span class="s2">';  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; } else if (' </span><span class="s0">+ ($vSchema) + </span><span class="s2">' !== undefined) { '</span><span class="s3">;</span>
        <span class="s0">}</span>
        <span class="s0">out += </span><span class="s2">' for (var ' </span><span class="s0">+ ($i) + </span><span class="s2">' = 0; ' </span><span class="s0">+ ($i) + </span><span class="s2">' &lt; ' </span><span class="s0">+ ($vSchema) + </span><span class="s2">'.length; ' </span><span class="s0">+ ($i) + </span><span class="s2">'++) { if (' </span><span class="s0">+ ($data) + </span><span class="s2">'[' </span><span class="s0">+ ($vSchema) + </span><span class="s2">'[' </span><span class="s0">+ ($i) + </span><span class="s2">']] === undefined '</span><span class="s3">;</span>
        <span class="s1">if </span><span class="s0">($ownProperties) {</span>
          <span class="s0">out += </span><span class="s2">' || ! Object.prototype.hasOwnProperty.call(' </span><span class="s0">+ ($data) + </span><span class="s2">', ' </span><span class="s0">+ ($vSchema) + </span><span class="s2">'[' </span><span class="s0">+ ($i) + </span><span class="s2">']) '</span><span class="s3">;</span>
        <span class="s0">}</span>
        <span class="s0">out += </span><span class="s2">') {  var err =   '</span><span class="s3">; </span><span class="s7">/* istanbul ignore else */</span>
        <span class="s1">if </span><span class="s0">(it.createErrors !== </span><span class="s1">false</span><span class="s0">) {</span>
          <span class="s0">out += </span><span class="s2">' { keyword: </span><span class="s3">\'</span><span class="s2">' </span><span class="s0">+ (</span><span class="s2">'required'</span><span class="s0">) + </span><span class="s2">'</span><span class="s3">\' </span><span class="s2">, dataPath: (dataPath || </span><span class="s3">\'\'</span><span class="s2">) + ' </span><span class="s0">+ (it.errorPath) + </span><span class="s2">' , schemaPath: ' </span><span class="s0">+ (it.util.toQuotedString($errSchemaPath)) + </span><span class="s2">' , params: { missingProperty: </span><span class="s3">\'</span><span class="s2">' </span><span class="s0">+ ($missingProperty) + </span><span class="s2">'</span><span class="s3">\' </span><span class="s2">} '</span><span class="s3">;</span>
          <span class="s1">if </span><span class="s0">(it.opts.messages !== </span><span class="s1">false</span><span class="s0">) {</span>
            <span class="s0">out += </span><span class="s2">' , message: </span><span class="s3">\'</span><span class="s2">'</span><span class="s3">;</span>
            <span class="s1">if </span><span class="s0">(it.opts._errorDataPathProperty) {</span>
              <span class="s0">out += </span><span class="s2">'is a required property'</span><span class="s3">;</span>
            <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
              <span class="s0">out += </span><span class="s2">'should have required property </span><span class="s3">\\\'</span><span class="s2">' </span><span class="s0">+ ($missingProperty) + </span><span class="s2">'</span><span class="s3">\\\'</span><span class="s2">'</span><span class="s3">;</span>
            <span class="s0">}</span>
            <span class="s0">out += </span><span class="s2">'</span><span class="s3">\' </span><span class="s2">'</span><span class="s3">;</span>
          <span class="s0">}</span>
          <span class="s1">if </span><span class="s0">(it.opts.verbose) {</span>
            <span class="s0">out += </span><span class="s2">' , schema: validate.schema' </span><span class="s0">+ ($schemaPath) + </span><span class="s2">' , parentSchema: validate.schema' </span><span class="s0">+ (it.schemaPath) + </span><span class="s2">' , data: ' </span><span class="s0">+ ($data) + </span><span class="s2">' '</span><span class="s3">;</span>
          <span class="s0">}</span>
          <span class="s0">out += </span><span class="s2">' } '</span><span class="s3">;</span>
        <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
          <span class="s0">out += </span><span class="s2">' {} '</span><span class="s3">;</span>
        <span class="s0">}</span>
        <span class="s0">out += </span><span class="s2">';  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; } } '</span><span class="s3">;</span>
        <span class="s1">if </span><span class="s0">($isData) {</span>
          <span class="s0">out += </span><span class="s2">'  }  '</span><span class="s3">;</span>
        <span class="s0">}</span>
      <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
        <span class="s1">var </span><span class="s0">arr3 = $required</span><span class="s3">;</span>
        <span class="s1">if </span><span class="s0">(arr3) {</span>
          <span class="s1">var </span><span class="s0">$propertyKey</span><span class="s3">, </span><span class="s0">i3 = -</span><span class="s4">1</span><span class="s3">,</span>
            <span class="s0">l3 = arr3.length - </span><span class="s4">1</span><span class="s3">;</span>
          <span class="s1">while </span><span class="s0">(i3 &lt; l3) {</span>
            <span class="s0">$propertyKey = arr3[i3 += </span><span class="s4">1</span><span class="s0">]</span><span class="s3">;</span>
            <span class="s1">var </span><span class="s0">$prop = it.util.getProperty($propertyKey)</span><span class="s3">,</span>
              <span class="s0">$missingProperty = it.util.escapeQuotes($propertyKey)</span><span class="s3">,</span>
              <span class="s0">$useData = $data + $prop</span><span class="s3">;</span>
            <span class="s1">if </span><span class="s0">(it.opts._errorDataPathProperty) {</span>
              <span class="s0">it.errorPath = it.util.getPath($currentErrorPath</span><span class="s3">, </span><span class="s0">$propertyKey</span><span class="s3">, </span><span class="s0">it.opts.jsonPointers)</span><span class="s3">;</span>
            <span class="s0">}</span>
            <span class="s0">out += </span><span class="s2">' if ( ' </span><span class="s0">+ ($useData) + </span><span class="s2">' === undefined '</span><span class="s3">;</span>
            <span class="s1">if </span><span class="s0">($ownProperties) {</span>
              <span class="s0">out += </span><span class="s2">' || ! Object.prototype.hasOwnProperty.call(' </span><span class="s0">+ ($data) + </span><span class="s2">', </span><span class="s3">\'</span><span class="s2">' </span><span class="s0">+ (it.util.escapeQuotes($propertyKey)) + </span><span class="s2">'</span><span class="s3">\'</span><span class="s2">) '</span><span class="s3">;</span>
            <span class="s0">}</span>
            <span class="s0">out += </span><span class="s2">') {  var err =   '</span><span class="s3">; </span><span class="s7">/* istanbul ignore else */</span>
            <span class="s1">if </span><span class="s0">(it.createErrors !== </span><span class="s1">false</span><span class="s0">) {</span>
              <span class="s0">out += </span><span class="s2">' { keyword: </span><span class="s3">\'</span><span class="s2">' </span><span class="s0">+ (</span><span class="s2">'required'</span><span class="s0">) + </span><span class="s2">'</span><span class="s3">\' </span><span class="s2">, dataPath: (dataPath || </span><span class="s3">\'\'</span><span class="s2">) + ' </span><span class="s0">+ (it.errorPath) + </span><span class="s2">' , schemaPath: ' </span><span class="s0">+ (it.util.toQuotedString($errSchemaPath)) + </span><span class="s2">' , params: { missingProperty: </span><span class="s3">\'</span><span class="s2">' </span><span class="s0">+ ($missingProperty) + </span><span class="s2">'</span><span class="s3">\' </span><span class="s2">} '</span><span class="s3">;</span>
              <span class="s1">if </span><span class="s0">(it.opts.messages !== </span><span class="s1">false</span><span class="s0">) {</span>
                <span class="s0">out += </span><span class="s2">' , message: </span><span class="s3">\'</span><span class="s2">'</span><span class="s3">;</span>
                <span class="s1">if </span><span class="s0">(it.opts._errorDataPathProperty) {</span>
                  <span class="s0">out += </span><span class="s2">'is a required property'</span><span class="s3">;</span>
                <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
                  <span class="s0">out += </span><span class="s2">'should have required property </span><span class="s3">\\\'</span><span class="s2">' </span><span class="s0">+ ($missingProperty) + </span><span class="s2">'</span><span class="s3">\\\'</span><span class="s2">'</span><span class="s3">;</span>
                <span class="s0">}</span>
                <span class="s0">out += </span><span class="s2">'</span><span class="s3">\' </span><span class="s2">'</span><span class="s3">;</span>
              <span class="s0">}</span>
              <span class="s1">if </span><span class="s0">(it.opts.verbose) {</span>
                <span class="s0">out += </span><span class="s2">' , schema: validate.schema' </span><span class="s0">+ ($schemaPath) + </span><span class="s2">' , parentSchema: validate.schema' </span><span class="s0">+ (it.schemaPath) + </span><span class="s2">' , data: ' </span><span class="s0">+ ($data) + </span><span class="s2">' '</span><span class="s3">;</span>
              <span class="s0">}</span>
              <span class="s0">out += </span><span class="s2">' } '</span><span class="s3">;</span>
            <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
              <span class="s0">out += </span><span class="s2">' {} '</span><span class="s3">;</span>
            <span class="s0">}</span>
            <span class="s0">out += </span><span class="s2">';  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; } '</span><span class="s3">;</span>
          <span class="s0">}</span>
        <span class="s0">}</span>
      <span class="s0">}</span>
    <span class="s0">}</span>
    <span class="s0">it.errorPath = $currentErrorPath</span><span class="s3">;</span>
  <span class="s0">} </span><span class="s1">else if </span><span class="s0">($breakOnError) {</span>
    <span class="s0">out += </span><span class="s2">' if (true) {'</span><span class="s3">;</span>
  <span class="s0">}</span>
  <span class="s1">return </span><span class="s0">out</span><span class="s3">;</span>
<span class="s0">}</span>

<span class="s0">}</span><span class="s3">,</span><span class="s0">{}]</span><span class="s3">,</span><span class="s4">37</span><span class="s0">:[</span><span class="s1">function</span><span class="s0">(require</span><span class="s3">,</span><span class="s0">module</span><span class="s3">,</span><span class="s0">exports){</span>
<span class="s2">'use strict'</span><span class="s3">;</span>
<span class="s0">module.exports = </span><span class="s1">function </span><span class="s0">generate_uniqueItems(it</span><span class="s3">, </span><span class="s0">$keyword</span><span class="s3">, </span><span class="s0">$ruleType) {</span>
  <span class="s1">var </span><span class="s0">out = </span><span class="s2">' '</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$lvl = it.level</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$dataLvl = it.dataLevel</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$schema = it.schema[$keyword]</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$schemaPath = it.schemaPath + it.util.getProperty($keyword)</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$errSchemaPath = it.errSchemaPath + </span><span class="s2">'/' </span><span class="s0">+ $keyword</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$breakOnError = !it.opts.allErrors</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$data = </span><span class="s2">'data' </span><span class="s0">+ ($dataLvl || </span><span class="s2">''</span><span class="s0">)</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$valid = </span><span class="s2">'valid' </span><span class="s0">+ $lvl</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$isData = it.opts.$data &amp;&amp; $schema &amp;&amp; $schema.$data</span><span class="s3">,</span>
    <span class="s0">$schemaValue</span><span class="s3">;</span>
  <span class="s1">if </span><span class="s0">($isData) {</span>
    <span class="s0">out += </span><span class="s2">' var schema' </span><span class="s0">+ ($lvl) + </span><span class="s2">' = ' </span><span class="s0">+ (it.util.getData($schema.$data</span><span class="s3">, </span><span class="s0">$dataLvl</span><span class="s3">, </span><span class="s0">it.dataPathArr)) + </span><span class="s2">'; '</span><span class="s3">;</span>
    <span class="s0">$schemaValue = </span><span class="s2">'schema' </span><span class="s0">+ $lvl</span><span class="s3">;</span>
  <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
    <span class="s0">$schemaValue = $schema</span><span class="s3">;</span>
  <span class="s0">}</span>
  <span class="s1">if </span><span class="s0">(($schema || $isData) &amp;&amp; it.opts.uniqueItems !== </span><span class="s1">false</span><span class="s0">) {</span>
    <span class="s1">if </span><span class="s0">($isData) {</span>
      <span class="s0">out += </span><span class="s2">' var ' </span><span class="s0">+ ($valid) + </span><span class="s2">'; if (' </span><span class="s0">+ ($schemaValue) + </span><span class="s2">' === false || ' </span><span class="s0">+ ($schemaValue) + </span><span class="s2">' === undefined) ' </span><span class="s0">+ ($valid) + </span><span class="s2">' = true; else if (typeof ' </span><span class="s0">+ ($schemaValue) + </span><span class="s2">' != </span><span class="s3">\'</span><span class="s2">boolean</span><span class="s3">\'</span><span class="s2">) ' </span><span class="s0">+ ($valid) + </span><span class="s2">' = false; else { '</span><span class="s3">;</span>
    <span class="s0">}</span>
    <span class="s0">out += </span><span class="s2">' var i = ' </span><span class="s0">+ ($data) + </span><span class="s2">'.length , ' </span><span class="s0">+ ($valid) + </span><span class="s2">' = true , j; if (i &gt; 1) { '</span><span class="s3">;</span>
    <span class="s1">var </span><span class="s0">$itemType = it.schema.items &amp;&amp; it.schema.items.type</span><span class="s3">,</span>
      <span class="s0">$typeIsArray = Array.isArray($itemType)</span><span class="s3">;</span>
    <span class="s1">if </span><span class="s0">(!$itemType || $itemType == </span><span class="s2">'object' </span><span class="s0">|| $itemType == </span><span class="s2">'array' </span><span class="s0">|| ($typeIsArray &amp;&amp; ($itemType.indexOf(</span><span class="s2">'object'</span><span class="s0">) &gt;= </span><span class="s4">0 </span><span class="s0">|| $itemType.indexOf(</span><span class="s2">'array'</span><span class="s0">) &gt;= </span><span class="s4">0</span><span class="s0">))) {</span>
      <span class="s0">out += </span><span class="s2">' outer: for (;i--;) { for (j = i; j--;) { if (equal(' </span><span class="s0">+ ($data) + </span><span class="s2">'[i], ' </span><span class="s0">+ ($data) + </span><span class="s2">'[j])) { ' </span><span class="s0">+ ($valid) + </span><span class="s2">' = false; break outer; } } } '</span><span class="s3">;</span>
    <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
      <span class="s0">out += </span><span class="s2">' var itemIndices = {}, item; for (;i--;) { var item = ' </span><span class="s0">+ ($data) + </span><span class="s2">'[i]; '</span><span class="s3">;</span>
      <span class="s1">var </span><span class="s0">$method = </span><span class="s2">'checkDataType' </span><span class="s0">+ ($typeIsArray ? </span><span class="s2">'s' </span><span class="s0">: </span><span class="s2">''</span><span class="s0">)</span><span class="s3">;</span>
      <span class="s0">out += </span><span class="s2">' if (' </span><span class="s0">+ (it.util[$method]($itemType</span><span class="s3">, </span><span class="s2">'item'</span><span class="s3">, </span><span class="s0">it.opts.strictNumbers</span><span class="s3">, </span><span class="s1">true</span><span class="s0">)) + </span><span class="s2">') continue; '</span><span class="s3">;</span>
      <span class="s1">if </span><span class="s0">($typeIsArray) {</span>
        <span class="s0">out += </span><span class="s2">' if (typeof item == </span><span class="s3">\'</span><span class="s2">string</span><span class="s3">\'</span><span class="s2">) item = </span><span class="s3">\'</span><span class="s2">&quot;</span><span class="s3">\' </span><span class="s2">+ item; '</span><span class="s3">;</span>
      <span class="s0">}</span>
      <span class="s0">out += </span><span class="s2">' if (typeof itemIndices[item] == </span><span class="s3">\'</span><span class="s2">number</span><span class="s3">\'</span><span class="s2">) { ' </span><span class="s0">+ ($valid) + </span><span class="s2">' = false; j = itemIndices[item]; break; } itemIndices[item] = i; } '</span><span class="s3">;</span>
    <span class="s0">}</span>
    <span class="s0">out += </span><span class="s2">' } '</span><span class="s3">;</span>
    <span class="s1">if </span><span class="s0">($isData) {</span>
      <span class="s0">out += </span><span class="s2">'  }  '</span><span class="s3">;</span>
    <span class="s0">}</span>
    <span class="s0">out += </span><span class="s2">' if (!' </span><span class="s0">+ ($valid) + </span><span class="s2">') {   '</span><span class="s3">;</span>
    <span class="s1">var </span><span class="s0">$$outStack = $$outStack || []</span><span class="s3">;</span>
    <span class="s0">$$outStack.push(out)</span><span class="s3">;</span>
    <span class="s0">out = </span><span class="s2">''</span><span class="s3">; </span><span class="s7">/* istanbul ignore else */</span>
    <span class="s1">if </span><span class="s0">(it.createErrors !== </span><span class="s1">false</span><span class="s0">) {</span>
      <span class="s0">out += </span><span class="s2">' { keyword: </span><span class="s3">\'</span><span class="s2">' </span><span class="s0">+ (</span><span class="s2">'uniqueItems'</span><span class="s0">) + </span><span class="s2">'</span><span class="s3">\' </span><span class="s2">, dataPath: (dataPath || </span><span class="s3">\'\'</span><span class="s2">) + ' </span><span class="s0">+ (it.errorPath) + </span><span class="s2">' , schemaPath: ' </span><span class="s0">+ (it.util.toQuotedString($errSchemaPath)) + </span><span class="s2">' , params: { i: i, j: j } '</span><span class="s3">;</span>
      <span class="s1">if </span><span class="s0">(it.opts.messages !== </span><span class="s1">false</span><span class="s0">) {</span>
        <span class="s0">out += </span><span class="s2">' , message: </span><span class="s3">\'</span><span class="s2">should NOT have duplicate items (items ## </span><span class="s3">\' </span><span class="s2">+ j + </span><span class="s3">\' </span><span class="s2">and </span><span class="s3">\' </span><span class="s2">+ i + </span><span class="s3">\' </span><span class="s2">are identical)</span><span class="s3">\' </span><span class="s2">'</span><span class="s3">;</span>
      <span class="s0">}</span>
      <span class="s1">if </span><span class="s0">(it.opts.verbose) {</span>
        <span class="s0">out += </span><span class="s2">' , schema:  '</span><span class="s3">;</span>
        <span class="s1">if </span><span class="s0">($isData) {</span>
          <span class="s0">out += </span><span class="s2">'validate.schema' </span><span class="s0">+ ($schemaPath)</span><span class="s3">;</span>
        <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
          <span class="s0">out += </span><span class="s2">'' </span><span class="s0">+ ($schema)</span><span class="s3">;</span>
        <span class="s0">}</span>
        <span class="s0">out += </span><span class="s2">'         , parentSchema: validate.schema' </span><span class="s0">+ (it.schemaPath) + </span><span class="s2">' , data: ' </span><span class="s0">+ ($data) + </span><span class="s2">' '</span><span class="s3">;</span>
      <span class="s0">}</span>
      <span class="s0">out += </span><span class="s2">' } '</span><span class="s3">;</span>
    <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
      <span class="s0">out += </span><span class="s2">' {} '</span><span class="s3">;</span>
    <span class="s0">}</span>
    <span class="s1">var </span><span class="s0">__err = out</span><span class="s3">;</span>
    <span class="s0">out = $$outStack.pop()</span><span class="s3">;</span>
    <span class="s1">if </span><span class="s0">(!it.compositeRule &amp;&amp; $breakOnError) {</span>
      <span class="s7">/* istanbul ignore if */</span>
      <span class="s1">if </span><span class="s0">(it.async) {</span>
        <span class="s0">out += </span><span class="s2">' throw new ValidationError([' </span><span class="s0">+ (__err) + </span><span class="s2">']); '</span><span class="s3">;</span>
      <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
        <span class="s0">out += </span><span class="s2">' validate.errors = [' </span><span class="s0">+ (__err) + </span><span class="s2">']; return false; '</span><span class="s3">;</span>
      <span class="s0">}</span>
    <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
      <span class="s0">out += </span><span class="s2">' var err = ' </span><span class="s0">+ (__err) + </span><span class="s2">';  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; '</span><span class="s3">;</span>
    <span class="s0">}</span>
    <span class="s0">out += </span><span class="s2">' } '</span><span class="s3">;</span>
    <span class="s1">if </span><span class="s0">($breakOnError) {</span>
      <span class="s0">out += </span><span class="s2">' else { '</span><span class="s3">;</span>
    <span class="s0">}</span>
  <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
    <span class="s1">if </span><span class="s0">($breakOnError) {</span>
      <span class="s0">out += </span><span class="s2">' if (true) { '</span><span class="s3">;</span>
    <span class="s0">}</span>
  <span class="s0">}</span>
  <span class="s1">return </span><span class="s0">out</span><span class="s3">;</span>
<span class="s0">}</span>

<span class="s0">}</span><span class="s3">,</span><span class="s0">{}]</span><span class="s3">,</span><span class="s4">38</span><span class="s0">:[</span><span class="s1">function</span><span class="s0">(require</span><span class="s3">,</span><span class="s0">module</span><span class="s3">,</span><span class="s0">exports){</span>
<span class="s2">'use strict'</span><span class="s3">;</span>
<span class="s0">module.exports = </span><span class="s1">function </span><span class="s0">generate_validate(it</span><span class="s3">, </span><span class="s0">$keyword</span><span class="s3">, </span><span class="s0">$ruleType) {</span>
  <span class="s1">var </span><span class="s0">out = </span><span class="s2">''</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$async = it.schema.$async === </span><span class="s1">true</span><span class="s3">,</span>
    <span class="s0">$refKeywords = it.util.schemaHasRulesExcept(it.schema</span><span class="s3">, </span><span class="s0">it.RULES.all</span><span class="s3">, </span><span class="s2">'$ref'</span><span class="s0">)</span><span class="s3">,</span>
    <span class="s0">$id = it.self._getId(it.schema)</span><span class="s3">;</span>
  <span class="s1">if </span><span class="s0">(it.opts.strictKeywords) {</span>
    <span class="s1">var </span><span class="s0">$unknownKwd = it.util.schemaUnknownRules(it.schema</span><span class="s3">, </span><span class="s0">it.RULES.keywords)</span><span class="s3">;</span>
    <span class="s1">if </span><span class="s0">($unknownKwd) {</span>
      <span class="s1">var </span><span class="s0">$keywordsMsg = </span><span class="s2">'unknown keyword: ' </span><span class="s0">+ $unknownKwd</span><span class="s3">;</span>
      <span class="s1">if </span><span class="s0">(it.opts.strictKeywords === </span><span class="s2">'log'</span><span class="s0">) it.logger.warn($keywordsMsg)</span><span class="s3">;</span>
      <span class="s1">else throw new </span><span class="s0">Error($keywordsMsg)</span><span class="s3">;</span>
    <span class="s0">}</span>
  <span class="s0">}</span>
  <span class="s1">if </span><span class="s0">(it.isTop) {</span>
    <span class="s0">out += </span><span class="s2">' var validate = '</span><span class="s3">;</span>
    <span class="s1">if </span><span class="s0">($async) {</span>
      <span class="s0">it.async = </span><span class="s1">true</span><span class="s3">;</span>
      <span class="s0">out += </span><span class="s2">'async '</span><span class="s3">;</span>
    <span class="s0">}</span>
    <span class="s0">out += </span><span class="s2">'function(data, dataPath, parentData, parentDataProperty, rootData) { </span><span class="s3">\'</span><span class="s2">use strict</span><span class="s3">\'</span><span class="s2">; '</span><span class="s3">;</span>
    <span class="s1">if </span><span class="s0">($id &amp;&amp; (it.opts.sourceCode || it.opts.processCode)) {</span>
      <span class="s0">out += </span><span class="s2">' ' </span><span class="s0">+ (</span><span class="s2">'/</span><span class="s3">\*</span><span class="s2"># sourceURL=' </span><span class="s0">+ $id + </span><span class="s2">' */'</span><span class="s0">) + </span><span class="s2">' '</span><span class="s3">;</span>
    <span class="s0">}</span>
  <span class="s0">}</span>
  <span class="s1">if </span><span class="s0">(</span><span class="s1">typeof </span><span class="s0">it.schema == </span><span class="s2">'boolean' </span><span class="s0">|| !($refKeywords || it.schema.$ref)) {</span>
    <span class="s1">var </span><span class="s0">$keyword = </span><span class="s2">'false schema'</span><span class="s3">;</span>
    <span class="s1">var </span><span class="s0">$lvl = it.level</span><span class="s3">;</span>
    <span class="s1">var </span><span class="s0">$dataLvl = it.dataLevel</span><span class="s3">;</span>
    <span class="s1">var </span><span class="s0">$schema = it.schema[$keyword]</span><span class="s3">;</span>
    <span class="s1">var </span><span class="s0">$schemaPath = it.schemaPath + it.util.getProperty($keyword)</span><span class="s3">;</span>
    <span class="s1">var </span><span class="s0">$errSchemaPath = it.errSchemaPath + </span><span class="s2">'/' </span><span class="s0">+ $keyword</span><span class="s3">;</span>
    <span class="s1">var </span><span class="s0">$breakOnError = !it.opts.allErrors</span><span class="s3">;</span>
    <span class="s1">var </span><span class="s0">$errorKeyword</span><span class="s3">;</span>
    <span class="s1">var </span><span class="s0">$data = </span><span class="s2">'data' </span><span class="s0">+ ($dataLvl || </span><span class="s2">''</span><span class="s0">)</span><span class="s3">;</span>
    <span class="s1">var </span><span class="s0">$valid = </span><span class="s2">'valid' </span><span class="s0">+ $lvl</span><span class="s3">;</span>
    <span class="s1">if </span><span class="s0">(it.schema === </span><span class="s1">false</span><span class="s0">) {</span>
      <span class="s1">if </span><span class="s0">(it.isTop) {</span>
        <span class="s0">$breakOnError = </span><span class="s1">true</span><span class="s3">;</span>
      <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
        <span class="s0">out += </span><span class="s2">' var ' </span><span class="s0">+ ($valid) + </span><span class="s2">' = false; '</span><span class="s3">;</span>
      <span class="s0">}</span>
      <span class="s1">var </span><span class="s0">$$outStack = $$outStack || []</span><span class="s3">;</span>
      <span class="s0">$$outStack.push(out)</span><span class="s3">;</span>
      <span class="s0">out = </span><span class="s2">''</span><span class="s3">; </span><span class="s7">/* istanbul ignore else */</span>
      <span class="s1">if </span><span class="s0">(it.createErrors !== </span><span class="s1">false</span><span class="s0">) {</span>
        <span class="s0">out += </span><span class="s2">' { keyword: </span><span class="s3">\'</span><span class="s2">' </span><span class="s0">+ ($errorKeyword || </span><span class="s2">'false schema'</span><span class="s0">) + </span><span class="s2">'</span><span class="s3">\' </span><span class="s2">, dataPath: (dataPath || </span><span class="s3">\'\'</span><span class="s2">) + ' </span><span class="s0">+ (it.errorPath) + </span><span class="s2">' , schemaPath: ' </span><span class="s0">+ (it.util.toQuotedString($errSchemaPath)) + </span><span class="s2">' , params: {} '</span><span class="s3">;</span>
        <span class="s1">if </span><span class="s0">(it.opts.messages !== </span><span class="s1">false</span><span class="s0">) {</span>
          <span class="s0">out += </span><span class="s2">' , message: </span><span class="s3">\'</span><span class="s2">boolean schema is false</span><span class="s3">\' </span><span class="s2">'</span><span class="s3">;</span>
        <span class="s0">}</span>
        <span class="s1">if </span><span class="s0">(it.opts.verbose) {</span>
          <span class="s0">out += </span><span class="s2">' , schema: false , parentSchema: validate.schema' </span><span class="s0">+ (it.schemaPath) + </span><span class="s2">' , data: ' </span><span class="s0">+ ($data) + </span><span class="s2">' '</span><span class="s3">;</span>
        <span class="s0">}</span>
        <span class="s0">out += </span><span class="s2">' } '</span><span class="s3">;</span>
      <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
        <span class="s0">out += </span><span class="s2">' {} '</span><span class="s3">;</span>
      <span class="s0">}</span>
      <span class="s1">var </span><span class="s0">__err = out</span><span class="s3">;</span>
      <span class="s0">out = $$outStack.pop()</span><span class="s3">;</span>
      <span class="s1">if </span><span class="s0">(!it.compositeRule &amp;&amp; $breakOnError) {</span>
        <span class="s7">/* istanbul ignore if */</span>
        <span class="s1">if </span><span class="s0">(it.async) {</span>
          <span class="s0">out += </span><span class="s2">' throw new ValidationError([' </span><span class="s0">+ (__err) + </span><span class="s2">']); '</span><span class="s3">;</span>
        <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
          <span class="s0">out += </span><span class="s2">' validate.errors = [' </span><span class="s0">+ (__err) + </span><span class="s2">']; return false; '</span><span class="s3">;</span>
        <span class="s0">}</span>
      <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
        <span class="s0">out += </span><span class="s2">' var err = ' </span><span class="s0">+ (__err) + </span><span class="s2">';  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; '</span><span class="s3">;</span>
      <span class="s0">}</span>
    <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
      <span class="s1">if </span><span class="s0">(it.isTop) {</span>
        <span class="s1">if </span><span class="s0">($async) {</span>
          <span class="s0">out += </span><span class="s2">' return data; '</span><span class="s3">;</span>
        <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
          <span class="s0">out += </span><span class="s2">' validate.errors = null; return true; '</span><span class="s3">;</span>
        <span class="s0">}</span>
      <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
        <span class="s0">out += </span><span class="s2">' var ' </span><span class="s0">+ ($valid) + </span><span class="s2">' = true; '</span><span class="s3">;</span>
      <span class="s0">}</span>
    <span class="s0">}</span>
    <span class="s1">if </span><span class="s0">(it.isTop) {</span>
      <span class="s0">out += </span><span class="s2">' }; return validate; '</span><span class="s3">;</span>
    <span class="s0">}</span>
    <span class="s1">return </span><span class="s0">out</span><span class="s3">;</span>
  <span class="s0">}</span>
  <span class="s1">if </span><span class="s0">(it.isTop) {</span>
    <span class="s1">var </span><span class="s0">$top = it.isTop</span><span class="s3">,</span>
      <span class="s0">$lvl = it.level = </span><span class="s4">0</span><span class="s3">,</span>
      <span class="s0">$dataLvl = it.dataLevel = </span><span class="s4">0</span><span class="s3">,</span>
      <span class="s0">$data = </span><span class="s2">'data'</span><span class="s3">;</span>
    <span class="s0">it.rootId = it.resolve.fullPath(it.self._getId(it.root.schema))</span><span class="s3">;</span>
    <span class="s0">it.baseId = it.baseId || it.rootId</span><span class="s3">;</span>
    <span class="s1">delete </span><span class="s0">it.isTop</span><span class="s3">;</span>
    <span class="s0">it.dataPathArr = [</span><span class="s2">&quot;&quot;</span><span class="s0">]</span><span class="s3">;</span>
    <span class="s1">if </span><span class="s0">(it.schema.default !== undefined &amp;&amp; it.opts.useDefaults &amp;&amp; it.opts.strictDefaults) {</span>
      <span class="s1">var </span><span class="s0">$defaultMsg = </span><span class="s2">'default is ignored in the schema root'</span><span class="s3">;</span>
      <span class="s1">if </span><span class="s0">(it.opts.strictDefaults === </span><span class="s2">'log'</span><span class="s0">) it.logger.warn($defaultMsg)</span><span class="s3">;</span>
      <span class="s1">else throw new </span><span class="s0">Error($defaultMsg)</span><span class="s3">;</span>
    <span class="s0">}</span>
    <span class="s0">out += </span><span class="s2">' var vErrors = null; '</span><span class="s3">;</span>
    <span class="s0">out += </span><span class="s2">' var errors = 0;     '</span><span class="s3">;</span>
    <span class="s0">out += </span><span class="s2">' if (rootData === undefined) rootData = data; '</span><span class="s3">;</span>
  <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
    <span class="s1">var </span><span class="s0">$lvl = it.level</span><span class="s3">,</span>
      <span class="s0">$dataLvl = it.dataLevel</span><span class="s3">,</span>
      <span class="s0">$data = </span><span class="s2">'data' </span><span class="s0">+ ($dataLvl || </span><span class="s2">''</span><span class="s0">)</span><span class="s3">;</span>
    <span class="s1">if </span><span class="s0">($id) it.baseId = it.resolve.url(it.baseId</span><span class="s3">, </span><span class="s0">$id)</span><span class="s3">;</span>
    <span class="s1">if </span><span class="s0">($async &amp;&amp; !it.async) </span><span class="s1">throw new </span><span class="s0">Error(</span><span class="s2">'async schema in sync schema'</span><span class="s0">)</span><span class="s3">;</span>
    <span class="s0">out += </span><span class="s2">' var errs_' </span><span class="s0">+ ($lvl) + </span><span class="s2">' = errors;'</span><span class="s3">;</span>
  <span class="s0">}</span>
  <span class="s1">var </span><span class="s0">$valid = </span><span class="s2">'valid' </span><span class="s0">+ $lvl</span><span class="s3">,</span>
    <span class="s0">$breakOnError = !it.opts.allErrors</span><span class="s3">,</span>
    <span class="s0">$closingBraces1 = </span><span class="s2">''</span><span class="s3">,</span>
    <span class="s0">$closingBraces2 = </span><span class="s2">''</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$errorKeyword</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">$typeSchema = it.schema.type</span><span class="s3">,</span>
    <span class="s0">$typeIsArray = Array.isArray($typeSchema)</span><span class="s3">;</span>
  <span class="s1">if </span><span class="s0">($typeSchema &amp;&amp; it.opts.nullable &amp;&amp; it.schema.nullable === </span><span class="s1">true</span><span class="s0">) {</span>
    <span class="s1">if </span><span class="s0">($typeIsArray) {</span>
      <span class="s1">if </span><span class="s0">($typeSchema.indexOf(</span><span class="s2">'null'</span><span class="s0">) == -</span><span class="s4">1</span><span class="s0">) $typeSchema = $typeSchema.concat(</span><span class="s2">'null'</span><span class="s0">)</span><span class="s3">;</span>
    <span class="s0">} </span><span class="s1">else if </span><span class="s0">($typeSchema != </span><span class="s2">'null'</span><span class="s0">) {</span>
      <span class="s0">$typeSchema = [$typeSchema</span><span class="s3">, </span><span class="s2">'null'</span><span class="s0">]</span><span class="s3">;</span>
      <span class="s0">$typeIsArray = </span><span class="s1">true</span><span class="s3">;</span>
    <span class="s0">}</span>
  <span class="s0">}</span>
  <span class="s1">if </span><span class="s0">($typeIsArray &amp;&amp; $typeSchema.length == </span><span class="s4">1</span><span class="s0">) {</span>
    <span class="s0">$typeSchema = $typeSchema[</span><span class="s4">0</span><span class="s0">]</span><span class="s3">;</span>
    <span class="s0">$typeIsArray = </span><span class="s1">false</span><span class="s3">;</span>
  <span class="s0">}</span>
  <span class="s1">if </span><span class="s0">(it.schema.$ref &amp;&amp; $refKeywords) {</span>
    <span class="s1">if </span><span class="s0">(it.opts.extendRefs == </span><span class="s2">'fail'</span><span class="s0">) {</span>
      <span class="s1">throw new </span><span class="s0">Error(</span><span class="s2">'$ref: validation keywords used in schema at path &quot;' </span><span class="s0">+ it.errSchemaPath + </span><span class="s2">'&quot; (see option extendRefs)'</span><span class="s0">)</span><span class="s3">;</span>
    <span class="s0">} </span><span class="s1">else if </span><span class="s0">(it.opts.extendRefs !== </span><span class="s1">true</span><span class="s0">) {</span>
      <span class="s0">$refKeywords = </span><span class="s1">false</span><span class="s3">;</span>
      <span class="s0">it.logger.warn(</span><span class="s2">'$ref: keywords ignored in schema at path &quot;' </span><span class="s0">+ it.errSchemaPath + </span><span class="s2">'&quot;'</span><span class="s0">)</span><span class="s3">;</span>
    <span class="s0">}</span>
  <span class="s0">}</span>
  <span class="s1">if </span><span class="s0">(it.schema.$comment &amp;&amp; it.opts.$comment) {</span>
    <span class="s0">out += </span><span class="s2">' ' </span><span class="s0">+ (it.RULES.all.$comment.code(it</span><span class="s3">, </span><span class="s2">'$comment'</span><span class="s0">))</span><span class="s3">;</span>
  <span class="s0">}</span>
  <span class="s1">if </span><span class="s0">($typeSchema) {</span>
    <span class="s1">if </span><span class="s0">(it.opts.coerceTypes) {</span>
      <span class="s1">var </span><span class="s0">$coerceToTypes = it.util.coerceToTypes(it.opts.coerceTypes</span><span class="s3">, </span><span class="s0">$typeSchema)</span><span class="s3">;</span>
    <span class="s0">}</span>
    <span class="s1">var </span><span class="s0">$rulesGroup = it.RULES.types[$typeSchema]</span><span class="s3">;</span>
    <span class="s1">if </span><span class="s0">($coerceToTypes || $typeIsArray || $rulesGroup === </span><span class="s1">true </span><span class="s0">|| ($rulesGroup &amp;&amp; !$shouldUseGroup($rulesGroup))) {</span>
      <span class="s1">var </span><span class="s0">$schemaPath = it.schemaPath + </span><span class="s2">'.type'</span><span class="s3">,</span>
        <span class="s0">$errSchemaPath = it.errSchemaPath + </span><span class="s2">'/type'</span><span class="s3">;</span>
      <span class="s1">var </span><span class="s0">$schemaPath = it.schemaPath + </span><span class="s2">'.type'</span><span class="s3">,</span>
        <span class="s0">$errSchemaPath = it.errSchemaPath + </span><span class="s2">'/type'</span><span class="s3">,</span>
        <span class="s0">$method = $typeIsArray ? </span><span class="s2">'checkDataTypes' </span><span class="s0">: </span><span class="s2">'checkDataType'</span><span class="s3">;</span>
      <span class="s0">out += </span><span class="s2">' if (' </span><span class="s0">+ (it.util[$method]($typeSchema</span><span class="s3">, </span><span class="s0">$data</span><span class="s3">, </span><span class="s0">it.opts.strictNumbers</span><span class="s3">, </span><span class="s1">true</span><span class="s0">)) + </span><span class="s2">') { '</span><span class="s3">;</span>
      <span class="s1">if </span><span class="s0">($coerceToTypes) {</span>
        <span class="s1">var </span><span class="s0">$dataType = </span><span class="s2">'dataType' </span><span class="s0">+ $lvl</span><span class="s3">,</span>
          <span class="s0">$coerced = </span><span class="s2">'coerced' </span><span class="s0">+ $lvl</span><span class="s3">;</span>
        <span class="s0">out += </span><span class="s2">' var ' </span><span class="s0">+ ($dataType) + </span><span class="s2">' = typeof ' </span><span class="s0">+ ($data) + </span><span class="s2">'; var ' </span><span class="s0">+ ($coerced) + </span><span class="s2">' = undefined; '</span><span class="s3">;</span>
        <span class="s1">if </span><span class="s0">(it.opts.coerceTypes == </span><span class="s2">'array'</span><span class="s0">) {</span>
          <span class="s0">out += </span><span class="s2">' if (' </span><span class="s0">+ ($dataType) + </span><span class="s2">' == </span><span class="s3">\'</span><span class="s2">object</span><span class="s3">\' </span><span class="s2">&amp;&amp; Array.isArray(' </span><span class="s0">+ ($data) + </span><span class="s2">') &amp;&amp; ' </span><span class="s0">+ ($data) + </span><span class="s2">'.length == 1) { ' </span><span class="s0">+ ($data) + </span><span class="s2">' = ' </span><span class="s0">+ ($data) + </span><span class="s2">'[0]; ' </span><span class="s0">+ ($dataType) + </span><span class="s2">' = typeof ' </span><span class="s0">+ ($data) + </span><span class="s2">'; if (' </span><span class="s0">+ (it.util.checkDataType(it.schema.type</span><span class="s3">, </span><span class="s0">$data</span><span class="s3">, </span><span class="s0">it.opts.strictNumbers)) + </span><span class="s2">') ' </span><span class="s0">+ ($coerced) + </span><span class="s2">' = ' </span><span class="s0">+ ($data) + </span><span class="s2">'; } '</span><span class="s3">;</span>
        <span class="s0">}</span>
        <span class="s0">out += </span><span class="s2">' if (' </span><span class="s0">+ ($coerced) + </span><span class="s2">' !== undefined) ; '</span><span class="s3">;</span>
        <span class="s1">var </span><span class="s0">arr1 = $coerceToTypes</span><span class="s3">;</span>
        <span class="s1">if </span><span class="s0">(arr1) {</span>
          <span class="s1">var </span><span class="s0">$type</span><span class="s3">, </span><span class="s0">$i = -</span><span class="s4">1</span><span class="s3">,</span>
            <span class="s0">l1 = arr1.length - </span><span class="s4">1</span><span class="s3">;</span>
          <span class="s1">while </span><span class="s0">($i &lt; l1) {</span>
            <span class="s0">$type = arr1[$i += </span><span class="s4">1</span><span class="s0">]</span><span class="s3">;</span>
            <span class="s1">if </span><span class="s0">($type == </span><span class="s2">'string'</span><span class="s0">) {</span>
              <span class="s0">out += </span><span class="s2">' else if (' </span><span class="s0">+ ($dataType) + </span><span class="s2">' == </span><span class="s3">\'</span><span class="s2">number</span><span class="s3">\' </span><span class="s2">|| ' </span><span class="s0">+ ($dataType) + </span><span class="s2">' == </span><span class="s3">\'</span><span class="s2">boolean</span><span class="s3">\'</span><span class="s2">) ' </span><span class="s0">+ ($coerced) + </span><span class="s2">' = </span><span class="s3">\'\' </span><span class="s2">+ ' </span><span class="s0">+ ($data) + </span><span class="s2">'; else if (' </span><span class="s0">+ ($data) + </span><span class="s2">' === null) ' </span><span class="s0">+ ($coerced) + </span><span class="s2">' = </span><span class="s3">\'\'</span><span class="s2">; '</span><span class="s3">;</span>
            <span class="s0">} </span><span class="s1">else if </span><span class="s0">($type == </span><span class="s2">'number' </span><span class="s0">|| $type == </span><span class="s2">'integer'</span><span class="s0">) {</span>
              <span class="s0">out += </span><span class="s2">' else if (' </span><span class="s0">+ ($dataType) + </span><span class="s2">' == </span><span class="s3">\'</span><span class="s2">boolean</span><span class="s3">\' </span><span class="s2">|| ' </span><span class="s0">+ ($data) + </span><span class="s2">' === null || (' </span><span class="s0">+ ($dataType) + </span><span class="s2">' == </span><span class="s3">\'</span><span class="s2">string</span><span class="s3">\' </span><span class="s2">&amp;&amp; ' </span><span class="s0">+ ($data) + </span><span class="s2">' &amp;&amp; ' </span><span class="s0">+ ($data) + </span><span class="s2">' == +' </span><span class="s0">+ ($data) + </span><span class="s2">' '</span><span class="s3">;</span>
              <span class="s1">if </span><span class="s0">($type == </span><span class="s2">'integer'</span><span class="s0">) {</span>
                <span class="s0">out += </span><span class="s2">' &amp;&amp; !(' </span><span class="s0">+ ($data) + </span><span class="s2">' % 1)'</span><span class="s3">;</span>
              <span class="s0">}</span>
              <span class="s0">out += </span><span class="s2">')) ' </span><span class="s0">+ ($coerced) + </span><span class="s2">' = +' </span><span class="s0">+ ($data) + </span><span class="s2">'; '</span><span class="s3">;</span>
            <span class="s0">} </span><span class="s1">else if </span><span class="s0">($type == </span><span class="s2">'boolean'</span><span class="s0">) {</span>
              <span class="s0">out += </span><span class="s2">' else if (' </span><span class="s0">+ ($data) + </span><span class="s2">' === </span><span class="s3">\'</span><span class="s2">false</span><span class="s3">\' </span><span class="s2">|| ' </span><span class="s0">+ ($data) + </span><span class="s2">' === 0 || ' </span><span class="s0">+ ($data) + </span><span class="s2">' === null) ' </span><span class="s0">+ ($coerced) + </span><span class="s2">' = false; else if (' </span><span class="s0">+ ($data) + </span><span class="s2">' === </span><span class="s3">\'</span><span class="s2">true</span><span class="s3">\' </span><span class="s2">|| ' </span><span class="s0">+ ($data) + </span><span class="s2">' === 1) ' </span><span class="s0">+ ($coerced) + </span><span class="s2">' = true; '</span><span class="s3">;</span>
            <span class="s0">} </span><span class="s1">else if </span><span class="s0">($type == </span><span class="s2">'null'</span><span class="s0">) {</span>
              <span class="s0">out += </span><span class="s2">' else if (' </span><span class="s0">+ ($data) + </span><span class="s2">' === </span><span class="s3">\'\' </span><span class="s2">|| ' </span><span class="s0">+ ($data) + </span><span class="s2">' === 0 || ' </span><span class="s0">+ ($data) + </span><span class="s2">' === false) ' </span><span class="s0">+ ($coerced) + </span><span class="s2">' = null; '</span><span class="s3">;</span>
            <span class="s0">} </span><span class="s1">else if </span><span class="s0">(it.opts.coerceTypes == </span><span class="s2">'array' </span><span class="s0">&amp;&amp; $type == </span><span class="s2">'array'</span><span class="s0">) {</span>
              <span class="s0">out += </span><span class="s2">' else if (' </span><span class="s0">+ ($dataType) + </span><span class="s2">' == </span><span class="s3">\'</span><span class="s2">string</span><span class="s3">\' </span><span class="s2">|| ' </span><span class="s0">+ ($dataType) + </span><span class="s2">' == </span><span class="s3">\'</span><span class="s2">number</span><span class="s3">\' </span><span class="s2">|| ' </span><span class="s0">+ ($dataType) + </span><span class="s2">' == </span><span class="s3">\'</span><span class="s2">boolean</span><span class="s3">\' </span><span class="s2">|| ' </span><span class="s0">+ ($data) + </span><span class="s2">' == null) ' </span><span class="s0">+ ($coerced) + </span><span class="s2">' = [' </span><span class="s0">+ ($data) + </span><span class="s2">']; '</span><span class="s3">;</span>
            <span class="s0">}</span>
          <span class="s0">}</span>
        <span class="s0">}</span>
        <span class="s0">out += </span><span class="s2">' else {   '</span><span class="s3">;</span>
        <span class="s1">var </span><span class="s0">$$outStack = $$outStack || []</span><span class="s3">;</span>
        <span class="s0">$$outStack.push(out)</span><span class="s3">;</span>
        <span class="s0">out = </span><span class="s2">''</span><span class="s3">; </span><span class="s7">/* istanbul ignore else */</span>
        <span class="s1">if </span><span class="s0">(it.createErrors !== </span><span class="s1">false</span><span class="s0">) {</span>
          <span class="s0">out += </span><span class="s2">' { keyword: </span><span class="s3">\'</span><span class="s2">' </span><span class="s0">+ ($errorKeyword || </span><span class="s2">'type'</span><span class="s0">) + </span><span class="s2">'</span><span class="s3">\' </span><span class="s2">, dataPath: (dataPath || </span><span class="s3">\'\'</span><span class="s2">) + ' </span><span class="s0">+ (it.errorPath) + </span><span class="s2">' , schemaPath: ' </span><span class="s0">+ (it.util.toQuotedString($errSchemaPath)) + </span><span class="s2">' , params: { type: </span><span class="s3">\'</span><span class="s2">'</span><span class="s3">;</span>
          <span class="s1">if </span><span class="s0">($typeIsArray) {</span>
            <span class="s0">out += </span><span class="s2">'' </span><span class="s0">+ ($typeSchema.join(</span><span class="s2">&quot;,&quot;</span><span class="s0">))</span><span class="s3">;</span>
          <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
            <span class="s0">out += </span><span class="s2">'' </span><span class="s0">+ ($typeSchema)</span><span class="s3">;</span>
          <span class="s0">}</span>
          <span class="s0">out += </span><span class="s2">'</span><span class="s3">\' </span><span class="s2">} '</span><span class="s3">;</span>
          <span class="s1">if </span><span class="s0">(it.opts.messages !== </span><span class="s1">false</span><span class="s0">) {</span>
            <span class="s0">out += </span><span class="s2">' , message: </span><span class="s3">\'</span><span class="s2">should be '</span><span class="s3">;</span>
            <span class="s1">if </span><span class="s0">($typeIsArray) {</span>
              <span class="s0">out += </span><span class="s2">'' </span><span class="s0">+ ($typeSchema.join(</span><span class="s2">&quot;,&quot;</span><span class="s0">))</span><span class="s3">;</span>
            <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
              <span class="s0">out += </span><span class="s2">'' </span><span class="s0">+ ($typeSchema)</span><span class="s3">;</span>
            <span class="s0">}</span>
            <span class="s0">out += </span><span class="s2">'</span><span class="s3">\' </span><span class="s2">'</span><span class="s3">;</span>
          <span class="s0">}</span>
          <span class="s1">if </span><span class="s0">(it.opts.verbose) {</span>
            <span class="s0">out += </span><span class="s2">' , schema: validate.schema' </span><span class="s0">+ ($schemaPath) + </span><span class="s2">' , parentSchema: validate.schema' </span><span class="s0">+ (it.schemaPath) + </span><span class="s2">' , data: ' </span><span class="s0">+ ($data) + </span><span class="s2">' '</span><span class="s3">;</span>
          <span class="s0">}</span>
          <span class="s0">out += </span><span class="s2">' } '</span><span class="s3">;</span>
        <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
          <span class="s0">out += </span><span class="s2">' {} '</span><span class="s3">;</span>
        <span class="s0">}</span>
        <span class="s1">var </span><span class="s0">__err = out</span><span class="s3">;</span>
        <span class="s0">out = $$outStack.pop()</span><span class="s3">;</span>
        <span class="s1">if </span><span class="s0">(!it.compositeRule &amp;&amp; $breakOnError) {</span>
          <span class="s7">/* istanbul ignore if */</span>
          <span class="s1">if </span><span class="s0">(it.async) {</span>
            <span class="s0">out += </span><span class="s2">' throw new ValidationError([' </span><span class="s0">+ (__err) + </span><span class="s2">']); '</span><span class="s3">;</span>
          <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
            <span class="s0">out += </span><span class="s2">' validate.errors = [' </span><span class="s0">+ (__err) + </span><span class="s2">']; return false; '</span><span class="s3">;</span>
          <span class="s0">}</span>
        <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
          <span class="s0">out += </span><span class="s2">' var err = ' </span><span class="s0">+ (__err) + </span><span class="s2">';  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; '</span><span class="s3">;</span>
        <span class="s0">}</span>
        <span class="s0">out += </span><span class="s2">' } if (' </span><span class="s0">+ ($coerced) + </span><span class="s2">' !== undefined) {  '</span><span class="s3">;</span>
        <span class="s1">var </span><span class="s0">$parentData = $dataLvl ? </span><span class="s2">'data' </span><span class="s0">+ (($dataLvl - </span><span class="s4">1</span><span class="s0">) || </span><span class="s2">''</span><span class="s0">) : </span><span class="s2">'parentData'</span><span class="s3">,</span>
          <span class="s0">$parentDataProperty = $dataLvl ? it.dataPathArr[$dataLvl] : </span><span class="s2">'parentDataProperty'</span><span class="s3">;</span>
        <span class="s0">out += </span><span class="s2">' ' </span><span class="s0">+ ($data) + </span><span class="s2">' = ' </span><span class="s0">+ ($coerced) + </span><span class="s2">'; '</span><span class="s3">;</span>
        <span class="s1">if </span><span class="s0">(!$dataLvl) {</span>
          <span class="s0">out += </span><span class="s2">'if (' </span><span class="s0">+ ($parentData) + </span><span class="s2">' !== undefined)'</span><span class="s3">;</span>
        <span class="s0">}</span>
        <span class="s0">out += </span><span class="s2">' ' </span><span class="s0">+ ($parentData) + </span><span class="s2">'[' </span><span class="s0">+ ($parentDataProperty) + </span><span class="s2">'] = ' </span><span class="s0">+ ($coerced) + </span><span class="s2">'; } '</span><span class="s3">;</span>
      <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
        <span class="s1">var </span><span class="s0">$$outStack = $$outStack || []</span><span class="s3">;</span>
        <span class="s0">$$outStack.push(out)</span><span class="s3">;</span>
        <span class="s0">out = </span><span class="s2">''</span><span class="s3">; </span><span class="s7">/* istanbul ignore else */</span>
        <span class="s1">if </span><span class="s0">(it.createErrors !== </span><span class="s1">false</span><span class="s0">) {</span>
          <span class="s0">out += </span><span class="s2">' { keyword: </span><span class="s3">\'</span><span class="s2">' </span><span class="s0">+ ($errorKeyword || </span><span class="s2">'type'</span><span class="s0">) + </span><span class="s2">'</span><span class="s3">\' </span><span class="s2">, dataPath: (dataPath || </span><span class="s3">\'\'</span><span class="s2">) + ' </span><span class="s0">+ (it.errorPath) + </span><span class="s2">' , schemaPath: ' </span><span class="s0">+ (it.util.toQuotedString($errSchemaPath)) + </span><span class="s2">' , params: { type: </span><span class="s3">\'</span><span class="s2">'</span><span class="s3">;</span>
          <span class="s1">if </span><span class="s0">($typeIsArray) {</span>
            <span class="s0">out += </span><span class="s2">'' </span><span class="s0">+ ($typeSchema.join(</span><span class="s2">&quot;,&quot;</span><span class="s0">))</span><span class="s3">;</span>
          <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
            <span class="s0">out += </span><span class="s2">'' </span><span class="s0">+ ($typeSchema)</span><span class="s3">;</span>
          <span class="s0">}</span>
          <span class="s0">out += </span><span class="s2">'</span><span class="s3">\' </span><span class="s2">} '</span><span class="s3">;</span>
          <span class="s1">if </span><span class="s0">(it.opts.messages !== </span><span class="s1">false</span><span class="s0">) {</span>
            <span class="s0">out += </span><span class="s2">' , message: </span><span class="s3">\'</span><span class="s2">should be '</span><span class="s3">;</span>
            <span class="s1">if </span><span class="s0">($typeIsArray) {</span>
              <span class="s0">out += </span><span class="s2">'' </span><span class="s0">+ ($typeSchema.join(</span><span class="s2">&quot;,&quot;</span><span class="s0">))</span><span class="s3">;</span>
            <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
              <span class="s0">out += </span><span class="s2">'' </span><span class="s0">+ ($typeSchema)</span><span class="s3">;</span>
            <span class="s0">}</span>
            <span class="s0">out += </span><span class="s2">'</span><span class="s3">\' </span><span class="s2">'</span><span class="s3">;</span>
          <span class="s0">}</span>
          <span class="s1">if </span><span class="s0">(it.opts.verbose) {</span>
            <span class="s0">out += </span><span class="s2">' , schema: validate.schema' </span><span class="s0">+ ($schemaPath) + </span><span class="s2">' , parentSchema: validate.schema' </span><span class="s0">+ (it.schemaPath) + </span><span class="s2">' , data: ' </span><span class="s0">+ ($data) + </span><span class="s2">' '</span><span class="s3">;</span>
          <span class="s0">}</span>
          <span class="s0">out += </span><span class="s2">' } '</span><span class="s3">;</span>
        <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
          <span class="s0">out += </span><span class="s2">' {} '</span><span class="s3">;</span>
        <span class="s0">}</span>
        <span class="s1">var </span><span class="s0">__err = out</span><span class="s3">;</span>
        <span class="s0">out = $$outStack.pop()</span><span class="s3">;</span>
        <span class="s1">if </span><span class="s0">(!it.compositeRule &amp;&amp; $breakOnError) {</span>
          <span class="s7">/* istanbul ignore if */</span>
          <span class="s1">if </span><span class="s0">(it.async) {</span>
            <span class="s0">out += </span><span class="s2">' throw new ValidationError([' </span><span class="s0">+ (__err) + </span><span class="s2">']); '</span><span class="s3">;</span>
          <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
            <span class="s0">out += </span><span class="s2">' validate.errors = [' </span><span class="s0">+ (__err) + </span><span class="s2">']; return false; '</span><span class="s3">;</span>
          <span class="s0">}</span>
        <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
          <span class="s0">out += </span><span class="s2">' var err = ' </span><span class="s0">+ (__err) + </span><span class="s2">';  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; '</span><span class="s3">;</span>
        <span class="s0">}</span>
      <span class="s0">}</span>
      <span class="s0">out += </span><span class="s2">' } '</span><span class="s3">;</span>
    <span class="s0">}</span>
  <span class="s0">}</span>
  <span class="s1">if </span><span class="s0">(it.schema.$ref &amp;&amp; !$refKeywords) {</span>
    <span class="s0">out += </span><span class="s2">' ' </span><span class="s0">+ (it.RULES.all.$ref.code(it</span><span class="s3">, </span><span class="s2">'$ref'</span><span class="s0">)) + </span><span class="s2">' '</span><span class="s3">;</span>
    <span class="s1">if </span><span class="s0">($breakOnError) {</span>
      <span class="s0">out += </span><span class="s2">' } if (errors === '</span><span class="s3">;</span>
      <span class="s1">if </span><span class="s0">($top) {</span>
        <span class="s0">out += </span><span class="s2">'0'</span><span class="s3">;</span>
      <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
        <span class="s0">out += </span><span class="s2">'errs_' </span><span class="s0">+ ($lvl)</span><span class="s3">;</span>
      <span class="s0">}</span>
      <span class="s0">out += </span><span class="s2">') { '</span><span class="s3">;</span>
      <span class="s0">$closingBraces2 += </span><span class="s2">'}'</span><span class="s3">;</span>
    <span class="s0">}</span>
  <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
    <span class="s1">var </span><span class="s0">arr2 = it.RULES</span><span class="s3">;</span>
    <span class="s1">if </span><span class="s0">(arr2) {</span>
      <span class="s1">var </span><span class="s0">$rulesGroup</span><span class="s3">, </span><span class="s0">i2 = -</span><span class="s4">1</span><span class="s3">,</span>
        <span class="s0">l2 = arr2.length - </span><span class="s4">1</span><span class="s3">;</span>
      <span class="s1">while </span><span class="s0">(i2 &lt; l2) {</span>
        <span class="s0">$rulesGroup = arr2[i2 += </span><span class="s4">1</span><span class="s0">]</span><span class="s3">;</span>
        <span class="s1">if </span><span class="s0">($shouldUseGroup($rulesGroup)) {</span>
          <span class="s1">if </span><span class="s0">($rulesGroup.type) {</span>
            <span class="s0">out += </span><span class="s2">' if (' </span><span class="s0">+ (it.util.checkDataType($rulesGroup.type</span><span class="s3">, </span><span class="s0">$data</span><span class="s3">, </span><span class="s0">it.opts.strictNumbers)) + </span><span class="s2">') { '</span><span class="s3">;</span>
          <span class="s0">}</span>
          <span class="s1">if </span><span class="s0">(it.opts.useDefaults) {</span>
            <span class="s1">if </span><span class="s0">($rulesGroup.type == </span><span class="s2">'object' </span><span class="s0">&amp;&amp; it.schema.properties) {</span>
              <span class="s1">var </span><span class="s0">$schema = it.schema.properties</span><span class="s3">,</span>
                <span class="s0">$schemaKeys = Object.keys($schema)</span><span class="s3">;</span>
              <span class="s1">var </span><span class="s0">arr3 = $schemaKeys</span><span class="s3">;</span>
              <span class="s1">if </span><span class="s0">(arr3) {</span>
                <span class="s1">var </span><span class="s0">$propertyKey</span><span class="s3">, </span><span class="s0">i3 = -</span><span class="s4">1</span><span class="s3">,</span>
                  <span class="s0">l3 = arr3.length - </span><span class="s4">1</span><span class="s3">;</span>
                <span class="s1">while </span><span class="s0">(i3 &lt; l3) {</span>
                  <span class="s0">$propertyKey = arr3[i3 += </span><span class="s4">1</span><span class="s0">]</span><span class="s3">;</span>
                  <span class="s1">var </span><span class="s0">$sch = $schema[$propertyKey]</span><span class="s3">;</span>
                  <span class="s1">if </span><span class="s0">($sch.default !== undefined) {</span>
                    <span class="s1">var </span><span class="s0">$passData = $data + it.util.getProperty($propertyKey)</span><span class="s3">;</span>
                    <span class="s1">if </span><span class="s0">(it.compositeRule) {</span>
                      <span class="s1">if </span><span class="s0">(it.opts.strictDefaults) {</span>
                        <span class="s1">var </span><span class="s0">$defaultMsg = </span><span class="s2">'default is ignored for: ' </span><span class="s0">+ $passData</span><span class="s3">;</span>
                        <span class="s1">if </span><span class="s0">(it.opts.strictDefaults === </span><span class="s2">'log'</span><span class="s0">) it.logger.warn($defaultMsg)</span><span class="s3">;</span>
                        <span class="s1">else throw new </span><span class="s0">Error($defaultMsg)</span><span class="s3">;</span>
                      <span class="s0">}</span>
                    <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
                      <span class="s0">out += </span><span class="s2">' if (' </span><span class="s0">+ ($passData) + </span><span class="s2">' === undefined '</span><span class="s3">;</span>
                      <span class="s1">if </span><span class="s0">(it.opts.useDefaults == </span><span class="s2">'empty'</span><span class="s0">) {</span>
                        <span class="s0">out += </span><span class="s2">' || ' </span><span class="s0">+ ($passData) + </span><span class="s2">' === null || ' </span><span class="s0">+ ($passData) + </span><span class="s2">' === </span><span class="s3">\'\' </span><span class="s2">'</span><span class="s3">;</span>
                      <span class="s0">}</span>
                      <span class="s0">out += </span><span class="s2">' ) ' </span><span class="s0">+ ($passData) + </span><span class="s2">' = '</span><span class="s3">;</span>
                      <span class="s1">if </span><span class="s0">(it.opts.useDefaults == </span><span class="s2">'shared'</span><span class="s0">) {</span>
                        <span class="s0">out += </span><span class="s2">' ' </span><span class="s0">+ (it.useDefault($sch.default)) + </span><span class="s2">' '</span><span class="s3">;</span>
                      <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
                        <span class="s0">out += </span><span class="s2">' ' </span><span class="s0">+ (JSON.stringify($sch.default)) + </span><span class="s2">' '</span><span class="s3">;</span>
                      <span class="s0">}</span>
                      <span class="s0">out += </span><span class="s2">'; '</span><span class="s3">;</span>
                    <span class="s0">}</span>
                  <span class="s0">}</span>
                <span class="s0">}</span>
              <span class="s0">}</span>
            <span class="s0">} </span><span class="s1">else if </span><span class="s0">($rulesGroup.type == </span><span class="s2">'array' </span><span class="s0">&amp;&amp; Array.isArray(it.schema.items)) {</span>
              <span class="s1">var </span><span class="s0">arr4 = it.schema.items</span><span class="s3">;</span>
              <span class="s1">if </span><span class="s0">(arr4) {</span>
                <span class="s1">var </span><span class="s0">$sch</span><span class="s3">, </span><span class="s0">$i = -</span><span class="s4">1</span><span class="s3">,</span>
                  <span class="s0">l4 = arr4.length - </span><span class="s4">1</span><span class="s3">;</span>
                <span class="s1">while </span><span class="s0">($i &lt; l4) {</span>
                  <span class="s0">$sch = arr4[$i += </span><span class="s4">1</span><span class="s0">]</span><span class="s3">;</span>
                  <span class="s1">if </span><span class="s0">($sch.default !== undefined) {</span>
                    <span class="s1">var </span><span class="s0">$passData = $data + </span><span class="s2">'[' </span><span class="s0">+ $i + </span><span class="s2">']'</span><span class="s3">;</span>
                    <span class="s1">if </span><span class="s0">(it.compositeRule) {</span>
                      <span class="s1">if </span><span class="s0">(it.opts.strictDefaults) {</span>
                        <span class="s1">var </span><span class="s0">$defaultMsg = </span><span class="s2">'default is ignored for: ' </span><span class="s0">+ $passData</span><span class="s3">;</span>
                        <span class="s1">if </span><span class="s0">(it.opts.strictDefaults === </span><span class="s2">'log'</span><span class="s0">) it.logger.warn($defaultMsg)</span><span class="s3">;</span>
                        <span class="s1">else throw new </span><span class="s0">Error($defaultMsg)</span><span class="s3">;</span>
                      <span class="s0">}</span>
                    <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
                      <span class="s0">out += </span><span class="s2">' if (' </span><span class="s0">+ ($passData) + </span><span class="s2">' === undefined '</span><span class="s3">;</span>
                      <span class="s1">if </span><span class="s0">(it.opts.useDefaults == </span><span class="s2">'empty'</span><span class="s0">) {</span>
                        <span class="s0">out += </span><span class="s2">' || ' </span><span class="s0">+ ($passData) + </span><span class="s2">' === null || ' </span><span class="s0">+ ($passData) + </span><span class="s2">' === </span><span class="s3">\'\' </span><span class="s2">'</span><span class="s3">;</span>
                      <span class="s0">}</span>
                      <span class="s0">out += </span><span class="s2">' ) ' </span><span class="s0">+ ($passData) + </span><span class="s2">' = '</span><span class="s3">;</span>
                      <span class="s1">if </span><span class="s0">(it.opts.useDefaults == </span><span class="s2">'shared'</span><span class="s0">) {</span>
                        <span class="s0">out += </span><span class="s2">' ' </span><span class="s0">+ (it.useDefault($sch.default)) + </span><span class="s2">' '</span><span class="s3">;</span>
                      <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
                        <span class="s0">out += </span><span class="s2">' ' </span><span class="s0">+ (JSON.stringify($sch.default)) + </span><span class="s2">' '</span><span class="s3">;</span>
                      <span class="s0">}</span>
                      <span class="s0">out += </span><span class="s2">'; '</span><span class="s3">;</span>
                    <span class="s0">}</span>
                  <span class="s0">}</span>
                <span class="s0">}</span>
              <span class="s0">}</span>
            <span class="s0">}</span>
          <span class="s0">}</span>
          <span class="s1">var </span><span class="s0">arr5 = $rulesGroup.rules</span><span class="s3">;</span>
          <span class="s1">if </span><span class="s0">(arr5) {</span>
            <span class="s1">var </span><span class="s0">$rule</span><span class="s3">, </span><span class="s0">i5 = -</span><span class="s4">1</span><span class="s3">,</span>
              <span class="s0">l5 = arr5.length - </span><span class="s4">1</span><span class="s3">;</span>
            <span class="s1">while </span><span class="s0">(i5 &lt; l5) {</span>
              <span class="s0">$rule = arr5[i5 += </span><span class="s4">1</span><span class="s0">]</span><span class="s3">;</span>
              <span class="s1">if </span><span class="s0">($shouldUseRule($rule)) {</span>
                <span class="s1">var </span><span class="s0">$code = $rule.code(it</span><span class="s3">, </span><span class="s0">$rule.keyword</span><span class="s3">, </span><span class="s0">$rulesGroup.type)</span><span class="s3">;</span>
                <span class="s1">if </span><span class="s0">($code) {</span>
                  <span class="s0">out += </span><span class="s2">' ' </span><span class="s0">+ ($code) + </span><span class="s2">' '</span><span class="s3">;</span>
                  <span class="s1">if </span><span class="s0">($breakOnError) {</span>
                    <span class="s0">$closingBraces1 += </span><span class="s2">'}'</span><span class="s3">;</span>
                  <span class="s0">}</span>
                <span class="s0">}</span>
              <span class="s0">}</span>
            <span class="s0">}</span>
          <span class="s0">}</span>
          <span class="s1">if </span><span class="s0">($breakOnError) {</span>
            <span class="s0">out += </span><span class="s2">' ' </span><span class="s0">+ ($closingBraces1) + </span><span class="s2">' '</span><span class="s3">;</span>
            <span class="s0">$closingBraces1 = </span><span class="s2">''</span><span class="s3">;</span>
          <span class="s0">}</span>
          <span class="s1">if </span><span class="s0">($rulesGroup.type) {</span>
            <span class="s0">out += </span><span class="s2">' } '</span><span class="s3">;</span>
            <span class="s1">if </span><span class="s0">($typeSchema &amp;&amp; $typeSchema === $rulesGroup.type &amp;&amp; !$coerceToTypes) {</span>
              <span class="s0">out += </span><span class="s2">' else { '</span><span class="s3">;</span>
              <span class="s1">var </span><span class="s0">$schemaPath = it.schemaPath + </span><span class="s2">'.type'</span><span class="s3">,</span>
                <span class="s0">$errSchemaPath = it.errSchemaPath + </span><span class="s2">'/type'</span><span class="s3">;</span>
              <span class="s1">var </span><span class="s0">$$outStack = $$outStack || []</span><span class="s3">;</span>
              <span class="s0">$$outStack.push(out)</span><span class="s3">;</span>
              <span class="s0">out = </span><span class="s2">''</span><span class="s3">; </span><span class="s7">/* istanbul ignore else */</span>
              <span class="s1">if </span><span class="s0">(it.createErrors !== </span><span class="s1">false</span><span class="s0">) {</span>
                <span class="s0">out += </span><span class="s2">' { keyword: </span><span class="s3">\'</span><span class="s2">' </span><span class="s0">+ ($errorKeyword || </span><span class="s2">'type'</span><span class="s0">) + </span><span class="s2">'</span><span class="s3">\' </span><span class="s2">, dataPath: (dataPath || </span><span class="s3">\'\'</span><span class="s2">) + ' </span><span class="s0">+ (it.errorPath) + </span><span class="s2">' , schemaPath: ' </span><span class="s0">+ (it.util.toQuotedString($errSchemaPath)) + </span><span class="s2">' , params: { type: </span><span class="s3">\'</span><span class="s2">'</span><span class="s3">;</span>
                <span class="s1">if </span><span class="s0">($typeIsArray) {</span>
                  <span class="s0">out += </span><span class="s2">'' </span><span class="s0">+ ($typeSchema.join(</span><span class="s2">&quot;,&quot;</span><span class="s0">))</span><span class="s3">;</span>
                <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
                  <span class="s0">out += </span><span class="s2">'' </span><span class="s0">+ ($typeSchema)</span><span class="s3">;</span>
                <span class="s0">}</span>
                <span class="s0">out += </span><span class="s2">'</span><span class="s3">\' </span><span class="s2">} '</span><span class="s3">;</span>
                <span class="s1">if </span><span class="s0">(it.opts.messages !== </span><span class="s1">false</span><span class="s0">) {</span>
                  <span class="s0">out += </span><span class="s2">' , message: </span><span class="s3">\'</span><span class="s2">should be '</span><span class="s3">;</span>
                  <span class="s1">if </span><span class="s0">($typeIsArray) {</span>
                    <span class="s0">out += </span><span class="s2">'' </span><span class="s0">+ ($typeSchema.join(</span><span class="s2">&quot;,&quot;</span><span class="s0">))</span><span class="s3">;</span>
                  <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
                    <span class="s0">out += </span><span class="s2">'' </span><span class="s0">+ ($typeSchema)</span><span class="s3">;</span>
                  <span class="s0">}</span>
                  <span class="s0">out += </span><span class="s2">'</span><span class="s3">\' </span><span class="s2">'</span><span class="s3">;</span>
                <span class="s0">}</span>
                <span class="s1">if </span><span class="s0">(it.opts.verbose) {</span>
                  <span class="s0">out += </span><span class="s2">' , schema: validate.schema' </span><span class="s0">+ ($schemaPath) + </span><span class="s2">' , parentSchema: validate.schema' </span><span class="s0">+ (it.schemaPath) + </span><span class="s2">' , data: ' </span><span class="s0">+ ($data) + </span><span class="s2">' '</span><span class="s3">;</span>
                <span class="s0">}</span>
                <span class="s0">out += </span><span class="s2">' } '</span><span class="s3">;</span>
              <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
                <span class="s0">out += </span><span class="s2">' {} '</span><span class="s3">;</span>
              <span class="s0">}</span>
              <span class="s1">var </span><span class="s0">__err = out</span><span class="s3">;</span>
              <span class="s0">out = $$outStack.pop()</span><span class="s3">;</span>
              <span class="s1">if </span><span class="s0">(!it.compositeRule &amp;&amp; $breakOnError) {</span>
                <span class="s7">/* istanbul ignore if */</span>
                <span class="s1">if </span><span class="s0">(it.async) {</span>
                  <span class="s0">out += </span><span class="s2">' throw new ValidationError([' </span><span class="s0">+ (__err) + </span><span class="s2">']); '</span><span class="s3">;</span>
                <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
                  <span class="s0">out += </span><span class="s2">' validate.errors = [' </span><span class="s0">+ (__err) + </span><span class="s2">']; return false; '</span><span class="s3">;</span>
                <span class="s0">}</span>
              <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
                <span class="s0">out += </span><span class="s2">' var err = ' </span><span class="s0">+ (__err) + </span><span class="s2">';  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; '</span><span class="s3">;</span>
              <span class="s0">}</span>
              <span class="s0">out += </span><span class="s2">' } '</span><span class="s3">;</span>
            <span class="s0">}</span>
          <span class="s0">}</span>
          <span class="s1">if </span><span class="s0">($breakOnError) {</span>
            <span class="s0">out += </span><span class="s2">' if (errors === '</span><span class="s3">;</span>
            <span class="s1">if </span><span class="s0">($top) {</span>
              <span class="s0">out += </span><span class="s2">'0'</span><span class="s3">;</span>
            <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
              <span class="s0">out += </span><span class="s2">'errs_' </span><span class="s0">+ ($lvl)</span><span class="s3">;</span>
            <span class="s0">}</span>
            <span class="s0">out += </span><span class="s2">') { '</span><span class="s3">;</span>
            <span class="s0">$closingBraces2 += </span><span class="s2">'}'</span><span class="s3">;</span>
          <span class="s0">}</span>
        <span class="s0">}</span>
      <span class="s0">}</span>
    <span class="s0">}</span>
  <span class="s0">}</span>
  <span class="s1">if </span><span class="s0">($breakOnError) {</span>
    <span class="s0">out += </span><span class="s2">' ' </span><span class="s0">+ ($closingBraces2) + </span><span class="s2">' '</span><span class="s3">;</span>
  <span class="s0">}</span>
  <span class="s1">if </span><span class="s0">($top) {</span>
    <span class="s1">if </span><span class="s0">($async) {</span>
      <span class="s0">out += </span><span class="s2">' if (errors === 0) return data;           '</span><span class="s3">;</span>
      <span class="s0">out += </span><span class="s2">' else throw new ValidationError(vErrors); '</span><span class="s3">;</span>
    <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
      <span class="s0">out += </span><span class="s2">' validate.errors = vErrors; '</span><span class="s3">;</span>
      <span class="s0">out += </span><span class="s2">' return errors === 0;       '</span><span class="s3">;</span>
    <span class="s0">}</span>
    <span class="s0">out += </span><span class="s2">' }; return validate;'</span><span class="s3">;</span>
  <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
    <span class="s0">out += </span><span class="s2">' var ' </span><span class="s0">+ ($valid) + </span><span class="s2">' = errors === errs_' </span><span class="s0">+ ($lvl) + </span><span class="s2">';'</span><span class="s3">;</span>
  <span class="s0">}</span>

  <span class="s1">function </span><span class="s0">$shouldUseGroup($rulesGroup) {</span>
    <span class="s1">var </span><span class="s0">rules = $rulesGroup.rules</span><span class="s3">;</span>
    <span class="s1">for </span><span class="s0">(</span><span class="s1">var </span><span class="s0">i = </span><span class="s4">0</span><span class="s3">; </span><span class="s0">i &lt; rules.length</span><span class="s3">; </span><span class="s0">i++)</span>
      <span class="s1">if </span><span class="s0">($shouldUseRule(rules[i])) </span><span class="s1">return true</span><span class="s3">;</span>
  <span class="s0">}</span>

  <span class="s1">function </span><span class="s0">$shouldUseRule($rule) {</span>
    <span class="s1">return </span><span class="s0">it.schema[$rule.keyword] !== undefined || ($rule.implements &amp;&amp; $ruleImplementsSomeKeyword($rule))</span><span class="s3">;</span>
  <span class="s0">}</span>

  <span class="s1">function </span><span class="s0">$ruleImplementsSomeKeyword($rule) {</span>
    <span class="s1">var </span><span class="s0">impl = $rule.implements</span><span class="s3">;</span>
    <span class="s1">for </span><span class="s0">(</span><span class="s1">var </span><span class="s0">i = </span><span class="s4">0</span><span class="s3">; </span><span class="s0">i &lt; impl.length</span><span class="s3">; </span><span class="s0">i++)</span>
      <span class="s1">if </span><span class="s0">(it.schema[impl[i]] !== undefined) </span><span class="s1">return true</span><span class="s3">;</span>
  <span class="s0">}</span>
  <span class="s1">return </span><span class="s0">out</span><span class="s3">;</span>
<span class="s0">}</span>

<span class="s0">}</span><span class="s3">,</span><span class="s0">{}]</span><span class="s3">,</span><span class="s4">39</span><span class="s0">:[</span><span class="s1">function</span><span class="s0">(require</span><span class="s3">,</span><span class="s0">module</span><span class="s3">,</span><span class="s0">exports){</span>
<span class="s2">'use strict'</span><span class="s3">;</span>

<span class="s1">var </span><span class="s0">IDENTIFIER = </span><span class="s4">/^[a-z_$][a-z0-9_$-]*$/i</span><span class="s3">;</span>
<span class="s1">var </span><span class="s0">customRuleCode = require(</span><span class="s2">'./dotjs/custom'</span><span class="s0">)</span><span class="s3">;</span>
<span class="s1">var </span><span class="s0">definitionSchema = require(</span><span class="s2">'./definition_schema'</span><span class="s0">)</span><span class="s3">;</span>

<span class="s0">module.exports = {</span>
  <span class="s0">add: addKeyword</span><span class="s3">,</span>
  <span class="s0">get: getKeyword</span><span class="s3">,</span>
  <span class="s0">remove: removeKeyword</span><span class="s3">,</span>
  <span class="s0">validate: validateKeyword</span>
<span class="s0">}</span><span class="s3">;</span>


<span class="s5">/**</span>
 <span class="s5">* Define custom keyword</span>
 <span class="s5">* </span><span class="s6">@this  </span><span class="s5">Ajv</span>
 <span class="s5">* </span><span class="s6">@param </span><span class="s5">{String} keyword custom keyword, should be unique (including different from all standard, custom and macro keywords).</span>
 <span class="s5">* </span><span class="s6">@param </span><span class="s5">{Object} definition keyword definition object with properties `type` (type(s) which the keyword applies to), `validate` or `compile`.</span>
 <span class="s5">* </span><span class="s6">@return </span><span class="s5">{Ajv} this for method chaining</span>
 <span class="s5">*/</span>
<span class="s1">function </span><span class="s0">addKeyword(keyword</span><span class="s3">, </span><span class="s0">definition) {</span>
  <span class="s7">/* jshint validthis: true */</span>
  <span class="s7">/* eslint no-shadow: 0 */</span>
  <span class="s1">var </span><span class="s0">RULES = </span><span class="s1">this</span><span class="s0">.RULES</span><span class="s3">;</span>
  <span class="s1">if </span><span class="s0">(RULES.keywords[keyword])</span>
    <span class="s1">throw new </span><span class="s0">Error(</span><span class="s2">'Keyword ' </span><span class="s0">+ keyword + </span><span class="s2">' is already defined'</span><span class="s0">)</span><span class="s3">;</span>

  <span class="s1">if </span><span class="s0">(!IDENTIFIER.test(keyword))</span>
    <span class="s1">throw new </span><span class="s0">Error(</span><span class="s2">'Keyword ' </span><span class="s0">+ keyword + </span><span class="s2">' is not a valid identifier'</span><span class="s0">)</span><span class="s3">;</span>

  <span class="s1">if </span><span class="s0">(definition) {</span>
    <span class="s1">this</span><span class="s0">.validateKeyword(definition</span><span class="s3">, </span><span class="s1">true</span><span class="s0">)</span><span class="s3">;</span>

    <span class="s1">var </span><span class="s0">dataType = definition.type</span><span class="s3">;</span>
    <span class="s1">if </span><span class="s0">(Array.isArray(dataType)) {</span>
      <span class="s1">for </span><span class="s0">(</span><span class="s1">var </span><span class="s0">i=</span><span class="s4">0</span><span class="s3">; </span><span class="s0">i&lt;dataType.length</span><span class="s3">; </span><span class="s0">i++)</span>
        <span class="s0">_addRule(keyword</span><span class="s3">, </span><span class="s0">dataType[i]</span><span class="s3">, </span><span class="s0">definition)</span><span class="s3">;</span>
    <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
      <span class="s0">_addRule(keyword</span><span class="s3">, </span><span class="s0">dataType</span><span class="s3">, </span><span class="s0">definition)</span><span class="s3">;</span>
    <span class="s0">}</span>

    <span class="s1">var </span><span class="s0">metaSchema = definition.metaSchema</span><span class="s3">;</span>
    <span class="s1">if </span><span class="s0">(metaSchema) {</span>
      <span class="s1">if </span><span class="s0">(definition.$data &amp;&amp; </span><span class="s1">this</span><span class="s0">._opts.$data) {</span>
        <span class="s0">metaSchema = {</span>
          <span class="s0">anyOf: [</span>
            <span class="s0">metaSchema</span><span class="s3">,</span>
            <span class="s0">{ </span><span class="s2">'$ref'</span><span class="s0">: </span><span class="s2">'https://raw.githubusercontent.com/ajv-validator/ajv/master/lib/refs/data.json#' </span><span class="s0">}</span>
          <span class="s0">]</span>
        <span class="s0">}</span><span class="s3">;</span>
      <span class="s0">}</span>
      <span class="s0">definition.validateSchema = </span><span class="s1">this</span><span class="s0">.compile(metaSchema</span><span class="s3">, </span><span class="s1">true</span><span class="s0">)</span><span class="s3">;</span>
    <span class="s0">}</span>
  <span class="s0">}</span>

  <span class="s0">RULES.keywords[keyword] = RULES.all[keyword] = </span><span class="s1">true</span><span class="s3">;</span>


  <span class="s1">function </span><span class="s0">_addRule(keyword</span><span class="s3">, </span><span class="s0">dataType</span><span class="s3">, </span><span class="s0">definition) {</span>
    <span class="s1">var </span><span class="s0">ruleGroup</span><span class="s3">;</span>
    <span class="s1">for </span><span class="s0">(</span><span class="s1">var </span><span class="s0">i=</span><span class="s4">0</span><span class="s3">; </span><span class="s0">i&lt;RULES.length</span><span class="s3">; </span><span class="s0">i++) {</span>
      <span class="s1">var </span><span class="s0">rg = RULES[i]</span><span class="s3">;</span>
      <span class="s1">if </span><span class="s0">(rg.type == dataType) {</span>
        <span class="s0">ruleGroup = rg</span><span class="s3">;</span>
        <span class="s1">break</span><span class="s3">;</span>
      <span class="s0">}</span>
    <span class="s0">}</span>

    <span class="s1">if </span><span class="s0">(!ruleGroup) {</span>
      <span class="s0">ruleGroup = { type: dataType</span><span class="s3">, </span><span class="s0">rules: [] }</span><span class="s3">;</span>
      <span class="s0">RULES.push(ruleGroup)</span><span class="s3">;</span>
    <span class="s0">}</span>

    <span class="s1">var </span><span class="s0">rule = {</span>
      <span class="s0">keyword: keyword</span><span class="s3">,</span>
      <span class="s0">definition: definition</span><span class="s3">,</span>
      <span class="s0">custom: </span><span class="s1">true</span><span class="s3">,</span>
      <span class="s0">code: customRuleCode</span><span class="s3">,</span>
      <span class="s1">implements</span><span class="s0">: definition.implements</span>
    <span class="s0">}</span><span class="s3">;</span>
    <span class="s0">ruleGroup.rules.push(rule)</span><span class="s3">;</span>
    <span class="s0">RULES.custom[keyword] = rule</span><span class="s3">;</span>
  <span class="s0">}</span>

  <span class="s1">return this</span><span class="s3">;</span>
<span class="s0">}</span>


<span class="s5">/**</span>
 <span class="s5">* Get keyword</span>
 <span class="s5">* </span><span class="s6">@this  </span><span class="s5">Ajv</span>
 <span class="s5">* </span><span class="s6">@param </span><span class="s5">{String} keyword pre-defined or custom keyword.</span>
 <span class="s5">* </span><span class="s6">@return </span><span class="s5">{Object|Boolean} custom keyword definition, `true` if it is a predefined keyword, `false` otherwise.</span>
 <span class="s5">*/</span>
<span class="s1">function </span><span class="s0">getKeyword(keyword) {</span>
  <span class="s7">/* jshint validthis: true */</span>
  <span class="s1">var </span><span class="s0">rule = </span><span class="s1">this</span><span class="s0">.RULES.custom[keyword]</span><span class="s3">;</span>
  <span class="s1">return </span><span class="s0">rule ? rule.definition : </span><span class="s1">this</span><span class="s0">.RULES.keywords[keyword] || </span><span class="s1">false</span><span class="s3">;</span>
<span class="s0">}</span>


<span class="s5">/**</span>
 <span class="s5">* Remove keyword</span>
 <span class="s5">* </span><span class="s6">@this  </span><span class="s5">Ajv</span>
 <span class="s5">* </span><span class="s6">@param </span><span class="s5">{String} keyword pre-defined or custom keyword.</span>
 <span class="s5">* </span><span class="s6">@return </span><span class="s5">{Ajv} this for method chaining</span>
 <span class="s5">*/</span>
<span class="s1">function </span><span class="s0">removeKeyword(keyword) {</span>
  <span class="s7">/* jshint validthis: true */</span>
  <span class="s1">var </span><span class="s0">RULES = </span><span class="s1">this</span><span class="s0">.RULES</span><span class="s3">;</span>
  <span class="s1">delete </span><span class="s0">RULES.keywords[keyword]</span><span class="s3">;</span>
  <span class="s1">delete </span><span class="s0">RULES.all[keyword]</span><span class="s3">;</span>
  <span class="s1">delete </span><span class="s0">RULES.custom[keyword]</span><span class="s3">;</span>
  <span class="s1">for </span><span class="s0">(</span><span class="s1">var </span><span class="s0">i=</span><span class="s4">0</span><span class="s3">; </span><span class="s0">i&lt;RULES.length</span><span class="s3">; </span><span class="s0">i++) {</span>
    <span class="s1">var </span><span class="s0">rules = RULES[i].rules</span><span class="s3">;</span>
    <span class="s1">for </span><span class="s0">(</span><span class="s1">var </span><span class="s0">j=</span><span class="s4">0</span><span class="s3">; </span><span class="s0">j&lt;rules.length</span><span class="s3">; </span><span class="s0">j++) {</span>
      <span class="s1">if </span><span class="s0">(rules[j].keyword == keyword) {</span>
        <span class="s0">rules.splice(j</span><span class="s3">, </span><span class="s4">1</span><span class="s0">)</span><span class="s3">;</span>
        <span class="s1">break</span><span class="s3">;</span>
      <span class="s0">}</span>
    <span class="s0">}</span>
  <span class="s0">}</span>
  <span class="s1">return this</span><span class="s3">;</span>
<span class="s0">}</span>


<span class="s5">/**</span>
 <span class="s5">* Validate keyword definition</span>
 <span class="s5">* </span><span class="s6">@this  </span><span class="s5">Ajv</span>
 <span class="s5">* </span><span class="s6">@param </span><span class="s5">{Object} definition keyword definition object.</span>
 <span class="s5">* </span><span class="s6">@param </span><span class="s5">{Boolean} throwError true to throw exception if definition is invalid</span>
 <span class="s5">* </span><span class="s6">@return </span><span class="s5">{boolean} validation result</span>
 <span class="s5">*/</span>
<span class="s1">function </span><span class="s0">validateKeyword(definition</span><span class="s3">, </span><span class="s0">throwError) {</span>
  <span class="s0">validateKeyword.errors = </span><span class="s1">null</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">v = </span><span class="s1">this</span><span class="s0">._validateKeyword = </span><span class="s1">this</span><span class="s0">._validateKeyword</span>
                                  <span class="s0">|| </span><span class="s1">this</span><span class="s0">.compile(definitionSchema</span><span class="s3">, </span><span class="s1">true</span><span class="s0">)</span><span class="s3">;</span>

  <span class="s1">if </span><span class="s0">(v(definition)) </span><span class="s1">return true</span><span class="s3">;</span>
  <span class="s0">validateKeyword.errors = v.errors</span><span class="s3">;</span>
  <span class="s1">if </span><span class="s0">(throwError)</span>
    <span class="s1">throw new </span><span class="s0">Error(</span><span class="s2">'custom keyword definition is invalid: '  </span><span class="s0">+ </span><span class="s1">this</span><span class="s0">.errorsText(v.errors))</span><span class="s3">;</span>
  <span class="s1">else</span>
    <span class="s1">return false</span><span class="s3">;</span>
<span class="s0">}</span>

<span class="s0">}</span><span class="s3">,</span><span class="s0">{</span><span class="s2">&quot;./definition_schema&quot;</span><span class="s0">:</span><span class="s4">12</span><span class="s3">,</span><span class="s2">&quot;./dotjs/custom&quot;</span><span class="s0">:</span><span class="s4">22</span><span class="s0">}]</span><span class="s3">,</span><span class="s4">40</span><span class="s0">:[</span><span class="s1">function</span><span class="s0">(require</span><span class="s3">,</span><span class="s0">module</span><span class="s3">,</span><span class="s0">exports){</span>
<span class="s0">module.exports={</span>
    <span class="s2">&quot;$schema&quot;</span><span class="s0">: </span><span class="s2">&quot;http://json-schema.org/draft-07/schema#&quot;</span><span class="s3">,</span>
    <span class="s2">&quot;$id&quot;</span><span class="s0">: </span><span class="s2">&quot;https://raw.githubusercontent.com/ajv-validator/ajv/master/lib/refs/data.json#&quot;</span><span class="s3">,</span>
    <span class="s2">&quot;description&quot;</span><span class="s0">: </span><span class="s2">&quot;Meta-schema for $data reference (JSON Schema extension proposal)&quot;</span><span class="s3">,</span>
    <span class="s2">&quot;type&quot;</span><span class="s0">: </span><span class="s2">&quot;object&quot;</span><span class="s3">,</span>
    <span class="s2">&quot;required&quot;</span><span class="s0">: [ </span><span class="s2">&quot;$data&quot; </span><span class="s0">]</span><span class="s3">,</span>
    <span class="s2">&quot;properties&quot;</span><span class="s0">: {</span>
        <span class="s2">&quot;$data&quot;</span><span class="s0">: {</span>
            <span class="s2">&quot;type&quot;</span><span class="s0">: </span><span class="s2">&quot;string&quot;</span><span class="s3">,</span>
            <span class="s2">&quot;anyOf&quot;</span><span class="s0">: [</span>
                <span class="s0">{ </span><span class="s2">&quot;format&quot;</span><span class="s0">: </span><span class="s2">&quot;relative-json-pointer&quot; </span><span class="s0">}</span><span class="s3">, </span>
                <span class="s0">{ </span><span class="s2">&quot;format&quot;</span><span class="s0">: </span><span class="s2">&quot;json-pointer&quot; </span><span class="s0">}</span>
            <span class="s0">]</span>
        <span class="s0">}</span>
    <span class="s0">}</span><span class="s3">,</span>
    <span class="s2">&quot;additionalProperties&quot;</span><span class="s0">: </span><span class="s1">false</span>
<span class="s0">}</span>

<span class="s0">}</span><span class="s3">,</span><span class="s0">{}]</span><span class="s3">,</span><span class="s4">41</span><span class="s0">:[</span><span class="s1">function</span><span class="s0">(require</span><span class="s3">,</span><span class="s0">module</span><span class="s3">,</span><span class="s0">exports){</span>
<span class="s0">module.exports={</span>
    <span class="s2">&quot;$schema&quot;</span><span class="s0">: </span><span class="s2">&quot;http://json-schema.org/draft-07/schema#&quot;</span><span class="s3">,</span>
    <span class="s2">&quot;$id&quot;</span><span class="s0">: </span><span class="s2">&quot;http://json-schema.org/draft-07/schema#&quot;</span><span class="s3">,</span>
    <span class="s2">&quot;title&quot;</span><span class="s0">: </span><span class="s2">&quot;Core schema meta-schema&quot;</span><span class="s3">,</span>
    <span class="s2">&quot;definitions&quot;</span><span class="s0">: {</span>
        <span class="s2">&quot;schemaArray&quot;</span><span class="s0">: {</span>
            <span class="s2">&quot;type&quot;</span><span class="s0">: </span><span class="s2">&quot;array&quot;</span><span class="s3">,</span>
            <span class="s2">&quot;minItems&quot;</span><span class="s0">: </span><span class="s4">1</span><span class="s3">,</span>
            <span class="s2">&quot;items&quot;</span><span class="s0">: { </span><span class="s2">&quot;$ref&quot;</span><span class="s0">: </span><span class="s2">&quot;#&quot; </span><span class="s0">}</span>
        <span class="s0">}</span><span class="s3">,</span>
        <span class="s2">&quot;nonNegativeInteger&quot;</span><span class="s0">: {</span>
            <span class="s2">&quot;type&quot;</span><span class="s0">: </span><span class="s2">&quot;integer&quot;</span><span class="s3">,</span>
            <span class="s2">&quot;minimum&quot;</span><span class="s0">: </span><span class="s4">0</span>
        <span class="s0">}</span><span class="s3">,</span>
        <span class="s2">&quot;nonNegativeIntegerDefault0&quot;</span><span class="s0">: {</span>
            <span class="s2">&quot;allOf&quot;</span><span class="s0">: [</span>
                <span class="s0">{ </span><span class="s2">&quot;$ref&quot;</span><span class="s0">: </span><span class="s2">&quot;#/definitions/nonNegativeInteger&quot; </span><span class="s0">}</span><span class="s3">,</span>
                <span class="s0">{ </span><span class="s2">&quot;default&quot;</span><span class="s0">: </span><span class="s4">0 </span><span class="s0">}</span>
            <span class="s0">]</span>
        <span class="s0">}</span><span class="s3">,</span>
        <span class="s2">&quot;simpleTypes&quot;</span><span class="s0">: {</span>
            <span class="s2">&quot;enum&quot;</span><span class="s0">: [</span>
                <span class="s2">&quot;array&quot;</span><span class="s3">,</span>
                <span class="s2">&quot;boolean&quot;</span><span class="s3">,</span>
                <span class="s2">&quot;integer&quot;</span><span class="s3">,</span>
                <span class="s2">&quot;null&quot;</span><span class="s3">,</span>
                <span class="s2">&quot;number&quot;</span><span class="s3">,</span>
                <span class="s2">&quot;object&quot;</span><span class="s3">,</span>
                <span class="s2">&quot;string&quot;</span>
            <span class="s0">]</span>
        <span class="s0">}</span><span class="s3">,</span>
        <span class="s2">&quot;stringArray&quot;</span><span class="s0">: {</span>
            <span class="s2">&quot;type&quot;</span><span class="s0">: </span><span class="s2">&quot;array&quot;</span><span class="s3">,</span>
            <span class="s2">&quot;items&quot;</span><span class="s0">: { </span><span class="s2">&quot;type&quot;</span><span class="s0">: </span><span class="s2">&quot;string&quot; </span><span class="s0">}</span><span class="s3">,</span>
            <span class="s2">&quot;uniqueItems&quot;</span><span class="s0">: </span><span class="s1">true</span><span class="s3">,</span>
            <span class="s2">&quot;default&quot;</span><span class="s0">: []</span>
        <span class="s0">}</span>
    <span class="s0">}</span><span class="s3">,</span>
    <span class="s2">&quot;type&quot;</span><span class="s0">: [</span><span class="s2">&quot;object&quot;</span><span class="s3">, </span><span class="s2">&quot;boolean&quot;</span><span class="s0">]</span><span class="s3">,</span>
    <span class="s2">&quot;properties&quot;</span><span class="s0">: {</span>
        <span class="s2">&quot;$id&quot;</span><span class="s0">: {</span>
            <span class="s2">&quot;type&quot;</span><span class="s0">: </span><span class="s2">&quot;string&quot;</span><span class="s3">,</span>
            <span class="s2">&quot;format&quot;</span><span class="s0">: </span><span class="s2">&quot;uri-reference&quot;</span>
        <span class="s0">}</span><span class="s3">,</span>
        <span class="s2">&quot;$schema&quot;</span><span class="s0">: {</span>
            <span class="s2">&quot;type&quot;</span><span class="s0">: </span><span class="s2">&quot;string&quot;</span><span class="s3">,</span>
            <span class="s2">&quot;format&quot;</span><span class="s0">: </span><span class="s2">&quot;uri&quot;</span>
        <span class="s0">}</span><span class="s3">,</span>
        <span class="s2">&quot;$ref&quot;</span><span class="s0">: {</span>
            <span class="s2">&quot;type&quot;</span><span class="s0">: </span><span class="s2">&quot;string&quot;</span><span class="s3">,</span>
            <span class="s2">&quot;format&quot;</span><span class="s0">: </span><span class="s2">&quot;uri-reference&quot;</span>
        <span class="s0">}</span><span class="s3">,</span>
        <span class="s2">&quot;$comment&quot;</span><span class="s0">: {</span>
            <span class="s2">&quot;type&quot;</span><span class="s0">: </span><span class="s2">&quot;string&quot;</span>
        <span class="s0">}</span><span class="s3">,</span>
        <span class="s2">&quot;title&quot;</span><span class="s0">: {</span>
            <span class="s2">&quot;type&quot;</span><span class="s0">: </span><span class="s2">&quot;string&quot;</span>
        <span class="s0">}</span><span class="s3">,</span>
        <span class="s2">&quot;description&quot;</span><span class="s0">: {</span>
            <span class="s2">&quot;type&quot;</span><span class="s0">: </span><span class="s2">&quot;string&quot;</span>
        <span class="s0">}</span><span class="s3">,</span>
        <span class="s2">&quot;default&quot;</span><span class="s0">: </span><span class="s1">true</span><span class="s3">,</span>
        <span class="s2">&quot;readOnly&quot;</span><span class="s0">: {</span>
            <span class="s2">&quot;type&quot;</span><span class="s0">: </span><span class="s2">&quot;boolean&quot;</span><span class="s3">,</span>
            <span class="s2">&quot;default&quot;</span><span class="s0">: </span><span class="s1">false</span>
        <span class="s0">}</span><span class="s3">,</span>
        <span class="s2">&quot;examples&quot;</span><span class="s0">: {</span>
            <span class="s2">&quot;type&quot;</span><span class="s0">: </span><span class="s2">&quot;array&quot;</span><span class="s3">,</span>
            <span class="s2">&quot;items&quot;</span><span class="s0">: </span><span class="s1">true</span>
        <span class="s0">}</span><span class="s3">,</span>
        <span class="s2">&quot;multipleOf&quot;</span><span class="s0">: {</span>
            <span class="s2">&quot;type&quot;</span><span class="s0">: </span><span class="s2">&quot;number&quot;</span><span class="s3">,</span>
            <span class="s2">&quot;exclusiveMinimum&quot;</span><span class="s0">: </span><span class="s4">0</span>
        <span class="s0">}</span><span class="s3">,</span>
        <span class="s2">&quot;maximum&quot;</span><span class="s0">: {</span>
            <span class="s2">&quot;type&quot;</span><span class="s0">: </span><span class="s2">&quot;number&quot;</span>
        <span class="s0">}</span><span class="s3">,</span>
        <span class="s2">&quot;exclusiveMaximum&quot;</span><span class="s0">: {</span>
            <span class="s2">&quot;type&quot;</span><span class="s0">: </span><span class="s2">&quot;number&quot;</span>
        <span class="s0">}</span><span class="s3">,</span>
        <span class="s2">&quot;minimum&quot;</span><span class="s0">: {</span>
            <span class="s2">&quot;type&quot;</span><span class="s0">: </span><span class="s2">&quot;number&quot;</span>
        <span class="s0">}</span><span class="s3">,</span>
        <span class="s2">&quot;exclusiveMinimum&quot;</span><span class="s0">: {</span>
            <span class="s2">&quot;type&quot;</span><span class="s0">: </span><span class="s2">&quot;number&quot;</span>
        <span class="s0">}</span><span class="s3">,</span>
        <span class="s2">&quot;maxLength&quot;</span><span class="s0">: { </span><span class="s2">&quot;$ref&quot;</span><span class="s0">: </span><span class="s2">&quot;#/definitions/nonNegativeInteger&quot; </span><span class="s0">}</span><span class="s3">,</span>
        <span class="s2">&quot;minLength&quot;</span><span class="s0">: { </span><span class="s2">&quot;$ref&quot;</span><span class="s0">: </span><span class="s2">&quot;#/definitions/nonNegativeIntegerDefault0&quot; </span><span class="s0">}</span><span class="s3">,</span>
        <span class="s2">&quot;pattern&quot;</span><span class="s0">: {</span>
            <span class="s2">&quot;type&quot;</span><span class="s0">: </span><span class="s2">&quot;string&quot;</span><span class="s3">,</span>
            <span class="s2">&quot;format&quot;</span><span class="s0">: </span><span class="s2">&quot;regex&quot;</span>
        <span class="s0">}</span><span class="s3">,</span>
        <span class="s2">&quot;additionalItems&quot;</span><span class="s0">: { </span><span class="s2">&quot;$ref&quot;</span><span class="s0">: </span><span class="s2">&quot;#&quot; </span><span class="s0">}</span><span class="s3">,</span>
        <span class="s2">&quot;items&quot;</span><span class="s0">: {</span>
            <span class="s2">&quot;anyOf&quot;</span><span class="s0">: [</span>
                <span class="s0">{ </span><span class="s2">&quot;$ref&quot;</span><span class="s0">: </span><span class="s2">&quot;#&quot; </span><span class="s0">}</span><span class="s3">,</span>
                <span class="s0">{ </span><span class="s2">&quot;$ref&quot;</span><span class="s0">: </span><span class="s2">&quot;#/definitions/schemaArray&quot; </span><span class="s0">}</span>
            <span class="s0">]</span><span class="s3">,</span>
            <span class="s2">&quot;default&quot;</span><span class="s0">: </span><span class="s1">true</span>
        <span class="s0">}</span><span class="s3">,</span>
        <span class="s2">&quot;maxItems&quot;</span><span class="s0">: { </span><span class="s2">&quot;$ref&quot;</span><span class="s0">: </span><span class="s2">&quot;#/definitions/nonNegativeInteger&quot; </span><span class="s0">}</span><span class="s3">,</span>
        <span class="s2">&quot;minItems&quot;</span><span class="s0">: { </span><span class="s2">&quot;$ref&quot;</span><span class="s0">: </span><span class="s2">&quot;#/definitions/nonNegativeIntegerDefault0&quot; </span><span class="s0">}</span><span class="s3">,</span>
        <span class="s2">&quot;uniqueItems&quot;</span><span class="s0">: {</span>
            <span class="s2">&quot;type&quot;</span><span class="s0">: </span><span class="s2">&quot;boolean&quot;</span><span class="s3">,</span>
            <span class="s2">&quot;default&quot;</span><span class="s0">: </span><span class="s1">false</span>
        <span class="s0">}</span><span class="s3">,</span>
        <span class="s2">&quot;contains&quot;</span><span class="s0">: { </span><span class="s2">&quot;$ref&quot;</span><span class="s0">: </span><span class="s2">&quot;#&quot; </span><span class="s0">}</span><span class="s3">,</span>
        <span class="s2">&quot;maxProperties&quot;</span><span class="s0">: { </span><span class="s2">&quot;$ref&quot;</span><span class="s0">: </span><span class="s2">&quot;#/definitions/nonNegativeInteger&quot; </span><span class="s0">}</span><span class="s3">,</span>
        <span class="s2">&quot;minProperties&quot;</span><span class="s0">: { </span><span class="s2">&quot;$ref&quot;</span><span class="s0">: </span><span class="s2">&quot;#/definitions/nonNegativeIntegerDefault0&quot; </span><span class="s0">}</span><span class="s3">,</span>
        <span class="s2">&quot;required&quot;</span><span class="s0">: { </span><span class="s2">&quot;$ref&quot;</span><span class="s0">: </span><span class="s2">&quot;#/definitions/stringArray&quot; </span><span class="s0">}</span><span class="s3">,</span>
        <span class="s2">&quot;additionalProperties&quot;</span><span class="s0">: { </span><span class="s2">&quot;$ref&quot;</span><span class="s0">: </span><span class="s2">&quot;#&quot; </span><span class="s0">}</span><span class="s3">,</span>
        <span class="s2">&quot;definitions&quot;</span><span class="s0">: {</span>
            <span class="s2">&quot;type&quot;</span><span class="s0">: </span><span class="s2">&quot;object&quot;</span><span class="s3">,</span>
            <span class="s2">&quot;additionalProperties&quot;</span><span class="s0">: { </span><span class="s2">&quot;$ref&quot;</span><span class="s0">: </span><span class="s2">&quot;#&quot; </span><span class="s0">}</span><span class="s3">,</span>
            <span class="s2">&quot;default&quot;</span><span class="s0">: {}</span>
        <span class="s0">}</span><span class="s3">,</span>
        <span class="s2">&quot;properties&quot;</span><span class="s0">: {</span>
            <span class="s2">&quot;type&quot;</span><span class="s0">: </span><span class="s2">&quot;object&quot;</span><span class="s3">,</span>
            <span class="s2">&quot;additionalProperties&quot;</span><span class="s0">: { </span><span class="s2">&quot;$ref&quot;</span><span class="s0">: </span><span class="s2">&quot;#&quot; </span><span class="s0">}</span><span class="s3">,</span>
            <span class="s2">&quot;default&quot;</span><span class="s0">: {}</span>
        <span class="s0">}</span><span class="s3">,</span>
        <span class="s2">&quot;patternProperties&quot;</span><span class="s0">: {</span>
            <span class="s2">&quot;type&quot;</span><span class="s0">: </span><span class="s2">&quot;object&quot;</span><span class="s3">,</span>
            <span class="s2">&quot;additionalProperties&quot;</span><span class="s0">: { </span><span class="s2">&quot;$ref&quot;</span><span class="s0">: </span><span class="s2">&quot;#&quot; </span><span class="s0">}</span><span class="s3">,</span>
            <span class="s2">&quot;propertyNames&quot;</span><span class="s0">: { </span><span class="s2">&quot;format&quot;</span><span class="s0">: </span><span class="s2">&quot;regex&quot; </span><span class="s0">}</span><span class="s3">,</span>
            <span class="s2">&quot;default&quot;</span><span class="s0">: {}</span>
        <span class="s0">}</span><span class="s3">,</span>
        <span class="s2">&quot;dependencies&quot;</span><span class="s0">: {</span>
            <span class="s2">&quot;type&quot;</span><span class="s0">: </span><span class="s2">&quot;object&quot;</span><span class="s3">,</span>
            <span class="s2">&quot;additionalProperties&quot;</span><span class="s0">: {</span>
                <span class="s2">&quot;anyOf&quot;</span><span class="s0">: [</span>
                    <span class="s0">{ </span><span class="s2">&quot;$ref&quot;</span><span class="s0">: </span><span class="s2">&quot;#&quot; </span><span class="s0">}</span><span class="s3">,</span>
                    <span class="s0">{ </span><span class="s2">&quot;$ref&quot;</span><span class="s0">: </span><span class="s2">&quot;#/definitions/stringArray&quot; </span><span class="s0">}</span>
                <span class="s0">]</span>
            <span class="s0">}</span>
        <span class="s0">}</span><span class="s3">,</span>
        <span class="s2">&quot;propertyNames&quot;</span><span class="s0">: { </span><span class="s2">&quot;$ref&quot;</span><span class="s0">: </span><span class="s2">&quot;#&quot; </span><span class="s0">}</span><span class="s3">,</span>
        <span class="s2">&quot;const&quot;</span><span class="s0">: </span><span class="s1">true</span><span class="s3">,</span>
        <span class="s2">&quot;enum&quot;</span><span class="s0">: {</span>
            <span class="s2">&quot;type&quot;</span><span class="s0">: </span><span class="s2">&quot;array&quot;</span><span class="s3">,</span>
            <span class="s2">&quot;items&quot;</span><span class="s0">: </span><span class="s1">true</span><span class="s3">,</span>
            <span class="s2">&quot;minItems&quot;</span><span class="s0">: </span><span class="s4">1</span><span class="s3">,</span>
            <span class="s2">&quot;uniqueItems&quot;</span><span class="s0">: </span><span class="s1">true</span>
        <span class="s0">}</span><span class="s3">,</span>
        <span class="s2">&quot;type&quot;</span><span class="s0">: {</span>
            <span class="s2">&quot;anyOf&quot;</span><span class="s0">: [</span>
                <span class="s0">{ </span><span class="s2">&quot;$ref&quot;</span><span class="s0">: </span><span class="s2">&quot;#/definitions/simpleTypes&quot; </span><span class="s0">}</span><span class="s3">,</span>
                <span class="s0">{</span>
                    <span class="s2">&quot;type&quot;</span><span class="s0">: </span><span class="s2">&quot;array&quot;</span><span class="s3">,</span>
                    <span class="s2">&quot;items&quot;</span><span class="s0">: { </span><span class="s2">&quot;$ref&quot;</span><span class="s0">: </span><span class="s2">&quot;#/definitions/simpleTypes&quot; </span><span class="s0">}</span><span class="s3">,</span>
                    <span class="s2">&quot;minItems&quot;</span><span class="s0">: </span><span class="s4">1</span><span class="s3">,</span>
                    <span class="s2">&quot;uniqueItems&quot;</span><span class="s0">: </span><span class="s1">true</span>
                <span class="s0">}</span>
            <span class="s0">]</span>
        <span class="s0">}</span><span class="s3">,</span>
        <span class="s2">&quot;format&quot;</span><span class="s0">: { </span><span class="s2">&quot;type&quot;</span><span class="s0">: </span><span class="s2">&quot;string&quot; </span><span class="s0">}</span><span class="s3">,</span>
        <span class="s2">&quot;contentMediaType&quot;</span><span class="s0">: { </span><span class="s2">&quot;type&quot;</span><span class="s0">: </span><span class="s2">&quot;string&quot; </span><span class="s0">}</span><span class="s3">,</span>
        <span class="s2">&quot;contentEncoding&quot;</span><span class="s0">: { </span><span class="s2">&quot;type&quot;</span><span class="s0">: </span><span class="s2">&quot;string&quot; </span><span class="s0">}</span><span class="s3">,</span>
        <span class="s2">&quot;if&quot;</span><span class="s0">: {</span><span class="s2">&quot;$ref&quot;</span><span class="s0">: </span><span class="s2">&quot;#&quot;</span><span class="s0">}</span><span class="s3">,</span>
        <span class="s2">&quot;then&quot;</span><span class="s0">: {</span><span class="s2">&quot;$ref&quot;</span><span class="s0">: </span><span class="s2">&quot;#&quot;</span><span class="s0">}</span><span class="s3">,</span>
        <span class="s2">&quot;else&quot;</span><span class="s0">: {</span><span class="s2">&quot;$ref&quot;</span><span class="s0">: </span><span class="s2">&quot;#&quot;</span><span class="s0">}</span><span class="s3">,</span>
        <span class="s2">&quot;allOf&quot;</span><span class="s0">: { </span><span class="s2">&quot;$ref&quot;</span><span class="s0">: </span><span class="s2">&quot;#/definitions/schemaArray&quot; </span><span class="s0">}</span><span class="s3">,</span>
        <span class="s2">&quot;anyOf&quot;</span><span class="s0">: { </span><span class="s2">&quot;$ref&quot;</span><span class="s0">: </span><span class="s2">&quot;#/definitions/schemaArray&quot; </span><span class="s0">}</span><span class="s3">,</span>
        <span class="s2">&quot;oneOf&quot;</span><span class="s0">: { </span><span class="s2">&quot;$ref&quot;</span><span class="s0">: </span><span class="s2">&quot;#/definitions/schemaArray&quot; </span><span class="s0">}</span><span class="s3">,</span>
        <span class="s2">&quot;not&quot;</span><span class="s0">: { </span><span class="s2">&quot;$ref&quot;</span><span class="s0">: </span><span class="s2">&quot;#&quot; </span><span class="s0">}</span>
    <span class="s0">}</span><span class="s3">,</span>
    <span class="s2">&quot;default&quot;</span><span class="s0">: </span><span class="s1">true</span>
<span class="s0">}</span>

<span class="s0">}</span><span class="s3">,</span><span class="s0">{}]</span><span class="s3">,</span><span class="s4">42</span><span class="s0">:[</span><span class="s1">function</span><span class="s0">(require</span><span class="s3">,</span><span class="s0">module</span><span class="s3">,</span><span class="s0">exports){</span>
<span class="s2">'use strict'</span><span class="s3">;</span>

<span class="s8">// do not edit .js files directly - edit src/index.jst</span>



<span class="s0">module.exports = </span><span class="s1">function </span><span class="s0">equal(a</span><span class="s3">, </span><span class="s0">b) {</span>
  <span class="s1">if </span><span class="s0">(a === b) </span><span class="s1">return true</span><span class="s3">;</span>

  <span class="s1">if </span><span class="s0">(a &amp;&amp; b &amp;&amp; </span><span class="s1">typeof </span><span class="s0">a == </span><span class="s2">'object' </span><span class="s0">&amp;&amp; </span><span class="s1">typeof </span><span class="s0">b == </span><span class="s2">'object'</span><span class="s0">) {</span>
    <span class="s1">if </span><span class="s0">(a.constructor !== b.constructor) </span><span class="s1">return false</span><span class="s3">;</span>

    <span class="s1">var </span><span class="s0">length</span><span class="s3">, </span><span class="s0">i</span><span class="s3">, </span><span class="s0">keys</span><span class="s3">;</span>
    <span class="s1">if </span><span class="s0">(Array.isArray(a)) {</span>
      <span class="s0">length = a.length</span><span class="s3">;</span>
      <span class="s1">if </span><span class="s0">(length != b.length) </span><span class="s1">return false</span><span class="s3">;</span>
      <span class="s1">for </span><span class="s0">(i = length</span><span class="s3">; </span><span class="s0">i-- !== </span><span class="s4">0</span><span class="s3">;</span><span class="s0">)</span>
        <span class="s1">if </span><span class="s0">(!equal(a[i]</span><span class="s3">, </span><span class="s0">b[i])) </span><span class="s1">return false</span><span class="s3">;</span>
      <span class="s1">return true</span><span class="s3">;</span>
    <span class="s0">}</span>



    <span class="s1">if </span><span class="s0">(a.constructor === RegExp) </span><span class="s1">return </span><span class="s0">a.source === b.source &amp;&amp; a.flags === b.flags</span><span class="s3">;</span>
    <span class="s1">if </span><span class="s0">(a.valueOf !== Object.prototype.valueOf) </span><span class="s1">return </span><span class="s0">a.valueOf() === b.valueOf()</span><span class="s3">;</span>
    <span class="s1">if </span><span class="s0">(a.toString !== Object.prototype.toString) </span><span class="s1">return </span><span class="s0">a.toString() === b.toString()</span><span class="s3">;</span>

    <span class="s0">keys = Object.keys(a)</span><span class="s3">;</span>
    <span class="s0">length = keys.length</span><span class="s3">;</span>
    <span class="s1">if </span><span class="s0">(length !== Object.keys(b).length) </span><span class="s1">return false</span><span class="s3">;</span>

    <span class="s1">for </span><span class="s0">(i = length</span><span class="s3">; </span><span class="s0">i-- !== </span><span class="s4">0</span><span class="s3">;</span><span class="s0">)</span>
      <span class="s1">if </span><span class="s0">(!Object.prototype.hasOwnProperty.call(b</span><span class="s3">, </span><span class="s0">keys[i])) </span><span class="s1">return false</span><span class="s3">;</span>

    <span class="s1">for </span><span class="s0">(i = length</span><span class="s3">; </span><span class="s0">i-- !== </span><span class="s4">0</span><span class="s3">;</span><span class="s0">) {</span>
      <span class="s1">var </span><span class="s0">key = keys[i]</span><span class="s3">;</span>

      <span class="s1">if </span><span class="s0">(!equal(a[key]</span><span class="s3">, </span><span class="s0">b[key])) </span><span class="s1">return false</span><span class="s3">;</span>
    <span class="s0">}</span>

    <span class="s1">return true</span><span class="s3">;</span>
  <span class="s0">}</span>

  <span class="s8">// true if both NaN, false otherwise</span>
  <span class="s1">return </span><span class="s0">a!==a &amp;&amp; b!==b</span><span class="s3">;</span>
<span class="s0">}</span><span class="s3">;</span>

<span class="s0">}</span><span class="s3">,</span><span class="s0">{}]</span><span class="s3">,</span><span class="s4">43</span><span class="s0">:[</span><span class="s1">function</span><span class="s0">(require</span><span class="s3">,</span><span class="s0">module</span><span class="s3">,</span><span class="s0">exports){</span>
<span class="s2">'use strict'</span><span class="s3">;</span>

<span class="s0">module.exports = </span><span class="s1">function </span><span class="s0">(data</span><span class="s3">, </span><span class="s0">opts) {</span>
    <span class="s1">if </span><span class="s0">(!opts) opts = {}</span><span class="s3">;</span>
    <span class="s1">if </span><span class="s0">(</span><span class="s1">typeof </span><span class="s0">opts === </span><span class="s2">'function'</span><span class="s0">) opts = { cmp: opts }</span><span class="s3">;</span>
    <span class="s1">var </span><span class="s0">cycles = (</span><span class="s1">typeof </span><span class="s0">opts.cycles === </span><span class="s2">'boolean'</span><span class="s0">) ? opts.cycles : </span><span class="s1">false</span><span class="s3">;</span>

    <span class="s1">var </span><span class="s0">cmp = opts.cmp &amp;&amp; (</span><span class="s1">function </span><span class="s0">(f) {</span>
        <span class="s1">return function </span><span class="s0">(node) {</span>
            <span class="s1">return function </span><span class="s0">(a</span><span class="s3">, </span><span class="s0">b) {</span>
                <span class="s1">var </span><span class="s0">aobj = { key: a</span><span class="s3">, </span><span class="s0">value: node[a] }</span><span class="s3">;</span>
                <span class="s1">var </span><span class="s0">bobj = { key: b</span><span class="s3">, </span><span class="s0">value: node[b] }</span><span class="s3">;</span>
                <span class="s1">return </span><span class="s0">f(aobj</span><span class="s3">, </span><span class="s0">bobj)</span><span class="s3">;</span>
            <span class="s0">}</span><span class="s3">;</span>
        <span class="s0">}</span><span class="s3">;</span>
    <span class="s0">})(opts.cmp)</span><span class="s3">;</span>

    <span class="s1">var </span><span class="s0">seen = []</span><span class="s3">;</span>
    <span class="s1">return </span><span class="s0">(</span><span class="s1">function </span><span class="s0">stringify (node) {</span>
        <span class="s1">if </span><span class="s0">(node &amp;&amp; node.toJSON &amp;&amp; </span><span class="s1">typeof </span><span class="s0">node.toJSON === </span><span class="s2">'function'</span><span class="s0">) {</span>
            <span class="s0">node = node.toJSON()</span><span class="s3">;</span>
        <span class="s0">}</span>

        <span class="s1">if </span><span class="s0">(node === undefined) </span><span class="s1">return</span><span class="s3">;</span>
        <span class="s1">if </span><span class="s0">(</span><span class="s1">typeof </span><span class="s0">node == </span><span class="s2">'number'</span><span class="s0">) </span><span class="s1">return </span><span class="s0">isFinite(node) ? </span><span class="s2">'' </span><span class="s0">+ node : </span><span class="s2">'null'</span><span class="s3">;</span>
        <span class="s1">if </span><span class="s0">(</span><span class="s1">typeof </span><span class="s0">node !== </span><span class="s2">'object'</span><span class="s0">) </span><span class="s1">return </span><span class="s0">JSON.stringify(node)</span><span class="s3">;</span>

        <span class="s1">var </span><span class="s0">i</span><span class="s3">, </span><span class="s0">out</span><span class="s3">;</span>
        <span class="s1">if </span><span class="s0">(Array.isArray(node)) {</span>
            <span class="s0">out = </span><span class="s2">'['</span><span class="s3">;</span>
            <span class="s1">for </span><span class="s0">(i = </span><span class="s4">0</span><span class="s3">; </span><span class="s0">i &lt; node.length</span><span class="s3">; </span><span class="s0">i++) {</span>
                <span class="s1">if </span><span class="s0">(i) out += </span><span class="s2">','</span><span class="s3">;</span>
                <span class="s0">out += stringify(node[i]) || </span><span class="s2">'null'</span><span class="s3">;</span>
            <span class="s0">}</span>
            <span class="s1">return </span><span class="s0">out + </span><span class="s2">']'</span><span class="s3">;</span>
        <span class="s0">}</span>

        <span class="s1">if </span><span class="s0">(node === </span><span class="s1">null</span><span class="s0">) </span><span class="s1">return </span><span class="s2">'null'</span><span class="s3">;</span>

        <span class="s1">if </span><span class="s0">(seen.indexOf(node) !== -</span><span class="s4">1</span><span class="s0">) {</span>
            <span class="s1">if </span><span class="s0">(cycles) </span><span class="s1">return </span><span class="s0">JSON.stringify(</span><span class="s2">'__cycle__'</span><span class="s0">)</span><span class="s3">;</span>
            <span class="s1">throw new </span><span class="s0">TypeError(</span><span class="s2">'Converting circular structure to JSON'</span><span class="s0">)</span><span class="s3">;</span>
        <span class="s0">}</span>

        <span class="s1">var </span><span class="s0">seenIndex = seen.push(node) - </span><span class="s4">1</span><span class="s3">;</span>
        <span class="s1">var </span><span class="s0">keys = Object.keys(node).sort(cmp &amp;&amp; cmp(node))</span><span class="s3">;</span>
        <span class="s0">out = </span><span class="s2">''</span><span class="s3">;</span>
        <span class="s1">for </span><span class="s0">(i = </span><span class="s4">0</span><span class="s3">; </span><span class="s0">i &lt; keys.length</span><span class="s3">; </span><span class="s0">i++) {</span>
            <span class="s1">var </span><span class="s0">key = keys[i]</span><span class="s3">;</span>
            <span class="s1">var </span><span class="s0">value = stringify(node[key])</span><span class="s3">;</span>

            <span class="s1">if </span><span class="s0">(!value) </span><span class="s1">continue</span><span class="s3">;</span>
            <span class="s1">if </span><span class="s0">(out) out += </span><span class="s2">','</span><span class="s3">;</span>
            <span class="s0">out += JSON.stringify(key) + </span><span class="s2">':' </span><span class="s0">+ value</span><span class="s3">;</span>
        <span class="s0">}</span>
        <span class="s0">seen.splice(seenIndex</span><span class="s3">, </span><span class="s4">1</span><span class="s0">)</span><span class="s3">;</span>
        <span class="s1">return </span><span class="s2">'{' </span><span class="s0">+ out + </span><span class="s2">'}'</span><span class="s3">;</span>
    <span class="s0">})(data)</span><span class="s3">;</span>
<span class="s0">}</span><span class="s3">;</span>

<span class="s0">}</span><span class="s3">,</span><span class="s0">{}]</span><span class="s3">,</span><span class="s4">44</span><span class="s0">:[</span><span class="s1">function</span><span class="s0">(require</span><span class="s3">,</span><span class="s0">module</span><span class="s3">,</span><span class="s0">exports){</span>
<span class="s2">'use strict'</span><span class="s3">;</span>

<span class="s1">var </span><span class="s0">traverse = module.exports = </span><span class="s1">function </span><span class="s0">(schema</span><span class="s3">, </span><span class="s0">opts</span><span class="s3">, </span><span class="s0">cb) {</span>
  <span class="s8">// Legacy support for v0.3.1 and earlier.</span>
  <span class="s1">if </span><span class="s0">(</span><span class="s1">typeof </span><span class="s0">opts == </span><span class="s2">'function'</span><span class="s0">) {</span>
    <span class="s0">cb = opts</span><span class="s3">;</span>
    <span class="s0">opts = {}</span><span class="s3">;</span>
  <span class="s0">}</span>

  <span class="s0">cb = opts.cb || cb</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">pre = (</span><span class="s1">typeof </span><span class="s0">cb == </span><span class="s2">'function'</span><span class="s0">) ? cb : cb.pre || </span><span class="s1">function</span><span class="s0">() {}</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">post = cb.post || </span><span class="s1">function</span><span class="s0">() {}</span><span class="s3">;</span>

  <span class="s0">_traverse(opts</span><span class="s3">, </span><span class="s0">pre</span><span class="s3">, </span><span class="s0">post</span><span class="s3">, </span><span class="s0">schema</span><span class="s3">, </span><span class="s2">''</span><span class="s3">, </span><span class="s0">schema)</span><span class="s3">;</span>
<span class="s0">}</span><span class="s3">;</span>


<span class="s0">traverse.keywords = {</span>
  <span class="s0">additionalItems: </span><span class="s1">true</span><span class="s3">,</span>
  <span class="s0">items: </span><span class="s1">true</span><span class="s3">,</span>
  <span class="s0">contains: </span><span class="s1">true</span><span class="s3">,</span>
  <span class="s0">additionalProperties: </span><span class="s1">true</span><span class="s3">,</span>
  <span class="s0">propertyNames: </span><span class="s1">true</span><span class="s3">,</span>
  <span class="s0">not: </span><span class="s1">true</span>
<span class="s0">}</span><span class="s3">;</span>

<span class="s0">traverse.arrayKeywords = {</span>
  <span class="s0">items: </span><span class="s1">true</span><span class="s3">,</span>
  <span class="s0">allOf: </span><span class="s1">true</span><span class="s3">,</span>
  <span class="s0">anyOf: </span><span class="s1">true</span><span class="s3">,</span>
  <span class="s0">oneOf: </span><span class="s1">true</span>
<span class="s0">}</span><span class="s3">;</span>

<span class="s0">traverse.propsKeywords = {</span>
  <span class="s0">definitions: </span><span class="s1">true</span><span class="s3">,</span>
  <span class="s0">properties: </span><span class="s1">true</span><span class="s3">,</span>
  <span class="s0">patternProperties: </span><span class="s1">true</span><span class="s3">,</span>
  <span class="s0">dependencies: </span><span class="s1">true</span>
<span class="s0">}</span><span class="s3">;</span>

<span class="s0">traverse.skipKeywords = {</span>
  <span class="s1">default</span><span class="s0">: </span><span class="s1">true</span><span class="s3">,</span>
  <span class="s1">enum</span><span class="s0">: </span><span class="s1">true</span><span class="s3">,</span>
  <span class="s1">const</span><span class="s0">: </span><span class="s1">true</span><span class="s3">,</span>
  <span class="s0">required: </span><span class="s1">true</span><span class="s3">,</span>
  <span class="s0">maximum: </span><span class="s1">true</span><span class="s3">,</span>
  <span class="s0">minimum: </span><span class="s1">true</span><span class="s3">,</span>
  <span class="s0">exclusiveMaximum: </span><span class="s1">true</span><span class="s3">,</span>
  <span class="s0">exclusiveMinimum: </span><span class="s1">true</span><span class="s3">,</span>
  <span class="s0">multipleOf: </span><span class="s1">true</span><span class="s3">,</span>
  <span class="s0">maxLength: </span><span class="s1">true</span><span class="s3">,</span>
  <span class="s0">minLength: </span><span class="s1">true</span><span class="s3">,</span>
  <span class="s0">pattern: </span><span class="s1">true</span><span class="s3">,</span>
  <span class="s0">format: </span><span class="s1">true</span><span class="s3">,</span>
  <span class="s0">maxItems: </span><span class="s1">true</span><span class="s3">,</span>
  <span class="s0">minItems: </span><span class="s1">true</span><span class="s3">,</span>
  <span class="s0">uniqueItems: </span><span class="s1">true</span><span class="s3">,</span>
  <span class="s0">maxProperties: </span><span class="s1">true</span><span class="s3">,</span>
  <span class="s0">minProperties: </span><span class="s1">true</span>
<span class="s0">}</span><span class="s3">;</span>


<span class="s1">function </span><span class="s0">_traverse(opts</span><span class="s3">, </span><span class="s0">pre</span><span class="s3">, </span><span class="s0">post</span><span class="s3">, </span><span class="s0">schema</span><span class="s3">, </span><span class="s0">jsonPtr</span><span class="s3">, </span><span class="s0">rootSchema</span><span class="s3">, </span><span class="s0">parentJsonPtr</span><span class="s3">, </span><span class="s0">parentKeyword</span><span class="s3">, </span><span class="s0">parentSchema</span><span class="s3">, </span><span class="s0">keyIndex) {</span>
  <span class="s1">if </span><span class="s0">(schema &amp;&amp; </span><span class="s1">typeof </span><span class="s0">schema == </span><span class="s2">'object' </span><span class="s0">&amp;&amp; !Array.isArray(schema)) {</span>
    <span class="s0">pre(schema</span><span class="s3">, </span><span class="s0">jsonPtr</span><span class="s3">, </span><span class="s0">rootSchema</span><span class="s3">, </span><span class="s0">parentJsonPtr</span><span class="s3">, </span><span class="s0">parentKeyword</span><span class="s3">, </span><span class="s0">parentSchema</span><span class="s3">, </span><span class="s0">keyIndex)</span><span class="s3">;</span>
    <span class="s1">for </span><span class="s0">(</span><span class="s1">var </span><span class="s0">key </span><span class="s1">in </span><span class="s0">schema) {</span>
      <span class="s1">var </span><span class="s0">sch = schema[key]</span><span class="s3">;</span>
      <span class="s1">if </span><span class="s0">(Array.isArray(sch)) {</span>
        <span class="s1">if </span><span class="s0">(key </span><span class="s1">in </span><span class="s0">traverse.arrayKeywords) {</span>
          <span class="s1">for </span><span class="s0">(</span><span class="s1">var </span><span class="s0">i=</span><span class="s4">0</span><span class="s3">; </span><span class="s0">i&lt;sch.length</span><span class="s3">; </span><span class="s0">i++)</span>
            <span class="s0">_traverse(opts</span><span class="s3">, </span><span class="s0">pre</span><span class="s3">, </span><span class="s0">post</span><span class="s3">, </span><span class="s0">sch[i]</span><span class="s3">, </span><span class="s0">jsonPtr + </span><span class="s2">'/' </span><span class="s0">+ key + </span><span class="s2">'/' </span><span class="s0">+ i</span><span class="s3">, </span><span class="s0">rootSchema</span><span class="s3">, </span><span class="s0">jsonPtr</span><span class="s3">, </span><span class="s0">key</span><span class="s3">, </span><span class="s0">schema</span><span class="s3">, </span><span class="s0">i)</span><span class="s3">;</span>
        <span class="s0">}</span>
      <span class="s0">} </span><span class="s1">else if </span><span class="s0">(key </span><span class="s1">in </span><span class="s0">traverse.propsKeywords) {</span>
        <span class="s1">if </span><span class="s0">(sch &amp;&amp; </span><span class="s1">typeof </span><span class="s0">sch == </span><span class="s2">'object'</span><span class="s0">) {</span>
          <span class="s1">for </span><span class="s0">(</span><span class="s1">var </span><span class="s0">prop </span><span class="s1">in </span><span class="s0">sch)</span>
            <span class="s0">_traverse(opts</span><span class="s3">, </span><span class="s0">pre</span><span class="s3">, </span><span class="s0">post</span><span class="s3">, </span><span class="s0">sch[prop]</span><span class="s3">, </span><span class="s0">jsonPtr + </span><span class="s2">'/' </span><span class="s0">+ key + </span><span class="s2">'/' </span><span class="s0">+ escapeJsonPtr(prop)</span><span class="s3">, </span><span class="s0">rootSchema</span><span class="s3">, </span><span class="s0">jsonPtr</span><span class="s3">, </span><span class="s0">key</span><span class="s3">, </span><span class="s0">schema</span><span class="s3">, </span><span class="s0">prop)</span><span class="s3">;</span>
        <span class="s0">}</span>
      <span class="s0">} </span><span class="s1">else if </span><span class="s0">(key </span><span class="s1">in </span><span class="s0">traverse.keywords || (opts.allKeys &amp;&amp; !(key </span><span class="s1">in </span><span class="s0">traverse.skipKeywords))) {</span>
        <span class="s0">_traverse(opts</span><span class="s3">, </span><span class="s0">pre</span><span class="s3">, </span><span class="s0">post</span><span class="s3">, </span><span class="s0">sch</span><span class="s3">, </span><span class="s0">jsonPtr + </span><span class="s2">'/' </span><span class="s0">+ key</span><span class="s3">, </span><span class="s0">rootSchema</span><span class="s3">, </span><span class="s0">jsonPtr</span><span class="s3">, </span><span class="s0">key</span><span class="s3">, </span><span class="s0">schema)</span><span class="s3">;</span>
      <span class="s0">}</span>
    <span class="s0">}</span>
    <span class="s0">post(schema</span><span class="s3">, </span><span class="s0">jsonPtr</span><span class="s3">, </span><span class="s0">rootSchema</span><span class="s3">, </span><span class="s0">parentJsonPtr</span><span class="s3">, </span><span class="s0">parentKeyword</span><span class="s3">, </span><span class="s0">parentSchema</span><span class="s3">, </span><span class="s0">keyIndex)</span><span class="s3">;</span>
  <span class="s0">}</span>
<span class="s0">}</span>


<span class="s1">function </span><span class="s0">escapeJsonPtr(str) {</span>
  <span class="s1">return </span><span class="s0">str.replace(</span><span class="s4">/~/g</span><span class="s3">, </span><span class="s2">'~0'</span><span class="s0">).replace(</span><span class="s4">/\//g</span><span class="s3">, </span><span class="s2">'~1'</span><span class="s0">)</span><span class="s3">;</span>
<span class="s0">}</span>

<span class="s0">}</span><span class="s3">,</span><span class="s0">{}]</span><span class="s3">,</span><span class="s4">45</span><span class="s0">:[</span><span class="s1">function</span><span class="s0">(require</span><span class="s3">,</span><span class="s0">module</span><span class="s3">,</span><span class="s0">exports){</span>
<span class="s5">/** </span><span class="s6">@license </span><span class="s5">URI.js v4.4.0 (c) 2011 Gary Court. License: http://github.com/garycourt/uri-js */</span>
<span class="s0">(</span><span class="s1">function </span><span class="s0">(global</span><span class="s3">, </span><span class="s0">factory) {</span>
	<span class="s1">typeof </span><span class="s0">exports === </span><span class="s2">'object' </span><span class="s0">&amp;&amp; </span><span class="s1">typeof </span><span class="s0">module !== </span><span class="s2">'undefined' </span><span class="s0">? factory(exports) :</span>
	<span class="s1">typeof </span><span class="s0">define === </span><span class="s2">'function' </span><span class="s0">&amp;&amp; define.amd ? define([</span><span class="s2">'exports'</span><span class="s0">]</span><span class="s3">, </span><span class="s0">factory) :</span>
	<span class="s0">(factory((global.URI = global.URI || {})))</span><span class="s3">;</span>
<span class="s0">}(</span><span class="s1">this</span><span class="s3">, </span><span class="s0">(</span><span class="s1">function </span><span class="s0">(exports) { </span><span class="s2">'use strict'</span><span class="s3">;</span>

<span class="s1">function </span><span class="s0">merge() {</span>
    <span class="s1">for </span><span class="s0">(</span><span class="s1">var </span><span class="s0">_len = arguments.length</span><span class="s3">, </span><span class="s0">sets = Array(_len)</span><span class="s3">, </span><span class="s0">_key = </span><span class="s4">0</span><span class="s3">; </span><span class="s0">_key &lt; _len</span><span class="s3">; </span><span class="s0">_key++) {</span>
        <span class="s0">sets[_key] = arguments[_key]</span><span class="s3">;</span>
    <span class="s0">}</span>

    <span class="s1">if </span><span class="s0">(sets.length &gt; </span><span class="s4">1</span><span class="s0">) {</span>
        <span class="s0">sets[</span><span class="s4">0</span><span class="s0">] = sets[</span><span class="s4">0</span><span class="s0">].slice(</span><span class="s4">0</span><span class="s3">, </span><span class="s0">-</span><span class="s4">1</span><span class="s0">)</span><span class="s3">;</span>
        <span class="s1">var </span><span class="s0">xl = sets.length - </span><span class="s4">1</span><span class="s3">;</span>
        <span class="s1">for </span><span class="s0">(</span><span class="s1">var </span><span class="s0">x = </span><span class="s4">1</span><span class="s3">; </span><span class="s0">x &lt; xl</span><span class="s3">; </span><span class="s0">++x) {</span>
            <span class="s0">sets[x] = sets[x].slice(</span><span class="s4">1</span><span class="s3">, </span><span class="s0">-</span><span class="s4">1</span><span class="s0">)</span><span class="s3">;</span>
        <span class="s0">}</span>
        <span class="s0">sets[xl] = sets[xl].slice(</span><span class="s4">1</span><span class="s0">)</span><span class="s3">;</span>
        <span class="s1">return </span><span class="s0">sets.join(</span><span class="s2">''</span><span class="s0">)</span><span class="s3">;</span>
    <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
        <span class="s1">return </span><span class="s0">sets[</span><span class="s4">0</span><span class="s0">]</span><span class="s3">;</span>
    <span class="s0">}</span>
<span class="s0">}</span>
<span class="s1">function </span><span class="s0">subexp(str) {</span>
    <span class="s1">return </span><span class="s2">&quot;(?:&quot; </span><span class="s0">+ str + </span><span class="s2">&quot;)&quot;</span><span class="s3">;</span>
<span class="s0">}</span>
<span class="s1">function </span><span class="s0">typeOf(o) {</span>
    <span class="s1">return </span><span class="s0">o === undefined ? </span><span class="s2">&quot;undefined&quot; </span><span class="s0">: o === </span><span class="s1">null </span><span class="s0">? </span><span class="s2">&quot;null&quot; </span><span class="s0">: Object.prototype.toString.call(o).split(</span><span class="s2">&quot; &quot;</span><span class="s0">).pop().split(</span><span class="s2">&quot;]&quot;</span><span class="s0">).shift().toLowerCase()</span><span class="s3">;</span>
<span class="s0">}</span>
<span class="s1">function </span><span class="s0">toUpperCase(str) {</span>
    <span class="s1">return </span><span class="s0">str.toUpperCase()</span><span class="s3">;</span>
<span class="s0">}</span>
<span class="s1">function </span><span class="s0">toArray(obj) {</span>
    <span class="s1">return </span><span class="s0">obj !== undefined &amp;&amp; obj !== </span><span class="s1">null </span><span class="s0">? obj </span><span class="s1">instanceof </span><span class="s0">Array ? obj : </span><span class="s1">typeof </span><span class="s0">obj.length !== </span><span class="s2">&quot;number&quot; </span><span class="s0">|| obj.split || obj.setInterval || obj.call ? [obj] : Array.prototype.slice.call(obj) : []</span><span class="s3">;</span>
<span class="s0">}</span>
<span class="s1">function </span><span class="s0">assign(target</span><span class="s3">, </span><span class="s0">source) {</span>
    <span class="s1">var </span><span class="s0">obj = target</span><span class="s3">;</span>
    <span class="s1">if </span><span class="s0">(source) {</span>
        <span class="s1">for </span><span class="s0">(</span><span class="s1">var </span><span class="s0">key </span><span class="s1">in </span><span class="s0">source) {</span>
            <span class="s0">obj[key] = source[key]</span><span class="s3">;</span>
        <span class="s0">}</span>
    <span class="s0">}</span>
    <span class="s1">return </span><span class="s0">obj</span><span class="s3">;</span>
<span class="s0">}</span>

<span class="s1">function </span><span class="s0">buildExps(isIRI) {</span>
    <span class="s1">var </span><span class="s0">ALPHA$$ = </span><span class="s2">&quot;[A-Za-z]&quot;</span><span class="s3">,</span>
        <span class="s0">CR$ = </span><span class="s2">&quot;[</span><span class="s3">\\</span><span class="s2">x0D]&quot;</span><span class="s3">,</span>
        <span class="s0">DIGIT$$ = </span><span class="s2">&quot;[0-9]&quot;</span><span class="s3">,</span>
        <span class="s0">DQUOTE$$ = </span><span class="s2">&quot;[</span><span class="s3">\\</span><span class="s2">x22]&quot;</span><span class="s3">,</span>
        <span class="s0">HEXDIG$$ = merge(DIGIT$$</span><span class="s3">, </span><span class="s2">&quot;[A-Fa-f]&quot;</span><span class="s0">)</span><span class="s3">,</span>
        <span class="s8">//case-insensitive</span>
    <span class="s0">LF$$ = </span><span class="s2">&quot;[</span><span class="s3">\\</span><span class="s2">x0A]&quot;</span><span class="s3">,</span>
        <span class="s0">SP$$ = </span><span class="s2">&quot;[</span><span class="s3">\\</span><span class="s2">x20]&quot;</span><span class="s3">,</span>
        <span class="s0">PCT_ENCODED$ = subexp(subexp(</span><span class="s2">&quot;%[EFef]&quot; </span><span class="s0">+ HEXDIG$$ + </span><span class="s2">&quot;%&quot; </span><span class="s0">+ HEXDIG$$ + HEXDIG$$ + </span><span class="s2">&quot;%&quot; </span><span class="s0">+ HEXDIG$$ + HEXDIG$$) + </span><span class="s2">&quot;|&quot; </span><span class="s0">+ subexp(</span><span class="s2">&quot;%[89A-Fa-f]&quot; </span><span class="s0">+ HEXDIG$$ + </span><span class="s2">&quot;%&quot; </span><span class="s0">+ HEXDIG$$ + HEXDIG$$) + </span><span class="s2">&quot;|&quot; </span><span class="s0">+ subexp(</span><span class="s2">&quot;%&quot; </span><span class="s0">+ HEXDIG$$ + HEXDIG$$))</span><span class="s3">,</span>
        <span class="s8">//expanded</span>
    <span class="s0">GEN_DELIMS$$ = </span><span class="s2">&quot;[</span><span class="s3">\\</span><span class="s2">:</span><span class="s3">\\</span><span class="s2">/</span><span class="s3">\\</span><span class="s2">?</span><span class="s3">\\</span><span class="s2">#</span><span class="s3">\\</span><span class="s2">[</span><span class="s3">\\</span><span class="s2">]</span><span class="s3">\\</span><span class="s2">@]&quot;</span><span class="s3">,</span>
        <span class="s0">SUB_DELIMS$$ = </span><span class="s2">&quot;[</span><span class="s3">\\</span><span class="s2">!</span><span class="s3">\\</span><span class="s2">$</span><span class="s3">\\</span><span class="s2">&amp;</span><span class="s3">\\</span><span class="s2">'</span><span class="s3">\\</span><span class="s2">(</span><span class="s3">\\</span><span class="s2">)</span><span class="s3">\\</span><span class="s2">*</span><span class="s3">\\</span><span class="s2">+</span><span class="s3">\\</span><span class="s2">,</span><span class="s3">\\</span><span class="s2">;</span><span class="s3">\\</span><span class="s2">=]&quot;</span><span class="s3">,</span>
        <span class="s0">RESERVED$$ = merge(GEN_DELIMS$$</span><span class="s3">, </span><span class="s0">SUB_DELIMS$$)</span><span class="s3">,</span>
        <span class="s0">UCSCHAR$$ = isIRI ? </span><span class="s2">&quot;[</span><span class="s3">\\</span><span class="s2">xA0-</span><span class="s3">\\</span><span class="s2">u200D</span><span class="s3">\\</span><span class="s2">u2010-</span><span class="s3">\\</span><span class="s2">u2029</span><span class="s3">\\</span><span class="s2">u202F-</span><span class="s3">\\</span><span class="s2">uD7FF</span><span class="s3">\\</span><span class="s2">uF900-</span><span class="s3">\\</span><span class="s2">uFDCF</span><span class="s3">\\</span><span class="s2">uFDF0-</span><span class="s3">\\</span><span class="s2">uFFEF]&quot; </span><span class="s0">: </span><span class="s2">&quot;[]&quot;</span><span class="s3">,</span>
        <span class="s8">//subset, excludes bidi control characters</span>
    <span class="s0">IPRIVATE$$ = isIRI ? </span><span class="s2">&quot;[</span><span class="s3">\\</span><span class="s2">uE000-</span><span class="s3">\\</span><span class="s2">uF8FF]&quot; </span><span class="s0">: </span><span class="s2">&quot;[]&quot;</span><span class="s3">,</span>
        <span class="s8">//subset</span>
    <span class="s0">UNRESERVED$$ = merge(ALPHA$$</span><span class="s3">, </span><span class="s0">DIGIT$$</span><span class="s3">, </span><span class="s2">&quot;[</span><span class="s3">\\</span><span class="s2">-</span><span class="s3">\\</span><span class="s2">.</span><span class="s3">\\</span><span class="s2">_</span><span class="s3">\\</span><span class="s2">~]&quot;</span><span class="s3">, </span><span class="s0">UCSCHAR$$)</span><span class="s3">,</span>
        <span class="s0">SCHEME$ = subexp(ALPHA$$ + merge(ALPHA$$</span><span class="s3">, </span><span class="s0">DIGIT$$</span><span class="s3">, </span><span class="s2">&quot;[</span><span class="s3">\\</span><span class="s2">+</span><span class="s3">\\</span><span class="s2">-</span><span class="s3">\\</span><span class="s2">.]&quot;</span><span class="s0">) + </span><span class="s2">&quot;*&quot;</span><span class="s0">)</span><span class="s3">,</span>
        <span class="s0">USERINFO$ = subexp(subexp(PCT_ENCODED$ + </span><span class="s2">&quot;|&quot; </span><span class="s0">+ merge(UNRESERVED$$</span><span class="s3">, </span><span class="s0">SUB_DELIMS$$</span><span class="s3">, </span><span class="s2">&quot;[</span><span class="s3">\\</span><span class="s2">:]&quot;</span><span class="s0">)) + </span><span class="s2">&quot;*&quot;</span><span class="s0">)</span><span class="s3">,</span>
        <span class="s0">DEC_OCTET$ = subexp(subexp(</span><span class="s2">&quot;25[0-5]&quot;</span><span class="s0">) + </span><span class="s2">&quot;|&quot; </span><span class="s0">+ subexp(</span><span class="s2">&quot;2[0-4]&quot; </span><span class="s0">+ DIGIT$$) + </span><span class="s2">&quot;|&quot; </span><span class="s0">+ subexp(</span><span class="s2">&quot;1&quot; </span><span class="s0">+ DIGIT$$ + DIGIT$$) + </span><span class="s2">&quot;|&quot; </span><span class="s0">+ subexp(</span><span class="s2">&quot;[1-9]&quot; </span><span class="s0">+ DIGIT$$) + </span><span class="s2">&quot;|&quot; </span><span class="s0">+ DIGIT$$)</span><span class="s3">,</span>
        <span class="s0">DEC_OCTET_RELAXED$ = subexp(subexp(</span><span class="s2">&quot;25[0-5]&quot;</span><span class="s0">) + </span><span class="s2">&quot;|&quot; </span><span class="s0">+ subexp(</span><span class="s2">&quot;2[0-4]&quot; </span><span class="s0">+ DIGIT$$) + </span><span class="s2">&quot;|&quot; </span><span class="s0">+ subexp(</span><span class="s2">&quot;1&quot; </span><span class="s0">+ DIGIT$$ + DIGIT$$) + </span><span class="s2">&quot;|&quot; </span><span class="s0">+ subexp(</span><span class="s2">&quot;0?[1-9]&quot; </span><span class="s0">+ DIGIT$$) + </span><span class="s2">&quot;|0?0?&quot; </span><span class="s0">+ DIGIT$$)</span><span class="s3">,</span>
        <span class="s8">//relaxed parsing rules</span>
    <span class="s0">IPV4ADDRESS$ = subexp(DEC_OCTET_RELAXED$ + </span><span class="s2">&quot;</span><span class="s3">\\</span><span class="s2">.&quot; </span><span class="s0">+ DEC_OCTET_RELAXED$ + </span><span class="s2">&quot;</span><span class="s3">\\</span><span class="s2">.&quot; </span><span class="s0">+ DEC_OCTET_RELAXED$ + </span><span class="s2">&quot;</span><span class="s3">\\</span><span class="s2">.&quot; </span><span class="s0">+ DEC_OCTET_RELAXED$)</span><span class="s3">,</span>
        <span class="s0">H16$ = subexp(HEXDIG$$ + </span><span class="s2">&quot;{1,4}&quot;</span><span class="s0">)</span><span class="s3">,</span>
        <span class="s0">LS32$ = subexp(subexp(H16$ + </span><span class="s2">&quot;</span><span class="s3">\\</span><span class="s2">:&quot; </span><span class="s0">+ H16$) + </span><span class="s2">&quot;|&quot; </span><span class="s0">+ IPV4ADDRESS$)</span><span class="s3">,</span>
        <span class="s0">IPV6ADDRESS1$ = subexp(subexp(H16$ + </span><span class="s2">&quot;</span><span class="s3">\\</span><span class="s2">:&quot;</span><span class="s0">) + </span><span class="s2">&quot;{6}&quot; </span><span class="s0">+ LS32$)</span><span class="s3">,</span>
        <span class="s8">//                           6( h16 &quot;:&quot; ) ls32</span>
    <span class="s0">IPV6ADDRESS2$ = subexp(</span><span class="s2">&quot;</span><span class="s3">\\</span><span class="s2">:</span><span class="s3">\\</span><span class="s2">:&quot; </span><span class="s0">+ subexp(H16$ + </span><span class="s2">&quot;</span><span class="s3">\\</span><span class="s2">:&quot;</span><span class="s0">) + </span><span class="s2">&quot;{5}&quot; </span><span class="s0">+ LS32$)</span><span class="s3">,</span>
        <span class="s8">//                      &quot;::&quot; 5( h16 &quot;:&quot; ) ls32</span>
    <span class="s0">IPV6ADDRESS3$ = subexp(subexp(H16$) + </span><span class="s2">&quot;?</span><span class="s3">\\</span><span class="s2">:</span><span class="s3">\\</span><span class="s2">:&quot; </span><span class="s0">+ subexp(H16$ + </span><span class="s2">&quot;</span><span class="s3">\\</span><span class="s2">:&quot;</span><span class="s0">) + </span><span class="s2">&quot;{4}&quot; </span><span class="s0">+ LS32$)</span><span class="s3">,</span>
        <span class="s8">//[               h16 ] &quot;::&quot; 4( h16 &quot;:&quot; ) ls32</span>
    <span class="s0">IPV6ADDRESS4$ = subexp(subexp(subexp(H16$ + </span><span class="s2">&quot;</span><span class="s3">\\</span><span class="s2">:&quot;</span><span class="s0">) + </span><span class="s2">&quot;{0,1}&quot; </span><span class="s0">+ H16$) + </span><span class="s2">&quot;?</span><span class="s3">\\</span><span class="s2">:</span><span class="s3">\\</span><span class="s2">:&quot; </span><span class="s0">+ subexp(H16$ + </span><span class="s2">&quot;</span><span class="s3">\\</span><span class="s2">:&quot;</span><span class="s0">) + </span><span class="s2">&quot;{3}&quot; </span><span class="s0">+ LS32$)</span><span class="s3">,</span>
        <span class="s8">//[ *1( h16 &quot;:&quot; ) h16 ] &quot;::&quot; 3( h16 &quot;:&quot; ) ls32</span>
    <span class="s0">IPV6ADDRESS5$ = subexp(subexp(subexp(H16$ + </span><span class="s2">&quot;</span><span class="s3">\\</span><span class="s2">:&quot;</span><span class="s0">) + </span><span class="s2">&quot;{0,2}&quot; </span><span class="s0">+ H16$) + </span><span class="s2">&quot;?</span><span class="s3">\\</span><span class="s2">:</span><span class="s3">\\</span><span class="s2">:&quot; </span><span class="s0">+ subexp(H16$ + </span><span class="s2">&quot;</span><span class="s3">\\</span><span class="s2">:&quot;</span><span class="s0">) + </span><span class="s2">&quot;{2}&quot; </span><span class="s0">+ LS32$)</span><span class="s3">,</span>
        <span class="s8">//[ *2( h16 &quot;:&quot; ) h16 ] &quot;::&quot; 2( h16 &quot;:&quot; ) ls32</span>
    <span class="s0">IPV6ADDRESS6$ = subexp(subexp(subexp(H16$ + </span><span class="s2">&quot;</span><span class="s3">\\</span><span class="s2">:&quot;</span><span class="s0">) + </span><span class="s2">&quot;{0,3}&quot; </span><span class="s0">+ H16$) + </span><span class="s2">&quot;?</span><span class="s3">\\</span><span class="s2">:</span><span class="s3">\\</span><span class="s2">:&quot; </span><span class="s0">+ H16$ + </span><span class="s2">&quot;</span><span class="s3">\\</span><span class="s2">:&quot; </span><span class="s0">+ LS32$)</span><span class="s3">,</span>
        <span class="s8">//[ *3( h16 &quot;:&quot; ) h16 ] &quot;::&quot;    h16 &quot;:&quot;   ls32</span>
    <span class="s0">IPV6ADDRESS7$ = subexp(subexp(subexp(H16$ + </span><span class="s2">&quot;</span><span class="s3">\\</span><span class="s2">:&quot;</span><span class="s0">) + </span><span class="s2">&quot;{0,4}&quot; </span><span class="s0">+ H16$) + </span><span class="s2">&quot;?</span><span class="s3">\\</span><span class="s2">:</span><span class="s3">\\</span><span class="s2">:&quot; </span><span class="s0">+ LS32$)</span><span class="s3">,</span>
        <span class="s8">//[ *4( h16 &quot;:&quot; ) h16 ] &quot;::&quot;              ls32</span>
    <span class="s0">IPV6ADDRESS8$ = subexp(subexp(subexp(H16$ + </span><span class="s2">&quot;</span><span class="s3">\\</span><span class="s2">:&quot;</span><span class="s0">) + </span><span class="s2">&quot;{0,5}&quot; </span><span class="s0">+ H16$) + </span><span class="s2">&quot;?</span><span class="s3">\\</span><span class="s2">:</span><span class="s3">\\</span><span class="s2">:&quot; </span><span class="s0">+ H16$)</span><span class="s3">,</span>
        <span class="s8">//[ *5( h16 &quot;:&quot; ) h16 ] &quot;::&quot;              h16</span>
    <span class="s0">IPV6ADDRESS9$ = subexp(subexp(subexp(H16$ + </span><span class="s2">&quot;</span><span class="s3">\\</span><span class="s2">:&quot;</span><span class="s0">) + </span><span class="s2">&quot;{0,6}&quot; </span><span class="s0">+ H16$) + </span><span class="s2">&quot;?</span><span class="s3">\\</span><span class="s2">:</span><span class="s3">\\</span><span class="s2">:&quot;</span><span class="s0">)</span><span class="s3">,</span>
        <span class="s8">//[ *6( h16 &quot;:&quot; ) h16 ] &quot;::&quot;</span>
    <span class="s0">IPV6ADDRESS$ = subexp([IPV6ADDRESS1$</span><span class="s3">, </span><span class="s0">IPV6ADDRESS2$</span><span class="s3">, </span><span class="s0">IPV6ADDRESS3$</span><span class="s3">, </span><span class="s0">IPV6ADDRESS4$</span><span class="s3">, </span><span class="s0">IPV6ADDRESS5$</span><span class="s3">, </span><span class="s0">IPV6ADDRESS6$</span><span class="s3">, </span><span class="s0">IPV6ADDRESS7$</span><span class="s3">, </span><span class="s0">IPV6ADDRESS8$</span><span class="s3">, </span><span class="s0">IPV6ADDRESS9$].join(</span><span class="s2">&quot;|&quot;</span><span class="s0">))</span><span class="s3">,</span>
        <span class="s0">ZONEID$ = subexp(subexp(UNRESERVED$$ + </span><span class="s2">&quot;|&quot; </span><span class="s0">+ PCT_ENCODED$) + </span><span class="s2">&quot;+&quot;</span><span class="s0">)</span><span class="s3">,</span>
        <span class="s8">//RFC 6874</span>
    <span class="s0">IPV6ADDRZ$ = subexp(IPV6ADDRESS$ + </span><span class="s2">&quot;</span><span class="s3">\\</span><span class="s2">%25&quot; </span><span class="s0">+ ZONEID$)</span><span class="s3">,</span>
        <span class="s8">//RFC 6874</span>
    <span class="s0">IPV6ADDRZ_RELAXED$ = subexp(IPV6ADDRESS$ + subexp(</span><span class="s2">&quot;</span><span class="s3">\\</span><span class="s2">%25|</span><span class="s3">\\</span><span class="s2">%(?!&quot; </span><span class="s0">+ HEXDIG$$ + </span><span class="s2">&quot;{2})&quot;</span><span class="s0">) + ZONEID$)</span><span class="s3">,</span>
        <span class="s8">//RFC 6874, with relaxed parsing rules</span>
    <span class="s0">IPVFUTURE$ = subexp(</span><span class="s2">&quot;[vV]&quot; </span><span class="s0">+ HEXDIG$$ + </span><span class="s2">&quot;+</span><span class="s3">\\</span><span class="s2">.&quot; </span><span class="s0">+ merge(UNRESERVED$$</span><span class="s3">, </span><span class="s0">SUB_DELIMS$$</span><span class="s3">, </span><span class="s2">&quot;[</span><span class="s3">\\</span><span class="s2">:]&quot;</span><span class="s0">) + </span><span class="s2">&quot;+&quot;</span><span class="s0">)</span><span class="s3">,</span>
        <span class="s0">IP_LITERAL$ = subexp(</span><span class="s2">&quot;</span><span class="s3">\\</span><span class="s2">[&quot; </span><span class="s0">+ subexp(IPV6ADDRZ_RELAXED$ + </span><span class="s2">&quot;|&quot; </span><span class="s0">+ IPV6ADDRESS$ + </span><span class="s2">&quot;|&quot; </span><span class="s0">+ IPVFUTURE$) + </span><span class="s2">&quot;</span><span class="s3">\\</span><span class="s2">]&quot;</span><span class="s0">)</span><span class="s3">,</span>
        <span class="s8">//RFC 6874</span>
    <span class="s0">REG_NAME$ = subexp(subexp(PCT_ENCODED$ + </span><span class="s2">&quot;|&quot; </span><span class="s0">+ merge(UNRESERVED$$</span><span class="s3">, </span><span class="s0">SUB_DELIMS$$)) + </span><span class="s2">&quot;*&quot;</span><span class="s0">)</span><span class="s3">,</span>
        <span class="s0">HOST$ = subexp(IP_LITERAL$ + </span><span class="s2">&quot;|&quot; </span><span class="s0">+ IPV4ADDRESS$ + </span><span class="s2">&quot;(?!&quot; </span><span class="s0">+ REG_NAME$ + </span><span class="s2">&quot;)&quot; </span><span class="s0">+ </span><span class="s2">&quot;|&quot; </span><span class="s0">+ REG_NAME$)</span><span class="s3">,</span>
        <span class="s0">PORT$ = subexp(DIGIT$$ + </span><span class="s2">&quot;*&quot;</span><span class="s0">)</span><span class="s3">,</span>
        <span class="s0">AUTHORITY$ = subexp(subexp(USERINFO$ + </span><span class="s2">&quot;@&quot;</span><span class="s0">) + </span><span class="s2">&quot;?&quot; </span><span class="s0">+ HOST$ + subexp(</span><span class="s2">&quot;</span><span class="s3">\\</span><span class="s2">:&quot; </span><span class="s0">+ PORT$) + </span><span class="s2">&quot;?&quot;</span><span class="s0">)</span><span class="s3">,</span>
        <span class="s0">PCHAR$ = subexp(PCT_ENCODED$ + </span><span class="s2">&quot;|&quot; </span><span class="s0">+ merge(UNRESERVED$$</span><span class="s3">, </span><span class="s0">SUB_DELIMS$$</span><span class="s3">, </span><span class="s2">&quot;[</span><span class="s3">\\</span><span class="s2">:</span><span class="s3">\\</span><span class="s2">@]&quot;</span><span class="s0">))</span><span class="s3">,</span>
        <span class="s0">SEGMENT$ = subexp(PCHAR$ + </span><span class="s2">&quot;*&quot;</span><span class="s0">)</span><span class="s3">,</span>
        <span class="s0">SEGMENT_NZ$ = subexp(PCHAR$ + </span><span class="s2">&quot;+&quot;</span><span class="s0">)</span><span class="s3">,</span>
        <span class="s0">SEGMENT_NZ_NC$ = subexp(subexp(PCT_ENCODED$ + </span><span class="s2">&quot;|&quot; </span><span class="s0">+ merge(UNRESERVED$$</span><span class="s3">, </span><span class="s0">SUB_DELIMS$$</span><span class="s3">, </span><span class="s2">&quot;[</span><span class="s3">\\</span><span class="s2">@]&quot;</span><span class="s0">)) + </span><span class="s2">&quot;+&quot;</span><span class="s0">)</span><span class="s3">,</span>
        <span class="s0">PATH_ABEMPTY$ = subexp(subexp(</span><span class="s2">&quot;</span><span class="s3">\\</span><span class="s2">/&quot; </span><span class="s0">+ SEGMENT$) + </span><span class="s2">&quot;*&quot;</span><span class="s0">)</span><span class="s3">,</span>
        <span class="s0">PATH_ABSOLUTE$ = subexp(</span><span class="s2">&quot;</span><span class="s3">\\</span><span class="s2">/&quot; </span><span class="s0">+ subexp(SEGMENT_NZ$ + PATH_ABEMPTY$) + </span><span class="s2">&quot;?&quot;</span><span class="s0">)</span><span class="s3">,</span>
        <span class="s8">//simplified</span>
    <span class="s0">PATH_NOSCHEME$ = subexp(SEGMENT_NZ_NC$ + PATH_ABEMPTY$)</span><span class="s3">,</span>
        <span class="s8">//simplified</span>
    <span class="s0">PATH_ROOTLESS$ = subexp(SEGMENT_NZ$ + PATH_ABEMPTY$)</span><span class="s3">,</span>
        <span class="s8">//simplified</span>
    <span class="s0">PATH_EMPTY$ = </span><span class="s2">&quot;(?!&quot; </span><span class="s0">+ PCHAR$ + </span><span class="s2">&quot;)&quot;</span><span class="s3">,</span>
        <span class="s0">PATH$ = subexp(PATH_ABEMPTY$ + </span><span class="s2">&quot;|&quot; </span><span class="s0">+ PATH_ABSOLUTE$ + </span><span class="s2">&quot;|&quot; </span><span class="s0">+ PATH_NOSCHEME$ + </span><span class="s2">&quot;|&quot; </span><span class="s0">+ PATH_ROOTLESS$ + </span><span class="s2">&quot;|&quot; </span><span class="s0">+ PATH_EMPTY$)</span><span class="s3">,</span>
        <span class="s0">QUERY$ = subexp(subexp(PCHAR$ + </span><span class="s2">&quot;|&quot; </span><span class="s0">+ merge(</span><span class="s2">&quot;[</span><span class="s3">\\</span><span class="s2">/</span><span class="s3">\\</span><span class="s2">?]&quot;</span><span class="s3">, </span><span class="s0">IPRIVATE$$)) + </span><span class="s2">&quot;*&quot;</span><span class="s0">)</span><span class="s3">,</span>
        <span class="s0">FRAGMENT$ = subexp(subexp(PCHAR$ + </span><span class="s2">&quot;|[</span><span class="s3">\\</span><span class="s2">/</span><span class="s3">\\</span><span class="s2">?]&quot;</span><span class="s0">) + </span><span class="s2">&quot;*&quot;</span><span class="s0">)</span><span class="s3">,</span>
        <span class="s0">HIER_PART$ = subexp(subexp(</span><span class="s2">&quot;</span><span class="s3">\\</span><span class="s2">/</span><span class="s3">\\</span><span class="s2">/&quot; </span><span class="s0">+ AUTHORITY$ + PATH_ABEMPTY$) + </span><span class="s2">&quot;|&quot; </span><span class="s0">+ PATH_ABSOLUTE$ + </span><span class="s2">&quot;|&quot; </span><span class="s0">+ PATH_ROOTLESS$ + </span><span class="s2">&quot;|&quot; </span><span class="s0">+ PATH_EMPTY$)</span><span class="s3">,</span>
        <span class="s0">URI$ = subexp(SCHEME$ + </span><span class="s2">&quot;</span><span class="s3">\\</span><span class="s2">:&quot; </span><span class="s0">+ HIER_PART$ + subexp(</span><span class="s2">&quot;</span><span class="s3">\\</span><span class="s2">?&quot; </span><span class="s0">+ QUERY$) + </span><span class="s2">&quot;?&quot; </span><span class="s0">+ subexp(</span><span class="s2">&quot;</span><span class="s3">\\</span><span class="s2">#&quot; </span><span class="s0">+ FRAGMENT$) + </span><span class="s2">&quot;?&quot;</span><span class="s0">)</span><span class="s3">,</span>
        <span class="s0">RELATIVE_PART$ = subexp(subexp(</span><span class="s2">&quot;</span><span class="s3">\\</span><span class="s2">/</span><span class="s3">\\</span><span class="s2">/&quot; </span><span class="s0">+ AUTHORITY$ + PATH_ABEMPTY$) + </span><span class="s2">&quot;|&quot; </span><span class="s0">+ PATH_ABSOLUTE$ + </span><span class="s2">&quot;|&quot; </span><span class="s0">+ PATH_NOSCHEME$ + </span><span class="s2">&quot;|&quot; </span><span class="s0">+ PATH_EMPTY$)</span><span class="s3">,</span>
        <span class="s0">RELATIVE$ = subexp(RELATIVE_PART$ + subexp(</span><span class="s2">&quot;</span><span class="s3">\\</span><span class="s2">?&quot; </span><span class="s0">+ QUERY$) + </span><span class="s2">&quot;?&quot; </span><span class="s0">+ subexp(</span><span class="s2">&quot;</span><span class="s3">\\</span><span class="s2">#&quot; </span><span class="s0">+ FRAGMENT$) + </span><span class="s2">&quot;?&quot;</span><span class="s0">)</span><span class="s3">,</span>
        <span class="s0">URI_REFERENCE$ = subexp(URI$ + </span><span class="s2">&quot;|&quot; </span><span class="s0">+ RELATIVE$)</span><span class="s3">,</span>
        <span class="s0">ABSOLUTE_URI$ = subexp(SCHEME$ + </span><span class="s2">&quot;</span><span class="s3">\\</span><span class="s2">:&quot; </span><span class="s0">+ HIER_PART$ + subexp(</span><span class="s2">&quot;</span><span class="s3">\\</span><span class="s2">?&quot; </span><span class="s0">+ QUERY$) + </span><span class="s2">&quot;?&quot;</span><span class="s0">)</span><span class="s3">,</span>
        <span class="s0">GENERIC_REF$ = </span><span class="s2">&quot;^(&quot; </span><span class="s0">+ SCHEME$ + </span><span class="s2">&quot;)</span><span class="s3">\\</span><span class="s2">:&quot; </span><span class="s0">+ subexp(subexp(</span><span class="s2">&quot;</span><span class="s3">\\</span><span class="s2">/</span><span class="s3">\\</span><span class="s2">/(&quot; </span><span class="s0">+ subexp(</span><span class="s2">&quot;(&quot; </span><span class="s0">+ USERINFO$ + </span><span class="s2">&quot;)@&quot;</span><span class="s0">) + </span><span class="s2">&quot;?(&quot; </span><span class="s0">+ HOST$ + </span><span class="s2">&quot;)&quot; </span><span class="s0">+ subexp(</span><span class="s2">&quot;</span><span class="s3">\\</span><span class="s2">:(&quot; </span><span class="s0">+ PORT$ + </span><span class="s2">&quot;)&quot;</span><span class="s0">) + </span><span class="s2">&quot;?)&quot;</span><span class="s0">) + </span><span class="s2">&quot;?(&quot; </span><span class="s0">+ PATH_ABEMPTY$ + </span><span class="s2">&quot;|&quot; </span><span class="s0">+ PATH_ABSOLUTE$ + </span><span class="s2">&quot;|&quot; </span><span class="s0">+ PATH_ROOTLESS$ + </span><span class="s2">&quot;|&quot; </span><span class="s0">+ PATH_EMPTY$ + </span><span class="s2">&quot;)&quot;</span><span class="s0">) + subexp(</span><span class="s2">&quot;</span><span class="s3">\\</span><span class="s2">?(&quot; </span><span class="s0">+ QUERY$ + </span><span class="s2">&quot;)&quot;</span><span class="s0">) + </span><span class="s2">&quot;?&quot; </span><span class="s0">+ subexp(</span><span class="s2">&quot;</span><span class="s3">\\</span><span class="s2">#(&quot; </span><span class="s0">+ FRAGMENT$ + </span><span class="s2">&quot;)&quot;</span><span class="s0">) + </span><span class="s2">&quot;?$&quot;</span><span class="s3">,</span>
        <span class="s0">RELATIVE_REF$ = </span><span class="s2">&quot;^(){0}&quot; </span><span class="s0">+ subexp(subexp(</span><span class="s2">&quot;</span><span class="s3">\\</span><span class="s2">/</span><span class="s3">\\</span><span class="s2">/(&quot; </span><span class="s0">+ subexp(</span><span class="s2">&quot;(&quot; </span><span class="s0">+ USERINFO$ + </span><span class="s2">&quot;)@&quot;</span><span class="s0">) + </span><span class="s2">&quot;?(&quot; </span><span class="s0">+ HOST$ + </span><span class="s2">&quot;)&quot; </span><span class="s0">+ subexp(</span><span class="s2">&quot;</span><span class="s3">\\</span><span class="s2">:(&quot; </span><span class="s0">+ PORT$ + </span><span class="s2">&quot;)&quot;</span><span class="s0">) + </span><span class="s2">&quot;?)&quot;</span><span class="s0">) + </span><span class="s2">&quot;?(&quot; </span><span class="s0">+ PATH_ABEMPTY$ + </span><span class="s2">&quot;|&quot; </span><span class="s0">+ PATH_ABSOLUTE$ + </span><span class="s2">&quot;|&quot; </span><span class="s0">+ PATH_NOSCHEME$ + </span><span class="s2">&quot;|&quot; </span><span class="s0">+ PATH_EMPTY$ + </span><span class="s2">&quot;)&quot;</span><span class="s0">) + subexp(</span><span class="s2">&quot;</span><span class="s3">\\</span><span class="s2">?(&quot; </span><span class="s0">+ QUERY$ + </span><span class="s2">&quot;)&quot;</span><span class="s0">) + </span><span class="s2">&quot;?&quot; </span><span class="s0">+ subexp(</span><span class="s2">&quot;</span><span class="s3">\\</span><span class="s2">#(&quot; </span><span class="s0">+ FRAGMENT$ + </span><span class="s2">&quot;)&quot;</span><span class="s0">) + </span><span class="s2">&quot;?$&quot;</span><span class="s3">,</span>
        <span class="s0">ABSOLUTE_REF$ = </span><span class="s2">&quot;^(&quot; </span><span class="s0">+ SCHEME$ + </span><span class="s2">&quot;)</span><span class="s3">\\</span><span class="s2">:&quot; </span><span class="s0">+ subexp(subexp(</span><span class="s2">&quot;</span><span class="s3">\\</span><span class="s2">/</span><span class="s3">\\</span><span class="s2">/(&quot; </span><span class="s0">+ subexp(</span><span class="s2">&quot;(&quot; </span><span class="s0">+ USERINFO$ + </span><span class="s2">&quot;)@&quot;</span><span class="s0">) + </span><span class="s2">&quot;?(&quot; </span><span class="s0">+ HOST$ + </span><span class="s2">&quot;)&quot; </span><span class="s0">+ subexp(</span><span class="s2">&quot;</span><span class="s3">\\</span><span class="s2">:(&quot; </span><span class="s0">+ PORT$ + </span><span class="s2">&quot;)&quot;</span><span class="s0">) + </span><span class="s2">&quot;?)&quot;</span><span class="s0">) + </span><span class="s2">&quot;?(&quot; </span><span class="s0">+ PATH_ABEMPTY$ + </span><span class="s2">&quot;|&quot; </span><span class="s0">+ PATH_ABSOLUTE$ + </span><span class="s2">&quot;|&quot; </span><span class="s0">+ PATH_ROOTLESS$ + </span><span class="s2">&quot;|&quot; </span><span class="s0">+ PATH_EMPTY$ + </span><span class="s2">&quot;)&quot;</span><span class="s0">) + subexp(</span><span class="s2">&quot;</span><span class="s3">\\</span><span class="s2">?(&quot; </span><span class="s0">+ QUERY$ + </span><span class="s2">&quot;)&quot;</span><span class="s0">) + </span><span class="s2">&quot;?$&quot;</span><span class="s3">,</span>
        <span class="s0">SAMEDOC_REF$ = </span><span class="s2">&quot;^&quot; </span><span class="s0">+ subexp(</span><span class="s2">&quot;</span><span class="s3">\\</span><span class="s2">#(&quot; </span><span class="s0">+ FRAGMENT$ + </span><span class="s2">&quot;)&quot;</span><span class="s0">) + </span><span class="s2">&quot;?$&quot;</span><span class="s3">,</span>
        <span class="s0">AUTHORITY_REF$ = </span><span class="s2">&quot;^&quot; </span><span class="s0">+ subexp(</span><span class="s2">&quot;(&quot; </span><span class="s0">+ USERINFO$ + </span><span class="s2">&quot;)@&quot;</span><span class="s0">) + </span><span class="s2">&quot;?(&quot; </span><span class="s0">+ HOST$ + </span><span class="s2">&quot;)&quot; </span><span class="s0">+ subexp(</span><span class="s2">&quot;</span><span class="s3">\\</span><span class="s2">:(&quot; </span><span class="s0">+ PORT$ + </span><span class="s2">&quot;)&quot;</span><span class="s0">) + </span><span class="s2">&quot;?$&quot;</span><span class="s3">;</span>
    <span class="s1">return </span><span class="s0">{</span>
        <span class="s0">NOT_SCHEME: </span><span class="s1">new </span><span class="s0">RegExp(merge(</span><span class="s2">&quot;[^]&quot;</span><span class="s3">, </span><span class="s0">ALPHA$$</span><span class="s3">, </span><span class="s0">DIGIT$$</span><span class="s3">, </span><span class="s2">&quot;[</span><span class="s3">\\</span><span class="s2">+</span><span class="s3">\\</span><span class="s2">-</span><span class="s3">\\</span><span class="s2">.]&quot;</span><span class="s0">)</span><span class="s3">, </span><span class="s2">&quot;g&quot;</span><span class="s0">)</span><span class="s3">,</span>
        <span class="s0">NOT_USERINFO: </span><span class="s1">new </span><span class="s0">RegExp(merge(</span><span class="s2">&quot;[^</span><span class="s3">\\</span><span class="s2">%</span><span class="s3">\\</span><span class="s2">:]&quot;</span><span class="s3">, </span><span class="s0">UNRESERVED$$</span><span class="s3">, </span><span class="s0">SUB_DELIMS$$)</span><span class="s3">, </span><span class="s2">&quot;g&quot;</span><span class="s0">)</span><span class="s3">,</span>
        <span class="s0">NOT_HOST: </span><span class="s1">new </span><span class="s0">RegExp(merge(</span><span class="s2">&quot;[^</span><span class="s3">\\</span><span class="s2">%</span><span class="s3">\\</span><span class="s2">[</span><span class="s3">\\</span><span class="s2">]</span><span class="s3">\\</span><span class="s2">:]&quot;</span><span class="s3">, </span><span class="s0">UNRESERVED$$</span><span class="s3">, </span><span class="s0">SUB_DELIMS$$)</span><span class="s3">, </span><span class="s2">&quot;g&quot;</span><span class="s0">)</span><span class="s3">,</span>
        <span class="s0">NOT_PATH: </span><span class="s1">new </span><span class="s0">RegExp(merge(</span><span class="s2">&quot;[^</span><span class="s3">\\</span><span class="s2">%</span><span class="s3">\\</span><span class="s2">/</span><span class="s3">\\</span><span class="s2">:</span><span class="s3">\\</span><span class="s2">@]&quot;</span><span class="s3">, </span><span class="s0">UNRESERVED$$</span><span class="s3">, </span><span class="s0">SUB_DELIMS$$)</span><span class="s3">, </span><span class="s2">&quot;g&quot;</span><span class="s0">)</span><span class="s3">,</span>
        <span class="s0">NOT_PATH_NOSCHEME: </span><span class="s1">new </span><span class="s0">RegExp(merge(</span><span class="s2">&quot;[^</span><span class="s3">\\</span><span class="s2">%</span><span class="s3">\\</span><span class="s2">/</span><span class="s3">\\</span><span class="s2">@]&quot;</span><span class="s3">, </span><span class="s0">UNRESERVED$$</span><span class="s3">, </span><span class="s0">SUB_DELIMS$$)</span><span class="s3">, </span><span class="s2">&quot;g&quot;</span><span class="s0">)</span><span class="s3">,</span>
        <span class="s0">NOT_QUERY: </span><span class="s1">new </span><span class="s0">RegExp(merge(</span><span class="s2">&quot;[^</span><span class="s3">\\</span><span class="s2">%]&quot;</span><span class="s3">, </span><span class="s0">UNRESERVED$$</span><span class="s3">, </span><span class="s0">SUB_DELIMS$$</span><span class="s3">, </span><span class="s2">&quot;[</span><span class="s3">\\</span><span class="s2">:</span><span class="s3">\\</span><span class="s2">@</span><span class="s3">\\</span><span class="s2">/</span><span class="s3">\\</span><span class="s2">?]&quot;</span><span class="s3">, </span><span class="s0">IPRIVATE$$)</span><span class="s3">, </span><span class="s2">&quot;g&quot;</span><span class="s0">)</span><span class="s3">,</span>
        <span class="s0">NOT_FRAGMENT: </span><span class="s1">new </span><span class="s0">RegExp(merge(</span><span class="s2">&quot;[^</span><span class="s3">\\</span><span class="s2">%]&quot;</span><span class="s3">, </span><span class="s0">UNRESERVED$$</span><span class="s3">, </span><span class="s0">SUB_DELIMS$$</span><span class="s3">, </span><span class="s2">&quot;[</span><span class="s3">\\</span><span class="s2">:</span><span class="s3">\\</span><span class="s2">@</span><span class="s3">\\</span><span class="s2">/</span><span class="s3">\\</span><span class="s2">?]&quot;</span><span class="s0">)</span><span class="s3">, </span><span class="s2">&quot;g&quot;</span><span class="s0">)</span><span class="s3">,</span>
        <span class="s0">ESCAPE: </span><span class="s1">new </span><span class="s0">RegExp(merge(</span><span class="s2">&quot;[^]&quot;</span><span class="s3">, </span><span class="s0">UNRESERVED$$</span><span class="s3">, </span><span class="s0">SUB_DELIMS$$)</span><span class="s3">, </span><span class="s2">&quot;g&quot;</span><span class="s0">)</span><span class="s3">,</span>
        <span class="s0">UNRESERVED: </span><span class="s1">new </span><span class="s0">RegExp(UNRESERVED$$</span><span class="s3">, </span><span class="s2">&quot;g&quot;</span><span class="s0">)</span><span class="s3">,</span>
        <span class="s0">OTHER_CHARS: </span><span class="s1">new </span><span class="s0">RegExp(merge(</span><span class="s2">&quot;[^</span><span class="s3">\\</span><span class="s2">%]&quot;</span><span class="s3">, </span><span class="s0">UNRESERVED$$</span><span class="s3">, </span><span class="s0">RESERVED$$)</span><span class="s3">, </span><span class="s2">&quot;g&quot;</span><span class="s0">)</span><span class="s3">,</span>
        <span class="s0">PCT_ENCODED: </span><span class="s1">new </span><span class="s0">RegExp(PCT_ENCODED$</span><span class="s3">, </span><span class="s2">&quot;g&quot;</span><span class="s0">)</span><span class="s3">,</span>
        <span class="s0">IPV4ADDRESS: </span><span class="s1">new </span><span class="s0">RegExp(</span><span class="s2">&quot;^(&quot; </span><span class="s0">+ IPV4ADDRESS$ + </span><span class="s2">&quot;)$&quot;</span><span class="s0">)</span><span class="s3">,</span>
        <span class="s0">IPV6ADDRESS: </span><span class="s1">new </span><span class="s0">RegExp(</span><span class="s2">&quot;^</span><span class="s3">\\</span><span class="s2">[?(&quot; </span><span class="s0">+ IPV6ADDRESS$ + </span><span class="s2">&quot;)&quot; </span><span class="s0">+ subexp(subexp(</span><span class="s2">&quot;</span><span class="s3">\\</span><span class="s2">%25|</span><span class="s3">\\</span><span class="s2">%(?!&quot; </span><span class="s0">+ HEXDIG$$ + </span><span class="s2">&quot;{2})&quot;</span><span class="s0">) + </span><span class="s2">&quot;(&quot; </span><span class="s0">+ ZONEID$ + </span><span class="s2">&quot;)&quot;</span><span class="s0">) + </span><span class="s2">&quot;?</span><span class="s3">\\</span><span class="s2">]?$&quot;</span><span class="s0">) </span><span class="s8">//RFC 6874, with relaxed parsing rules</span>
    <span class="s0">}</span><span class="s3">;</span>
<span class="s0">}</span>
<span class="s1">var </span><span class="s0">URI_PROTOCOL = buildExps(</span><span class="s1">false</span><span class="s0">)</span><span class="s3">;</span>

<span class="s1">var </span><span class="s0">IRI_PROTOCOL = buildExps(</span><span class="s1">true</span><span class="s0">)</span><span class="s3">;</span>

<span class="s1">var </span><span class="s0">slicedToArray = </span><span class="s1">function </span><span class="s0">() {</span>
  <span class="s1">function </span><span class="s0">sliceIterator(arr</span><span class="s3">, </span><span class="s0">i) {</span>
    <span class="s1">var </span><span class="s0">_arr = []</span><span class="s3">;</span>
    <span class="s1">var </span><span class="s0">_n = </span><span class="s1">true</span><span class="s3">;</span>
    <span class="s1">var </span><span class="s0">_d = </span><span class="s1">false</span><span class="s3">;</span>
    <span class="s1">var </span><span class="s0">_e = undefined</span><span class="s3">;</span>

    <span class="s1">try </span><span class="s0">{</span>
      <span class="s1">for </span><span class="s0">(</span><span class="s1">var </span><span class="s0">_i = arr[Symbol.iterator]()</span><span class="s3">, </span><span class="s0">_s</span><span class="s3">; </span><span class="s0">!(_n = (_s = _i.next()).done)</span><span class="s3">; </span><span class="s0">_n = </span><span class="s1">true</span><span class="s0">) {</span>
        <span class="s0">_arr.push(_s.value)</span><span class="s3">;</span>

        <span class="s1">if </span><span class="s0">(i &amp;&amp; _arr.length === i) </span><span class="s1">break</span><span class="s3">;</span>
      <span class="s0">}</span>
    <span class="s0">} </span><span class="s1">catch </span><span class="s0">(err) {</span>
      <span class="s0">_d = </span><span class="s1">true</span><span class="s3">;</span>
      <span class="s0">_e = err</span><span class="s3">;</span>
    <span class="s0">} </span><span class="s1">finally </span><span class="s0">{</span>
      <span class="s1">try </span><span class="s0">{</span>
        <span class="s1">if </span><span class="s0">(!_n &amp;&amp; _i[</span><span class="s2">&quot;return&quot;</span><span class="s0">]) _i[</span><span class="s2">&quot;return&quot;</span><span class="s0">]()</span><span class="s3">;</span>
      <span class="s0">} </span><span class="s1">finally </span><span class="s0">{</span>
        <span class="s1">if </span><span class="s0">(_d) </span><span class="s1">throw </span><span class="s0">_e</span><span class="s3">;</span>
      <span class="s0">}</span>
    <span class="s0">}</span>

    <span class="s1">return </span><span class="s0">_arr</span><span class="s3">;</span>
  <span class="s0">}</span>

  <span class="s1">return function </span><span class="s0">(arr</span><span class="s3">, </span><span class="s0">i) {</span>
    <span class="s1">if </span><span class="s0">(Array.isArray(arr)) {</span>
      <span class="s1">return </span><span class="s0">arr</span><span class="s3">;</span>
    <span class="s0">} </span><span class="s1">else if </span><span class="s0">(Symbol.iterator </span><span class="s1">in </span><span class="s0">Object(arr)) {</span>
      <span class="s1">return </span><span class="s0">sliceIterator(arr</span><span class="s3">, </span><span class="s0">i)</span><span class="s3">;</span>
    <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
      <span class="s1">throw new </span><span class="s0">TypeError(</span><span class="s2">&quot;Invalid attempt to destructure non-iterable instance&quot;</span><span class="s0">)</span><span class="s3">;</span>
    <span class="s0">}</span>
  <span class="s0">}</span><span class="s3">;</span>
<span class="s0">}()</span><span class="s3">;</span>













<span class="s1">var </span><span class="s0">toConsumableArray = </span><span class="s1">function </span><span class="s0">(arr) {</span>
  <span class="s1">if </span><span class="s0">(Array.isArray(arr)) {</span>
    <span class="s1">for </span><span class="s0">(</span><span class="s1">var </span><span class="s0">i = </span><span class="s4">0</span><span class="s3">, </span><span class="s0">arr2 = Array(arr.length)</span><span class="s3">; </span><span class="s0">i &lt; arr.length</span><span class="s3">; </span><span class="s0">i++) arr2[i] = arr[i]</span><span class="s3">;</span>

    <span class="s1">return </span><span class="s0">arr2</span><span class="s3">;</span>
  <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
    <span class="s1">return </span><span class="s0">Array.from(arr)</span><span class="s3">;</span>
  <span class="s0">}</span>
<span class="s0">}</span><span class="s3">;</span>

<span class="s5">/** Highest positive signed 32-bit float value */</span>

<span class="s1">var </span><span class="s0">maxInt = </span><span class="s4">2147483647</span><span class="s3">; </span><span class="s8">// aka. 0x7FFFFFFF or 2^31-1</span>

<span class="s5">/** Bootstring parameters */</span>
<span class="s1">var </span><span class="s0">base = </span><span class="s4">36</span><span class="s3">;</span>
<span class="s1">var </span><span class="s0">tMin = </span><span class="s4">1</span><span class="s3">;</span>
<span class="s1">var </span><span class="s0">tMax = </span><span class="s4">26</span><span class="s3">;</span>
<span class="s1">var </span><span class="s0">skew = </span><span class="s4">38</span><span class="s3">;</span>
<span class="s1">var </span><span class="s0">damp = </span><span class="s4">700</span><span class="s3">;</span>
<span class="s1">var </span><span class="s0">initialBias = </span><span class="s4">72</span><span class="s3">;</span>
<span class="s1">var </span><span class="s0">initialN = </span><span class="s4">128</span><span class="s3">; </span><span class="s8">// 0x80</span>
<span class="s1">var </span><span class="s0">delimiter = </span><span class="s2">'-'</span><span class="s3">; </span><span class="s8">// '\x2D'</span>

<span class="s5">/** Regular expressions */</span>
<span class="s1">var </span><span class="s0">regexPunycode = </span><span class="s4">/^xn--/</span><span class="s3">;</span>
<span class="s1">var </span><span class="s0">regexNonASCII = </span><span class="s4">/[^\0-\x7E]/</span><span class="s3">; </span><span class="s8">// non-ASCII chars</span>
<span class="s1">var </span><span class="s0">regexSeparators = </span><span class="s4">/[\x2E\u3002\uFF0E\uFF61]/g</span><span class="s3">; </span><span class="s8">// RFC 3490 separators</span>

<span class="s5">/** Error messages */</span>
<span class="s1">var </span><span class="s0">errors = {</span>
	<span class="s2">'overflow'</span><span class="s0">: </span><span class="s2">'Overflow: input needs wider integers to process'</span><span class="s3">,</span>
	<span class="s2">'not-basic'</span><span class="s0">: </span><span class="s2">'Illegal input &gt;= 0x80 (not a basic code point)'</span><span class="s3">,</span>
	<span class="s2">'invalid-input'</span><span class="s0">: </span><span class="s2">'Invalid input'</span>
<span class="s0">}</span><span class="s3">;</span>

<span class="s5">/** Convenience shortcuts */</span>
<span class="s1">var </span><span class="s0">baseMinusTMin = base - tMin</span><span class="s3">;</span>
<span class="s1">var </span><span class="s0">floor = Math.floor</span><span class="s3">;</span>
<span class="s1">var </span><span class="s0">stringFromCharCode = String.fromCharCode</span><span class="s3">;</span>

<span class="s7">/*--------------------------------------------------------------------------*/</span>

<span class="s5">/**</span>
 <span class="s5">* A generic error utility function.</span>
 <span class="s5">* </span><span class="s6">@private</span>
 <span class="s5">* </span><span class="s6">@param </span><span class="s5">{String} type The error type.</span>
 <span class="s5">* </span><span class="s6">@returns </span><span class="s5">{Error} Throws a `RangeError` with the applicable error message.</span>
 <span class="s5">*/</span>
<span class="s1">function </span><span class="s0">error$1(type) {</span>
	<span class="s1">throw new </span><span class="s0">RangeError(errors[type])</span><span class="s3">;</span>
<span class="s0">}</span>

<span class="s5">/**</span>
 <span class="s5">* A generic `Array#map` utility function.</span>
 <span class="s5">* </span><span class="s6">@private</span>
 <span class="s5">* </span><span class="s6">@param </span><span class="s5">{Array} array The array to iterate over.</span>
 <span class="s5">* </span><span class="s6">@param </span><span class="s5">{Function} callback The function that gets called for every array</span>
 <span class="s5">* item.</span>
 <span class="s5">* </span><span class="s6">@returns </span><span class="s5">{Array} A new array of values returned by the callback function.</span>
 <span class="s5">*/</span>
<span class="s1">function </span><span class="s0">map(array</span><span class="s3">, </span><span class="s0">fn) {</span>
	<span class="s1">var </span><span class="s0">result = []</span><span class="s3">;</span>
	<span class="s1">var </span><span class="s0">length = array.length</span><span class="s3">;</span>
	<span class="s1">while </span><span class="s0">(length--) {</span>
		<span class="s0">result[length] = fn(array[length])</span><span class="s3">;</span>
	<span class="s0">}</span>
	<span class="s1">return </span><span class="s0">result</span><span class="s3">;</span>
<span class="s0">}</span>

<span class="s5">/**</span>
 <span class="s5">* A simple `Array#map`-like wrapper to work with domain name strings or email</span>
 <span class="s5">* addresses.</span>
 <span class="s5">* </span><span class="s6">@private</span>
 <span class="s5">* </span><span class="s6">@param </span><span class="s5">{String} domain The domain name or email address.</span>
 <span class="s5">* </span><span class="s6">@param </span><span class="s5">{Function} callback The function that gets called for every</span>
 <span class="s5">* character.</span>
 <span class="s5">* </span><span class="s6">@returns </span><span class="s5">{Array} A new string of characters returned by the callback</span>
 <span class="s5">* function.</span>
 <span class="s5">*/</span>
<span class="s1">function </span><span class="s0">mapDomain(string</span><span class="s3">, </span><span class="s0">fn) {</span>
	<span class="s1">var </span><span class="s0">parts = string.split(</span><span class="s2">'@'</span><span class="s0">)</span><span class="s3">;</span>
	<span class="s1">var </span><span class="s0">result = </span><span class="s2">''</span><span class="s3">;</span>
	<span class="s1">if </span><span class="s0">(parts.length &gt; </span><span class="s4">1</span><span class="s0">) {</span>
		<span class="s8">// In email addresses, only the domain name should be punycoded. Leave</span>
		<span class="s8">// the local part (i.e. everything up to `@`) intact.</span>
		<span class="s0">result = parts[</span><span class="s4">0</span><span class="s0">] + </span><span class="s2">'@'</span><span class="s3">;</span>
		<span class="s0">string = parts[</span><span class="s4">1</span><span class="s0">]</span><span class="s3">;</span>
	<span class="s0">}</span>
	<span class="s8">// Avoid `split(regex)` for IE8 compatibility. See #17.</span>
	<span class="s0">string = string.replace(regexSeparators</span><span class="s3">, </span><span class="s2">'</span><span class="s3">\x2E</span><span class="s2">'</span><span class="s0">)</span><span class="s3">;</span>
	<span class="s1">var </span><span class="s0">labels = string.split(</span><span class="s2">'.'</span><span class="s0">)</span><span class="s3">;</span>
	<span class="s1">var </span><span class="s0">encoded = map(labels</span><span class="s3">, </span><span class="s0">fn).join(</span><span class="s2">'.'</span><span class="s0">)</span><span class="s3">;</span>
	<span class="s1">return </span><span class="s0">result + encoded</span><span class="s3">;</span>
<span class="s0">}</span>

<span class="s5">/**</span>
 <span class="s5">* Creates an array containing the numeric code points of each Unicode</span>
 <span class="s5">* character in the string. While JavaScript uses UCS-2 internally,</span>
 <span class="s5">* this function will convert a pair of surrogate halves (each of which</span>
 <span class="s5">* UCS-2 exposes as separate characters) into a single code point,</span>
 <span class="s5">* matching UTF-16.</span>
 <span class="s5">* </span><span class="s6">@see </span><span class="s5">`punycode.ucs2.encode`</span>
 <span class="s5">* </span><span class="s6">@see </span><span class="s5">&lt;https://mathiasbynens.be/notes/javascript-encoding&gt;</span>
 <span class="s5">* </span><span class="s6">@memberOf </span><span class="s5">punycode.ucs2</span>
 <span class="s5">* </span><span class="s6">@name </span><span class="s5">decode</span>
 <span class="s5">* </span><span class="s6">@param </span><span class="s5">{String} string The Unicode input string (UCS-2).</span>
 <span class="s5">* </span><span class="s6">@returns </span><span class="s5">{Array} The new array of code points.</span>
 <span class="s5">*/</span>
<span class="s1">function </span><span class="s0">ucs2decode(string) {</span>
	<span class="s1">var </span><span class="s0">output = []</span><span class="s3">;</span>
	<span class="s1">var </span><span class="s0">counter = </span><span class="s4">0</span><span class="s3">;</span>
	<span class="s1">var </span><span class="s0">length = string.length</span><span class="s3">;</span>
	<span class="s1">while </span><span class="s0">(counter &lt; length) {</span>
		<span class="s1">var </span><span class="s0">value = string.charCodeAt(counter++)</span><span class="s3">;</span>
		<span class="s1">if </span><span class="s0">(value &gt;= </span><span class="s4">0xD800 </span><span class="s0">&amp;&amp; value &lt;= </span><span class="s4">0xDBFF </span><span class="s0">&amp;&amp; counter &lt; length) {</span>
			<span class="s8">// It's a high surrogate, and there is a next character.</span>
			<span class="s1">var </span><span class="s0">extra = string.charCodeAt(counter++)</span><span class="s3">;</span>
			<span class="s1">if </span><span class="s0">((extra &amp; </span><span class="s4">0xFC00</span><span class="s0">) == </span><span class="s4">0xDC00</span><span class="s0">) {</span>
				<span class="s8">// Low surrogate.</span>
				<span class="s0">output.push(((value &amp; </span><span class="s4">0x3FF</span><span class="s0">) &lt;&lt; </span><span class="s4">10</span><span class="s0">) + (extra &amp; </span><span class="s4">0x3FF</span><span class="s0">) + </span><span class="s4">0x10000</span><span class="s0">)</span><span class="s3">;</span>
			<span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
				<span class="s8">// It's an unmatched surrogate; only append this code unit, in case the</span>
				<span class="s8">// next code unit is the high surrogate of a surrogate pair.</span>
				<span class="s0">output.push(value)</span><span class="s3">;</span>
				<span class="s0">counter--</span><span class="s3">;</span>
			<span class="s0">}</span>
		<span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
			<span class="s0">output.push(value)</span><span class="s3">;</span>
		<span class="s0">}</span>
	<span class="s0">}</span>
	<span class="s1">return </span><span class="s0">output</span><span class="s3">;</span>
<span class="s0">}</span>

<span class="s5">/**</span>
 <span class="s5">* Creates a string based on an array of numeric code points.</span>
 <span class="s5">* </span><span class="s6">@see </span><span class="s5">`punycode.ucs2.decode`</span>
 <span class="s5">* </span><span class="s6">@memberOf </span><span class="s5">punycode.ucs2</span>
 <span class="s5">* </span><span class="s6">@name </span><span class="s5">encode</span>
 <span class="s5">* </span><span class="s6">@param </span><span class="s5">{Array} codePoints The array of numeric code points.</span>
 <span class="s5">* </span><span class="s6">@returns </span><span class="s5">{String} The new Unicode string (UCS-2).</span>
 <span class="s5">*/</span>
<span class="s1">var </span><span class="s0">ucs2encode = </span><span class="s1">function </span><span class="s0">ucs2encode(array) {</span>
	<span class="s1">return </span><span class="s0">String.fromCodePoint.apply(String</span><span class="s3">, </span><span class="s0">toConsumableArray(array))</span><span class="s3">;</span>
<span class="s0">}</span><span class="s3">;</span>

<span class="s5">/**</span>
 <span class="s5">* Converts a basic code point into a digit/integer.</span>
 <span class="s5">* </span><span class="s6">@see </span><span class="s5">`digitToBasic()`</span>
 <span class="s5">* </span><span class="s6">@private</span>
 <span class="s5">* </span><span class="s6">@param </span><span class="s5">{Number} codePoint The basic numeric code point value.</span>
 <span class="s5">* </span><span class="s6">@returns </span><span class="s5">{Number} The numeric value of a basic code point (for use in</span>
 <span class="s5">* representing integers) in the range `0` to `base - 1`, or `base` if</span>
 <span class="s5">* the code point does not represent a value.</span>
 <span class="s5">*/</span>
<span class="s1">var </span><span class="s0">basicToDigit = </span><span class="s1">function </span><span class="s0">basicToDigit(codePoint) {</span>
	<span class="s1">if </span><span class="s0">(codePoint - </span><span class="s4">0x30 </span><span class="s0">&lt; </span><span class="s4">0x0A</span><span class="s0">) {</span>
		<span class="s1">return </span><span class="s0">codePoint - </span><span class="s4">0x16</span><span class="s3">;</span>
	<span class="s0">}</span>
	<span class="s1">if </span><span class="s0">(codePoint - </span><span class="s4">0x41 </span><span class="s0">&lt; </span><span class="s4">0x1A</span><span class="s0">) {</span>
		<span class="s1">return </span><span class="s0">codePoint - </span><span class="s4">0x41</span><span class="s3">;</span>
	<span class="s0">}</span>
	<span class="s1">if </span><span class="s0">(codePoint - </span><span class="s4">0x61 </span><span class="s0">&lt; </span><span class="s4">0x1A</span><span class="s0">) {</span>
		<span class="s1">return </span><span class="s0">codePoint - </span><span class="s4">0x61</span><span class="s3">;</span>
	<span class="s0">}</span>
	<span class="s1">return </span><span class="s0">base</span><span class="s3">;</span>
<span class="s0">}</span><span class="s3">;</span>

<span class="s5">/**</span>
 <span class="s5">* Converts a digit/integer into a basic code point.</span>
 <span class="s5">* </span><span class="s6">@see </span><span class="s5">`basicToDigit()`</span>
 <span class="s5">* </span><span class="s6">@private</span>
 <span class="s5">* </span><span class="s6">@param </span><span class="s5">{Number} digit The numeric value of a basic code point.</span>
 <span class="s5">* </span><span class="s6">@returns </span><span class="s5">{Number} The basic code point whose value (when used for</span>
 <span class="s5">* representing integers) is `digit`, which needs to be in the range</span>
 <span class="s5">* `0` to `base - 1`. If `flag` is non-zero, the uppercase form is</span>
 <span class="s5">* used; else, the lowercase form is used. The behavior is undefined</span>
 <span class="s5">* if `flag` is non-zero and `digit` has no uppercase form.</span>
 <span class="s5">*/</span>
<span class="s1">var </span><span class="s0">digitToBasic = </span><span class="s1">function </span><span class="s0">digitToBasic(digit</span><span class="s3">, </span><span class="s0">flag) {</span>
	<span class="s8">//  0..25 map to ASCII a..z or A..Z</span>
	<span class="s8">// 26..35 map to ASCII 0..9</span>
	<span class="s1">return </span><span class="s0">digit + </span><span class="s4">22 </span><span class="s0">+ </span><span class="s4">75 </span><span class="s0">* (digit &lt; </span><span class="s4">26</span><span class="s0">) - ((flag != </span><span class="s4">0</span><span class="s0">) &lt;&lt; </span><span class="s4">5</span><span class="s0">)</span><span class="s3">;</span>
<span class="s0">}</span><span class="s3">;</span>

<span class="s5">/**</span>
 <span class="s5">* Bias adaptation function as per section 3.4 of RFC 3492.</span>
 <span class="s5">* https://tools.ietf.org/html/rfc3492#section-3.4</span>
 <span class="s5">* </span><span class="s6">@private</span>
 <span class="s5">*/</span>
<span class="s1">var </span><span class="s0">adapt = </span><span class="s1">function </span><span class="s0">adapt(delta</span><span class="s3">, </span><span class="s0">numPoints</span><span class="s3">, </span><span class="s0">firstTime) {</span>
	<span class="s1">var </span><span class="s0">k = </span><span class="s4">0</span><span class="s3">;</span>
	<span class="s0">delta = firstTime ? floor(delta / damp) : delta &gt;&gt; </span><span class="s4">1</span><span class="s3">;</span>
	<span class="s0">delta += floor(delta / numPoints)</span><span class="s3">;</span>
	<span class="s1">for </span><span class="s0">(</span><span class="s3">; </span><span class="s7">/* no initialization */</span><span class="s0">delta &gt; baseMinusTMin * tMax &gt;&gt; </span><span class="s4">1</span><span class="s3">; </span><span class="s0">k += base) {</span>
		<span class="s0">delta = floor(delta / baseMinusTMin)</span><span class="s3">;</span>
	<span class="s0">}</span>
	<span class="s1">return </span><span class="s0">floor(k + (baseMinusTMin + </span><span class="s4">1</span><span class="s0">) * delta / (delta + skew))</span><span class="s3">;</span>
<span class="s0">}</span><span class="s3">;</span>

<span class="s5">/**</span>
 <span class="s5">* Converts a Punycode string of ASCII-only symbols to a string of Unicode</span>
 <span class="s5">* symbols.</span>
 <span class="s5">* </span><span class="s6">@memberOf </span><span class="s5">punycode</span>
 <span class="s5">* </span><span class="s6">@param </span><span class="s5">{String} input The Punycode string of ASCII-only symbols.</span>
 <span class="s5">* </span><span class="s6">@returns </span><span class="s5">{String} The resulting string of Unicode symbols.</span>
 <span class="s5">*/</span>
<span class="s1">var </span><span class="s0">decode = </span><span class="s1">function </span><span class="s0">decode(input) {</span>
	<span class="s8">// Don't use UCS-2.</span>
	<span class="s1">var </span><span class="s0">output = []</span><span class="s3">;</span>
	<span class="s1">var </span><span class="s0">inputLength = input.length</span><span class="s3">;</span>
	<span class="s1">var </span><span class="s0">i = </span><span class="s4">0</span><span class="s3">;</span>
	<span class="s1">var </span><span class="s0">n = initialN</span><span class="s3">;</span>
	<span class="s1">var </span><span class="s0">bias = initialBias</span><span class="s3">;</span>

	<span class="s8">// Handle the basic code points: let `basic` be the number of input code</span>
	<span class="s8">// points before the last delimiter, or `0` if there is none, then copy</span>
	<span class="s8">// the first basic code points to the output.</span>

	<span class="s1">var </span><span class="s0">basic = input.lastIndexOf(delimiter)</span><span class="s3">;</span>
	<span class="s1">if </span><span class="s0">(basic &lt; </span><span class="s4">0</span><span class="s0">) {</span>
		<span class="s0">basic = </span><span class="s4">0</span><span class="s3">;</span>
	<span class="s0">}</span>

	<span class="s1">for </span><span class="s0">(</span><span class="s1">var </span><span class="s0">j = </span><span class="s4">0</span><span class="s3">; </span><span class="s0">j &lt; basic</span><span class="s3">; </span><span class="s0">++j) {</span>
		<span class="s8">// if it's not a basic code point</span>
		<span class="s1">if </span><span class="s0">(input.charCodeAt(j) &gt;= </span><span class="s4">0x80</span><span class="s0">) {</span>
			<span class="s0">error$1(</span><span class="s2">'not-basic'</span><span class="s0">)</span><span class="s3">;</span>
		<span class="s0">}</span>
		<span class="s0">output.push(input.charCodeAt(j))</span><span class="s3">;</span>
	<span class="s0">}</span>

	<span class="s8">// Main decoding loop: start just after the last delimiter if any basic code</span>
	<span class="s8">// points were copied; start at the beginning otherwise.</span>

	<span class="s1">for </span><span class="s0">(</span><span class="s1">var </span><span class="s0">index = basic &gt; </span><span class="s4">0 </span><span class="s0">? basic + </span><span class="s4">1 </span><span class="s0">: </span><span class="s4">0</span><span class="s3">; </span><span class="s0">index &lt; inputLength</span><span class="s3">;</span><span class="s0">) </span><span class="s7">/* no final expression */</span><span class="s0">{</span>

		<span class="s8">// `index` is the index of the next character to be consumed.</span>
		<span class="s8">// Decode a generalized variable-length integer into `delta`,</span>
		<span class="s8">// which gets added to `i`. The overflow checking is easier</span>
		<span class="s8">// if we increase `i` as we go, then subtract off its starting</span>
		<span class="s8">// value at the end to obtain `delta`.</span>
		<span class="s1">var </span><span class="s0">oldi = i</span><span class="s3">;</span>
		<span class="s1">for </span><span class="s0">(</span><span class="s1">var </span><span class="s0">w = </span><span class="s4">1</span><span class="s3">, </span><span class="s0">k = base</span><span class="s3">;; </span><span class="s7">/* no condition */</span><span class="s0">k += base) {</span>

			<span class="s1">if </span><span class="s0">(index &gt;= inputLength) {</span>
				<span class="s0">error$1(</span><span class="s2">'invalid-input'</span><span class="s0">)</span><span class="s3">;</span>
			<span class="s0">}</span>

			<span class="s1">var </span><span class="s0">digit = basicToDigit(input.charCodeAt(index++))</span><span class="s3">;</span>

			<span class="s1">if </span><span class="s0">(digit &gt;= base || digit &gt; floor((maxInt - i) / w)) {</span>
				<span class="s0">error$1(</span><span class="s2">'overflow'</span><span class="s0">)</span><span class="s3">;</span>
			<span class="s0">}</span>

			<span class="s0">i += digit * w</span><span class="s3">;</span>
			<span class="s1">var </span><span class="s0">t = k &lt;= bias ? tMin : k &gt;= bias + tMax ? tMax : k - bias</span><span class="s3">;</span>

			<span class="s1">if </span><span class="s0">(digit &lt; t) {</span>
				<span class="s1">break</span><span class="s3">;</span>
			<span class="s0">}</span>

			<span class="s1">var </span><span class="s0">baseMinusT = base - t</span><span class="s3">;</span>
			<span class="s1">if </span><span class="s0">(w &gt; floor(maxInt / baseMinusT)) {</span>
				<span class="s0">error$1(</span><span class="s2">'overflow'</span><span class="s0">)</span><span class="s3">;</span>
			<span class="s0">}</span>

			<span class="s0">w *= baseMinusT</span><span class="s3">;</span>
		<span class="s0">}</span>

		<span class="s1">var </span><span class="s0">out = output.length + </span><span class="s4">1</span><span class="s3">;</span>
		<span class="s0">bias = adapt(i - oldi</span><span class="s3">, </span><span class="s0">out</span><span class="s3">, </span><span class="s0">oldi == </span><span class="s4">0</span><span class="s0">)</span><span class="s3">;</span>

		<span class="s8">// `i` was supposed to wrap around from `out` to `0`,</span>
		<span class="s8">// incrementing `n` each time, so we'll fix that now:</span>
		<span class="s1">if </span><span class="s0">(floor(i / out) &gt; maxInt - n) {</span>
			<span class="s0">error$1(</span><span class="s2">'overflow'</span><span class="s0">)</span><span class="s3">;</span>
		<span class="s0">}</span>

		<span class="s0">n += floor(i / out)</span><span class="s3">;</span>
		<span class="s0">i %= out</span><span class="s3">;</span>

		<span class="s8">// Insert `n` at position `i` of the output.</span>
		<span class="s0">output.splice(i++</span><span class="s3">, </span><span class="s4">0</span><span class="s3">, </span><span class="s0">n)</span><span class="s3">;</span>
	<span class="s0">}</span>

	<span class="s1">return </span><span class="s0">String.fromCodePoint.apply(String</span><span class="s3">, </span><span class="s0">output)</span><span class="s3">;</span>
<span class="s0">}</span><span class="s3">;</span>

<span class="s5">/**</span>
 <span class="s5">* Converts a string of Unicode symbols (e.g. a domain name label) to a</span>
 <span class="s5">* Punycode string of ASCII-only symbols.</span>
 <span class="s5">* </span><span class="s6">@memberOf </span><span class="s5">punycode</span>
 <span class="s5">* </span><span class="s6">@param </span><span class="s5">{String} input The string of Unicode symbols.</span>
 <span class="s5">* </span><span class="s6">@returns </span><span class="s5">{String} The resulting Punycode string of ASCII-only symbols.</span>
 <span class="s5">*/</span>
<span class="s1">var </span><span class="s0">encode = </span><span class="s1">function </span><span class="s0">encode(input) {</span>
	<span class="s1">var </span><span class="s0">output = []</span><span class="s3">;</span>

	<span class="s8">// Convert the input in UCS-2 to an array of Unicode code points.</span>
	<span class="s0">input = ucs2decode(input)</span><span class="s3">;</span>

	<span class="s8">// Cache the length.</span>
	<span class="s1">var </span><span class="s0">inputLength = input.length</span><span class="s3">;</span>

	<span class="s8">// Initialize the state.</span>
	<span class="s1">var </span><span class="s0">n = initialN</span><span class="s3">;</span>
	<span class="s1">var </span><span class="s0">delta = </span><span class="s4">0</span><span class="s3">;</span>
	<span class="s1">var </span><span class="s0">bias = initialBias</span><span class="s3">;</span>

	<span class="s8">// Handle the basic code points.</span>
	<span class="s1">var </span><span class="s0">_iteratorNormalCompletion = </span><span class="s1">true</span><span class="s3">;</span>
	<span class="s1">var </span><span class="s0">_didIteratorError = </span><span class="s1">false</span><span class="s3">;</span>
	<span class="s1">var </span><span class="s0">_iteratorError = undefined</span><span class="s3">;</span>

	<span class="s1">try </span><span class="s0">{</span>
		<span class="s1">for </span><span class="s0">(</span><span class="s1">var </span><span class="s0">_iterator = input[Symbol.iterator]()</span><span class="s3">, </span><span class="s0">_step</span><span class="s3">; </span><span class="s0">!(_iteratorNormalCompletion = (_step = _iterator.next()).done)</span><span class="s3">; </span><span class="s0">_iteratorNormalCompletion = </span><span class="s1">true</span><span class="s0">) {</span>
			<span class="s1">var </span><span class="s0">_currentValue2 = _step.value</span><span class="s3">;</span>

			<span class="s1">if </span><span class="s0">(_currentValue2 &lt; </span><span class="s4">0x80</span><span class="s0">) {</span>
				<span class="s0">output.push(stringFromCharCode(_currentValue2))</span><span class="s3">;</span>
			<span class="s0">}</span>
		<span class="s0">}</span>
	<span class="s0">} </span><span class="s1">catch </span><span class="s0">(err) {</span>
		<span class="s0">_didIteratorError = </span><span class="s1">true</span><span class="s3">;</span>
		<span class="s0">_iteratorError = err</span><span class="s3">;</span>
	<span class="s0">} </span><span class="s1">finally </span><span class="s0">{</span>
		<span class="s1">try </span><span class="s0">{</span>
			<span class="s1">if </span><span class="s0">(!_iteratorNormalCompletion &amp;&amp; _iterator.return) {</span>
				<span class="s0">_iterator.return()</span><span class="s3">;</span>
			<span class="s0">}</span>
		<span class="s0">} </span><span class="s1">finally </span><span class="s0">{</span>
			<span class="s1">if </span><span class="s0">(_didIteratorError) {</span>
				<span class="s1">throw </span><span class="s0">_iteratorError</span><span class="s3">;</span>
			<span class="s0">}</span>
		<span class="s0">}</span>
	<span class="s0">}</span>

	<span class="s1">var </span><span class="s0">basicLength = output.length</span><span class="s3">;</span>
	<span class="s1">var </span><span class="s0">handledCPCount = basicLength</span><span class="s3">;</span>

	<span class="s8">// `handledCPCount` is the number of code points that have been handled;</span>
	<span class="s8">// `basicLength` is the number of basic code points.</span>

	<span class="s8">// Finish the basic string with a delimiter unless it's empty.</span>
	<span class="s1">if </span><span class="s0">(basicLength) {</span>
		<span class="s0">output.push(delimiter)</span><span class="s3">;</span>
	<span class="s0">}</span>

	<span class="s8">// Main encoding loop:</span>
	<span class="s1">while </span><span class="s0">(handledCPCount &lt; inputLength) {</span>

		<span class="s8">// All non-basic code points &lt; n have been handled already. Find the next</span>
		<span class="s8">// larger one:</span>
		<span class="s1">var </span><span class="s0">m = maxInt</span><span class="s3">;</span>
		<span class="s1">var </span><span class="s0">_iteratorNormalCompletion2 = </span><span class="s1">true</span><span class="s3">;</span>
		<span class="s1">var </span><span class="s0">_didIteratorError2 = </span><span class="s1">false</span><span class="s3">;</span>
		<span class="s1">var </span><span class="s0">_iteratorError2 = undefined</span><span class="s3">;</span>

		<span class="s1">try </span><span class="s0">{</span>
			<span class="s1">for </span><span class="s0">(</span><span class="s1">var </span><span class="s0">_iterator2 = input[Symbol.iterator]()</span><span class="s3">, </span><span class="s0">_step2</span><span class="s3">; </span><span class="s0">!(_iteratorNormalCompletion2 = (_step2 = _iterator2.next()).done)</span><span class="s3">; </span><span class="s0">_iteratorNormalCompletion2 = </span><span class="s1">true</span><span class="s0">) {</span>
				<span class="s1">var </span><span class="s0">currentValue = _step2.value</span><span class="s3">;</span>

				<span class="s1">if </span><span class="s0">(currentValue &gt;= n &amp;&amp; currentValue &lt; m) {</span>
					<span class="s0">m = currentValue</span><span class="s3">;</span>
				<span class="s0">}</span>
			<span class="s0">}</span>

			<span class="s8">// Increase `delta` enough to advance the decoder's &lt;n,i&gt; state to &lt;m,0&gt;,</span>
			<span class="s8">// but guard against overflow.</span>
		<span class="s0">} </span><span class="s1">catch </span><span class="s0">(err) {</span>
			<span class="s0">_didIteratorError2 = </span><span class="s1">true</span><span class="s3">;</span>
			<span class="s0">_iteratorError2 = err</span><span class="s3">;</span>
		<span class="s0">} </span><span class="s1">finally </span><span class="s0">{</span>
			<span class="s1">try </span><span class="s0">{</span>
				<span class="s1">if </span><span class="s0">(!_iteratorNormalCompletion2 &amp;&amp; _iterator2.return) {</span>
					<span class="s0">_iterator2.return()</span><span class="s3">;</span>
				<span class="s0">}</span>
			<span class="s0">} </span><span class="s1">finally </span><span class="s0">{</span>
				<span class="s1">if </span><span class="s0">(_didIteratorError2) {</span>
					<span class="s1">throw </span><span class="s0">_iteratorError2</span><span class="s3">;</span>
				<span class="s0">}</span>
			<span class="s0">}</span>
		<span class="s0">}</span>

		<span class="s1">var </span><span class="s0">handledCPCountPlusOne = handledCPCount + </span><span class="s4">1</span><span class="s3">;</span>
		<span class="s1">if </span><span class="s0">(m - n &gt; floor((maxInt - delta) / handledCPCountPlusOne)) {</span>
			<span class="s0">error$1(</span><span class="s2">'overflow'</span><span class="s0">)</span><span class="s3">;</span>
		<span class="s0">}</span>

		<span class="s0">delta += (m - n) * handledCPCountPlusOne</span><span class="s3">;</span>
		<span class="s0">n = m</span><span class="s3">;</span>

		<span class="s1">var </span><span class="s0">_iteratorNormalCompletion3 = </span><span class="s1">true</span><span class="s3">;</span>
		<span class="s1">var </span><span class="s0">_didIteratorError3 = </span><span class="s1">false</span><span class="s3">;</span>
		<span class="s1">var </span><span class="s0">_iteratorError3 = undefined</span><span class="s3">;</span>

		<span class="s1">try </span><span class="s0">{</span>
			<span class="s1">for </span><span class="s0">(</span><span class="s1">var </span><span class="s0">_iterator3 = input[Symbol.iterator]()</span><span class="s3">, </span><span class="s0">_step3</span><span class="s3">; </span><span class="s0">!(_iteratorNormalCompletion3 = (_step3 = _iterator3.next()).done)</span><span class="s3">; </span><span class="s0">_iteratorNormalCompletion3 = </span><span class="s1">true</span><span class="s0">) {</span>
				<span class="s1">var </span><span class="s0">_currentValue = _step3.value</span><span class="s3">;</span>

				<span class="s1">if </span><span class="s0">(_currentValue &lt; n &amp;&amp; ++delta &gt; maxInt) {</span>
					<span class="s0">error$1(</span><span class="s2">'overflow'</span><span class="s0">)</span><span class="s3">;</span>
				<span class="s0">}</span>
				<span class="s1">if </span><span class="s0">(_currentValue == n) {</span>
					<span class="s8">// Represent delta as a generalized variable-length integer.</span>
					<span class="s1">var </span><span class="s0">q = delta</span><span class="s3">;</span>
					<span class="s1">for </span><span class="s0">(</span><span class="s1">var </span><span class="s0">k = base</span><span class="s3">;; </span><span class="s7">/* no condition */</span><span class="s0">k += base) {</span>
						<span class="s1">var </span><span class="s0">t = k &lt;= bias ? tMin : k &gt;= bias + tMax ? tMax : k - bias</span><span class="s3">;</span>
						<span class="s1">if </span><span class="s0">(q &lt; t) {</span>
							<span class="s1">break</span><span class="s3">;</span>
						<span class="s0">}</span>
						<span class="s1">var </span><span class="s0">qMinusT = q - t</span><span class="s3">;</span>
						<span class="s1">var </span><span class="s0">baseMinusT = base - t</span><span class="s3">;</span>
						<span class="s0">output.push(stringFromCharCode(digitToBasic(t + qMinusT % baseMinusT</span><span class="s3">, </span><span class="s4">0</span><span class="s0">)))</span><span class="s3">;</span>
						<span class="s0">q = floor(qMinusT / baseMinusT)</span><span class="s3">;</span>
					<span class="s0">}</span>

					<span class="s0">output.push(stringFromCharCode(digitToBasic(q</span><span class="s3">, </span><span class="s4">0</span><span class="s0">)))</span><span class="s3">;</span>
					<span class="s0">bias = adapt(delta</span><span class="s3">, </span><span class="s0">handledCPCountPlusOne</span><span class="s3">, </span><span class="s0">handledCPCount == basicLength)</span><span class="s3">;</span>
					<span class="s0">delta = </span><span class="s4">0</span><span class="s3">;</span>
					<span class="s0">++handledCPCount</span><span class="s3">;</span>
				<span class="s0">}</span>
			<span class="s0">}</span>
		<span class="s0">} </span><span class="s1">catch </span><span class="s0">(err) {</span>
			<span class="s0">_didIteratorError3 = </span><span class="s1">true</span><span class="s3">;</span>
			<span class="s0">_iteratorError3 = err</span><span class="s3">;</span>
		<span class="s0">} </span><span class="s1">finally </span><span class="s0">{</span>
			<span class="s1">try </span><span class="s0">{</span>
				<span class="s1">if </span><span class="s0">(!_iteratorNormalCompletion3 &amp;&amp; _iterator3.return) {</span>
					<span class="s0">_iterator3.return()</span><span class="s3">;</span>
				<span class="s0">}</span>
			<span class="s0">} </span><span class="s1">finally </span><span class="s0">{</span>
				<span class="s1">if </span><span class="s0">(_didIteratorError3) {</span>
					<span class="s1">throw </span><span class="s0">_iteratorError3</span><span class="s3">;</span>
				<span class="s0">}</span>
			<span class="s0">}</span>
		<span class="s0">}</span>

		<span class="s0">++delta</span><span class="s3">;</span>
		<span class="s0">++n</span><span class="s3">;</span>
	<span class="s0">}</span>
	<span class="s1">return </span><span class="s0">output.join(</span><span class="s2">''</span><span class="s0">)</span><span class="s3">;</span>
<span class="s0">}</span><span class="s3">;</span>

<span class="s5">/**</span>
 <span class="s5">* Converts a Punycode string representing a domain name or an email address</span>
 <span class="s5">* to Unicode. Only the Punycoded parts of the input will be converted, i.e.</span>
 <span class="s5">* it doesn't matter if you call it on a string that has already been</span>
 <span class="s5">* converted to Unicode.</span>
 <span class="s5">* </span><span class="s6">@memberOf </span><span class="s5">punycode</span>
 <span class="s5">* </span><span class="s6">@param </span><span class="s5">{String} input The Punycoded domain name or email address to</span>
 <span class="s5">* convert to Unicode.</span>
 <span class="s5">* </span><span class="s6">@returns </span><span class="s5">{String} The Unicode representation of the given Punycode</span>
 <span class="s5">* string.</span>
 <span class="s5">*/</span>
<span class="s1">var </span><span class="s0">toUnicode = </span><span class="s1">function </span><span class="s0">toUnicode(input) {</span>
	<span class="s1">return </span><span class="s0">mapDomain(input</span><span class="s3">, </span><span class="s1">function </span><span class="s0">(string) {</span>
		<span class="s1">return </span><span class="s0">regexPunycode.test(string) ? decode(string.slice(</span><span class="s4">4</span><span class="s0">).toLowerCase()) : string</span><span class="s3">;</span>
	<span class="s0">})</span><span class="s3">;</span>
<span class="s0">}</span><span class="s3">;</span>

<span class="s5">/**</span>
 <span class="s5">* Converts a Unicode string representing a domain name or an email address to</span>
 <span class="s5">* Punycode. Only the non-ASCII parts of the domain name will be converted,</span>
 <span class="s5">* i.e. it doesn't matter if you call it with a domain that's already in</span>
 <span class="s5">* ASCII.</span>
 <span class="s5">* </span><span class="s6">@memberOf </span><span class="s5">punycode</span>
 <span class="s5">* </span><span class="s6">@param </span><span class="s5">{String} input The domain name or email address to convert, as a</span>
 <span class="s5">* Unicode string.</span>
 <span class="s5">* </span><span class="s6">@returns </span><span class="s5">{String} The Punycode representation of the given domain name or</span>
 <span class="s5">* email address.</span>
 <span class="s5">*/</span>
<span class="s1">var </span><span class="s0">toASCII = </span><span class="s1">function </span><span class="s0">toASCII(input) {</span>
	<span class="s1">return </span><span class="s0">mapDomain(input</span><span class="s3">, </span><span class="s1">function </span><span class="s0">(string) {</span>
		<span class="s1">return </span><span class="s0">regexNonASCII.test(string) ? </span><span class="s2">'xn--' </span><span class="s0">+ encode(string) : string</span><span class="s3">;</span>
	<span class="s0">})</span><span class="s3">;</span>
<span class="s0">}</span><span class="s3">;</span>

<span class="s7">/*--------------------------------------------------------------------------*/</span>

<span class="s5">/** Define the public API */</span>
<span class="s1">var </span><span class="s0">punycode = {</span>
	<span class="s5">/**</span>
  <span class="s5">* A string representing the current Punycode.js version number.</span>
  <span class="s5">* </span><span class="s6">@memberOf </span><span class="s5">punycode</span>
  <span class="s5">* </span><span class="s6">@type </span><span class="s5">String</span>
  <span class="s5">*/</span>
	<span class="s2">'version'</span><span class="s0">: </span><span class="s2">'2.1.0'</span><span class="s3">,</span>
	<span class="s5">/**</span>
  <span class="s5">* An object of methods to convert from JavaScript's internal character</span>
  <span class="s5">* representation (UCS-2) to Unicode code points, and back.</span>
  <span class="s5">* </span><span class="s6">@see </span><span class="s5">&lt;https://mathiasbynens.be/notes/javascript-encoding&gt;</span>
  <span class="s5">* </span><span class="s6">@memberOf </span><span class="s5">punycode</span>
  <span class="s5">* </span><span class="s6">@type </span><span class="s5">Object</span>
  <span class="s5">*/</span>
	<span class="s2">'ucs2'</span><span class="s0">: {</span>
		<span class="s2">'decode'</span><span class="s0">: ucs2decode</span><span class="s3">,</span>
		<span class="s2">'encode'</span><span class="s0">: ucs2encode</span>
	<span class="s0">}</span><span class="s3">,</span>
	<span class="s2">'decode'</span><span class="s0">: decode</span><span class="s3">,</span>
	<span class="s2">'encode'</span><span class="s0">: encode</span><span class="s3">,</span>
	<span class="s2">'toASCII'</span><span class="s0">: toASCII</span><span class="s3">,</span>
	<span class="s2">'toUnicode'</span><span class="s0">: toUnicode</span>
<span class="s0">}</span><span class="s3">;</span>

<span class="s5">/**</span>
 <span class="s5">* URI.js</span>
 <span class="s5">*</span>
 <span class="s5">* </span><span class="s6">@fileoverview </span><span class="s5">An RFC 3986 compliant, scheme extendable URI parsing/validating/resolving library for JavaScript.</span>
 <span class="s5">* </span><span class="s6">@author </span><span class="s5">&lt;a href=&quot;mailto:gary.court@gmail.com&quot;&gt;Gary Court&lt;/a&gt;</span>
 <span class="s5">* </span><span class="s6">@see </span><span class="s5">http://github.com/garycourt/uri-js</span>
 <span class="s5">*/</span>
<span class="s5">/**</span>
 <span class="s5">* Copyright 2011 Gary Court. All rights reserved.</span>
 <span class="s5">*</span>
 <span class="s5">* Redistribution and use in source and binary forms, with or without modification, are</span>
 <span class="s5">* permitted provided that the following conditions are met:</span>
 <span class="s5">*</span>
 <span class="s5">*    1. Redistributions of source code must retain the above copyright notice, this list of</span>
 <span class="s5">*       conditions and the following disclaimer.</span>
 <span class="s5">*</span>
 <span class="s5">*    2. Redistributions in binary form must reproduce the above copyright notice, this list</span>
 <span class="s5">*       of conditions and the following disclaimer in the documentation and/or other materials</span>
 <span class="s5">*       provided with the distribution.</span>
 <span class="s5">*</span>
 <span class="s5">* THIS SOFTWARE IS PROVIDED BY GARY COURT ``AS IS'' AND ANY EXPRESS OR IMPLIED</span>
 <span class="s5">* WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND</span>
 <span class="s5">* FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL GARY COURT OR</span>
 <span class="s5">* CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR</span>
 <span class="s5">* CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR</span>
 <span class="s5">* SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON</span>
 <span class="s5">* ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING</span>
 <span class="s5">* NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF</span>
 <span class="s5">* ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</span>
 <span class="s5">*</span>
 <span class="s5">* The views and conclusions contained in the software and documentation are those of the</span>
 <span class="s5">* authors and should not be interpreted as representing official policies, either expressed</span>
 <span class="s5">* or implied, of Gary Court.</span>
 <span class="s5">*/</span>
<span class="s1">var </span><span class="s0">SCHEMES = {}</span><span class="s3">;</span>
<span class="s1">function </span><span class="s0">pctEncChar(chr) {</span>
    <span class="s1">var </span><span class="s0">c = chr.charCodeAt(</span><span class="s4">0</span><span class="s0">)</span><span class="s3">;</span>
    <span class="s1">var </span><span class="s0">e = </span><span class="s1">void </span><span class="s4">0</span><span class="s3">;</span>
    <span class="s1">if </span><span class="s0">(c &lt; </span><span class="s4">16</span><span class="s0">) e = </span><span class="s2">&quot;%0&quot; </span><span class="s0">+ c.toString(</span><span class="s4">16</span><span class="s0">).toUpperCase()</span><span class="s3">;</span><span class="s1">else if </span><span class="s0">(c &lt; </span><span class="s4">128</span><span class="s0">) e = </span><span class="s2">&quot;%&quot; </span><span class="s0">+ c.toString(</span><span class="s4">16</span><span class="s0">).toUpperCase()</span><span class="s3">;</span><span class="s1">else if </span><span class="s0">(c &lt; </span><span class="s4">2048</span><span class="s0">) e = </span><span class="s2">&quot;%&quot; </span><span class="s0">+ (c &gt;&gt; </span><span class="s4">6 </span><span class="s0">| </span><span class="s4">192</span><span class="s0">).toString(</span><span class="s4">16</span><span class="s0">).toUpperCase() + </span><span class="s2">&quot;%&quot; </span><span class="s0">+ (c &amp; </span><span class="s4">63 </span><span class="s0">| </span><span class="s4">128</span><span class="s0">).toString(</span><span class="s4">16</span><span class="s0">).toUpperCase()</span><span class="s3">;</span><span class="s1">else </span><span class="s0">e = </span><span class="s2">&quot;%&quot; </span><span class="s0">+ (c &gt;&gt; </span><span class="s4">12 </span><span class="s0">| </span><span class="s4">224</span><span class="s0">).toString(</span><span class="s4">16</span><span class="s0">).toUpperCase() + </span><span class="s2">&quot;%&quot; </span><span class="s0">+ (c &gt;&gt; </span><span class="s4">6 </span><span class="s0">&amp; </span><span class="s4">63 </span><span class="s0">| </span><span class="s4">128</span><span class="s0">).toString(</span><span class="s4">16</span><span class="s0">).toUpperCase() + </span><span class="s2">&quot;%&quot; </span><span class="s0">+ (c &amp; </span><span class="s4">63 </span><span class="s0">| </span><span class="s4">128</span><span class="s0">).toString(</span><span class="s4">16</span><span class="s0">).toUpperCase()</span><span class="s3">;</span>
    <span class="s1">return </span><span class="s0">e</span><span class="s3">;</span>
<span class="s0">}</span>
<span class="s1">function </span><span class="s0">pctDecChars(str) {</span>
    <span class="s1">var </span><span class="s0">newStr = </span><span class="s2">&quot;&quot;</span><span class="s3">;</span>
    <span class="s1">var </span><span class="s0">i = </span><span class="s4">0</span><span class="s3">;</span>
    <span class="s1">var </span><span class="s0">il = str.length</span><span class="s3">;</span>
    <span class="s1">while </span><span class="s0">(i &lt; il) {</span>
        <span class="s1">var </span><span class="s0">c = parseInt(str.substr(i + </span><span class="s4">1</span><span class="s3">, </span><span class="s4">2</span><span class="s0">)</span><span class="s3">, </span><span class="s4">16</span><span class="s0">)</span><span class="s3">;</span>
        <span class="s1">if </span><span class="s0">(c &lt; </span><span class="s4">128</span><span class="s0">) {</span>
            <span class="s0">newStr += String.fromCharCode(c)</span><span class="s3">;</span>
            <span class="s0">i += </span><span class="s4">3</span><span class="s3">;</span>
        <span class="s0">} </span><span class="s1">else if </span><span class="s0">(c &gt;= </span><span class="s4">194 </span><span class="s0">&amp;&amp; c &lt; </span><span class="s4">224</span><span class="s0">) {</span>
            <span class="s1">if </span><span class="s0">(il - i &gt;= </span><span class="s4">6</span><span class="s0">) {</span>
                <span class="s1">var </span><span class="s0">c2 = parseInt(str.substr(i + </span><span class="s4">4</span><span class="s3">, </span><span class="s4">2</span><span class="s0">)</span><span class="s3">, </span><span class="s4">16</span><span class="s0">)</span><span class="s3">;</span>
                <span class="s0">newStr += String.fromCharCode((c &amp; </span><span class="s4">31</span><span class="s0">) &lt;&lt; </span><span class="s4">6 </span><span class="s0">| c2 &amp; </span><span class="s4">63</span><span class="s0">)</span><span class="s3">;</span>
            <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
                <span class="s0">newStr += str.substr(i</span><span class="s3">, </span><span class="s4">6</span><span class="s0">)</span><span class="s3">;</span>
            <span class="s0">}</span>
            <span class="s0">i += </span><span class="s4">6</span><span class="s3">;</span>
        <span class="s0">} </span><span class="s1">else if </span><span class="s0">(c &gt;= </span><span class="s4">224</span><span class="s0">) {</span>
            <span class="s1">if </span><span class="s0">(il - i &gt;= </span><span class="s4">9</span><span class="s0">) {</span>
                <span class="s1">var </span><span class="s0">_c = parseInt(str.substr(i + </span><span class="s4">4</span><span class="s3">, </span><span class="s4">2</span><span class="s0">)</span><span class="s3">, </span><span class="s4">16</span><span class="s0">)</span><span class="s3">;</span>
                <span class="s1">var </span><span class="s0">c3 = parseInt(str.substr(i + </span><span class="s4">7</span><span class="s3">, </span><span class="s4">2</span><span class="s0">)</span><span class="s3">, </span><span class="s4">16</span><span class="s0">)</span><span class="s3">;</span>
                <span class="s0">newStr += String.fromCharCode((c &amp; </span><span class="s4">15</span><span class="s0">) &lt;&lt; </span><span class="s4">12 </span><span class="s0">| (_c &amp; </span><span class="s4">63</span><span class="s0">) &lt;&lt; </span><span class="s4">6 </span><span class="s0">| c3 &amp; </span><span class="s4">63</span><span class="s0">)</span><span class="s3">;</span>
            <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
                <span class="s0">newStr += str.substr(i</span><span class="s3">, </span><span class="s4">9</span><span class="s0">)</span><span class="s3">;</span>
            <span class="s0">}</span>
            <span class="s0">i += </span><span class="s4">9</span><span class="s3">;</span>
        <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
            <span class="s0">newStr += str.substr(i</span><span class="s3">, </span><span class="s4">3</span><span class="s0">)</span><span class="s3">;</span>
            <span class="s0">i += </span><span class="s4">3</span><span class="s3">;</span>
        <span class="s0">}</span>
    <span class="s0">}</span>
    <span class="s1">return </span><span class="s0">newStr</span><span class="s3">;</span>
<span class="s0">}</span>
<span class="s1">function </span><span class="s0">_normalizeComponentEncoding(components</span><span class="s3">, </span><span class="s0">protocol) {</span>
    <span class="s1">function </span><span class="s0">decodeUnreserved(str) {</span>
        <span class="s1">var </span><span class="s0">decStr = pctDecChars(str)</span><span class="s3">;</span>
        <span class="s1">return </span><span class="s0">!decStr.match(protocol.UNRESERVED) ? str : decStr</span><span class="s3">;</span>
    <span class="s0">}</span>
    <span class="s1">if </span><span class="s0">(components.scheme) components.scheme = String(components.scheme).replace(protocol.PCT_ENCODED</span><span class="s3">, </span><span class="s0">decodeUnreserved).toLowerCase().replace(protocol.NOT_SCHEME</span><span class="s3">, </span><span class="s2">&quot;&quot;</span><span class="s0">)</span><span class="s3">;</span>
    <span class="s1">if </span><span class="s0">(components.userinfo !== undefined) components.userinfo = String(components.userinfo).replace(protocol.PCT_ENCODED</span><span class="s3">, </span><span class="s0">decodeUnreserved).replace(protocol.NOT_USERINFO</span><span class="s3">, </span><span class="s0">pctEncChar).replace(protocol.PCT_ENCODED</span><span class="s3">, </span><span class="s0">toUpperCase)</span><span class="s3">;</span>
    <span class="s1">if </span><span class="s0">(components.host !== undefined) components.host = String(components.host).replace(protocol.PCT_ENCODED</span><span class="s3">, </span><span class="s0">decodeUnreserved).toLowerCase().replace(protocol.NOT_HOST</span><span class="s3">, </span><span class="s0">pctEncChar).replace(protocol.PCT_ENCODED</span><span class="s3">, </span><span class="s0">toUpperCase)</span><span class="s3">;</span>
    <span class="s1">if </span><span class="s0">(components.path !== undefined) components.path = String(components.path).replace(protocol.PCT_ENCODED</span><span class="s3">, </span><span class="s0">decodeUnreserved).replace(components.scheme ? protocol.NOT_PATH : protocol.NOT_PATH_NOSCHEME</span><span class="s3">, </span><span class="s0">pctEncChar).replace(protocol.PCT_ENCODED</span><span class="s3">, </span><span class="s0">toUpperCase)</span><span class="s3">;</span>
    <span class="s1">if </span><span class="s0">(components.query !== undefined) components.query = String(components.query).replace(protocol.PCT_ENCODED</span><span class="s3">, </span><span class="s0">decodeUnreserved).replace(protocol.NOT_QUERY</span><span class="s3">, </span><span class="s0">pctEncChar).replace(protocol.PCT_ENCODED</span><span class="s3">, </span><span class="s0">toUpperCase)</span><span class="s3">;</span>
    <span class="s1">if </span><span class="s0">(components.fragment !== undefined) components.fragment = String(components.fragment).replace(protocol.PCT_ENCODED</span><span class="s3">, </span><span class="s0">decodeUnreserved).replace(protocol.NOT_FRAGMENT</span><span class="s3">, </span><span class="s0">pctEncChar).replace(protocol.PCT_ENCODED</span><span class="s3">, </span><span class="s0">toUpperCase)</span><span class="s3">;</span>
    <span class="s1">return </span><span class="s0">components</span><span class="s3">;</span>
<span class="s0">}</span>

<span class="s1">function </span><span class="s0">_stripLeadingZeros(str) {</span>
    <span class="s1">return </span><span class="s0">str.replace(</span><span class="s4">/^0*(.*)/</span><span class="s3">, </span><span class="s2">&quot;$1&quot;</span><span class="s0">) || </span><span class="s2">&quot;0&quot;</span><span class="s3">;</span>
<span class="s0">}</span>
<span class="s1">function </span><span class="s0">_normalizeIPv4(host</span><span class="s3">, </span><span class="s0">protocol) {</span>
    <span class="s1">var </span><span class="s0">matches = host.match(protocol.IPV4ADDRESS) || []</span><span class="s3">;</span>

    <span class="s1">var </span><span class="s0">_matches = slicedToArray(matches</span><span class="s3">, </span><span class="s4">2</span><span class="s0">)</span><span class="s3">,</span>
        <span class="s0">address = _matches[</span><span class="s4">1</span><span class="s0">]</span><span class="s3">;</span>

    <span class="s1">if </span><span class="s0">(address) {</span>
        <span class="s1">return </span><span class="s0">address.split(</span><span class="s2">&quot;.&quot;</span><span class="s0">).map(_stripLeadingZeros).join(</span><span class="s2">&quot;.&quot;</span><span class="s0">)</span><span class="s3">;</span>
    <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
        <span class="s1">return </span><span class="s0">host</span><span class="s3">;</span>
    <span class="s0">}</span>
<span class="s0">}</span>
<span class="s1">function </span><span class="s0">_normalizeIPv6(host</span><span class="s3">, </span><span class="s0">protocol) {</span>
    <span class="s1">var </span><span class="s0">matches = host.match(protocol.IPV6ADDRESS) || []</span><span class="s3">;</span>

    <span class="s1">var </span><span class="s0">_matches2 = slicedToArray(matches</span><span class="s3">, </span><span class="s4">3</span><span class="s0">)</span><span class="s3">,</span>
        <span class="s0">address = _matches2[</span><span class="s4">1</span><span class="s0">]</span><span class="s3">,</span>
        <span class="s0">zone = _matches2[</span><span class="s4">2</span><span class="s0">]</span><span class="s3">;</span>

    <span class="s1">if </span><span class="s0">(address) {</span>
        <span class="s1">var </span><span class="s0">_address$toLowerCase$ = address.toLowerCase().split(</span><span class="s2">'::'</span><span class="s0">).reverse()</span><span class="s3">,</span>
            <span class="s0">_address$toLowerCase$2 = slicedToArray(_address$toLowerCase$</span><span class="s3">, </span><span class="s4">2</span><span class="s0">)</span><span class="s3">,</span>
            <span class="s0">last = _address$toLowerCase$2[</span><span class="s4">0</span><span class="s0">]</span><span class="s3">,</span>
            <span class="s0">first = _address$toLowerCase$2[</span><span class="s4">1</span><span class="s0">]</span><span class="s3">;</span>

        <span class="s1">var </span><span class="s0">firstFields = first ? first.split(</span><span class="s2">&quot;:&quot;</span><span class="s0">).map(_stripLeadingZeros) : []</span><span class="s3">;</span>
        <span class="s1">var </span><span class="s0">lastFields = last.split(</span><span class="s2">&quot;:&quot;</span><span class="s0">).map(_stripLeadingZeros)</span><span class="s3">;</span>
        <span class="s1">var </span><span class="s0">isLastFieldIPv4Address = protocol.IPV4ADDRESS.test(lastFields[lastFields.length - </span><span class="s4">1</span><span class="s0">])</span><span class="s3">;</span>
        <span class="s1">var </span><span class="s0">fieldCount = isLastFieldIPv4Address ? </span><span class="s4">7 </span><span class="s0">: </span><span class="s4">8</span><span class="s3">;</span>
        <span class="s1">var </span><span class="s0">lastFieldsStart = lastFields.length - fieldCount</span><span class="s3">;</span>
        <span class="s1">var </span><span class="s0">fields = Array(fieldCount)</span><span class="s3">;</span>
        <span class="s1">for </span><span class="s0">(</span><span class="s1">var </span><span class="s0">x = </span><span class="s4">0</span><span class="s3">; </span><span class="s0">x &lt; fieldCount</span><span class="s3">; </span><span class="s0">++x) {</span>
            <span class="s0">fields[x] = firstFields[x] || lastFields[lastFieldsStart + x] || </span><span class="s2">''</span><span class="s3">;</span>
        <span class="s0">}</span>
        <span class="s1">if </span><span class="s0">(isLastFieldIPv4Address) {</span>
            <span class="s0">fields[fieldCount - </span><span class="s4">1</span><span class="s0">] = _normalizeIPv4(fields[fieldCount - </span><span class="s4">1</span><span class="s0">]</span><span class="s3">, </span><span class="s0">protocol)</span><span class="s3">;</span>
        <span class="s0">}</span>
        <span class="s1">var </span><span class="s0">allZeroFields = fields.reduce(</span><span class="s1">function </span><span class="s0">(acc</span><span class="s3">, </span><span class="s0">field</span><span class="s3">, </span><span class="s0">index) {</span>
            <span class="s1">if </span><span class="s0">(!field || field === </span><span class="s2">&quot;0&quot;</span><span class="s0">) {</span>
                <span class="s1">var </span><span class="s0">lastLongest = acc[acc.length - </span><span class="s4">1</span><span class="s0">]</span><span class="s3">;</span>
                <span class="s1">if </span><span class="s0">(lastLongest &amp;&amp; lastLongest.index + lastLongest.length === index) {</span>
                    <span class="s0">lastLongest.length++</span><span class="s3">;</span>
                <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
                    <span class="s0">acc.push({ index: index</span><span class="s3">, </span><span class="s0">length: </span><span class="s4">1 </span><span class="s0">})</span><span class="s3">;</span>
                <span class="s0">}</span>
            <span class="s0">}</span>
            <span class="s1">return </span><span class="s0">acc</span><span class="s3">;</span>
        <span class="s0">}</span><span class="s3">, </span><span class="s0">[])</span><span class="s3">;</span>
        <span class="s1">var </span><span class="s0">longestZeroFields = allZeroFields.sort(</span><span class="s1">function </span><span class="s0">(a</span><span class="s3">, </span><span class="s0">b) {</span>
            <span class="s1">return </span><span class="s0">b.length - a.length</span><span class="s3">;</span>
        <span class="s0">})[</span><span class="s4">0</span><span class="s0">]</span><span class="s3">;</span>
        <span class="s1">var </span><span class="s0">newHost = </span><span class="s1">void </span><span class="s4">0</span><span class="s3">;</span>
        <span class="s1">if </span><span class="s0">(longestZeroFields &amp;&amp; longestZeroFields.length &gt; </span><span class="s4">1</span><span class="s0">) {</span>
            <span class="s1">var </span><span class="s0">newFirst = fields.slice(</span><span class="s4">0</span><span class="s3">, </span><span class="s0">longestZeroFields.index)</span><span class="s3">;</span>
            <span class="s1">var </span><span class="s0">newLast = fields.slice(longestZeroFields.index + longestZeroFields.length)</span><span class="s3">;</span>
            <span class="s0">newHost = newFirst.join(</span><span class="s2">&quot;:&quot;</span><span class="s0">) + </span><span class="s2">&quot;::&quot; </span><span class="s0">+ newLast.join(</span><span class="s2">&quot;:&quot;</span><span class="s0">)</span><span class="s3">;</span>
        <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
            <span class="s0">newHost = fields.join(</span><span class="s2">&quot;:&quot;</span><span class="s0">)</span><span class="s3">;</span>
        <span class="s0">}</span>
        <span class="s1">if </span><span class="s0">(zone) {</span>
            <span class="s0">newHost += </span><span class="s2">&quot;%&quot; </span><span class="s0">+ zone</span><span class="s3">;</span>
        <span class="s0">}</span>
        <span class="s1">return </span><span class="s0">newHost</span><span class="s3">;</span>
    <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
        <span class="s1">return </span><span class="s0">host</span><span class="s3">;</span>
    <span class="s0">}</span>
<span class="s0">}</span>
<span class="s1">var </span><span class="s0">URI_PARSE = </span><span class="s4">/^(?:([^:\/?#]+):)?(?:\/\/((?:([^\/?#@]*)@)?(\[[^\/?#\]]+\]|[^\/?#:]*)(?:\:(\d*))?))?([^?#]*)(?:\?([^#]*))?(?:#((?:.|\n|\r)*))?/i</span><span class="s3">;</span>
<span class="s1">var </span><span class="s0">NO_MATCH_IS_UNDEFINED = </span><span class="s2">&quot;&quot;</span><span class="s0">.match(</span><span class="s4">/(){0}/</span><span class="s0">)[</span><span class="s4">1</span><span class="s0">] === undefined</span><span class="s3">;</span>
<span class="s1">function </span><span class="s0">parse(uriString) {</span>
    <span class="s1">var </span><span class="s0">options = arguments.length &gt; </span><span class="s4">1 </span><span class="s0">&amp;&amp; arguments[</span><span class="s4">1</span><span class="s0">] !== undefined ? arguments[</span><span class="s4">1</span><span class="s0">] : {}</span><span class="s3">;</span>

    <span class="s1">var </span><span class="s0">components = {}</span><span class="s3">;</span>
    <span class="s1">var </span><span class="s0">protocol = options.iri !== </span><span class="s1">false </span><span class="s0">? IRI_PROTOCOL : URI_PROTOCOL</span><span class="s3">;</span>
    <span class="s1">if </span><span class="s0">(options.reference === </span><span class="s2">&quot;suffix&quot;</span><span class="s0">) uriString = (options.scheme ? options.scheme + </span><span class="s2">&quot;:&quot; </span><span class="s0">: </span><span class="s2">&quot;&quot;</span><span class="s0">) + </span><span class="s2">&quot;//&quot; </span><span class="s0">+ uriString</span><span class="s3">;</span>
    <span class="s1">var </span><span class="s0">matches = uriString.match(URI_PARSE)</span><span class="s3">;</span>
    <span class="s1">if </span><span class="s0">(matches) {</span>
        <span class="s1">if </span><span class="s0">(NO_MATCH_IS_UNDEFINED) {</span>
            <span class="s8">//store each component</span>
            <span class="s0">components.scheme = matches[</span><span class="s4">1</span><span class="s0">]</span><span class="s3">;</span>
            <span class="s0">components.userinfo = matches[</span><span class="s4">3</span><span class="s0">]</span><span class="s3">;</span>
            <span class="s0">components.host = matches[</span><span class="s4">4</span><span class="s0">]</span><span class="s3">;</span>
            <span class="s0">components.port = parseInt(matches[</span><span class="s4">5</span><span class="s0">]</span><span class="s3">, </span><span class="s4">10</span><span class="s0">)</span><span class="s3">;</span>
            <span class="s0">components.path = matches[</span><span class="s4">6</span><span class="s0">] || </span><span class="s2">&quot;&quot;</span><span class="s3">;</span>
            <span class="s0">components.query = matches[</span><span class="s4">7</span><span class="s0">]</span><span class="s3">;</span>
            <span class="s0">components.fragment = matches[</span><span class="s4">8</span><span class="s0">]</span><span class="s3">;</span>
            <span class="s8">//fix port number</span>
            <span class="s1">if </span><span class="s0">(isNaN(components.port)) {</span>
                <span class="s0">components.port = matches[</span><span class="s4">5</span><span class="s0">]</span><span class="s3">;</span>
            <span class="s0">}</span>
        <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
            <span class="s8">//IE FIX for improper RegExp matching</span>
            <span class="s8">//store each component</span>
            <span class="s0">components.scheme = matches[</span><span class="s4">1</span><span class="s0">] || undefined</span><span class="s3">;</span>
            <span class="s0">components.userinfo = uriString.indexOf(</span><span class="s2">&quot;@&quot;</span><span class="s0">) !== -</span><span class="s4">1 </span><span class="s0">? matches[</span><span class="s4">3</span><span class="s0">] : undefined</span><span class="s3">;</span>
            <span class="s0">components.host = uriString.indexOf(</span><span class="s2">&quot;//&quot;</span><span class="s0">) !== -</span><span class="s4">1 </span><span class="s0">? matches[</span><span class="s4">4</span><span class="s0">] : undefined</span><span class="s3">;</span>
            <span class="s0">components.port = parseInt(matches[</span><span class="s4">5</span><span class="s0">]</span><span class="s3">, </span><span class="s4">10</span><span class="s0">)</span><span class="s3">;</span>
            <span class="s0">components.path = matches[</span><span class="s4">6</span><span class="s0">] || </span><span class="s2">&quot;&quot;</span><span class="s3">;</span>
            <span class="s0">components.query = uriString.indexOf(</span><span class="s2">&quot;?&quot;</span><span class="s0">) !== -</span><span class="s4">1 </span><span class="s0">? matches[</span><span class="s4">7</span><span class="s0">] : undefined</span><span class="s3">;</span>
            <span class="s0">components.fragment = uriString.indexOf(</span><span class="s2">&quot;#&quot;</span><span class="s0">) !== -</span><span class="s4">1 </span><span class="s0">? matches[</span><span class="s4">8</span><span class="s0">] : undefined</span><span class="s3">;</span>
            <span class="s8">//fix port number</span>
            <span class="s1">if </span><span class="s0">(isNaN(components.port)) {</span>
                <span class="s0">components.port = uriString.match(</span><span class="s4">/\/\/(?:.|\n)*\:(?:\/|\?|\#|$)/</span><span class="s0">) ? matches[</span><span class="s4">4</span><span class="s0">] : undefined</span><span class="s3">;</span>
            <span class="s0">}</span>
        <span class="s0">}</span>
        <span class="s1">if </span><span class="s0">(components.host) {</span>
            <span class="s8">//normalize IP hosts</span>
            <span class="s0">components.host = _normalizeIPv6(_normalizeIPv4(components.host</span><span class="s3">, </span><span class="s0">protocol)</span><span class="s3">, </span><span class="s0">protocol)</span><span class="s3">;</span>
        <span class="s0">}</span>
        <span class="s8">//determine reference type</span>
        <span class="s1">if </span><span class="s0">(components.scheme === undefined &amp;&amp; components.userinfo === undefined &amp;&amp; components.host === undefined &amp;&amp; components.port === undefined &amp;&amp; !components.path &amp;&amp; components.query === undefined) {</span>
            <span class="s0">components.reference = </span><span class="s2">&quot;same-document&quot;</span><span class="s3">;</span>
        <span class="s0">} </span><span class="s1">else if </span><span class="s0">(components.scheme === undefined) {</span>
            <span class="s0">components.reference = </span><span class="s2">&quot;relative&quot;</span><span class="s3">;</span>
        <span class="s0">} </span><span class="s1">else if </span><span class="s0">(components.fragment === undefined) {</span>
            <span class="s0">components.reference = </span><span class="s2">&quot;absolute&quot;</span><span class="s3">;</span>
        <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
            <span class="s0">components.reference = </span><span class="s2">&quot;uri&quot;</span><span class="s3">;</span>
        <span class="s0">}</span>
        <span class="s8">//check for reference errors</span>
        <span class="s1">if </span><span class="s0">(options.reference &amp;&amp; options.reference !== </span><span class="s2">&quot;suffix&quot; </span><span class="s0">&amp;&amp; options.reference !== components.reference) {</span>
            <span class="s0">components.error = components.error || </span><span class="s2">&quot;URI is not a &quot; </span><span class="s0">+ options.reference + </span><span class="s2">&quot; reference.&quot;</span><span class="s3">;</span>
        <span class="s0">}</span>
        <span class="s8">//find scheme handler</span>
        <span class="s1">var </span><span class="s0">schemeHandler = SCHEMES[(options.scheme || components.scheme || </span><span class="s2">&quot;&quot;</span><span class="s0">).toLowerCase()]</span><span class="s3">;</span>
        <span class="s8">//check if scheme can't handle IRIs</span>
        <span class="s1">if </span><span class="s0">(!options.unicodeSupport &amp;&amp; (!schemeHandler || !schemeHandler.unicodeSupport)) {</span>
            <span class="s8">//if host component is a domain name</span>
            <span class="s1">if </span><span class="s0">(components.host &amp;&amp; (options.domainHost || schemeHandler &amp;&amp; schemeHandler.domainHost)) {</span>
                <span class="s8">//convert Unicode IDN -&gt; ASCII IDN</span>
                <span class="s1">try </span><span class="s0">{</span>
                    <span class="s0">components.host = punycode.toASCII(components.host.replace(protocol.PCT_ENCODED</span><span class="s3">, </span><span class="s0">pctDecChars).toLowerCase())</span><span class="s3">;</span>
                <span class="s0">} </span><span class="s1">catch </span><span class="s0">(e) {</span>
                    <span class="s0">components.error = components.error || </span><span class="s2">&quot;Host's domain name can not be converted to ASCII via punycode: &quot; </span><span class="s0">+ e</span><span class="s3">;</span>
                <span class="s0">}</span>
            <span class="s0">}</span>
            <span class="s8">//convert IRI -&gt; URI</span>
            <span class="s0">_normalizeComponentEncoding(components</span><span class="s3">, </span><span class="s0">URI_PROTOCOL)</span><span class="s3">;</span>
        <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
            <span class="s8">//normalize encodings</span>
            <span class="s0">_normalizeComponentEncoding(components</span><span class="s3">, </span><span class="s0">protocol)</span><span class="s3">;</span>
        <span class="s0">}</span>
        <span class="s8">//perform scheme specific parsing</span>
        <span class="s1">if </span><span class="s0">(schemeHandler &amp;&amp; schemeHandler.parse) {</span>
            <span class="s0">schemeHandler.parse(components</span><span class="s3">, </span><span class="s0">options)</span><span class="s3">;</span>
        <span class="s0">}</span>
    <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
        <span class="s0">components.error = components.error || </span><span class="s2">&quot;URI can not be parsed.&quot;</span><span class="s3">;</span>
    <span class="s0">}</span>
    <span class="s1">return </span><span class="s0">components</span><span class="s3">;</span>
<span class="s0">}</span>

<span class="s1">function </span><span class="s0">_recomposeAuthority(components</span><span class="s3">, </span><span class="s0">options) {</span>
    <span class="s1">var </span><span class="s0">protocol = options.iri !== </span><span class="s1">false </span><span class="s0">? IRI_PROTOCOL : URI_PROTOCOL</span><span class="s3">;</span>
    <span class="s1">var </span><span class="s0">uriTokens = []</span><span class="s3">;</span>
    <span class="s1">if </span><span class="s0">(components.userinfo !== undefined) {</span>
        <span class="s0">uriTokens.push(components.userinfo)</span><span class="s3">;</span>
        <span class="s0">uriTokens.push(</span><span class="s2">&quot;@&quot;</span><span class="s0">)</span><span class="s3">;</span>
    <span class="s0">}</span>
    <span class="s1">if </span><span class="s0">(components.host !== undefined) {</span>
        <span class="s8">//normalize IP hosts, add brackets and escape zone separator for IPv6</span>
        <span class="s0">uriTokens.push(_normalizeIPv6(_normalizeIPv4(String(components.host)</span><span class="s3">, </span><span class="s0">protocol)</span><span class="s3">, </span><span class="s0">protocol).replace(protocol.IPV6ADDRESS</span><span class="s3">, </span><span class="s1">function </span><span class="s0">(_</span><span class="s3">, </span><span class="s0">$1</span><span class="s3">, </span><span class="s0">$2) {</span>
            <span class="s1">return </span><span class="s2">&quot;[&quot; </span><span class="s0">+ $1 + ($2 ? </span><span class="s2">&quot;%25&quot; </span><span class="s0">+ $2 : </span><span class="s2">&quot;&quot;</span><span class="s0">) + </span><span class="s2">&quot;]&quot;</span><span class="s3">;</span>
        <span class="s0">}))</span><span class="s3">;</span>
    <span class="s0">}</span>
    <span class="s1">if </span><span class="s0">(</span><span class="s1">typeof </span><span class="s0">components.port === </span><span class="s2">&quot;number&quot; </span><span class="s0">|| </span><span class="s1">typeof </span><span class="s0">components.port === </span><span class="s2">&quot;string&quot;</span><span class="s0">) {</span>
        <span class="s0">uriTokens.push(</span><span class="s2">&quot;:&quot;</span><span class="s0">)</span><span class="s3">;</span>
        <span class="s0">uriTokens.push(String(components.port))</span><span class="s3">;</span>
    <span class="s0">}</span>
    <span class="s1">return </span><span class="s0">uriTokens.length ? uriTokens.join(</span><span class="s2">&quot;&quot;</span><span class="s0">) : undefined</span><span class="s3">;</span>
<span class="s0">}</span>

<span class="s1">var </span><span class="s0">RDS1 = </span><span class="s4">/^\.\.?\//</span><span class="s3">;</span>
<span class="s1">var </span><span class="s0">RDS2 = </span><span class="s4">/^\/\.(\/|$)/</span><span class="s3">;</span>
<span class="s1">var </span><span class="s0">RDS3 = </span><span class="s4">/^\/\.\.(\/|$)/</span><span class="s3">;</span>
<span class="s1">var </span><span class="s0">RDS5 = </span><span class="s4">/^\/?(?:.|\n)*?(?=\/|$)/</span><span class="s3">;</span>
<span class="s1">function </span><span class="s0">removeDotSegments(input) {</span>
    <span class="s1">var </span><span class="s0">output = []</span><span class="s3">;</span>
    <span class="s1">while </span><span class="s0">(input.length) {</span>
        <span class="s1">if </span><span class="s0">(input.match(RDS1)) {</span>
            <span class="s0">input = input.replace(RDS1</span><span class="s3">, </span><span class="s2">&quot;&quot;</span><span class="s0">)</span><span class="s3">;</span>
        <span class="s0">} </span><span class="s1">else if </span><span class="s0">(input.match(RDS2)) {</span>
            <span class="s0">input = input.replace(RDS2</span><span class="s3">, </span><span class="s2">&quot;/&quot;</span><span class="s0">)</span><span class="s3">;</span>
        <span class="s0">} </span><span class="s1">else if </span><span class="s0">(input.match(RDS3)) {</span>
            <span class="s0">input = input.replace(RDS3</span><span class="s3">, </span><span class="s2">&quot;/&quot;</span><span class="s0">)</span><span class="s3">;</span>
            <span class="s0">output.pop()</span><span class="s3">;</span>
        <span class="s0">} </span><span class="s1">else if </span><span class="s0">(input === </span><span class="s2">&quot;.&quot; </span><span class="s0">|| input === </span><span class="s2">&quot;..&quot;</span><span class="s0">) {</span>
            <span class="s0">input = </span><span class="s2">&quot;&quot;</span><span class="s3">;</span>
        <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
            <span class="s1">var </span><span class="s0">im = input.match(RDS5)</span><span class="s3">;</span>
            <span class="s1">if </span><span class="s0">(im) {</span>
                <span class="s1">var </span><span class="s0">s = im[</span><span class="s4">0</span><span class="s0">]</span><span class="s3">;</span>
                <span class="s0">input = input.slice(s.length)</span><span class="s3">;</span>
                <span class="s0">output.push(s)</span><span class="s3">;</span>
            <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
                <span class="s1">throw new </span><span class="s0">Error(</span><span class="s2">&quot;Unexpected dot segment condition&quot;</span><span class="s0">)</span><span class="s3">;</span>
            <span class="s0">}</span>
        <span class="s0">}</span>
    <span class="s0">}</span>
    <span class="s1">return </span><span class="s0">output.join(</span><span class="s2">&quot;&quot;</span><span class="s0">)</span><span class="s3">;</span>
<span class="s0">}</span>

<span class="s1">function </span><span class="s0">serialize(components) {</span>
    <span class="s1">var </span><span class="s0">options = arguments.length &gt; </span><span class="s4">1 </span><span class="s0">&amp;&amp; arguments[</span><span class="s4">1</span><span class="s0">] !== undefined ? arguments[</span><span class="s4">1</span><span class="s0">] : {}</span><span class="s3">;</span>

    <span class="s1">var </span><span class="s0">protocol = options.iri ? IRI_PROTOCOL : URI_PROTOCOL</span><span class="s3">;</span>
    <span class="s1">var </span><span class="s0">uriTokens = []</span><span class="s3">;</span>
    <span class="s8">//find scheme handler</span>
    <span class="s1">var </span><span class="s0">schemeHandler = SCHEMES[(options.scheme || components.scheme || </span><span class="s2">&quot;&quot;</span><span class="s0">).toLowerCase()]</span><span class="s3">;</span>
    <span class="s8">//perform scheme specific serialization</span>
    <span class="s1">if </span><span class="s0">(schemeHandler &amp;&amp; schemeHandler.serialize) schemeHandler.serialize(components</span><span class="s3">, </span><span class="s0">options)</span><span class="s3">;</span>
    <span class="s1">if </span><span class="s0">(components.host) {</span>
        <span class="s8">//if host component is an IPv6 address</span>
        <span class="s1">if </span><span class="s0">(protocol.IPV6ADDRESS.test(components.host)) {}</span>
        <span class="s8">//TODO: normalize IPv6 address as per RFC 5952</span>

        <span class="s8">//if host component is a domain name</span>
        <span class="s1">else if </span><span class="s0">(options.domainHost || schemeHandler &amp;&amp; schemeHandler.domainHost) {</span>
                <span class="s8">//convert IDN via punycode</span>
                <span class="s1">try </span><span class="s0">{</span>
                    <span class="s0">components.host = !options.iri ? punycode.toASCII(components.host.replace(protocol.PCT_ENCODED</span><span class="s3">, </span><span class="s0">pctDecChars).toLowerCase()) : punycode.toUnicode(components.host)</span><span class="s3">;</span>
                <span class="s0">} </span><span class="s1">catch </span><span class="s0">(e) {</span>
                    <span class="s0">components.error = components.error || </span><span class="s2">&quot;Host's domain name can not be converted to &quot; </span><span class="s0">+ (!options.iri ? </span><span class="s2">&quot;ASCII&quot; </span><span class="s0">: </span><span class="s2">&quot;Unicode&quot;</span><span class="s0">) + </span><span class="s2">&quot; via punycode: &quot; </span><span class="s0">+ e</span><span class="s3">;</span>
                <span class="s0">}</span>
            <span class="s0">}</span>
    <span class="s0">}</span>
    <span class="s8">//normalize encoding</span>
    <span class="s0">_normalizeComponentEncoding(components</span><span class="s3">, </span><span class="s0">protocol)</span><span class="s3">;</span>
    <span class="s1">if </span><span class="s0">(options.reference !== </span><span class="s2">&quot;suffix&quot; </span><span class="s0">&amp;&amp; components.scheme) {</span>
        <span class="s0">uriTokens.push(components.scheme)</span><span class="s3">;</span>
        <span class="s0">uriTokens.push(</span><span class="s2">&quot;:&quot;</span><span class="s0">)</span><span class="s3">;</span>
    <span class="s0">}</span>
    <span class="s1">var </span><span class="s0">authority = _recomposeAuthority(components</span><span class="s3">, </span><span class="s0">options)</span><span class="s3">;</span>
    <span class="s1">if </span><span class="s0">(authority !== undefined) {</span>
        <span class="s1">if </span><span class="s0">(options.reference !== </span><span class="s2">&quot;suffix&quot;</span><span class="s0">) {</span>
            <span class="s0">uriTokens.push(</span><span class="s2">&quot;//&quot;</span><span class="s0">)</span><span class="s3">;</span>
        <span class="s0">}</span>
        <span class="s0">uriTokens.push(authority)</span><span class="s3">;</span>
        <span class="s1">if </span><span class="s0">(components.path &amp;&amp; components.path.charAt(</span><span class="s4">0</span><span class="s0">) !== </span><span class="s2">&quot;/&quot;</span><span class="s0">) {</span>
            <span class="s0">uriTokens.push(</span><span class="s2">&quot;/&quot;</span><span class="s0">)</span><span class="s3">;</span>
        <span class="s0">}</span>
    <span class="s0">}</span>
    <span class="s1">if </span><span class="s0">(components.path !== undefined) {</span>
        <span class="s1">var </span><span class="s0">s = components.path</span><span class="s3">;</span>
        <span class="s1">if </span><span class="s0">(!options.absolutePath &amp;&amp; (!schemeHandler || !schemeHandler.absolutePath)) {</span>
            <span class="s0">s = removeDotSegments(s)</span><span class="s3">;</span>
        <span class="s0">}</span>
        <span class="s1">if </span><span class="s0">(authority === undefined) {</span>
            <span class="s0">s = s.replace(</span><span class="s4">/^\/\//</span><span class="s3">, </span><span class="s2">&quot;/%2F&quot;</span><span class="s0">)</span><span class="s3">; </span><span class="s8">//don't allow the path to start with &quot;//&quot;</span>
        <span class="s0">}</span>
        <span class="s0">uriTokens.push(s)</span><span class="s3">;</span>
    <span class="s0">}</span>
    <span class="s1">if </span><span class="s0">(components.query !== undefined) {</span>
        <span class="s0">uriTokens.push(</span><span class="s2">&quot;?&quot;</span><span class="s0">)</span><span class="s3">;</span>
        <span class="s0">uriTokens.push(components.query)</span><span class="s3">;</span>
    <span class="s0">}</span>
    <span class="s1">if </span><span class="s0">(components.fragment !== undefined) {</span>
        <span class="s0">uriTokens.push(</span><span class="s2">&quot;#&quot;</span><span class="s0">)</span><span class="s3">;</span>
        <span class="s0">uriTokens.push(components.fragment)</span><span class="s3">;</span>
    <span class="s0">}</span>
    <span class="s1">return </span><span class="s0">uriTokens.join(</span><span class="s2">&quot;&quot;</span><span class="s0">)</span><span class="s3">; </span><span class="s8">//merge tokens into a string</span>
<span class="s0">}</span>

<span class="s1">function </span><span class="s0">resolveComponents(base</span><span class="s3">, </span><span class="s0">relative) {</span>
    <span class="s1">var </span><span class="s0">options = arguments.length &gt; </span><span class="s4">2 </span><span class="s0">&amp;&amp; arguments[</span><span class="s4">2</span><span class="s0">] !== undefined ? arguments[</span><span class="s4">2</span><span class="s0">] : {}</span><span class="s3">;</span>
    <span class="s1">var </span><span class="s0">skipNormalization = arguments[</span><span class="s4">3</span><span class="s0">]</span><span class="s3">;</span>

    <span class="s1">var </span><span class="s0">target = {}</span><span class="s3">;</span>
    <span class="s1">if </span><span class="s0">(!skipNormalization) {</span>
        <span class="s0">base = parse(serialize(base</span><span class="s3">, </span><span class="s0">options)</span><span class="s3">, </span><span class="s0">options)</span><span class="s3">; </span><span class="s8">//normalize base components</span>
        <span class="s0">relative = parse(serialize(relative</span><span class="s3">, </span><span class="s0">options)</span><span class="s3">, </span><span class="s0">options)</span><span class="s3">; </span><span class="s8">//normalize relative components</span>
    <span class="s0">}</span>
    <span class="s0">options = options || {}</span><span class="s3">;</span>
    <span class="s1">if </span><span class="s0">(!options.tolerant &amp;&amp; relative.scheme) {</span>
        <span class="s0">target.scheme = relative.scheme</span><span class="s3">;</span>
        <span class="s8">//target.authority = relative.authority;</span>
        <span class="s0">target.userinfo = relative.userinfo</span><span class="s3">;</span>
        <span class="s0">target.host = relative.host</span><span class="s3">;</span>
        <span class="s0">target.port = relative.port</span><span class="s3">;</span>
        <span class="s0">target.path = removeDotSegments(relative.path || </span><span class="s2">&quot;&quot;</span><span class="s0">)</span><span class="s3">;</span>
        <span class="s0">target.query = relative.query</span><span class="s3">;</span>
    <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
        <span class="s1">if </span><span class="s0">(relative.userinfo !== undefined || relative.host !== undefined || relative.port !== undefined) {</span>
            <span class="s8">//target.authority = relative.authority;</span>
            <span class="s0">target.userinfo = relative.userinfo</span><span class="s3">;</span>
            <span class="s0">target.host = relative.host</span><span class="s3">;</span>
            <span class="s0">target.port = relative.port</span><span class="s3">;</span>
            <span class="s0">target.path = removeDotSegments(relative.path || </span><span class="s2">&quot;&quot;</span><span class="s0">)</span><span class="s3">;</span>
            <span class="s0">target.query = relative.query</span><span class="s3">;</span>
        <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
            <span class="s1">if </span><span class="s0">(!relative.path) {</span>
                <span class="s0">target.path = base.path</span><span class="s3">;</span>
                <span class="s1">if </span><span class="s0">(relative.query !== undefined) {</span>
                    <span class="s0">target.query = relative.query</span><span class="s3">;</span>
                <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
                    <span class="s0">target.query = base.query</span><span class="s3">;</span>
                <span class="s0">}</span>
            <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
                <span class="s1">if </span><span class="s0">(relative.path.charAt(</span><span class="s4">0</span><span class="s0">) === </span><span class="s2">&quot;/&quot;</span><span class="s0">) {</span>
                    <span class="s0">target.path = removeDotSegments(relative.path)</span><span class="s3">;</span>
                <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
                    <span class="s1">if </span><span class="s0">((base.userinfo !== undefined || base.host !== undefined || base.port !== undefined) &amp;&amp; !base.path) {</span>
                        <span class="s0">target.path = </span><span class="s2">&quot;/&quot; </span><span class="s0">+ relative.path</span><span class="s3">;</span>
                    <span class="s0">} </span><span class="s1">else if </span><span class="s0">(!base.path) {</span>
                        <span class="s0">target.path = relative.path</span><span class="s3">;</span>
                    <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
                        <span class="s0">target.path = base.path.slice(</span><span class="s4">0</span><span class="s3">, </span><span class="s0">base.path.lastIndexOf(</span><span class="s2">&quot;/&quot;</span><span class="s0">) + </span><span class="s4">1</span><span class="s0">) + relative.path</span><span class="s3">;</span>
                    <span class="s0">}</span>
                    <span class="s0">target.path = removeDotSegments(target.path)</span><span class="s3">;</span>
                <span class="s0">}</span>
                <span class="s0">target.query = relative.query</span><span class="s3">;</span>
            <span class="s0">}</span>
            <span class="s8">//target.authority = base.authority;</span>
            <span class="s0">target.userinfo = base.userinfo</span><span class="s3">;</span>
            <span class="s0">target.host = base.host</span><span class="s3">;</span>
            <span class="s0">target.port = base.port</span><span class="s3">;</span>
        <span class="s0">}</span>
        <span class="s0">target.scheme = base.scheme</span><span class="s3">;</span>
    <span class="s0">}</span>
    <span class="s0">target.fragment = relative.fragment</span><span class="s3">;</span>
    <span class="s1">return </span><span class="s0">target</span><span class="s3">;</span>
<span class="s0">}</span>

<span class="s1">function </span><span class="s0">resolve(baseURI</span><span class="s3">, </span><span class="s0">relativeURI</span><span class="s3">, </span><span class="s0">options) {</span>
    <span class="s1">var </span><span class="s0">schemelessOptions = assign({ scheme: </span><span class="s2">'null' </span><span class="s0">}</span><span class="s3">, </span><span class="s0">options)</span><span class="s3">;</span>
    <span class="s1">return </span><span class="s0">serialize(resolveComponents(parse(baseURI</span><span class="s3">, </span><span class="s0">schemelessOptions)</span><span class="s3">, </span><span class="s0">parse(relativeURI</span><span class="s3">, </span><span class="s0">schemelessOptions)</span><span class="s3">, </span><span class="s0">schemelessOptions</span><span class="s3">, </span><span class="s1">true</span><span class="s0">)</span><span class="s3">, </span><span class="s0">schemelessOptions)</span><span class="s3">;</span>
<span class="s0">}</span>

<span class="s1">function </span><span class="s0">normalize(uri</span><span class="s3">, </span><span class="s0">options) {</span>
    <span class="s1">if </span><span class="s0">(</span><span class="s1">typeof </span><span class="s0">uri === </span><span class="s2">&quot;string&quot;</span><span class="s0">) {</span>
        <span class="s0">uri = serialize(parse(uri</span><span class="s3">, </span><span class="s0">options)</span><span class="s3">, </span><span class="s0">options)</span><span class="s3">;</span>
    <span class="s0">} </span><span class="s1">else if </span><span class="s0">(typeOf(uri) === </span><span class="s2">&quot;object&quot;</span><span class="s0">) {</span>
        <span class="s0">uri = parse(serialize(uri</span><span class="s3">, </span><span class="s0">options)</span><span class="s3">, </span><span class="s0">options)</span><span class="s3">;</span>
    <span class="s0">}</span>
    <span class="s1">return </span><span class="s0">uri</span><span class="s3">;</span>
<span class="s0">}</span>

<span class="s1">function </span><span class="s0">equal(uriA</span><span class="s3">, </span><span class="s0">uriB</span><span class="s3">, </span><span class="s0">options) {</span>
    <span class="s1">if </span><span class="s0">(</span><span class="s1">typeof </span><span class="s0">uriA === </span><span class="s2">&quot;string&quot;</span><span class="s0">) {</span>
        <span class="s0">uriA = serialize(parse(uriA</span><span class="s3">, </span><span class="s0">options)</span><span class="s3">, </span><span class="s0">options)</span><span class="s3">;</span>
    <span class="s0">} </span><span class="s1">else if </span><span class="s0">(typeOf(uriA) === </span><span class="s2">&quot;object&quot;</span><span class="s0">) {</span>
        <span class="s0">uriA = serialize(uriA</span><span class="s3">, </span><span class="s0">options)</span><span class="s3">;</span>
    <span class="s0">}</span>
    <span class="s1">if </span><span class="s0">(</span><span class="s1">typeof </span><span class="s0">uriB === </span><span class="s2">&quot;string&quot;</span><span class="s0">) {</span>
        <span class="s0">uriB = serialize(parse(uriB</span><span class="s3">, </span><span class="s0">options)</span><span class="s3">, </span><span class="s0">options)</span><span class="s3">;</span>
    <span class="s0">} </span><span class="s1">else if </span><span class="s0">(typeOf(uriB) === </span><span class="s2">&quot;object&quot;</span><span class="s0">) {</span>
        <span class="s0">uriB = serialize(uriB</span><span class="s3">, </span><span class="s0">options)</span><span class="s3">;</span>
    <span class="s0">}</span>
    <span class="s1">return </span><span class="s0">uriA === uriB</span><span class="s3">;</span>
<span class="s0">}</span>

<span class="s1">function </span><span class="s0">escapeComponent(str</span><span class="s3">, </span><span class="s0">options) {</span>
    <span class="s1">return </span><span class="s0">str &amp;&amp; str.toString().replace(!options || !options.iri ? URI_PROTOCOL.ESCAPE : IRI_PROTOCOL.ESCAPE</span><span class="s3">, </span><span class="s0">pctEncChar)</span><span class="s3">;</span>
<span class="s0">}</span>

<span class="s1">function </span><span class="s0">unescapeComponent(str</span><span class="s3">, </span><span class="s0">options) {</span>
    <span class="s1">return </span><span class="s0">str &amp;&amp; str.toString().replace(!options || !options.iri ? URI_PROTOCOL.PCT_ENCODED : IRI_PROTOCOL.PCT_ENCODED</span><span class="s3">, </span><span class="s0">pctDecChars)</span><span class="s3">;</span>
<span class="s0">}</span>

<span class="s1">var </span><span class="s0">handler = {</span>
    <span class="s0">scheme: </span><span class="s2">&quot;http&quot;</span><span class="s3">,</span>
    <span class="s0">domainHost: </span><span class="s1">true</span><span class="s3">,</span>
    <span class="s0">parse: </span><span class="s1">function </span><span class="s0">parse(components</span><span class="s3">, </span><span class="s0">options) {</span>
        <span class="s8">//report missing host</span>
        <span class="s1">if </span><span class="s0">(!components.host) {</span>
            <span class="s0">components.error = components.error || </span><span class="s2">&quot;HTTP URIs must have a host.&quot;</span><span class="s3">;</span>
        <span class="s0">}</span>
        <span class="s1">return </span><span class="s0">components</span><span class="s3">;</span>
    <span class="s0">}</span><span class="s3">,</span>
    <span class="s0">serialize: </span><span class="s1">function </span><span class="s0">serialize(components</span><span class="s3">, </span><span class="s0">options) {</span>
        <span class="s1">var </span><span class="s0">secure = String(components.scheme).toLowerCase() === </span><span class="s2">&quot;https&quot;</span><span class="s3">;</span>
        <span class="s8">//normalize the default port</span>
        <span class="s1">if </span><span class="s0">(components.port === (secure ? </span><span class="s4">443 </span><span class="s0">: </span><span class="s4">80</span><span class="s0">) || components.port === </span><span class="s2">&quot;&quot;</span><span class="s0">) {</span>
            <span class="s0">components.port = undefined</span><span class="s3">;</span>
        <span class="s0">}</span>
        <span class="s8">//normalize the empty path</span>
        <span class="s1">if </span><span class="s0">(!components.path) {</span>
            <span class="s0">components.path = </span><span class="s2">&quot;/&quot;</span><span class="s3">;</span>
        <span class="s0">}</span>
        <span class="s8">//NOTE: We do not parse query strings for HTTP URIs</span>
        <span class="s8">//as WWW Form Url Encoded query strings are part of the HTML4+ spec,</span>
        <span class="s8">//and not the HTTP spec.</span>
        <span class="s1">return </span><span class="s0">components</span><span class="s3">;</span>
    <span class="s0">}</span>
<span class="s0">}</span><span class="s3">;</span>

<span class="s1">var </span><span class="s0">handler$1 = {</span>
    <span class="s0">scheme: </span><span class="s2">&quot;https&quot;</span><span class="s3">,</span>
    <span class="s0">domainHost: handler.domainHost</span><span class="s3">,</span>
    <span class="s0">parse: handler.parse</span><span class="s3">,</span>
    <span class="s0">serialize: handler.serialize</span>
<span class="s0">}</span><span class="s3">;</span>

<span class="s1">function </span><span class="s0">isSecure(wsComponents) {</span>
    <span class="s1">return typeof </span><span class="s0">wsComponents.secure === </span><span class="s2">'boolean' </span><span class="s0">? wsComponents.secure : String(wsComponents.scheme).toLowerCase() === </span><span class="s2">&quot;wss&quot;</span><span class="s3">;</span>
<span class="s0">}</span>
<span class="s8">//RFC 6455</span>
<span class="s1">var </span><span class="s0">handler$2 = {</span>
    <span class="s0">scheme: </span><span class="s2">&quot;ws&quot;</span><span class="s3">,</span>
    <span class="s0">domainHost: </span><span class="s1">true</span><span class="s3">,</span>
    <span class="s0">parse: </span><span class="s1">function </span><span class="s0">parse(components</span><span class="s3">, </span><span class="s0">options) {</span>
        <span class="s1">var </span><span class="s0">wsComponents = components</span><span class="s3">;</span>
        <span class="s8">//indicate if the secure flag is set</span>
        <span class="s0">wsComponents.secure = isSecure(wsComponents)</span><span class="s3">;</span>
        <span class="s8">//construct resouce name</span>
        <span class="s0">wsComponents.resourceName = (wsComponents.path || </span><span class="s2">'/'</span><span class="s0">) + (wsComponents.query ? </span><span class="s2">'?' </span><span class="s0">+ wsComponents.query : </span><span class="s2">''</span><span class="s0">)</span><span class="s3">;</span>
        <span class="s0">wsComponents.path = undefined</span><span class="s3">;</span>
        <span class="s0">wsComponents.query = undefined</span><span class="s3">;</span>
        <span class="s1">return </span><span class="s0">wsComponents</span><span class="s3">;</span>
    <span class="s0">}</span><span class="s3">,</span>
    <span class="s0">serialize: </span><span class="s1">function </span><span class="s0">serialize(wsComponents</span><span class="s3">, </span><span class="s0">options) {</span>
        <span class="s8">//normalize the default port</span>
        <span class="s1">if </span><span class="s0">(wsComponents.port === (isSecure(wsComponents) ? </span><span class="s4">443 </span><span class="s0">: </span><span class="s4">80</span><span class="s0">) || wsComponents.port === </span><span class="s2">&quot;&quot;</span><span class="s0">) {</span>
            <span class="s0">wsComponents.port = undefined</span><span class="s3">;</span>
        <span class="s0">}</span>
        <span class="s8">//ensure scheme matches secure flag</span>
        <span class="s1">if </span><span class="s0">(</span><span class="s1">typeof </span><span class="s0">wsComponents.secure === </span><span class="s2">'boolean'</span><span class="s0">) {</span>
            <span class="s0">wsComponents.scheme = wsComponents.secure ? </span><span class="s2">'wss' </span><span class="s0">: </span><span class="s2">'ws'</span><span class="s3">;</span>
            <span class="s0">wsComponents.secure = undefined</span><span class="s3">;</span>
        <span class="s0">}</span>
        <span class="s8">//reconstruct path from resource name</span>
        <span class="s1">if </span><span class="s0">(wsComponents.resourceName) {</span>
            <span class="s1">var </span><span class="s0">_wsComponents$resourc = wsComponents.resourceName.split(</span><span class="s2">'?'</span><span class="s0">)</span><span class="s3">,</span>
                <span class="s0">_wsComponents$resourc2 = slicedToArray(_wsComponents$resourc</span><span class="s3">, </span><span class="s4">2</span><span class="s0">)</span><span class="s3">,</span>
                <span class="s0">path = _wsComponents$resourc2[</span><span class="s4">0</span><span class="s0">]</span><span class="s3">,</span>
                <span class="s0">query = _wsComponents$resourc2[</span><span class="s4">1</span><span class="s0">]</span><span class="s3">;</span>

            <span class="s0">wsComponents.path = path &amp;&amp; path !== </span><span class="s2">'/' </span><span class="s0">? path : undefined</span><span class="s3">;</span>
            <span class="s0">wsComponents.query = query</span><span class="s3">;</span>
            <span class="s0">wsComponents.resourceName = undefined</span><span class="s3">;</span>
        <span class="s0">}</span>
        <span class="s8">//forbid fragment component</span>
        <span class="s0">wsComponents.fragment = undefined</span><span class="s3">;</span>
        <span class="s1">return </span><span class="s0">wsComponents</span><span class="s3">;</span>
    <span class="s0">}</span>
<span class="s0">}</span><span class="s3">;</span>

<span class="s1">var </span><span class="s0">handler$3 = {</span>
    <span class="s0">scheme: </span><span class="s2">&quot;wss&quot;</span><span class="s3">,</span>
    <span class="s0">domainHost: handler$2.domainHost</span><span class="s3">,</span>
    <span class="s0">parse: handler$2.parse</span><span class="s3">,</span>
    <span class="s0">serialize: handler$2.serialize</span>
<span class="s0">}</span><span class="s3">;</span>

<span class="s1">var </span><span class="s0">O = {}</span><span class="s3">;</span>
<span class="s1">var </span><span class="s0">isIRI = </span><span class="s1">true</span><span class="s3">;</span>
<span class="s8">//RFC 3986</span>
<span class="s1">var </span><span class="s0">UNRESERVED$$ = </span><span class="s2">&quot;[A-Za-z0-9</span><span class="s3">\\</span><span class="s2">-</span><span class="s3">\\</span><span class="s2">.</span><span class="s3">\\</span><span class="s2">_</span><span class="s3">\\</span><span class="s2">~&quot; </span><span class="s0">+ (isIRI ? </span><span class="s2">&quot;</span><span class="s3">\\</span><span class="s2">xA0-</span><span class="s3">\\</span><span class="s2">u200D</span><span class="s3">\\</span><span class="s2">u2010-</span><span class="s3">\\</span><span class="s2">u2029</span><span class="s3">\\</span><span class="s2">u202F-</span><span class="s3">\\</span><span class="s2">uD7FF</span><span class="s3">\\</span><span class="s2">uF900-</span><span class="s3">\\</span><span class="s2">uFDCF</span><span class="s3">\\</span><span class="s2">uFDF0-</span><span class="s3">\\</span><span class="s2">uFFEF&quot; </span><span class="s0">: </span><span class="s2">&quot;&quot;</span><span class="s0">) + </span><span class="s2">&quot;]&quot;</span><span class="s3">;</span>
<span class="s1">var </span><span class="s0">HEXDIG$$ = </span><span class="s2">&quot;[0-9A-Fa-f]&quot;</span><span class="s3">; </span><span class="s8">//case-insensitive</span>
<span class="s1">var </span><span class="s0">PCT_ENCODED$ = subexp(subexp(</span><span class="s2">&quot;%[EFef]&quot; </span><span class="s0">+ HEXDIG$$ + </span><span class="s2">&quot;%&quot; </span><span class="s0">+ HEXDIG$$ + HEXDIG$$ + </span><span class="s2">&quot;%&quot; </span><span class="s0">+ HEXDIG$$ + HEXDIG$$) + </span><span class="s2">&quot;|&quot; </span><span class="s0">+ subexp(</span><span class="s2">&quot;%[89A-Fa-f]&quot; </span><span class="s0">+ HEXDIG$$ + </span><span class="s2">&quot;%&quot; </span><span class="s0">+ HEXDIG$$ + HEXDIG$$) + </span><span class="s2">&quot;|&quot; </span><span class="s0">+ subexp(</span><span class="s2">&quot;%&quot; </span><span class="s0">+ HEXDIG$$ + HEXDIG$$))</span><span class="s3">; </span><span class="s8">//expanded</span>
<span class="s8">//RFC 5322, except these symbols as per RFC 6068: @ : / ? # [ ] &amp; ; =</span>
<span class="s8">//const ATEXT$$ = &quot;[A-Za-z0-9\\!\\#\\$\\%\\&amp;\\'\\*\\+\\-\\/\\=\\?\\^\\_\\`\\{\\|\\}\\~]&quot;;</span>
<span class="s8">//const WSP$$ = &quot;[\\x20\\x09]&quot;;</span>
<span class="s8">//const OBS_QTEXT$$ = &quot;[\\x01-\\x08\\x0B\\x0C\\x0E-\\x1F\\x7F]&quot;;  //(%d1-8 / %d11-12 / %d14-31 / %d127)</span>
<span class="s8">//const QTEXT$$ = merge(&quot;[\\x21\\x23-\\x5B\\x5D-\\x7E]&quot;, OBS_QTEXT$$);  //%d33 / %d35-91 / %d93-126 / obs-qtext</span>
<span class="s8">//const VCHAR$$ = &quot;[\\x21-\\x7E]&quot;;</span>
<span class="s8">//const WSP$$ = &quot;[\\x20\\x09]&quot;;</span>
<span class="s8">//const OBS_QP$ = subexp(&quot;\\\\&quot; + merge(&quot;[\\x00\\x0D\\x0A]&quot;, OBS_QTEXT$$));  //%d0 / CR / LF / obs-qtext</span>
<span class="s8">//const FWS$ = subexp(subexp(WSP$$ + &quot;*&quot; + &quot;\\x0D\\x0A&quot;) + &quot;?&quot; + WSP$$ + &quot;+&quot;);</span>
<span class="s8">//const QUOTED_PAIR$ = subexp(subexp(&quot;\\\\&quot; + subexp(VCHAR$$ + &quot;|&quot; + WSP$$)) + &quot;|&quot; + OBS_QP$);</span>
<span class="s8">//const QUOTED_STRING$ = subexp('\\&quot;' + subexp(FWS$ + &quot;?&quot; + QCONTENT$) + &quot;*&quot; + FWS$ + &quot;?&quot; + '\\&quot;');</span>
<span class="s1">var </span><span class="s0">ATEXT$$ = </span><span class="s2">&quot;[A-Za-z0-9</span><span class="s3">\\</span><span class="s2">!</span><span class="s3">\\</span><span class="s2">$</span><span class="s3">\\</span><span class="s2">%</span><span class="s3">\\</span><span class="s2">'</span><span class="s3">\\</span><span class="s2">*</span><span class="s3">\\</span><span class="s2">+</span><span class="s3">\\</span><span class="s2">-</span><span class="s3">\\</span><span class="s2">^</span><span class="s3">\\</span><span class="s2">_</span><span class="s3">\\</span><span class="s2">`</span><span class="s3">\\</span><span class="s2">{</span><span class="s3">\\</span><span class="s2">|</span><span class="s3">\\</span><span class="s2">}</span><span class="s3">\\</span><span class="s2">~]&quot;</span><span class="s3">;</span>
<span class="s1">var </span><span class="s0">QTEXT$$ = </span><span class="s2">&quot;[</span><span class="s3">\\</span><span class="s2">!</span><span class="s3">\\</span><span class="s2">$</span><span class="s3">\\</span><span class="s2">%</span><span class="s3">\\</span><span class="s2">'</span><span class="s3">\\</span><span class="s2">(</span><span class="s3">\\</span><span class="s2">)</span><span class="s3">\\</span><span class="s2">*</span><span class="s3">\\</span><span class="s2">+</span><span class="s3">\\</span><span class="s2">,</span><span class="s3">\\</span><span class="s2">-</span><span class="s3">\\</span><span class="s2">.0-9</span><span class="s3">\\</span><span class="s2">&lt;</span><span class="s3">\\</span><span class="s2">&gt;A-Z</span><span class="s3">\\</span><span class="s2">x5E-</span><span class="s3">\\</span><span class="s2">x7E]&quot;</span><span class="s3">;</span>
<span class="s1">var </span><span class="s0">VCHAR$$ = merge(QTEXT$$</span><span class="s3">, </span><span class="s2">&quot;[</span><span class="s3">\\\&quot;\\\\</span><span class="s2">]&quot;</span><span class="s0">)</span><span class="s3">;</span>
<span class="s1">var </span><span class="s0">SOME_DELIMS$$ = </span><span class="s2">&quot;[</span><span class="s3">\\</span><span class="s2">!</span><span class="s3">\\</span><span class="s2">$</span><span class="s3">\\</span><span class="s2">'</span><span class="s3">\\</span><span class="s2">(</span><span class="s3">\\</span><span class="s2">)</span><span class="s3">\\</span><span class="s2">*</span><span class="s3">\\</span><span class="s2">+</span><span class="s3">\\</span><span class="s2">,</span><span class="s3">\\</span><span class="s2">;</span><span class="s3">\\</span><span class="s2">:</span><span class="s3">\\</span><span class="s2">@]&quot;</span><span class="s3">;</span>
<span class="s1">var </span><span class="s0">UNRESERVED = </span><span class="s1">new </span><span class="s0">RegExp(UNRESERVED$$</span><span class="s3">, </span><span class="s2">&quot;g&quot;</span><span class="s0">)</span><span class="s3">;</span>
<span class="s1">var </span><span class="s0">PCT_ENCODED = </span><span class="s1">new </span><span class="s0">RegExp(PCT_ENCODED$</span><span class="s3">, </span><span class="s2">&quot;g&quot;</span><span class="s0">)</span><span class="s3">;</span>
<span class="s1">var </span><span class="s0">NOT_LOCAL_PART = </span><span class="s1">new </span><span class="s0">RegExp(merge(</span><span class="s2">&quot;[^]&quot;</span><span class="s3">, </span><span class="s0">ATEXT$$</span><span class="s3">, </span><span class="s2">&quot;[</span><span class="s3">\\</span><span class="s2">.]&quot;</span><span class="s3">, </span><span class="s2">'[</span><span class="s3">\\</span><span class="s2">&quot;]'</span><span class="s3">, </span><span class="s0">VCHAR$$)</span><span class="s3">, </span><span class="s2">&quot;g&quot;</span><span class="s0">)</span><span class="s3">;</span>
<span class="s1">var </span><span class="s0">NOT_HFNAME = </span><span class="s1">new </span><span class="s0">RegExp(merge(</span><span class="s2">&quot;[^]&quot;</span><span class="s3">, </span><span class="s0">UNRESERVED$$</span><span class="s3">, </span><span class="s0">SOME_DELIMS$$)</span><span class="s3">, </span><span class="s2">&quot;g&quot;</span><span class="s0">)</span><span class="s3">;</span>
<span class="s1">var </span><span class="s0">NOT_HFVALUE = NOT_HFNAME</span><span class="s3">;</span>
<span class="s1">function </span><span class="s0">decodeUnreserved(str) {</span>
    <span class="s1">var </span><span class="s0">decStr = pctDecChars(str)</span><span class="s3">;</span>
    <span class="s1">return </span><span class="s0">!decStr.match(UNRESERVED) ? str : decStr</span><span class="s3">;</span>
<span class="s0">}</span>
<span class="s1">var </span><span class="s0">handler$4 = {</span>
    <span class="s0">scheme: </span><span class="s2">&quot;mailto&quot;</span><span class="s3">,</span>
    <span class="s0">parse: </span><span class="s1">function </span><span class="s0">parse$$1(components</span><span class="s3">, </span><span class="s0">options) {</span>
        <span class="s1">var </span><span class="s0">mailtoComponents = components</span><span class="s3">;</span>
        <span class="s1">var </span><span class="s0">to = mailtoComponents.to = mailtoComponents.path ? mailtoComponents.path.split(</span><span class="s2">&quot;,&quot;</span><span class="s0">) : []</span><span class="s3">;</span>
        <span class="s0">mailtoComponents.path = undefined</span><span class="s3">;</span>
        <span class="s1">if </span><span class="s0">(mailtoComponents.query) {</span>
            <span class="s1">var </span><span class="s0">unknownHeaders = </span><span class="s1">false</span><span class="s3">;</span>
            <span class="s1">var </span><span class="s0">headers = {}</span><span class="s3">;</span>
            <span class="s1">var </span><span class="s0">hfields = mailtoComponents.query.split(</span><span class="s2">&quot;&amp;&quot;</span><span class="s0">)</span><span class="s3">;</span>
            <span class="s1">for </span><span class="s0">(</span><span class="s1">var </span><span class="s0">x = </span><span class="s4">0</span><span class="s3">, </span><span class="s0">xl = hfields.length</span><span class="s3">; </span><span class="s0">x &lt; xl</span><span class="s3">; </span><span class="s0">++x) {</span>
                <span class="s1">var </span><span class="s0">hfield = hfields[x].split(</span><span class="s2">&quot;=&quot;</span><span class="s0">)</span><span class="s3">;</span>
                <span class="s1">switch </span><span class="s0">(hfield[</span><span class="s4">0</span><span class="s0">]) {</span>
                    <span class="s1">case </span><span class="s2">&quot;to&quot;</span><span class="s0">:</span>
                        <span class="s1">var </span><span class="s0">toAddrs = hfield[</span><span class="s4">1</span><span class="s0">].split(</span><span class="s2">&quot;,&quot;</span><span class="s0">)</span><span class="s3">;</span>
                        <span class="s1">for </span><span class="s0">(</span><span class="s1">var </span><span class="s0">_x = </span><span class="s4">0</span><span class="s3">, </span><span class="s0">_xl = toAddrs.length</span><span class="s3">; </span><span class="s0">_x &lt; _xl</span><span class="s3">; </span><span class="s0">++_x) {</span>
                            <span class="s0">to.push(toAddrs[_x])</span><span class="s3">;</span>
                        <span class="s0">}</span>
                        <span class="s1">break</span><span class="s3">;</span>
                    <span class="s1">case </span><span class="s2">&quot;subject&quot;</span><span class="s0">:</span>
                        <span class="s0">mailtoComponents.subject = unescapeComponent(hfield[</span><span class="s4">1</span><span class="s0">]</span><span class="s3">, </span><span class="s0">options)</span><span class="s3">;</span>
                        <span class="s1">break</span><span class="s3">;</span>
                    <span class="s1">case </span><span class="s2">&quot;body&quot;</span><span class="s0">:</span>
                        <span class="s0">mailtoComponents.body = unescapeComponent(hfield[</span><span class="s4">1</span><span class="s0">]</span><span class="s3">, </span><span class="s0">options)</span><span class="s3">;</span>
                        <span class="s1">break</span><span class="s3">;</span>
                    <span class="s1">default</span><span class="s0">:</span>
                        <span class="s0">unknownHeaders = </span><span class="s1">true</span><span class="s3">;</span>
                        <span class="s0">headers[unescapeComponent(hfield[</span><span class="s4">0</span><span class="s0">]</span><span class="s3">, </span><span class="s0">options)] = unescapeComponent(hfield[</span><span class="s4">1</span><span class="s0">]</span><span class="s3">, </span><span class="s0">options)</span><span class="s3">;</span>
                        <span class="s1">break</span><span class="s3">;</span>
                <span class="s0">}</span>
            <span class="s0">}</span>
            <span class="s1">if </span><span class="s0">(unknownHeaders) mailtoComponents.headers = headers</span><span class="s3">;</span>
        <span class="s0">}</span>
        <span class="s0">mailtoComponents.query = undefined</span><span class="s3">;</span>
        <span class="s1">for </span><span class="s0">(</span><span class="s1">var </span><span class="s0">_x2 = </span><span class="s4">0</span><span class="s3">, </span><span class="s0">_xl2 = to.length</span><span class="s3">; </span><span class="s0">_x2 &lt; _xl2</span><span class="s3">; </span><span class="s0">++_x2) {</span>
            <span class="s1">var </span><span class="s0">addr = to[_x2].split(</span><span class="s2">&quot;@&quot;</span><span class="s0">)</span><span class="s3">;</span>
            <span class="s0">addr[</span><span class="s4">0</span><span class="s0">] = unescapeComponent(addr[</span><span class="s4">0</span><span class="s0">])</span><span class="s3">;</span>
            <span class="s1">if </span><span class="s0">(!options.unicodeSupport) {</span>
                <span class="s8">//convert Unicode IDN -&gt; ASCII IDN</span>
                <span class="s1">try </span><span class="s0">{</span>
                    <span class="s0">addr[</span><span class="s4">1</span><span class="s0">] = punycode.toASCII(unescapeComponent(addr[</span><span class="s4">1</span><span class="s0">]</span><span class="s3">, </span><span class="s0">options).toLowerCase())</span><span class="s3">;</span>
                <span class="s0">} </span><span class="s1">catch </span><span class="s0">(e) {</span>
                    <span class="s0">mailtoComponents.error = mailtoComponents.error || </span><span class="s2">&quot;Email address's domain name can not be converted to ASCII via punycode: &quot; </span><span class="s0">+ e</span><span class="s3">;</span>
                <span class="s0">}</span>
            <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
                <span class="s0">addr[</span><span class="s4">1</span><span class="s0">] = unescapeComponent(addr[</span><span class="s4">1</span><span class="s0">]</span><span class="s3">, </span><span class="s0">options).toLowerCase()</span><span class="s3">;</span>
            <span class="s0">}</span>
            <span class="s0">to[_x2] = addr.join(</span><span class="s2">&quot;@&quot;</span><span class="s0">)</span><span class="s3">;</span>
        <span class="s0">}</span>
        <span class="s1">return </span><span class="s0">mailtoComponents</span><span class="s3">;</span>
    <span class="s0">}</span><span class="s3">,</span>
    <span class="s0">serialize: </span><span class="s1">function </span><span class="s0">serialize$$1(mailtoComponents</span><span class="s3">, </span><span class="s0">options) {</span>
        <span class="s1">var </span><span class="s0">components = mailtoComponents</span><span class="s3">;</span>
        <span class="s1">var </span><span class="s0">to = toArray(mailtoComponents.to)</span><span class="s3">;</span>
        <span class="s1">if </span><span class="s0">(to) {</span>
            <span class="s1">for </span><span class="s0">(</span><span class="s1">var </span><span class="s0">x = </span><span class="s4">0</span><span class="s3">, </span><span class="s0">xl = to.length</span><span class="s3">; </span><span class="s0">x &lt; xl</span><span class="s3">; </span><span class="s0">++x) {</span>
                <span class="s1">var </span><span class="s0">toAddr = String(to[x])</span><span class="s3">;</span>
                <span class="s1">var </span><span class="s0">atIdx = toAddr.lastIndexOf(</span><span class="s2">&quot;@&quot;</span><span class="s0">)</span><span class="s3">;</span>
                <span class="s1">var </span><span class="s0">localPart = toAddr.slice(</span><span class="s4">0</span><span class="s3">, </span><span class="s0">atIdx).replace(PCT_ENCODED</span><span class="s3">, </span><span class="s0">decodeUnreserved).replace(PCT_ENCODED</span><span class="s3">, </span><span class="s0">toUpperCase).replace(NOT_LOCAL_PART</span><span class="s3">, </span><span class="s0">pctEncChar)</span><span class="s3">;</span>
                <span class="s1">var </span><span class="s0">domain = toAddr.slice(atIdx + </span><span class="s4">1</span><span class="s0">)</span><span class="s3">;</span>
                <span class="s8">//convert IDN via punycode</span>
                <span class="s1">try </span><span class="s0">{</span>
                    <span class="s0">domain = !options.iri ? punycode.toASCII(unescapeComponent(domain</span><span class="s3">, </span><span class="s0">options).toLowerCase()) : punycode.toUnicode(domain)</span><span class="s3">;</span>
                <span class="s0">} </span><span class="s1">catch </span><span class="s0">(e) {</span>
                    <span class="s0">components.error = components.error || </span><span class="s2">&quot;Email address's domain name can not be converted to &quot; </span><span class="s0">+ (!options.iri ? </span><span class="s2">&quot;ASCII&quot; </span><span class="s0">: </span><span class="s2">&quot;Unicode&quot;</span><span class="s0">) + </span><span class="s2">&quot; via punycode: &quot; </span><span class="s0">+ e</span><span class="s3">;</span>
                <span class="s0">}</span>
                <span class="s0">to[x] = localPart + </span><span class="s2">&quot;@&quot; </span><span class="s0">+ domain</span><span class="s3">;</span>
            <span class="s0">}</span>
            <span class="s0">components.path = to.join(</span><span class="s2">&quot;,&quot;</span><span class="s0">)</span><span class="s3">;</span>
        <span class="s0">}</span>
        <span class="s1">var </span><span class="s0">headers = mailtoComponents.headers = mailtoComponents.headers || {}</span><span class="s3">;</span>
        <span class="s1">if </span><span class="s0">(mailtoComponents.subject) headers[</span><span class="s2">&quot;subject&quot;</span><span class="s0">] = mailtoComponents.subject</span><span class="s3">;</span>
        <span class="s1">if </span><span class="s0">(mailtoComponents.body) headers[</span><span class="s2">&quot;body&quot;</span><span class="s0">] = mailtoComponents.body</span><span class="s3">;</span>
        <span class="s1">var </span><span class="s0">fields = []</span><span class="s3">;</span>
        <span class="s1">for </span><span class="s0">(</span><span class="s1">var </span><span class="s0">name </span><span class="s1">in </span><span class="s0">headers) {</span>
            <span class="s1">if </span><span class="s0">(headers[name] !== O[name]) {</span>
                <span class="s0">fields.push(name.replace(PCT_ENCODED</span><span class="s3">, </span><span class="s0">decodeUnreserved).replace(PCT_ENCODED</span><span class="s3">, </span><span class="s0">toUpperCase).replace(NOT_HFNAME</span><span class="s3">, </span><span class="s0">pctEncChar) + </span><span class="s2">&quot;=&quot; </span><span class="s0">+ headers[name].replace(PCT_ENCODED</span><span class="s3">, </span><span class="s0">decodeUnreserved).replace(PCT_ENCODED</span><span class="s3">, </span><span class="s0">toUpperCase).replace(NOT_HFVALUE</span><span class="s3">, </span><span class="s0">pctEncChar))</span><span class="s3">;</span>
            <span class="s0">}</span>
        <span class="s0">}</span>
        <span class="s1">if </span><span class="s0">(fields.length) {</span>
            <span class="s0">components.query = fields.join(</span><span class="s2">&quot;&amp;&quot;</span><span class="s0">)</span><span class="s3">;</span>
        <span class="s0">}</span>
        <span class="s1">return </span><span class="s0">components</span><span class="s3">;</span>
    <span class="s0">}</span>
<span class="s0">}</span><span class="s3">;</span>

<span class="s1">var </span><span class="s0">URN_PARSE = </span><span class="s4">/^([^\:]+)\:(.*)/</span><span class="s3">;</span>
<span class="s8">//RFC 2141</span>
<span class="s1">var </span><span class="s0">handler$5 = {</span>
    <span class="s0">scheme: </span><span class="s2">&quot;urn&quot;</span><span class="s3">,</span>
    <span class="s0">parse: </span><span class="s1">function </span><span class="s0">parse$$1(components</span><span class="s3">, </span><span class="s0">options) {</span>
        <span class="s1">var </span><span class="s0">matches = components.path &amp;&amp; components.path.match(URN_PARSE)</span><span class="s3">;</span>
        <span class="s1">var </span><span class="s0">urnComponents = components</span><span class="s3">;</span>
        <span class="s1">if </span><span class="s0">(matches) {</span>
            <span class="s1">var </span><span class="s0">scheme = options.scheme || urnComponents.scheme || </span><span class="s2">&quot;urn&quot;</span><span class="s3">;</span>
            <span class="s1">var </span><span class="s0">nid = matches[</span><span class="s4">1</span><span class="s0">].toLowerCase()</span><span class="s3">;</span>
            <span class="s1">var </span><span class="s0">nss = matches[</span><span class="s4">2</span><span class="s0">]</span><span class="s3">;</span>
            <span class="s1">var </span><span class="s0">urnScheme = scheme + </span><span class="s2">&quot;:&quot; </span><span class="s0">+ (options.nid || nid)</span><span class="s3">;</span>
            <span class="s1">var </span><span class="s0">schemeHandler = SCHEMES[urnScheme]</span><span class="s3">;</span>
            <span class="s0">urnComponents.nid = nid</span><span class="s3">;</span>
            <span class="s0">urnComponents.nss = nss</span><span class="s3">;</span>
            <span class="s0">urnComponents.path = undefined</span><span class="s3">;</span>
            <span class="s1">if </span><span class="s0">(schemeHandler) {</span>
                <span class="s0">urnComponents = schemeHandler.parse(urnComponents</span><span class="s3">, </span><span class="s0">options)</span><span class="s3">;</span>
            <span class="s0">}</span>
        <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
            <span class="s0">urnComponents.error = urnComponents.error || </span><span class="s2">&quot;URN can not be parsed.&quot;</span><span class="s3">;</span>
        <span class="s0">}</span>
        <span class="s1">return </span><span class="s0">urnComponents</span><span class="s3">;</span>
    <span class="s0">}</span><span class="s3">,</span>
    <span class="s0">serialize: </span><span class="s1">function </span><span class="s0">serialize$$1(urnComponents</span><span class="s3">, </span><span class="s0">options) {</span>
        <span class="s1">var </span><span class="s0">scheme = options.scheme || urnComponents.scheme || </span><span class="s2">&quot;urn&quot;</span><span class="s3">;</span>
        <span class="s1">var </span><span class="s0">nid = urnComponents.nid</span><span class="s3">;</span>
        <span class="s1">var </span><span class="s0">urnScheme = scheme + </span><span class="s2">&quot;:&quot; </span><span class="s0">+ (options.nid || nid)</span><span class="s3">;</span>
        <span class="s1">var </span><span class="s0">schemeHandler = SCHEMES[urnScheme]</span><span class="s3">;</span>
        <span class="s1">if </span><span class="s0">(schemeHandler) {</span>
            <span class="s0">urnComponents = schemeHandler.serialize(urnComponents</span><span class="s3">, </span><span class="s0">options)</span><span class="s3">;</span>
        <span class="s0">}</span>
        <span class="s1">var </span><span class="s0">uriComponents = urnComponents</span><span class="s3">;</span>
        <span class="s1">var </span><span class="s0">nss = urnComponents.nss</span><span class="s3">;</span>
        <span class="s0">uriComponents.path = (nid || options.nid) + </span><span class="s2">&quot;:&quot; </span><span class="s0">+ nss</span><span class="s3">;</span>
        <span class="s1">return </span><span class="s0">uriComponents</span><span class="s3">;</span>
    <span class="s0">}</span>
<span class="s0">}</span><span class="s3">;</span>

<span class="s1">var </span><span class="s0">UUID = </span><span class="s4">/^[0-9A-Fa-f]{8}(?:\-[0-9A-Fa-f]{4}){3}\-[0-9A-Fa-f]{12}$/</span><span class="s3">;</span>
<span class="s8">//RFC 4122</span>
<span class="s1">var </span><span class="s0">handler$6 = {</span>
    <span class="s0">scheme: </span><span class="s2">&quot;urn:uuid&quot;</span><span class="s3">,</span>
    <span class="s0">parse: </span><span class="s1">function </span><span class="s0">parse(urnComponents</span><span class="s3">, </span><span class="s0">options) {</span>
        <span class="s1">var </span><span class="s0">uuidComponents = urnComponents</span><span class="s3">;</span>
        <span class="s0">uuidComponents.uuid = uuidComponents.nss</span><span class="s3">;</span>
        <span class="s0">uuidComponents.nss = undefined</span><span class="s3">;</span>
        <span class="s1">if </span><span class="s0">(!options.tolerant &amp;&amp; (!uuidComponents.uuid || !uuidComponents.uuid.match(UUID))) {</span>
            <span class="s0">uuidComponents.error = uuidComponents.error || </span><span class="s2">&quot;UUID is not valid.&quot;</span><span class="s3">;</span>
        <span class="s0">}</span>
        <span class="s1">return </span><span class="s0">uuidComponents</span><span class="s3">;</span>
    <span class="s0">}</span><span class="s3">,</span>
    <span class="s0">serialize: </span><span class="s1">function </span><span class="s0">serialize(uuidComponents</span><span class="s3">, </span><span class="s0">options) {</span>
        <span class="s1">var </span><span class="s0">urnComponents = uuidComponents</span><span class="s3">;</span>
        <span class="s8">//normalize UUID</span>
        <span class="s0">urnComponents.nss = (uuidComponents.uuid || </span><span class="s2">&quot;&quot;</span><span class="s0">).toLowerCase()</span><span class="s3">;</span>
        <span class="s1">return </span><span class="s0">urnComponents</span><span class="s3">;</span>
    <span class="s0">}</span>
<span class="s0">}</span><span class="s3">;</span>

<span class="s0">SCHEMES[handler.scheme] = handler</span><span class="s3">;</span>
<span class="s0">SCHEMES[handler$1.scheme] = handler$1</span><span class="s3">;</span>
<span class="s0">SCHEMES[handler$2.scheme] = handler$2</span><span class="s3">;</span>
<span class="s0">SCHEMES[handler$3.scheme] = handler$3</span><span class="s3">;</span>
<span class="s0">SCHEMES[handler$4.scheme] = handler$4</span><span class="s3">;</span>
<span class="s0">SCHEMES[handler$5.scheme] = handler$5</span><span class="s3">;</span>
<span class="s0">SCHEMES[handler$6.scheme] = handler$6</span><span class="s3">;</span>

<span class="s0">exports.SCHEMES = SCHEMES</span><span class="s3">;</span>
<span class="s0">exports.pctEncChar = pctEncChar</span><span class="s3">;</span>
<span class="s0">exports.pctDecChars = pctDecChars</span><span class="s3">;</span>
<span class="s0">exports.parse = parse</span><span class="s3">;</span>
<span class="s0">exports.removeDotSegments = removeDotSegments</span><span class="s3">;</span>
<span class="s0">exports.serialize = serialize</span><span class="s3">;</span>
<span class="s0">exports.resolveComponents = resolveComponents</span><span class="s3">;</span>
<span class="s0">exports.resolve = resolve</span><span class="s3">;</span>
<span class="s0">exports.normalize = normalize</span><span class="s3">;</span>
<span class="s0">exports.equal = equal</span><span class="s3">;</span>
<span class="s0">exports.escapeComponent = escapeComponent</span><span class="s3">;</span>
<span class="s0">exports.unescapeComponent = unescapeComponent</span><span class="s3">;</span>

<span class="s0">Object.defineProperty(exports</span><span class="s3">, </span><span class="s2">'__esModule'</span><span class="s3">, </span><span class="s0">{ value: </span><span class="s1">true </span><span class="s0">})</span><span class="s3">;</span>

<span class="s0">})))</span><span class="s3">;</span>


<span class="s0">}</span><span class="s3">,</span><span class="s0">{}]</span><span class="s3">,</span><span class="s2">&quot;ajv&quot;</span><span class="s0">:[</span><span class="s1">function</span><span class="s0">(require</span><span class="s3">,</span><span class="s0">module</span><span class="s3">,</span><span class="s0">exports){</span>
<span class="s2">'use strict'</span><span class="s3">;</span>

<span class="s1">var </span><span class="s0">compileSchema = require(</span><span class="s2">'./compile'</span><span class="s0">)</span>
  <span class="s3">, </span><span class="s0">resolve = require(</span><span class="s2">'./compile/resolve'</span><span class="s0">)</span>
  <span class="s3">, </span><span class="s0">Cache = require(</span><span class="s2">'./cache'</span><span class="s0">)</span>
  <span class="s3">, </span><span class="s0">SchemaObject = require(</span><span class="s2">'./compile/schema_obj'</span><span class="s0">)</span>
  <span class="s3">, </span><span class="s0">stableStringify = require(</span><span class="s2">'fast-json-stable-stringify'</span><span class="s0">)</span>
  <span class="s3">, </span><span class="s0">formats = require(</span><span class="s2">'./compile/formats'</span><span class="s0">)</span>
  <span class="s3">, </span><span class="s0">rules = require(</span><span class="s2">'./compile/rules'</span><span class="s0">)</span>
  <span class="s3">, </span><span class="s0">$dataMetaSchema = require(</span><span class="s2">'./data'</span><span class="s0">)</span>
  <span class="s3">, </span><span class="s0">util = require(</span><span class="s2">'./compile/util'</span><span class="s0">)</span><span class="s3">;</span>

<span class="s0">module.exports = Ajv</span><span class="s3">;</span>

<span class="s0">Ajv.prototype.validate = validate</span><span class="s3">;</span>
<span class="s0">Ajv.prototype.compile = compile</span><span class="s3">;</span>
<span class="s0">Ajv.prototype.addSchema = addSchema</span><span class="s3">;</span>
<span class="s0">Ajv.prototype.addMetaSchema = addMetaSchema</span><span class="s3">;</span>
<span class="s0">Ajv.prototype.validateSchema = validateSchema</span><span class="s3">;</span>
<span class="s0">Ajv.prototype.getSchema = getSchema</span><span class="s3">;</span>
<span class="s0">Ajv.prototype.removeSchema = removeSchema</span><span class="s3">;</span>
<span class="s0">Ajv.prototype.addFormat = addFormat</span><span class="s3">;</span>
<span class="s0">Ajv.prototype.errorsText = errorsText</span><span class="s3">;</span>

<span class="s0">Ajv.prototype._addSchema = _addSchema</span><span class="s3">;</span>
<span class="s0">Ajv.prototype._compile = _compile</span><span class="s3">;</span>

<span class="s0">Ajv.prototype.compileAsync = require(</span><span class="s2">'./compile/async'</span><span class="s0">)</span><span class="s3">;</span>
<span class="s1">var </span><span class="s0">customKeyword = require(</span><span class="s2">'./keyword'</span><span class="s0">)</span><span class="s3">;</span>
<span class="s0">Ajv.prototype.addKeyword = customKeyword.add</span><span class="s3">;</span>
<span class="s0">Ajv.prototype.getKeyword = customKeyword.get</span><span class="s3">;</span>
<span class="s0">Ajv.prototype.removeKeyword = customKeyword.remove</span><span class="s3">;</span>
<span class="s0">Ajv.prototype.validateKeyword = customKeyword.validate</span><span class="s3">;</span>

<span class="s1">var </span><span class="s0">errorClasses = require(</span><span class="s2">'./compile/error_classes'</span><span class="s0">)</span><span class="s3">;</span>
<span class="s0">Ajv.ValidationError = errorClasses.Validation</span><span class="s3">;</span>
<span class="s0">Ajv.MissingRefError = errorClasses.MissingRef</span><span class="s3">;</span>
<span class="s0">Ajv.$dataMetaSchema = $dataMetaSchema</span><span class="s3">;</span>

<span class="s1">var </span><span class="s0">META_SCHEMA_ID = </span><span class="s2">'http://json-schema.org/draft-07/schema'</span><span class="s3">;</span>

<span class="s1">var </span><span class="s0">META_IGNORE_OPTIONS = [ </span><span class="s2">'removeAdditional'</span><span class="s3">, </span><span class="s2">'useDefaults'</span><span class="s3">, </span><span class="s2">'coerceTypes'</span><span class="s3">, </span><span class="s2">'strictDefaults' </span><span class="s0">]</span><span class="s3">;</span>
<span class="s1">var </span><span class="s0">META_SUPPORT_DATA = [</span><span class="s2">'/properties'</span><span class="s0">]</span><span class="s3">;</span>

<span class="s5">/**</span>
 <span class="s5">* Creates validator instance.</span>
 <span class="s5">* Usage: `Ajv(opts)`</span>
 <span class="s5">* </span><span class="s6">@param </span><span class="s5">{Object} opts optional options</span>
 <span class="s5">* </span><span class="s6">@return </span><span class="s5">{Object} ajv instance</span>
 <span class="s5">*/</span>
<span class="s1">function </span><span class="s0">Ajv(opts) {</span>
  <span class="s1">if </span><span class="s0">(!(</span><span class="s1">this instanceof </span><span class="s0">Ajv)) </span><span class="s1">return new </span><span class="s0">Ajv(opts)</span><span class="s3">;</span>
  <span class="s0">opts = </span><span class="s1">this</span><span class="s0">._opts = util.copy(opts) || {}</span><span class="s3">;</span>
  <span class="s0">setLogger(</span><span class="s1">this</span><span class="s0">)</span><span class="s3">;</span>
  <span class="s1">this</span><span class="s0">._schemas = {}</span><span class="s3">;</span>
  <span class="s1">this</span><span class="s0">._refs = {}</span><span class="s3">;</span>
  <span class="s1">this</span><span class="s0">._fragments = {}</span><span class="s3">;</span>
  <span class="s1">this</span><span class="s0">._formats = formats(opts.format)</span><span class="s3">;</span>

  <span class="s1">this</span><span class="s0">._cache = opts.cache || </span><span class="s1">new </span><span class="s0">Cache</span><span class="s3">;</span>
  <span class="s1">this</span><span class="s0">._loadingSchemas = {}</span><span class="s3">;</span>
  <span class="s1">this</span><span class="s0">._compilations = []</span><span class="s3">;</span>
  <span class="s1">this</span><span class="s0">.RULES = rules()</span><span class="s3">;</span>
  <span class="s1">this</span><span class="s0">._getId = chooseGetId(opts)</span><span class="s3">;</span>

  <span class="s0">opts.loopRequired = opts.loopRequired || Infinity</span><span class="s3">;</span>
  <span class="s1">if </span><span class="s0">(opts.errorDataPath == </span><span class="s2">'property'</span><span class="s0">) opts._errorDataPathProperty = </span><span class="s1">true</span><span class="s3">;</span>
  <span class="s1">if </span><span class="s0">(opts.serialize === undefined) opts.serialize = stableStringify</span><span class="s3">;</span>
  <span class="s1">this</span><span class="s0">._metaOpts = getMetaSchemaOptions(</span><span class="s1">this</span><span class="s0">)</span><span class="s3">;</span>

  <span class="s1">if </span><span class="s0">(opts.formats) addInitialFormats(</span><span class="s1">this</span><span class="s0">)</span><span class="s3">;</span>
  <span class="s1">if </span><span class="s0">(opts.keywords) addInitialKeywords(</span><span class="s1">this</span><span class="s0">)</span><span class="s3">;</span>
  <span class="s0">addDefaultMetaSchema(</span><span class="s1">this</span><span class="s0">)</span><span class="s3">;</span>
  <span class="s1">if </span><span class="s0">(</span><span class="s1">typeof </span><span class="s0">opts.meta == </span><span class="s2">'object'</span><span class="s0">) </span><span class="s1">this</span><span class="s0">.addMetaSchema(opts.meta)</span><span class="s3">;</span>
  <span class="s1">if </span><span class="s0">(opts.nullable) </span><span class="s1">this</span><span class="s0">.addKeyword(</span><span class="s2">'nullable'</span><span class="s3">, </span><span class="s0">{metaSchema: {type: </span><span class="s2">'boolean'</span><span class="s0">}})</span><span class="s3">;</span>
  <span class="s0">addInitialSchemas(</span><span class="s1">this</span><span class="s0">)</span><span class="s3">;</span>
<span class="s0">}</span>



<span class="s5">/**</span>
 <span class="s5">* Validate data using schema</span>
 <span class="s5">* Schema will be compiled and cached (using serialized JSON as key. [fast-json-stable-stringify](https://github.com/epoberezkin/fast-json-stable-stringify) is used to serialize.</span>
 <span class="s5">* </span><span class="s6">@this   </span><span class="s5">Ajv</span>
 <span class="s5">* </span><span class="s6">@param  </span><span class="s5">{String|Object} schemaKeyRef key, ref or schema object</span>
 <span class="s5">* </span><span class="s6">@param  </span><span class="s5">{Any} data to be validated</span>
 <span class="s5">* </span><span class="s6">@return </span><span class="s5">{Boolean} validation result. Errors from the last validation will be available in `ajv.errors` (and also in compiled schema: `schema.errors`).</span>
 <span class="s5">*/</span>
<span class="s1">function </span><span class="s0">validate(schemaKeyRef</span><span class="s3">, </span><span class="s0">data) {</span>
  <span class="s1">var </span><span class="s0">v</span><span class="s3">;</span>
  <span class="s1">if </span><span class="s0">(</span><span class="s1">typeof </span><span class="s0">schemaKeyRef == </span><span class="s2">'string'</span><span class="s0">) {</span>
    <span class="s0">v = </span><span class="s1">this</span><span class="s0">.getSchema(schemaKeyRef)</span><span class="s3">;</span>
    <span class="s1">if </span><span class="s0">(!v) </span><span class="s1">throw new </span><span class="s0">Error(</span><span class="s2">'no schema with key or ref &quot;' </span><span class="s0">+ schemaKeyRef + </span><span class="s2">'&quot;'</span><span class="s0">)</span><span class="s3">;</span>
  <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
    <span class="s1">var </span><span class="s0">schemaObj = </span><span class="s1">this</span><span class="s0">._addSchema(schemaKeyRef)</span><span class="s3">;</span>
    <span class="s0">v = schemaObj.validate || </span><span class="s1">this</span><span class="s0">._compile(schemaObj)</span><span class="s3">;</span>
  <span class="s0">}</span>

  <span class="s1">var </span><span class="s0">valid = v(data)</span><span class="s3">;</span>
  <span class="s1">if </span><span class="s0">(v.$async !== </span><span class="s1">true</span><span class="s0">) </span><span class="s1">this</span><span class="s0">.errors = v.errors</span><span class="s3">;</span>
  <span class="s1">return </span><span class="s0">valid</span><span class="s3">;</span>
<span class="s0">}</span>


<span class="s5">/**</span>
 <span class="s5">* Create validating function for passed schema.</span>
 <span class="s5">* </span><span class="s6">@this   </span><span class="s5">Ajv</span>
 <span class="s5">* </span><span class="s6">@param  </span><span class="s5">{Object} schema schema object</span>
 <span class="s5">* </span><span class="s6">@param  </span><span class="s5">{Boolean} _meta true if schema is a meta-schema. Used internally to compile meta schemas of custom keywords.</span>
 <span class="s5">* </span><span class="s6">@return </span><span class="s5">{Function} validating function</span>
 <span class="s5">*/</span>
<span class="s1">function </span><span class="s0">compile(schema</span><span class="s3">, </span><span class="s0">_meta) {</span>
  <span class="s1">var </span><span class="s0">schemaObj = </span><span class="s1">this</span><span class="s0">._addSchema(schema</span><span class="s3">, </span><span class="s0">undefined</span><span class="s3">, </span><span class="s0">_meta)</span><span class="s3">;</span>
  <span class="s1">return </span><span class="s0">schemaObj.validate || </span><span class="s1">this</span><span class="s0">._compile(schemaObj)</span><span class="s3">;</span>
<span class="s0">}</span>


<span class="s5">/**</span>
 <span class="s5">* Adds schema to the instance.</span>
 <span class="s5">* </span><span class="s6">@this   </span><span class="s5">Ajv</span>
 <span class="s5">* </span><span class="s6">@param </span><span class="s5">{Object|Array} schema schema or array of schemas. If array is passed, `key` and other parameters will be ignored.</span>
 <span class="s5">* </span><span class="s6">@param </span><span class="s5">{String} key Optional schema key. Can be passed to `validate` method instead of schema object or id/ref. One schema per instance can have empty `id` and `key`.</span>
 <span class="s5">* </span><span class="s6">@param </span><span class="s5">{Boolean} _skipValidation true to skip schema validation. Used internally, option validateSchema should be used instead.</span>
 <span class="s5">* </span><span class="s6">@param </span><span class="s5">{Boolean} _meta true if schema is a meta-schema. Used internally, addMetaSchema should be used instead.</span>
 <span class="s5">* </span><span class="s6">@return </span><span class="s5">{Ajv} this for method chaining</span>
 <span class="s5">*/</span>
<span class="s1">function </span><span class="s0">addSchema(schema</span><span class="s3">, </span><span class="s0">key</span><span class="s3">, </span><span class="s0">_skipValidation</span><span class="s3">, </span><span class="s0">_meta) {</span>
  <span class="s1">if </span><span class="s0">(Array.isArray(schema)){</span>
    <span class="s1">for </span><span class="s0">(</span><span class="s1">var </span><span class="s0">i=</span><span class="s4">0</span><span class="s3">; </span><span class="s0">i&lt;schema.length</span><span class="s3">; </span><span class="s0">i++) </span><span class="s1">this</span><span class="s0">.addSchema(schema[i]</span><span class="s3">, </span><span class="s0">undefined</span><span class="s3">, </span><span class="s0">_skipValidation</span><span class="s3">, </span><span class="s0">_meta)</span><span class="s3">;</span>
    <span class="s1">return this</span><span class="s3">;</span>
  <span class="s0">}</span>
  <span class="s1">var </span><span class="s0">id = </span><span class="s1">this</span><span class="s0">._getId(schema)</span><span class="s3">;</span>
  <span class="s1">if </span><span class="s0">(id !== undefined &amp;&amp; </span><span class="s1">typeof </span><span class="s0">id != </span><span class="s2">'string'</span><span class="s0">)</span>
    <span class="s1">throw new </span><span class="s0">Error(</span><span class="s2">'schema id must be string'</span><span class="s0">)</span><span class="s3">;</span>
  <span class="s0">key = resolve.normalizeId(key || id)</span><span class="s3">;</span>
  <span class="s0">checkUnique(</span><span class="s1">this</span><span class="s3">, </span><span class="s0">key)</span><span class="s3">;</span>
  <span class="s1">this</span><span class="s0">._schemas[key] = </span><span class="s1">this</span><span class="s0">._addSchema(schema</span><span class="s3">, </span><span class="s0">_skipValidation</span><span class="s3">, </span><span class="s0">_meta</span><span class="s3">, </span><span class="s1">true</span><span class="s0">)</span><span class="s3">;</span>
  <span class="s1">return this</span><span class="s3">;</span>
<span class="s0">}</span>


<span class="s5">/**</span>
 <span class="s5">* Add schema that will be used to validate other schemas</span>
 <span class="s5">* options in META_IGNORE_OPTIONS are alway set to false</span>
 <span class="s5">* </span><span class="s6">@this   </span><span class="s5">Ajv</span>
 <span class="s5">* </span><span class="s6">@param </span><span class="s5">{Object} schema schema object</span>
 <span class="s5">* </span><span class="s6">@param </span><span class="s5">{String} key optional schema key</span>
 <span class="s5">* </span><span class="s6">@param </span><span class="s5">{Boolean} skipValidation true to skip schema validation, can be used to override validateSchema option for meta-schema</span>
 <span class="s5">* </span><span class="s6">@return </span><span class="s5">{Ajv} this for method chaining</span>
 <span class="s5">*/</span>
<span class="s1">function </span><span class="s0">addMetaSchema(schema</span><span class="s3">, </span><span class="s0">key</span><span class="s3">, </span><span class="s0">skipValidation) {</span>
  <span class="s1">this</span><span class="s0">.addSchema(schema</span><span class="s3">, </span><span class="s0">key</span><span class="s3">, </span><span class="s0">skipValidation</span><span class="s3">, </span><span class="s1">true</span><span class="s0">)</span><span class="s3">;</span>
  <span class="s1">return this</span><span class="s3">;</span>
<span class="s0">}</span>


<span class="s5">/**</span>
 <span class="s5">* Validate schema</span>
 <span class="s5">* </span><span class="s6">@this   </span><span class="s5">Ajv</span>
 <span class="s5">* </span><span class="s6">@param </span><span class="s5">{Object} schema schema to validate</span>
 <span class="s5">* </span><span class="s6">@param </span><span class="s5">{Boolean} throwOrLogError pass true to throw (or log) an error if invalid</span>
 <span class="s5">* </span><span class="s6">@return </span><span class="s5">{Boolean} true if schema is valid</span>
 <span class="s5">*/</span>
<span class="s1">function </span><span class="s0">validateSchema(schema</span><span class="s3">, </span><span class="s0">throwOrLogError) {</span>
  <span class="s1">var </span><span class="s0">$schema = schema.$schema</span><span class="s3">;</span>
  <span class="s1">if </span><span class="s0">($schema !== undefined &amp;&amp; </span><span class="s1">typeof </span><span class="s0">$schema != </span><span class="s2">'string'</span><span class="s0">)</span>
    <span class="s1">throw new </span><span class="s0">Error(</span><span class="s2">'$schema must be a string'</span><span class="s0">)</span><span class="s3">;</span>
  <span class="s0">$schema = $schema || </span><span class="s1">this</span><span class="s0">._opts.defaultMeta || defaultMeta(</span><span class="s1">this</span><span class="s0">)</span><span class="s3">;</span>
  <span class="s1">if </span><span class="s0">(!$schema) {</span>
    <span class="s1">this</span><span class="s0">.logger.warn(</span><span class="s2">'meta-schema not available'</span><span class="s0">)</span><span class="s3">;</span>
    <span class="s1">this</span><span class="s0">.errors = </span><span class="s1">null</span><span class="s3">;</span>
    <span class="s1">return true</span><span class="s3">;</span>
  <span class="s0">}</span>
  <span class="s1">var </span><span class="s0">valid = </span><span class="s1">this</span><span class="s0">.validate($schema</span><span class="s3">, </span><span class="s0">schema)</span><span class="s3">;</span>
  <span class="s1">if </span><span class="s0">(!valid &amp;&amp; throwOrLogError) {</span>
    <span class="s1">var </span><span class="s0">message = </span><span class="s2">'schema is invalid: ' </span><span class="s0">+ </span><span class="s1">this</span><span class="s0">.errorsText()</span><span class="s3">;</span>
    <span class="s1">if </span><span class="s0">(</span><span class="s1">this</span><span class="s0">._opts.validateSchema == </span><span class="s2">'log'</span><span class="s0">) </span><span class="s1">this</span><span class="s0">.logger.error(message)</span><span class="s3">;</span>
    <span class="s1">else throw new </span><span class="s0">Error(message)</span><span class="s3">;</span>
  <span class="s0">}</span>
  <span class="s1">return </span><span class="s0">valid</span><span class="s3">;</span>
<span class="s0">}</span>


<span class="s1">function </span><span class="s0">defaultMeta(self) {</span>
  <span class="s1">var </span><span class="s0">meta = self._opts.meta</span><span class="s3">;</span>
  <span class="s0">self._opts.defaultMeta = </span><span class="s1">typeof </span><span class="s0">meta == </span><span class="s2">'object'</span>
                            <span class="s0">? self._getId(meta) || meta</span>
                            <span class="s0">: self.getSchema(META_SCHEMA_ID)</span>
                              <span class="s0">? META_SCHEMA_ID</span>
                              <span class="s0">: undefined</span><span class="s3">;</span>
  <span class="s1">return </span><span class="s0">self._opts.defaultMeta</span><span class="s3">;</span>
<span class="s0">}</span>


<span class="s5">/**</span>
 <span class="s5">* Get compiled schema from the instance by `key` or `ref`.</span>
 <span class="s5">* </span><span class="s6">@this   </span><span class="s5">Ajv</span>
 <span class="s5">* </span><span class="s6">@param  </span><span class="s5">{String} keyRef `key` that was passed to `addSchema` or full schema reference (`schema.id` or resolved id).</span>
 <span class="s5">* </span><span class="s6">@return </span><span class="s5">{Function} schema validating function (with property `schema`).</span>
 <span class="s5">*/</span>
<span class="s1">function </span><span class="s0">getSchema(keyRef) {</span>
  <span class="s1">var </span><span class="s0">schemaObj = _getSchemaObj(</span><span class="s1">this</span><span class="s3">, </span><span class="s0">keyRef)</span><span class="s3">;</span>
  <span class="s1">switch </span><span class="s0">(</span><span class="s1">typeof </span><span class="s0">schemaObj) {</span>
    <span class="s1">case </span><span class="s2">'object'</span><span class="s0">: </span><span class="s1">return </span><span class="s0">schemaObj.validate || </span><span class="s1">this</span><span class="s0">._compile(schemaObj)</span><span class="s3">;</span>
    <span class="s1">case </span><span class="s2">'string'</span><span class="s0">: </span><span class="s1">return this</span><span class="s0">.getSchema(schemaObj)</span><span class="s3">;</span>
    <span class="s1">case </span><span class="s2">'undefined'</span><span class="s0">: </span><span class="s1">return </span><span class="s0">_getSchemaFragment(</span><span class="s1">this</span><span class="s3">, </span><span class="s0">keyRef)</span><span class="s3">;</span>
  <span class="s0">}</span>
<span class="s0">}</span>


<span class="s1">function </span><span class="s0">_getSchemaFragment(self</span><span class="s3">, </span><span class="s0">ref) {</span>
  <span class="s1">var </span><span class="s0">res = resolve.schema.call(self</span><span class="s3">, </span><span class="s0">{ schema: {} }</span><span class="s3">, </span><span class="s0">ref)</span><span class="s3">;</span>
  <span class="s1">if </span><span class="s0">(res) {</span>
    <span class="s1">var </span><span class="s0">schema = res.schema</span>
      <span class="s3">, </span><span class="s0">root = res.root</span>
      <span class="s3">, </span><span class="s0">baseId = res.baseId</span><span class="s3">;</span>
    <span class="s1">var </span><span class="s0">v = compileSchema.call(self</span><span class="s3">, </span><span class="s0">schema</span><span class="s3">, </span><span class="s0">root</span><span class="s3">, </span><span class="s0">undefined</span><span class="s3">, </span><span class="s0">baseId)</span><span class="s3">;</span>
    <span class="s0">self._fragments[ref] = </span><span class="s1">new </span><span class="s0">SchemaObject({</span>
      <span class="s0">ref: ref</span><span class="s3">,</span>
      <span class="s0">fragment: </span><span class="s1">true</span><span class="s3">,</span>
      <span class="s0">schema: schema</span><span class="s3">,</span>
      <span class="s0">root: root</span><span class="s3">,</span>
      <span class="s0">baseId: baseId</span><span class="s3">,</span>
      <span class="s0">validate: v</span>
    <span class="s0">})</span><span class="s3">;</span>
    <span class="s1">return </span><span class="s0">v</span><span class="s3">;</span>
  <span class="s0">}</span>
<span class="s0">}</span>


<span class="s1">function </span><span class="s0">_getSchemaObj(self</span><span class="s3">, </span><span class="s0">keyRef) {</span>
  <span class="s0">keyRef = resolve.normalizeId(keyRef)</span><span class="s3">;</span>
  <span class="s1">return </span><span class="s0">self._schemas[keyRef] || self._refs[keyRef] || self._fragments[keyRef]</span><span class="s3">;</span>
<span class="s0">}</span>


<span class="s5">/**</span>
 <span class="s5">* Remove cached schema(s).</span>
 <span class="s5">* If no parameter is passed all schemas but meta-schemas are removed.</span>
 <span class="s5">* If RegExp is passed all schemas with key/id matching pattern but meta-schemas are removed.</span>
 <span class="s5">* Even if schema is referenced by other schemas it still can be removed as other schemas have local references.</span>
 <span class="s5">* </span><span class="s6">@this   </span><span class="s5">Ajv</span>
 <span class="s5">* </span><span class="s6">@param  </span><span class="s5">{String|Object|RegExp} schemaKeyRef key, ref, pattern to match key/ref or schema object</span>
 <span class="s5">* </span><span class="s6">@return </span><span class="s5">{Ajv} this for method chaining</span>
 <span class="s5">*/</span>
<span class="s1">function </span><span class="s0">removeSchema(schemaKeyRef) {</span>
  <span class="s1">if </span><span class="s0">(schemaKeyRef </span><span class="s1">instanceof </span><span class="s0">RegExp) {</span>
    <span class="s0">_removeAllSchemas(</span><span class="s1">this</span><span class="s3">, </span><span class="s1">this</span><span class="s0">._schemas</span><span class="s3">, </span><span class="s0">schemaKeyRef)</span><span class="s3">;</span>
    <span class="s0">_removeAllSchemas(</span><span class="s1">this</span><span class="s3">, </span><span class="s1">this</span><span class="s0">._refs</span><span class="s3">, </span><span class="s0">schemaKeyRef)</span><span class="s3">;</span>
    <span class="s1">return this</span><span class="s3">;</span>
  <span class="s0">}</span>
  <span class="s1">switch </span><span class="s0">(</span><span class="s1">typeof </span><span class="s0">schemaKeyRef) {</span>
    <span class="s1">case </span><span class="s2">'undefined'</span><span class="s0">:</span>
      <span class="s0">_removeAllSchemas(</span><span class="s1">this</span><span class="s3">, </span><span class="s1">this</span><span class="s0">._schemas)</span><span class="s3">;</span>
      <span class="s0">_removeAllSchemas(</span><span class="s1">this</span><span class="s3">, </span><span class="s1">this</span><span class="s0">._refs)</span><span class="s3">;</span>
      <span class="s1">this</span><span class="s0">._cache.clear()</span><span class="s3">;</span>
      <span class="s1">return this</span><span class="s3">;</span>
    <span class="s1">case </span><span class="s2">'string'</span><span class="s0">:</span>
      <span class="s1">var </span><span class="s0">schemaObj = _getSchemaObj(</span><span class="s1">this</span><span class="s3">, </span><span class="s0">schemaKeyRef)</span><span class="s3">;</span>
      <span class="s1">if </span><span class="s0">(schemaObj) </span><span class="s1">this</span><span class="s0">._cache.del(schemaObj.cacheKey)</span><span class="s3">;</span>
      <span class="s1">delete this</span><span class="s0">._schemas[schemaKeyRef]</span><span class="s3">;</span>
      <span class="s1">delete this</span><span class="s0">._refs[schemaKeyRef]</span><span class="s3">;</span>
      <span class="s1">return this</span><span class="s3">;</span>
    <span class="s1">case </span><span class="s2">'object'</span><span class="s0">:</span>
      <span class="s1">var </span><span class="s0">serialize = </span><span class="s1">this</span><span class="s0">._opts.serialize</span><span class="s3">;</span>
      <span class="s1">var </span><span class="s0">cacheKey = serialize ? serialize(schemaKeyRef) : schemaKeyRef</span><span class="s3">;</span>
      <span class="s1">this</span><span class="s0">._cache.del(cacheKey)</span><span class="s3">;</span>
      <span class="s1">var </span><span class="s0">id = </span><span class="s1">this</span><span class="s0">._getId(schemaKeyRef)</span><span class="s3">;</span>
      <span class="s1">if </span><span class="s0">(id) {</span>
        <span class="s0">id = resolve.normalizeId(id)</span><span class="s3">;</span>
        <span class="s1">delete this</span><span class="s0">._schemas[id]</span><span class="s3">;</span>
        <span class="s1">delete this</span><span class="s0">._refs[id]</span><span class="s3">;</span>
      <span class="s0">}</span>
  <span class="s0">}</span>
  <span class="s1">return this</span><span class="s3">;</span>
<span class="s0">}</span>


<span class="s1">function </span><span class="s0">_removeAllSchemas(self</span><span class="s3">, </span><span class="s0">schemas</span><span class="s3">, </span><span class="s0">regex) {</span>
  <span class="s1">for </span><span class="s0">(</span><span class="s1">var </span><span class="s0">keyRef </span><span class="s1">in </span><span class="s0">schemas) {</span>
    <span class="s1">var </span><span class="s0">schemaObj = schemas[keyRef]</span><span class="s3">;</span>
    <span class="s1">if </span><span class="s0">(!schemaObj.meta &amp;&amp; (!regex || regex.test(keyRef))) {</span>
      <span class="s0">self._cache.del(schemaObj.cacheKey)</span><span class="s3">;</span>
      <span class="s1">delete </span><span class="s0">schemas[keyRef]</span><span class="s3">;</span>
    <span class="s0">}</span>
  <span class="s0">}</span>
<span class="s0">}</span>


<span class="s7">/* @this   Ajv */</span>
<span class="s1">function </span><span class="s0">_addSchema(schema</span><span class="s3">, </span><span class="s0">skipValidation</span><span class="s3">, </span><span class="s0">meta</span><span class="s3">, </span><span class="s0">shouldAddSchema) {</span>
  <span class="s1">if </span><span class="s0">(</span><span class="s1">typeof </span><span class="s0">schema != </span><span class="s2">'object' </span><span class="s0">&amp;&amp; </span><span class="s1">typeof </span><span class="s0">schema != </span><span class="s2">'boolean'</span><span class="s0">)</span>
    <span class="s1">throw new </span><span class="s0">Error(</span><span class="s2">'schema should be object or boolean'</span><span class="s0">)</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">serialize = </span><span class="s1">this</span><span class="s0">._opts.serialize</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">cacheKey = serialize ? serialize(schema) : schema</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">cached = </span><span class="s1">this</span><span class="s0">._cache.get(cacheKey)</span><span class="s3">;</span>
  <span class="s1">if </span><span class="s0">(cached) </span><span class="s1">return </span><span class="s0">cached</span><span class="s3">;</span>

  <span class="s0">shouldAddSchema = shouldAddSchema || </span><span class="s1">this</span><span class="s0">._opts.addUsedSchema !== </span><span class="s1">false</span><span class="s3">;</span>

  <span class="s1">var </span><span class="s0">id = resolve.normalizeId(</span><span class="s1">this</span><span class="s0">._getId(schema))</span><span class="s3">;</span>
  <span class="s1">if </span><span class="s0">(id &amp;&amp; shouldAddSchema) checkUnique(</span><span class="s1">this</span><span class="s3">, </span><span class="s0">id)</span><span class="s3">;</span>

  <span class="s1">var </span><span class="s0">willValidate = </span><span class="s1">this</span><span class="s0">._opts.validateSchema !== </span><span class="s1">false </span><span class="s0">&amp;&amp; !skipValidation</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">recursiveMeta</span><span class="s3">;</span>
  <span class="s1">if </span><span class="s0">(willValidate &amp;&amp; !(recursiveMeta = id &amp;&amp; id == resolve.normalizeId(schema.$schema)))</span>
    <span class="s1">this</span><span class="s0">.validateSchema(schema</span><span class="s3">, </span><span class="s1">true</span><span class="s0">)</span><span class="s3">;</span>

  <span class="s1">var </span><span class="s0">localRefs = resolve.ids.call(</span><span class="s1">this</span><span class="s3">, </span><span class="s0">schema)</span><span class="s3">;</span>

  <span class="s1">var </span><span class="s0">schemaObj = </span><span class="s1">new </span><span class="s0">SchemaObject({</span>
    <span class="s0">id: id</span><span class="s3">,</span>
    <span class="s0">schema: schema</span><span class="s3">,</span>
    <span class="s0">localRefs: localRefs</span><span class="s3">,</span>
    <span class="s0">cacheKey: cacheKey</span><span class="s3">,</span>
    <span class="s0">meta: meta</span>
  <span class="s0">})</span><span class="s3">;</span>

  <span class="s1">if </span><span class="s0">(id[</span><span class="s4">0</span><span class="s0">] != </span><span class="s2">'#' </span><span class="s0">&amp;&amp; shouldAddSchema) </span><span class="s1">this</span><span class="s0">._refs[id] = schemaObj</span><span class="s3">;</span>
  <span class="s1">this</span><span class="s0">._cache.put(cacheKey</span><span class="s3">, </span><span class="s0">schemaObj)</span><span class="s3">;</span>

  <span class="s1">if </span><span class="s0">(willValidate &amp;&amp; recursiveMeta) </span><span class="s1">this</span><span class="s0">.validateSchema(schema</span><span class="s3">, </span><span class="s1">true</span><span class="s0">)</span><span class="s3">;</span>

  <span class="s1">return </span><span class="s0">schemaObj</span><span class="s3">;</span>
<span class="s0">}</span>


<span class="s7">/* @this   Ajv */</span>
<span class="s1">function </span><span class="s0">_compile(schemaObj</span><span class="s3">, </span><span class="s0">root) {</span>
  <span class="s1">if </span><span class="s0">(schemaObj.compiling) {</span>
    <span class="s0">schemaObj.validate = callValidate</span><span class="s3">;</span>
    <span class="s0">callValidate.schema = schemaObj.schema</span><span class="s3">;</span>
    <span class="s0">callValidate.errors = </span><span class="s1">null</span><span class="s3">;</span>
    <span class="s0">callValidate.root = root ? root : callValidate</span><span class="s3">;</span>
    <span class="s1">if </span><span class="s0">(schemaObj.schema.$async === </span><span class="s1">true</span><span class="s0">)</span>
      <span class="s0">callValidate.$async = </span><span class="s1">true</span><span class="s3">;</span>
    <span class="s1">return </span><span class="s0">callValidate</span><span class="s3">;</span>
  <span class="s0">}</span>
  <span class="s0">schemaObj.compiling = </span><span class="s1">true</span><span class="s3">;</span>

  <span class="s1">var </span><span class="s0">currentOpts</span><span class="s3">;</span>
  <span class="s1">if </span><span class="s0">(schemaObj.meta) {</span>
    <span class="s0">currentOpts = </span><span class="s1">this</span><span class="s0">._opts</span><span class="s3">;</span>
    <span class="s1">this</span><span class="s0">._opts = </span><span class="s1">this</span><span class="s0">._metaOpts</span><span class="s3">;</span>
  <span class="s0">}</span>

  <span class="s1">var </span><span class="s0">v</span><span class="s3">;</span>
  <span class="s1">try </span><span class="s0">{ v = compileSchema.call(</span><span class="s1">this</span><span class="s3">, </span><span class="s0">schemaObj.schema</span><span class="s3">, </span><span class="s0">root</span><span class="s3">, </span><span class="s0">schemaObj.localRefs)</span><span class="s3">; </span><span class="s0">}</span>
  <span class="s1">catch</span><span class="s0">(e) {</span>
    <span class="s1">delete </span><span class="s0">schemaObj.validate</span><span class="s3">;</span>
    <span class="s1">throw </span><span class="s0">e</span><span class="s3">;</span>
  <span class="s0">}</span>
  <span class="s1">finally </span><span class="s0">{</span>
    <span class="s0">schemaObj.compiling = </span><span class="s1">false</span><span class="s3">;</span>
    <span class="s1">if </span><span class="s0">(schemaObj.meta) </span><span class="s1">this</span><span class="s0">._opts = currentOpts</span><span class="s3">;</span>
  <span class="s0">}</span>

  <span class="s0">schemaObj.validate = v</span><span class="s3">;</span>
  <span class="s0">schemaObj.refs = v.refs</span><span class="s3">;</span>
  <span class="s0">schemaObj.refVal = v.refVal</span><span class="s3">;</span>
  <span class="s0">schemaObj.root = v.root</span><span class="s3">;</span>
  <span class="s1">return </span><span class="s0">v</span><span class="s3">;</span>


  <span class="s7">/* @this   {*} - custom context, see passContext option */</span>
  <span class="s1">function </span><span class="s0">callValidate() {</span>
    <span class="s7">/* jshint validthis: true */</span>
    <span class="s1">var </span><span class="s0">_validate = schemaObj.validate</span><span class="s3">;</span>
    <span class="s1">var </span><span class="s0">result = _validate.apply(</span><span class="s1">this</span><span class="s3">, </span><span class="s0">arguments)</span><span class="s3">;</span>
    <span class="s0">callValidate.errors = _validate.errors</span><span class="s3">;</span>
    <span class="s1">return </span><span class="s0">result</span><span class="s3">;</span>
  <span class="s0">}</span>
<span class="s0">}</span>


<span class="s1">function </span><span class="s0">chooseGetId(opts) {</span>
  <span class="s1">switch </span><span class="s0">(opts.schemaId) {</span>
    <span class="s1">case </span><span class="s2">'auto'</span><span class="s0">: </span><span class="s1">return </span><span class="s0">_get$IdOrId</span><span class="s3">;</span>
    <span class="s1">case </span><span class="s2">'id'</span><span class="s0">: </span><span class="s1">return </span><span class="s0">_getId</span><span class="s3">;</span>
    <span class="s1">default</span><span class="s0">: </span><span class="s1">return </span><span class="s0">_get$Id</span><span class="s3">;</span>
  <span class="s0">}</span>
<span class="s0">}</span>

<span class="s7">/* @this   Ajv */</span>
<span class="s1">function </span><span class="s0">_getId(schema) {</span>
  <span class="s1">if </span><span class="s0">(schema.$id) </span><span class="s1">this</span><span class="s0">.logger.warn(</span><span class="s2">'schema $id ignored'</span><span class="s3">, </span><span class="s0">schema.$id)</span><span class="s3">;</span>
  <span class="s1">return </span><span class="s0">schema.id</span><span class="s3">;</span>
<span class="s0">}</span>

<span class="s7">/* @this   Ajv */</span>
<span class="s1">function </span><span class="s0">_get$Id(schema) {</span>
  <span class="s1">if </span><span class="s0">(schema.id) </span><span class="s1">this</span><span class="s0">.logger.warn(</span><span class="s2">'schema id ignored'</span><span class="s3">, </span><span class="s0">schema.id)</span><span class="s3">;</span>
  <span class="s1">return </span><span class="s0">schema.$id</span><span class="s3">;</span>
<span class="s0">}</span>


<span class="s1">function </span><span class="s0">_get$IdOrId(schema) {</span>
  <span class="s1">if </span><span class="s0">(schema.$id &amp;&amp; schema.id &amp;&amp; schema.$id != schema.id)</span>
    <span class="s1">throw new </span><span class="s0">Error(</span><span class="s2">'schema $id is different from id'</span><span class="s0">)</span><span class="s3">;</span>
  <span class="s1">return </span><span class="s0">schema.$id || schema.id</span><span class="s3">;</span>
<span class="s0">}</span>


<span class="s5">/**</span>
 <span class="s5">* Convert array of error message objects to string</span>
 <span class="s5">* </span><span class="s6">@this   </span><span class="s5">Ajv</span>
 <span class="s5">* </span><span class="s6">@param  </span><span class="s5">{Array&lt;Object&gt;} errors optional array of validation errors, if not passed errors from the instance are used.</span>
 <span class="s5">* </span><span class="s6">@param  </span><span class="s5">{Object} options optional options with properties `separator` and `dataVar`.</span>
 <span class="s5">* </span><span class="s6">@return </span><span class="s5">{String} human readable string with all errors descriptions</span>
 <span class="s5">*/</span>
<span class="s1">function </span><span class="s0">errorsText(errors</span><span class="s3">, </span><span class="s0">options) {</span>
  <span class="s0">errors = errors || </span><span class="s1">this</span><span class="s0">.errors</span><span class="s3">;</span>
  <span class="s1">if </span><span class="s0">(!errors) </span><span class="s1">return </span><span class="s2">'No errors'</span><span class="s3">;</span>
  <span class="s0">options = options || {}</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">separator = options.separator === undefined ? </span><span class="s2">', ' </span><span class="s0">: options.separator</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">dataVar = options.dataVar === undefined ? </span><span class="s2">'data' </span><span class="s0">: options.dataVar</span><span class="s3">;</span>

  <span class="s1">var </span><span class="s0">text = </span><span class="s2">''</span><span class="s3">;</span>
  <span class="s1">for </span><span class="s0">(</span><span class="s1">var </span><span class="s0">i=</span><span class="s4">0</span><span class="s3">; </span><span class="s0">i&lt;errors.length</span><span class="s3">; </span><span class="s0">i++) {</span>
    <span class="s1">var </span><span class="s0">e = errors[i]</span><span class="s3">;</span>
    <span class="s1">if </span><span class="s0">(e) text += dataVar + e.dataPath + </span><span class="s2">' ' </span><span class="s0">+ e.message + separator</span><span class="s3">;</span>
  <span class="s0">}</span>
  <span class="s1">return </span><span class="s0">text.slice(</span><span class="s4">0</span><span class="s3">, </span><span class="s0">-separator.length)</span><span class="s3">;</span>
<span class="s0">}</span>


<span class="s5">/**</span>
 <span class="s5">* Add custom format</span>
 <span class="s5">* </span><span class="s6">@this   </span><span class="s5">Ajv</span>
 <span class="s5">* </span><span class="s6">@param </span><span class="s5">{String} name format name</span>
 <span class="s5">* </span><span class="s6">@param </span><span class="s5">{String|RegExp|Function} format string is converted to RegExp; function should return boolean (true when valid)</span>
 <span class="s5">* </span><span class="s6">@return </span><span class="s5">{Ajv} this for method chaining</span>
 <span class="s5">*/</span>
<span class="s1">function </span><span class="s0">addFormat(name</span><span class="s3">, </span><span class="s0">format) {</span>
  <span class="s1">if </span><span class="s0">(</span><span class="s1">typeof </span><span class="s0">format == </span><span class="s2">'string'</span><span class="s0">) format = </span><span class="s1">new </span><span class="s0">RegExp(format)</span><span class="s3">;</span>
  <span class="s1">this</span><span class="s0">._formats[name] = format</span><span class="s3">;</span>
  <span class="s1">return this</span><span class="s3">;</span>
<span class="s0">}</span>


<span class="s1">function </span><span class="s0">addDefaultMetaSchema(self) {</span>
  <span class="s1">var </span><span class="s0">$dataSchema</span><span class="s3">;</span>
  <span class="s1">if </span><span class="s0">(self._opts.$data) {</span>
    <span class="s0">$dataSchema = require(</span><span class="s2">'./refs/data.json'</span><span class="s0">)</span><span class="s3">;</span>
    <span class="s0">self.addMetaSchema($dataSchema</span><span class="s3">, </span><span class="s0">$dataSchema.$id</span><span class="s3">, </span><span class="s1">true</span><span class="s0">)</span><span class="s3">;</span>
  <span class="s0">}</span>
  <span class="s1">if </span><span class="s0">(self._opts.meta === </span><span class="s1">false</span><span class="s0">) </span><span class="s1">return</span><span class="s3">;</span>
  <span class="s1">var </span><span class="s0">metaSchema = require(</span><span class="s2">'./refs/json-schema-draft-07.json'</span><span class="s0">)</span><span class="s3">;</span>
  <span class="s1">if </span><span class="s0">(self._opts.$data) metaSchema = $dataMetaSchema(metaSchema</span><span class="s3">, </span><span class="s0">META_SUPPORT_DATA)</span><span class="s3">;</span>
  <span class="s0">self.addMetaSchema(metaSchema</span><span class="s3">, </span><span class="s0">META_SCHEMA_ID</span><span class="s3">, </span><span class="s1">true</span><span class="s0">)</span><span class="s3">;</span>
  <span class="s0">self._refs[</span><span class="s2">'http://json-schema.org/schema'</span><span class="s0">] = META_SCHEMA_ID</span><span class="s3">;</span>
<span class="s0">}</span>


<span class="s1">function </span><span class="s0">addInitialSchemas(self) {</span>
  <span class="s1">var </span><span class="s0">optsSchemas = self._opts.schemas</span><span class="s3">;</span>
  <span class="s1">if </span><span class="s0">(!optsSchemas) </span><span class="s1">return</span><span class="s3">;</span>
  <span class="s1">if </span><span class="s0">(Array.isArray(optsSchemas)) self.addSchema(optsSchemas)</span><span class="s3">;</span>
  <span class="s1">else for </span><span class="s0">(</span><span class="s1">var </span><span class="s0">key </span><span class="s1">in </span><span class="s0">optsSchemas) self.addSchema(optsSchemas[key]</span><span class="s3">, </span><span class="s0">key)</span><span class="s3">;</span>
<span class="s0">}</span>


<span class="s1">function </span><span class="s0">addInitialFormats(self) {</span>
  <span class="s1">for </span><span class="s0">(</span><span class="s1">var </span><span class="s0">name </span><span class="s1">in </span><span class="s0">self._opts.formats) {</span>
    <span class="s1">var </span><span class="s0">format = self._opts.formats[name]</span><span class="s3">;</span>
    <span class="s0">self.addFormat(name</span><span class="s3">, </span><span class="s0">format)</span><span class="s3">;</span>
  <span class="s0">}</span>
<span class="s0">}</span>


<span class="s1">function </span><span class="s0">addInitialKeywords(self) {</span>
  <span class="s1">for </span><span class="s0">(</span><span class="s1">var </span><span class="s0">name </span><span class="s1">in </span><span class="s0">self._opts.keywords) {</span>
    <span class="s1">var </span><span class="s0">keyword = self._opts.keywords[name]</span><span class="s3">;</span>
    <span class="s0">self.addKeyword(name</span><span class="s3">, </span><span class="s0">keyword)</span><span class="s3">;</span>
  <span class="s0">}</span>
<span class="s0">}</span>


<span class="s1">function </span><span class="s0">checkUnique(self</span><span class="s3">, </span><span class="s0">id) {</span>
  <span class="s1">if </span><span class="s0">(self._schemas[id] || self._refs[id])</span>
    <span class="s1">throw new </span><span class="s0">Error(</span><span class="s2">'schema with key or id &quot;' </span><span class="s0">+ id + </span><span class="s2">'&quot; already exists'</span><span class="s0">)</span><span class="s3">;</span>
<span class="s0">}</span>


<span class="s1">function </span><span class="s0">getMetaSchemaOptions(self) {</span>
  <span class="s1">var </span><span class="s0">metaOpts = util.copy(self._opts)</span><span class="s3">;</span>
  <span class="s1">for </span><span class="s0">(</span><span class="s1">var </span><span class="s0">i=</span><span class="s4">0</span><span class="s3">; </span><span class="s0">i&lt;META_IGNORE_OPTIONS.length</span><span class="s3">; </span><span class="s0">i++)</span>
    <span class="s1">delete </span><span class="s0">metaOpts[META_IGNORE_OPTIONS[i]]</span><span class="s3">;</span>
  <span class="s1">return </span><span class="s0">metaOpts</span><span class="s3">;</span>
<span class="s0">}</span>


<span class="s1">function </span><span class="s0">setLogger(self) {</span>
  <span class="s1">var </span><span class="s0">logger = self._opts.logger</span><span class="s3">;</span>
  <span class="s1">if </span><span class="s0">(logger === </span><span class="s1">false</span><span class="s0">) {</span>
    <span class="s0">self.logger = {log: noop</span><span class="s3">, </span><span class="s0">warn: noop</span><span class="s3">, </span><span class="s0">error: noop}</span><span class="s3">;</span>
  <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
    <span class="s1">if </span><span class="s0">(logger === undefined) logger = console</span><span class="s3">;</span>
    <span class="s1">if </span><span class="s0">(!(</span><span class="s1">typeof </span><span class="s0">logger == </span><span class="s2">'object' </span><span class="s0">&amp;&amp; logger.log &amp;&amp; logger.warn &amp;&amp; logger.error))</span>
      <span class="s1">throw new </span><span class="s0">Error(</span><span class="s2">'logger must implement log, warn and error methods'</span><span class="s0">)</span><span class="s3">;</span>
    <span class="s0">self.logger = logger</span><span class="s3">;</span>
  <span class="s0">}</span>
<span class="s0">}</span>


<span class="s1">function </span><span class="s0">noop() {}</span>

<span class="s0">}</span><span class="s3">,</span><span class="s0">{</span><span class="s2">&quot;./cache&quot;</span><span class="s0">:</span><span class="s4">1</span><span class="s3">,</span><span class="s2">&quot;./compile&quot;</span><span class="s0">:</span><span class="s4">5</span><span class="s3">,</span><span class="s2">&quot;./compile/async&quot;</span><span class="s0">:</span><span class="s4">2</span><span class="s3">,</span><span class="s2">&quot;./compile/error_classes&quot;</span><span class="s0">:</span><span class="s4">3</span><span class="s3">,</span><span class="s2">&quot;./compile/formats&quot;</span><span class="s0">:</span><span class="s4">4</span><span class="s3">,</span><span class="s2">&quot;./compile/resolve&quot;</span><span class="s0">:</span><span class="s4">6</span><span class="s3">,</span><span class="s2">&quot;./compile/rules&quot;</span><span class="s0">:</span><span class="s4">7</span><span class="s3">,</span><span class="s2">&quot;./compile/schema_obj&quot;</span><span class="s0">:</span><span class="s4">8</span><span class="s3">,</span><span class="s2">&quot;./compile/util&quot;</span><span class="s0">:</span><span class="s4">10</span><span class="s3">,</span><span class="s2">&quot;./data&quot;</span><span class="s0">:</span><span class="s4">11</span><span class="s3">,</span><span class="s2">&quot;./keyword&quot;</span><span class="s0">:</span><span class="s4">39</span><span class="s3">,</span><span class="s2">&quot;./refs/data.json&quot;</span><span class="s0">:</span><span class="s4">40</span><span class="s3">,</span><span class="s2">&quot;./refs/json-schema-draft-07.json&quot;</span><span class="s0">:</span><span class="s4">41</span><span class="s3">,</span><span class="s2">&quot;fast-json-stable-stringify&quot;</span><span class="s0">:</span><span class="s4">43</span><span class="s0">}]}</span><span class="s3">,</span><span class="s0">{}</span><span class="s3">,</span><span class="s0">[])(</span><span class="s2">&quot;ajv&quot;</span><span class="s0">)</span>
<span class="s0">})</span><span class="s3">;</span>
</pre>
</body>
</html>