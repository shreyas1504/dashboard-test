<html>
<head>
<title>umd-with-async-ittr.js</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.s0 { color: #cfd2d5;}
.s1 { color: #cc7832; font-weight: bold;}
.s2 { color: #cc7832;}
.s3 { color: #8ea765;}
.s4 { color: #6897bb;}
</style>
</head>
<body bgcolor="#1c1c1c">
<table CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#606060" >
<tr><td><center>
<font face="Arial, Helvetica" color="#000000">
umd-with-async-ittr.js</font>
</center></td></tr></table>
<pre><span class="s0">!</span><span class="s1">function</span><span class="s0">(e</span><span class="s2">,</span><span class="s0">t){</span><span class="s3">&quot;object&quot;</span><span class="s0">==</span><span class="s1">typeof </span><span class="s0">exports&amp;&amp;</span><span class="s3">&quot;undefined&quot;</span><span class="s0">!=</span><span class="s1">typeof </span><span class="s0">module?t(exports):</span><span class="s3">&quot;function&quot;</span><span class="s0">==</span><span class="s1">typeof </span><span class="s0">define&amp;&amp;define.amd?define([</span><span class="s3">&quot;exports&quot;</span><span class="s0">]</span><span class="s2">,</span><span class="s0">t):t((e=</span><span class="s3">&quot;undefined&quot;</span><span class="s0">!=</span><span class="s1">typeof </span><span class="s0">globalThis?globalThis:e||self).idb={})}(</span><span class="s1">this</span><span class="s2">,</span><span class="s0">(</span><span class="s1">function</span><span class="s0">(e){</span><span class="s3">&quot;use strict&quot;</span><span class="s2">;</span><span class="s1">const </span><span class="s0">t=(e</span><span class="s2">,</span><span class="s0">t)=&gt;t.some((t=&gt;e </span><span class="s1">instanceof </span><span class="s0">t))</span><span class="s2">;</span><span class="s1">let </span><span class="s0">n</span><span class="s2">,</span><span class="s0">r</span><span class="s2">;</span><span class="s1">const </span><span class="s0">o=</span><span class="s1">new </span><span class="s0">WeakMap</span><span class="s2">,</span><span class="s0">s=</span><span class="s1">new </span><span class="s0">WeakMap</span><span class="s2">,</span><span class="s0">i=</span><span class="s1">new </span><span class="s0">WeakMap</span><span class="s2">,</span><span class="s0">a=</span><span class="s1">new </span><span class="s0">WeakMap</span><span class="s2">,</span><span class="s0">c=</span><span class="s1">new </span><span class="s0">WeakMap</span><span class="s2">;</span><span class="s1">let </span><span class="s0">u={get(e</span><span class="s2">,</span><span class="s0">t</span><span class="s2">,</span><span class="s0">n){</span><span class="s1">if</span><span class="s0">(e </span><span class="s1">instanceof </span><span class="s0">IDBTransaction){</span><span class="s1">if</span><span class="s0">(</span><span class="s3">&quot;done&quot;</span><span class="s0">===t)</span><span class="s1">return </span><span class="s0">s.get(e)</span><span class="s2">;</span><span class="s1">if</span><span class="s0">(</span><span class="s3">&quot;objectStoreNames&quot;</span><span class="s0">===t)</span><span class="s1">return </span><span class="s0">e.objectStoreNames||i.get(e)</span><span class="s2">;</span><span class="s1">if</span><span class="s0">(</span><span class="s3">&quot;store&quot;</span><span class="s0">===t)</span><span class="s1">return </span><span class="s0">n.objectStoreNames[</span><span class="s4">1</span><span class="s0">]?</span><span class="s1">void </span><span class="s4">0</span><span class="s0">:n.objectStore(n.objectStoreNames[</span><span class="s4">0</span><span class="s0">])}</span><span class="s1">return </span><span class="s0">p(e[t])}</span><span class="s2">,</span><span class="s0">set:(e</span><span class="s2">,</span><span class="s0">t</span><span class="s2">,</span><span class="s0">n)=&gt;(e[t]=n</span><span class="s2">,</span><span class="s0">!</span><span class="s4">0</span><span class="s0">)</span><span class="s2">,</span><span class="s0">has:(e</span><span class="s2">,</span><span class="s0">t)=&gt;e </span><span class="s1">instanceof </span><span class="s0">IDBTransaction&amp;&amp;(</span><span class="s3">&quot;done&quot;</span><span class="s0">===t||</span><span class="s3">&quot;store&quot;</span><span class="s0">===t)||t </span><span class="s1">in </span><span class="s0">e}</span><span class="s2">;</span><span class="s1">function </span><span class="s0">d(e){u=e(u)}</span><span class="s1">function </span><span class="s0">f(e){</span><span class="s1">return </span><span class="s0">e!==IDBDatabase.prototype.transaction||</span><span class="s3">&quot;objectStoreNames&quot;</span><span class="s1">in </span><span class="s0">IDBTransaction.prototype?(r||(r=[IDBCursor.prototype.advance</span><span class="s2">,</span><span class="s0">IDBCursor.prototype.continue</span><span class="s2">,</span><span class="s0">IDBCursor.prototype.continuePrimaryKey])).includes(e)?</span><span class="s1">function</span><span class="s0">(...t){</span><span class="s1">return </span><span class="s0">e.apply(D(</span><span class="s1">this</span><span class="s0">)</span><span class="s2">,</span><span class="s0">t)</span><span class="s2">,</span><span class="s0">p(o.get(</span><span class="s1">this</span><span class="s0">))}:</span><span class="s1">function</span><span class="s0">(...t){</span><span class="s1">return </span><span class="s0">p(e.apply(D(</span><span class="s1">this</span><span class="s0">)</span><span class="s2">,</span><span class="s0">t))}:</span><span class="s1">function</span><span class="s0">(t</span><span class="s2">,</span><span class="s0">...n){</span><span class="s1">const </span><span class="s0">r=e.call(D(</span><span class="s1">this</span><span class="s0">)</span><span class="s2">,</span><span class="s0">t</span><span class="s2">,</span><span class="s0">...n)</span><span class="s2">;</span><span class="s1">return </span><span class="s0">i.set(r</span><span class="s2">,</span><span class="s0">t.sort?t.sort():[t])</span><span class="s2">,</span><span class="s0">p(r)}}</span><span class="s1">function </span><span class="s0">l(e){</span><span class="s1">return</span><span class="s3">&quot;function&quot;</span><span class="s0">==</span><span class="s1">typeof </span><span class="s0">e?f(e):(e </span><span class="s1">instanceof </span><span class="s0">IDBTransaction&amp;&amp;</span><span class="s1">function</span><span class="s0">(e){</span><span class="s1">if</span><span class="s0">(s.has(e))</span><span class="s1">return</span><span class="s2">;</span><span class="s1">const </span><span class="s0">t=</span><span class="s1">new </span><span class="s0">Promise(((t</span><span class="s2">,</span><span class="s0">n)=&gt;{</span><span class="s1">const </span><span class="s0">r=()=&gt;{e.removeEventListener(</span><span class="s3">&quot;complete&quot;</span><span class="s2">,</span><span class="s0">o)</span><span class="s2">,</span><span class="s0">e.removeEventListener(</span><span class="s3">&quot;error&quot;</span><span class="s2">,</span><span class="s0">s)</span><span class="s2">,</span><span class="s0">e.removeEventListener(</span><span class="s3">&quot;abort&quot;</span><span class="s2">,</span><span class="s0">s)}</span><span class="s2">,</span><span class="s0">o=()=&gt;{t()</span><span class="s2">,</span><span class="s0">r()}</span><span class="s2">,</span><span class="s0">s=()=&gt;{n(e.error||</span><span class="s1">new </span><span class="s0">DOMException(</span><span class="s3">&quot;AbortError&quot;</span><span class="s2">,</span><span class="s3">&quot;AbortError&quot;</span><span class="s0">))</span><span class="s2">,</span><span class="s0">r()}</span><span class="s2">;</span><span class="s0">e.addEventListener(</span><span class="s3">&quot;complete&quot;</span><span class="s2">,</span><span class="s0">o)</span><span class="s2">,</span><span class="s0">e.addEventListener(</span><span class="s3">&quot;error&quot;</span><span class="s2">,</span><span class="s0">s)</span><span class="s2">,</span><span class="s0">e.addEventListener(</span><span class="s3">&quot;abort&quot;</span><span class="s2">,</span><span class="s0">s)}))</span><span class="s2">;</span><span class="s0">s.set(e</span><span class="s2">,</span><span class="s0">t)}(e)</span><span class="s2">,</span><span class="s0">t(e</span><span class="s2">,</span><span class="s0">n||(n=[IDBDatabase</span><span class="s2">,</span><span class="s0">IDBObjectStore</span><span class="s2">,</span><span class="s0">IDBIndex</span><span class="s2">,</span><span class="s0">IDBCursor</span><span class="s2">,</span><span class="s0">IDBTransaction]))?</span><span class="s1">new </span><span class="s0">Proxy(e</span><span class="s2">,</span><span class="s0">u):e)}</span><span class="s1">function </span><span class="s0">p(e){</span><span class="s1">if</span><span class="s0">(e </span><span class="s1">instanceof </span><span class="s0">IDBRequest)</span><span class="s1">return function</span><span class="s0">(e){</span><span class="s1">const </span><span class="s0">t=</span><span class="s1">new </span><span class="s0">Promise(((t</span><span class="s2">,</span><span class="s0">n)=&gt;{</span><span class="s1">const </span><span class="s0">r=()=&gt;{e.removeEventListener(</span><span class="s3">&quot;success&quot;</span><span class="s2">,</span><span class="s0">o)</span><span class="s2">,</span><span class="s0">e.removeEventListener(</span><span class="s3">&quot;error&quot;</span><span class="s2">,</span><span class="s0">s)}</span><span class="s2">,</span><span class="s0">o=()=&gt;{t(p(e.result))</span><span class="s2">,</span><span class="s0">r()}</span><span class="s2">,</span><span class="s0">s=()=&gt;{n(e.error)</span><span class="s2">,</span><span class="s0">r()}</span><span class="s2">;</span><span class="s0">e.addEventListener(</span><span class="s3">&quot;success&quot;</span><span class="s2">,</span><span class="s0">o)</span><span class="s2">,</span><span class="s0">e.addEventListener(</span><span class="s3">&quot;error&quot;</span><span class="s2">,</span><span class="s0">s)}))</span><span class="s2">;</span><span class="s1">return </span><span class="s0">t.then((t=&gt;{t </span><span class="s1">instanceof </span><span class="s0">IDBCursor&amp;&amp;o.set(t</span><span class="s2">,</span><span class="s0">e)})).catch((()=&gt;{}))</span><span class="s2">,</span><span class="s0">c.set(t</span><span class="s2">,</span><span class="s0">e)</span><span class="s2">,</span><span class="s0">t}(e)</span><span class="s2">;</span><span class="s1">if</span><span class="s0">(a.has(e))</span><span class="s1">return </span><span class="s0">a.get(e)</span><span class="s2">;</span><span class="s1">const </span><span class="s0">t=l(e)</span><span class="s2">;</span><span class="s1">return </span><span class="s0">t!==e&amp;&amp;(a.set(e</span><span class="s2">,</span><span class="s0">t)</span><span class="s2">,</span><span class="s0">c.set(t</span><span class="s2">,</span><span class="s0">e))</span><span class="s2">,</span><span class="s0">t}</span><span class="s1">const </span><span class="s0">D=e=&gt;c.get(e)</span><span class="s2">;</span><span class="s1">const </span><span class="s0">I=[</span><span class="s3">&quot;get&quot;</span><span class="s2">,</span><span class="s3">&quot;getKey&quot;</span><span class="s2">,</span><span class="s3">&quot;getAll&quot;</span><span class="s2">,</span><span class="s3">&quot;getAllKeys&quot;</span><span class="s2">,</span><span class="s3">&quot;count&quot;</span><span class="s0">]</span><span class="s2">,</span><span class="s0">b=[</span><span class="s3">&quot;put&quot;</span><span class="s2">,</span><span class="s3">&quot;add&quot;</span><span class="s2">,</span><span class="s3">&quot;delete&quot;</span><span class="s2">,</span><span class="s3">&quot;clear&quot;</span><span class="s0">]</span><span class="s2">,</span><span class="s0">y=</span><span class="s1">new </span><span class="s0">Map</span><span class="s2">;</span><span class="s1">function </span><span class="s0">B(e</span><span class="s2">,</span><span class="s0">t){</span><span class="s1">if</span><span class="s0">(!(e </span><span class="s1">instanceof </span><span class="s0">IDBDatabase)||t </span><span class="s1">in </span><span class="s0">e||</span><span class="s3">&quot;string&quot;</span><span class="s0">!=</span><span class="s1">typeof </span><span class="s0">t)</span><span class="s1">return</span><span class="s2">;</span><span class="s1">if</span><span class="s0">(y.get(t))</span><span class="s1">return </span><span class="s0">y.get(t)</span><span class="s2">;</span><span class="s1">const </span><span class="s0">n=t.replace(</span><span class="s4">/FromIndex$/</span><span class="s2">,</span><span class="s3">&quot;&quot;</span><span class="s0">)</span><span class="s2">,</span><span class="s0">r=t!==n</span><span class="s2">,</span><span class="s0">o=b.includes(n)</span><span class="s2">;</span><span class="s1">if</span><span class="s0">(!(n </span><span class="s1">in</span><span class="s0">(r?IDBIndex:IDBObjectStore).prototype)||!o&amp;&amp;!I.includes(n))</span><span class="s1">return</span><span class="s2">;</span><span class="s1">const </span><span class="s0">s=async </span><span class="s1">function</span><span class="s0">(e</span><span class="s2">,</span><span class="s0">...t){</span><span class="s1">const </span><span class="s0">s=</span><span class="s1">this</span><span class="s0">.transaction(e</span><span class="s2">,</span><span class="s0">o?</span><span class="s3">&quot;readwrite&quot;</span><span class="s0">:</span><span class="s3">&quot;readonly&quot;</span><span class="s0">)</span><span class="s2">;</span><span class="s1">let </span><span class="s0">i=s.store</span><span class="s2">;</span><span class="s1">return </span><span class="s0">r&amp;&amp;(i=i.index(t.shift()))</span><span class="s2">,</span><span class="s0">(</span><span class="s1">await </span><span class="s0">Promise.all([i[n](...t)</span><span class="s2">,</span><span class="s0">o&amp;&amp;s.done]))[</span><span class="s4">0</span><span class="s0">]}</span><span class="s2">;</span><span class="s1">return </span><span class="s0">y.set(t</span><span class="s2">,</span><span class="s0">s)</span><span class="s2">,</span><span class="s0">s}d((e=&gt;({...e</span><span class="s2">,</span><span class="s0">get:(t</span><span class="s2">,</span><span class="s0">n</span><span class="s2">,</span><span class="s0">r)=&gt;B(t</span><span class="s2">,</span><span class="s0">n)||e.get(t</span><span class="s2">,</span><span class="s0">n</span><span class="s2">,</span><span class="s0">r)</span><span class="s2">,</span><span class="s0">has:(t</span><span class="s2">,</span><span class="s0">n)=&gt;!!B(t</span><span class="s2">,</span><span class="s0">n)||e.has(t</span><span class="s2">,</span><span class="s0">n)})))</span><span class="s2">;</span><span class="s1">const </span><span class="s0">g=[</span><span class="s3">&quot;continue&quot;</span><span class="s2">,</span><span class="s3">&quot;continuePrimaryKey&quot;</span><span class="s2">,</span><span class="s3">&quot;advance&quot;</span><span class="s0">]</span><span class="s2">,</span><span class="s0">h={}</span><span class="s2">,</span><span class="s0">v=</span><span class="s1">new </span><span class="s0">WeakMap</span><span class="s2">,</span><span class="s0">m=</span><span class="s1">new </span><span class="s0">WeakMap</span><span class="s2">,</span><span class="s0">w={get(e</span><span class="s2">,</span><span class="s0">t){</span><span class="s1">if</span><span class="s0">(!g.includes(t))</span><span class="s1">return </span><span class="s0">e[t]</span><span class="s2">;</span><span class="s1">let </span><span class="s0">n=h[t]</span><span class="s2">;</span><span class="s1">return </span><span class="s0">n||(n=h[t]=</span><span class="s1">function</span><span class="s0">(...e){v.set(</span><span class="s1">this</span><span class="s2">,</span><span class="s0">m.get(</span><span class="s1">this</span><span class="s0">)[t](...e))})</span><span class="s2">,</span><span class="s0">n}}</span><span class="s2">;</span><span class="s0">async </span><span class="s1">function</span><span class="s0">*E(...e){</span><span class="s1">let </span><span class="s0">t=</span><span class="s1">this</span><span class="s2">;</span><span class="s1">if</span><span class="s0">(t </span><span class="s1">instanceof </span><span class="s0">IDBCursor||(t=</span><span class="s1">await </span><span class="s0">t.openCursor(...e))</span><span class="s2">,</span><span class="s0">!t)</span><span class="s1">return</span><span class="s2">;</span><span class="s1">const </span><span class="s0">n=</span><span class="s1">new </span><span class="s0">Proxy(t</span><span class="s2">,</span><span class="s0">w)</span><span class="s2">;</span><span class="s1">for</span><span class="s0">(m.set(n</span><span class="s2">,</span><span class="s0">t)</span><span class="s2">,</span><span class="s0">c.set(n</span><span class="s2">,</span><span class="s0">D(t))</span><span class="s2">;</span><span class="s0">t</span><span class="s2">;</span><span class="s0">)</span><span class="s1">yield </span><span class="s0">n</span><span class="s2">,</span><span class="s0">t=</span><span class="s1">await</span><span class="s0">(v.get(n)||t.continue())</span><span class="s2">,</span><span class="s0">v.delete(n)}</span><span class="s1">function </span><span class="s0">L(e</span><span class="s2">,</span><span class="s0">n){</span><span class="s1">return </span><span class="s0">n===Symbol.asyncIterator&amp;&amp;t(e</span><span class="s2">,</span><span class="s0">[IDBIndex</span><span class="s2">,</span><span class="s0">IDBObjectStore</span><span class="s2">,</span><span class="s0">IDBCursor])||</span><span class="s3">&quot;iterate&quot;</span><span class="s0">===n&amp;&amp;t(e</span><span class="s2">,</span><span class="s0">[IDBIndex</span><span class="s2">,</span><span class="s0">IDBObjectStore])}d((e=&gt;({...e</span><span class="s2">,</span><span class="s0">get:(t</span><span class="s2">,</span><span class="s0">n</span><span class="s2">,</span><span class="s0">r)=&gt;L(t</span><span class="s2">,</span><span class="s0">n)?E:e.get(t</span><span class="s2">,</span><span class="s0">n</span><span class="s2">,</span><span class="s0">r)</span><span class="s2">,</span><span class="s0">has:(t</span><span class="s2">,</span><span class="s0">n)=&gt;L(t</span><span class="s2">,</span><span class="s0">n)||e.has(t</span><span class="s2">,</span><span class="s0">n)})))</span><span class="s2">,</span><span class="s0">e.deleteDB=</span><span class="s1">function</span><span class="s0">(e</span><span class="s2">,</span><span class="s0">{blocked:t}={}){</span><span class="s1">const </span><span class="s0">n=indexedDB.deleteDatabase(e)</span><span class="s2">;</span><span class="s1">return </span><span class="s0">t&amp;&amp;n.addEventListener(</span><span class="s3">&quot;blocked&quot;</span><span class="s2">,</span><span class="s0">(e=&gt;t(e.oldVersion</span><span class="s2">,</span><span class="s0">e)))</span><span class="s2">,</span><span class="s0">p(n).then((()=&gt;{}))}</span><span class="s2">,</span><span class="s0">e.openDB=</span><span class="s1">function</span><span class="s0">(e</span><span class="s2">,</span><span class="s0">t</span><span class="s2">,</span><span class="s0">{blocked:n</span><span class="s2">,</span><span class="s0">upgrade:r</span><span class="s2">,</span><span class="s0">blocking:o</span><span class="s2">,</span><span class="s0">terminated:s}={}){</span><span class="s1">const </span><span class="s0">i=indexedDB.open(e</span><span class="s2">,</span><span class="s0">t)</span><span class="s2">,</span><span class="s0">a=p(i)</span><span class="s2">;</span><span class="s1">return </span><span class="s0">r&amp;&amp;i.addEventListener(</span><span class="s3">&quot;upgradeneeded&quot;</span><span class="s2">,</span><span class="s0">(e=&gt;{r(p(i.result)</span><span class="s2">,</span><span class="s0">e.oldVersion</span><span class="s2">,</span><span class="s0">e.newVersion</span><span class="s2">,</span><span class="s0">p(i.transaction)</span><span class="s2">,</span><span class="s0">e)}))</span><span class="s2">,</span><span class="s0">n&amp;&amp;i.addEventListener(</span><span class="s3">&quot;blocked&quot;</span><span class="s2">,</span><span class="s0">(e=&gt;n(e.oldVersion</span><span class="s2">,</span><span class="s0">e.newVersion</span><span class="s2">,</span><span class="s0">e)))</span><span class="s2">,</span><span class="s0">a.then((e=&gt;{s&amp;&amp;e.addEventListener(</span><span class="s3">&quot;close&quot;</span><span class="s2">,</span><span class="s0">(()=&gt;s()))</span><span class="s2">,</span><span class="s0">o&amp;&amp;e.addEventListener(</span><span class="s3">&quot;versionchange&quot;</span><span class="s2">,</span><span class="s0">(e=&gt;o(e.oldVersion</span><span class="s2">,</span><span class="s0">e.newVersion</span><span class="s2">,</span><span class="s0">e)))})).catch((()=&gt;{}))</span><span class="s2">,</span><span class="s0">a}</span><span class="s2">,</span><span class="s0">e.unwrap=D</span><span class="s2">,</span><span class="s0">e.wrap=p}))</span><span class="s2">;</span>
</pre>
</body>
</html>